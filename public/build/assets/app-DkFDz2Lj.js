var dq=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var SWe=dq((o5e,jS)=>{var ga=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function hq(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var iB={exports:{}},T1={},sB={exports:{}},vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xv=Symbol.for("react.element"),fq=Symbol.for("react.portal"),gq=Symbol.for("react.fragment"),mq=Symbol.for("react.strict_mode"),pq=Symbol.for("react.profiler"),yq=Symbol.for("react.provider"),vq=Symbol.for("react.context"),wq=Symbol.for("react.forward_ref"),bq=Symbol.for("react.suspense"),xq=Symbol.for("react.memo"),Sq=Symbol.for("react.lazy"),t$=Symbol.iterator;function Cq(t){return t===null||typeof t!="object"?null:(t=t$&&t[t$]||t["@@iterator"],typeof t=="function"?t:null)}var oB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},aB=Object.assign,lB={};function Bm(t,e,r){this.props=t,this.context=e,this.refs=lB,this.updater=r||oB}Bm.prototype.isReactComponent={};Bm.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Bm.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cB(){}cB.prototype=Bm.prototype;function cA(t,e,r){this.props=t,this.context=e,this.refs=lB,this.updater=r||oB}var uA=cA.prototype=new cB;uA.constructor=cA;aB(uA,Bm.prototype);uA.isPureReactComponent=!0;var r$=Array.isArray,uB=Object.prototype.hasOwnProperty,dA={current:null},dB={key:!0,ref:!0,__self:!0,__source:!0};function hB(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)uB.call(e,n)&&!dB.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:xv,type:t,key:s,ref:o,props:i,_owner:dA.current}}function _q(t,e){return{$$typeof:xv,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function hA(t){return typeof t=="object"&&t!==null&&t.$$typeof===xv}function Rq(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var n$=/\/+/g;function oR(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Rq(""+t.key):e.toString(36)}function Lx(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case xv:case fq:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+oR(o,0):n,r$(i)?(r="",t!=null&&(r=t.replace(n$,"$&/")+"/"),Lx(i,e,r,"",function(u){return u})):i!=null&&(hA(i)&&(i=_q(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(n$,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",r$(t))for(var a=0;a<t.length;a++){s=t[a];var c=n+oR(s,a);o+=Lx(s,e,r,c,i)}else if(c=Cq(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=n+oR(s,a++),o+=Lx(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Cw(t,e,r){if(t==null)return t;var n=[],i=0;return Lx(t,n,"","",function(s){return e.call(r,s,i++)}),n}function Eq(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Wi={current:null},Fx={transition:null},Nq={ReactCurrentDispatcher:Wi,ReactCurrentBatchConfig:Fx,ReactCurrentOwner:dA};function fB(){throw Error("act(...) is not supported in production builds of React.")}vt.Children={map:Cw,forEach:function(t,e,r){Cw(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Cw(t,function(){e++}),e},toArray:function(t){return Cw(t,function(e){return e})||[]},only:function(t){if(!hA(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};vt.Component=Bm;vt.Fragment=gq;vt.Profiler=pq;vt.PureComponent=cA;vt.StrictMode=mq;vt.Suspense=bq;vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nq;vt.act=fB;vt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=aB({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=dA.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)uB.call(e,c)&&!dB.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:xv,type:t.type,key:i,ref:s,props:n,_owner:o}};vt.createContext=function(t){return t={$$typeof:vq,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:yq,_context:t},t.Consumer=t};vt.createElement=hB;vt.createFactory=function(t){var e=hB.bind(null,t);return e.type=t,e};vt.createRef=function(){return{current:null}};vt.forwardRef=function(t){return{$$typeof:wq,render:t}};vt.isValidElement=hA;vt.lazy=function(t){return{$$typeof:Sq,_payload:{_status:-1,_result:t},_init:Eq}};vt.memo=function(t,e){return{$$typeof:xq,type:t,compare:e===void 0?null:e}};vt.startTransition=function(t){var e=Fx.transition;Fx.transition={};try{t()}finally{Fx.transition=e}};vt.unstable_act=fB;vt.useCallback=function(t,e){return Wi.current.useCallback(t,e)};vt.useContext=function(t){return Wi.current.useContext(t)};vt.useDebugValue=function(){};vt.useDeferredValue=function(t){return Wi.current.useDeferredValue(t)};vt.useEffect=function(t,e){return Wi.current.useEffect(t,e)};vt.useId=function(){return Wi.current.useId()};vt.useImperativeHandle=function(t,e,r){return Wi.current.useImperativeHandle(t,e,r)};vt.useInsertionEffect=function(t,e){return Wi.current.useInsertionEffect(t,e)};vt.useLayoutEffect=function(t,e){return Wi.current.useLayoutEffect(t,e)};vt.useMemo=function(t,e){return Wi.current.useMemo(t,e)};vt.useReducer=function(t,e,r){return Wi.current.useReducer(t,e,r)};vt.useRef=function(t){return Wi.current.useRef(t)};vt.useState=function(t){return Wi.current.useState(t)};vt.useSyncExternalStore=function(t,e,r){return Wi.current.useSyncExternalStore(t,e,r)};vt.useTransition=function(){return Wi.current.useTransition()};vt.version="18.3.1";sB.exports=vt;var $=sB.exports;const Pt=bv($);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kq=$,Tq=Symbol.for("react.element"),Pq=Symbol.for("react.fragment"),Mq=Object.prototype.hasOwnProperty,Aq=kq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Oq={key:!0,ref:!0,__self:!0,__source:!0};function gB(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Mq.call(e,n)&&!Oq.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Tq,type:t,key:s,ref:o,props:i,_owner:Aq.current}}T1.Fragment=Pq;T1.jsx=gB;T1.jsxs=gB;iB.exports=T1;var l=iB.exports;function mB(t,e){return function(){return t.apply(e,arguments)}}const{toString:Iq}=Object.prototype,{getPrototypeOf:fA}=Object,{iterator:P1,toStringTag:pB}=Symbol,M1=(t=>e=>{const r=Iq.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Na=t=>(t=t.toLowerCase(),e=>M1(e)===t),A1=t=>e=>typeof e===t,{isArray:Wm}=Array,vm=A1("undefined");function Sv(t){return t!==null&&!vm(t)&&t.constructor!==null&&!vm(t.constructor)&&fs(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const yB=Na("ArrayBuffer");function jq(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&yB(t.buffer),e}const Hq=A1("string"),fs=A1("function"),vB=A1("number"),Cv=t=>t!==null&&typeof t=="object",$q=t=>t===!0||t===!1,Vx=t=>{if(M1(t)!=="object")return!1;const e=fA(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(pB in t)&&!(P1 in t)},Dq=t=>{if(!Cv(t)||Sv(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Lq=Na("Date"),Fq=Na("File"),Vq=Na("Blob"),Bq=Na("FileList"),Wq=t=>Cv(t)&&fs(t.pipe),zq=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||fs(t.append)&&((e=M1(t))==="formdata"||e==="object"&&fs(t.toString)&&t.toString()==="[object FormData]"))},Uq=Na("URLSearchParams"),[Yq,Gq,Kq,qq]=["ReadableStream","Request","Response","Headers"].map(Na),Xq=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _v(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,i;if(typeof t!="object"&&(t=[t]),Wm(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{if(Sv(t))return;const s=r?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(n=0;n<o;n++)a=s[n],e.call(null,t[a],a,t)}}function wB(t,e){if(Sv(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,i;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const vh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,bB=t=>!vm(t)&&t!==vh;function RT(){const{caseless:t,skipUndefined:e}=bB(this)&&this||{},r={},n=(i,s)=>{const o=t&&wB(r,s)||s;Vx(r[o])&&Vx(i)?r[o]=RT(r[o],i):Vx(i)?r[o]=RT({},i):Wm(i)?r[o]=i.slice():(!e||!vm(i))&&(r[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&_v(arguments[i],n);return r}const Qq=(t,e,r,{allOwnKeys:n}={})=>(_v(e,(i,s)=>{r&&fs(i)?t[s]=mB(i,r):t[s]=i},{allOwnKeys:n}),t),Jq=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Zq=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},eX=(t,e,r,n)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!n||n(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&fA(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},tX=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},rX=t=>{if(!t)return null;if(Wm(t))return t;let e=t.length;if(!vB(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},nX=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&fA(Uint8Array)),iX=(t,e)=>{const n=(t&&t[P1]).call(t);let i;for(;(i=n.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},sX=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},oX=Na("HTMLFormElement"),aX=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),i$=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),lX=Na("RegExp"),xB=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};_v(r,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(n[s]=o||i)}),Object.defineProperties(t,n)},cX=t=>{xB(t,(e,r)=>{if(fs(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(fs(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},uX=(t,e)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return Wm(t)?n(t):n(String(t).split(e)),r},dX=()=>{},hX=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function fX(t){return!!(t&&fs(t.append)&&t[pB]==="FormData"&&t[P1])}const gX=t=>{const e=new Array(10),r=(n,i)=>{if(Cv(n)){if(e.indexOf(n)>=0)return;if(Sv(n))return n;if(!("toJSON"in n)){e[i]=n;const s=Wm(n)?[]:{};return _v(n,(o,a)=>{const c=r(o,i+1);!vm(c)&&(s[a]=c)}),e[i]=void 0,s}}return n};return r(t,0)},mX=Na("AsyncFunction"),pX=t=>t&&(Cv(t)||fs(t))&&fs(t.then)&&fs(t.catch),SB=((t,e)=>t?setImmediate:e?((r,n)=>(vh.addEventListener("message",({source:i,data:s})=>{i===vh&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),vh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",fs(vh.postMessage)),yX=typeof queueMicrotask<"u"?queueMicrotask.bind(vh):typeof process<"u"&&process.nextTick||SB,vX=t=>t!=null&&fs(t[P1]),J={isArray:Wm,isArrayBuffer:yB,isBuffer:Sv,isFormData:zq,isArrayBufferView:jq,isString:Hq,isNumber:vB,isBoolean:$q,isObject:Cv,isPlainObject:Vx,isEmptyObject:Dq,isReadableStream:Yq,isRequest:Gq,isResponse:Kq,isHeaders:qq,isUndefined:vm,isDate:Lq,isFile:Fq,isBlob:Vq,isRegExp:lX,isFunction:fs,isStream:Wq,isURLSearchParams:Uq,isTypedArray:nX,isFileList:Bq,forEach:_v,merge:RT,extend:Qq,trim:Xq,stripBOM:Jq,inherits:Zq,toFlatObject:eX,kindOf:M1,kindOfTest:Na,endsWith:tX,toArray:rX,forEachEntry:iX,matchAll:sX,isHTMLForm:oX,hasOwnProperty:i$,hasOwnProp:i$,reduceDescriptors:xB,freezeMethods:cX,toObjectSet:uX,toCamelCase:aX,noop:dX,toFiniteNumber:hX,findKey:wB,global:vh,isContextDefined:bB,isSpecCompliantForm:fX,toJSONObject:gX,isAsyncFn:mX,isThenable:pX,setImmediate:SB,asap:yX,isIterable:vX};function Je(t,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}J.inherits(Je,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const CB=Je.prototype,_B={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{_B[t]={value:t}});Object.defineProperties(Je,_B);Object.defineProperty(CB,"isAxiosError",{value:!0});Je.from=(t,e,r,n,i,s)=>{const o=Object.create(CB);J.toFlatObject(t,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const a=t&&t.message?t.message:"Error",c=e==null&&t?t.code:e;return Je.call(o,a,c,r,n,i),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",s&&Object.assign(o,s),o};const wX=null;function ET(t){return J.isPlainObject(t)||J.isArray(t)}function RB(t){return J.endsWith(t,"[]")?t.slice(0,-2):t}function s$(t,e,r){return t?t.concat(e).map(function(i,s){return i=RB(i),!r&&s?"["+i+"]":i}).join(r?".":""):e}function bX(t){return J.isArray(t)&&!t.some(ET)}const xX=J.toFlatObject(J,{},null,function(e){return/^is[A-Z]/.test(e)});function O1(t,e,r){if(!J.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=J.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,y){return!J.isUndefined(y[p])});const n=r.metaTokens,i=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&J.isSpecCompliantForm(e);if(!J.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(J.isDate(g))return g.toISOString();if(J.isBoolean(g))return g.toString();if(!c&&J.isBlob(g))throw new Je("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(g)||J.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function d(g,p,y){let w=g;if(g&&!y&&typeof g=="object"){if(J.endsWith(p,"{}"))p=n?p:p.slice(0,-2),g=JSON.stringify(g);else if(J.isArray(g)&&bX(g)||(J.isFileList(g)||J.endsWith(p,"[]"))&&(w=J.toArray(g)))return p=RB(p),w.forEach(function(x,S){!(J.isUndefined(x)||x===null)&&e.append(o===!0?s$([p],S,s):o===null?p:p+"[]",u(x))}),!1}return ET(g)?!0:(e.append(s$(y,p,s),u(g)),!1)}const f=[],h=Object.assign(xX,{defaultVisitor:d,convertValue:u,isVisitable:ET});function m(g,p){if(!J.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(g),J.forEach(g,function(w,v){(!(J.isUndefined(w)||w===null)&&i.call(e,w,J.isString(v)?v.trim():v,p,h))===!0&&m(w,p?p.concat(v):[v])}),f.pop()}}if(!J.isObject(t))throw new TypeError("data must be an object");return m(t),e}function o$(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function gA(t,e){this._pairs=[],t&&O1(t,this,e)}const EB=gA.prototype;EB.append=function(e,r){this._pairs.push([e,r])};EB.toString=function(e){const r=e?function(n){return e.call(this,n,o$)}:o$;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function SX(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function NB(t,e,r){if(!e)return t;const n=r&&r.encode||SX;J.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(e,r):s=J.isURLSearchParams(e)?e.toString():new gA(e,r).toString(n),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class a${constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){J.forEach(this.handlers,function(n){n!==null&&e(n)})}}const kB={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},CX=typeof URLSearchParams<"u"?URLSearchParams:gA,_X=typeof FormData<"u"?FormData:null,RX=typeof Blob<"u"?Blob:null,EX={isBrowser:!0,classes:{URLSearchParams:CX,FormData:_X,Blob:RX},protocols:["http","https","file","blob","url","data"]},mA=typeof window<"u"&&typeof document<"u",NT=typeof navigator=="object"&&navigator||void 0,NX=mA&&(!NT||["ReactNative","NativeScript","NS"].indexOf(NT.product)<0),kX=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",TX=mA&&window.location.href||"http://localhost",PX=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mA,hasStandardBrowserEnv:NX,hasStandardBrowserWebWorkerEnv:kX,navigator:NT,origin:TX},Symbol.toStringTag,{value:"Module"})),bi={...PX,...EX};function MX(t,e){return O1(t,new bi.classes.URLSearchParams,{visitor:function(r,n,i,s){return bi.isNode&&J.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function AX(t){return J.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function OX(t){const e={},r=Object.keys(t);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],e[s]=t[s];return e}function TB(t){function e(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),c=s>=r.length;return o=!o&&J.isArray(i)?i.length:o,c?(J.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!a):((!i[o]||!J.isObject(i[o]))&&(i[o]=[]),e(r,n,i[o],s)&&J.isArray(i[o])&&(i[o]=OX(i[o])),!a)}if(J.isFormData(t)&&J.isFunction(t.entries)){const r={};return J.forEachEntry(t,(n,i)=>{e(AX(n),i,r,0)}),r}return null}function IX(t,e,r){if(J.isString(t))try{return(e||JSON.parse)(t),J.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const Rv={transitional:kB,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=J.isObject(e);if(s&&J.isHTMLForm(e)&&(e=new FormData(e)),J.isFormData(e))return i?JSON.stringify(TB(e)):e;if(J.isArrayBuffer(e)||J.isBuffer(e)||J.isStream(e)||J.isFile(e)||J.isBlob(e)||J.isReadableStream(e))return e;if(J.isArrayBufferView(e))return e.buffer;if(J.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return MX(e,this.formSerializer).toString();if((a=J.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return O1(a?{"files[]":e}:e,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),IX(e)):e}],transformResponse:[function(e){const r=this.transitional||Rv.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(J.isResponse(e)||J.isReadableStream(e))return e;if(e&&J.isString(e)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?Je.from(a,Je.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:bi.classes.FormData,Blob:bi.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],t=>{Rv.headers[t]={}});const jX=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),HX=t=>{const e={};let r,n,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||e[r]&&jX[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},l$=Symbol("internals");function mp(t){return t&&String(t).trim().toLowerCase()}function Bx(t){return t===!1||t==null?t:J.isArray(t)?t.map(Bx):String(t)}function $X(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const DX=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function aR(t,e,r,n,i){if(J.isFunction(n))return n.call(this,e,r);if(i&&(e=r),!!J.isString(e)){if(J.isString(n))return e.indexOf(n)!==-1;if(J.isRegExp(n))return n.test(e)}}function LX(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function FX(t,e){const r=J.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(i,s,o){return this[n].call(this,e,i,s,o)},configurable:!0})})}let gs=class{constructor(e){e&&this.set(e)}set(e,r,n){const i=this;function s(a,c,u){const d=mp(c);if(!d)throw new Error("header name must be a non-empty string");const f=J.findKey(i,d);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=Bx(a))}const o=(a,c)=>J.forEach(a,(u,d)=>s(u,d,c));if(J.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(J.isString(e)&&(e=e.trim())&&!DX(e))o(HX(e),r);else if(J.isObject(e)&&J.isIterable(e)){let a={},c,u;for(const d of e){if(!J.isArray(d))throw TypeError("Object iterator must return a key-value pair");a[u=d[0]]=(c=a[u])?J.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(a,r)}else e!=null&&s(r,e,n);return this}get(e,r){if(e=mp(e),e){const n=J.findKey(this,e);if(n){const i=this[n];if(!r)return i;if(r===!0)return $X(i);if(J.isFunction(r))return r.call(this,i,n);if(J.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=mp(e),e){const n=J.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||aR(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let i=!1;function s(o){if(o=mp(o),o){const a=J.findKey(n,o);a&&(!r||aR(n,n[a],a,r))&&(delete n[a],i=!0)}}return J.isArray(e)?e.forEach(s):s(e),i}clear(e){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!e||aR(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const r=this,n={};return J.forEach(this,(i,s)=>{const o=J.findKey(n,s);if(o){r[o]=Bx(i),delete r[s];return}const a=e?LX(s):String(s).trim();a!==s&&delete r[s],r[a]=Bx(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return J.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=e&&J.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[l$]=this[l$]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=mp(o);n[a]||(FX(i,o),n[a]=!0)}return J.isArray(e)?e.forEach(s):s(e),this}};gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);J.reduceDescriptors(gs.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});J.freezeMethods(gs);function lR(t,e){const r=this||Rv,n=e||r,i=gs.from(n.headers);let s=n.data;return J.forEach(t,function(a){s=a.call(r,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function PB(t){return!!(t&&t.__CANCEL__)}function zm(t,e,r){Je.call(this,t??"canceled",Je.ERR_CANCELED,e,r),this.name="CanceledError"}J.inherits(zm,Je,{__CANCEL__:!0});function MB(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new Je("Request failed with status code "+r.status,[Je.ERR_BAD_REQUEST,Je.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function VX(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function BX(t,e){t=t||10;const r=new Array(t),n=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=n[s];o||(o=u),r[i]=c,n[i]=u;let f=s,h=0;for(;f!==i;)h+=r[f++],f=f%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-o<e)return;const m=d&&u-d;return m?Math.round(h*1e3/m):void 0}}function WX(t,e){let r=0,n=1e3/e,i,s;const o=(u,d=Date.now())=>{r=d,i=null,s&&(clearTimeout(s),s=null),t(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-f)))},()=>i&&o(i)]}const HS=(t,e,r=3)=>{let n=0;const i=BX(50,250);return WX(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,c=o-n,u=i(c),d=o<=a;n=o;const f={loaded:o,total:a,progress:a?o/a:void 0,bytes:c,rate:u||void 0,estimated:u&&a&&d?(a-o)/u:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(f)},r)},c$=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},u$=t=>(...e)=>J.asap(()=>t(...e)),zX=bi.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,bi.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(bi.origin),bi.navigator&&/(msie|trident)/i.test(bi.navigator.userAgent)):()=>!0,UX=bi.hasStandardBrowserEnv?{write(t,e,r,n,i,s,o){if(typeof document>"u")return;const a=[`${t}=${encodeURIComponent(e)}`];J.isNumber(r)&&a.push(`expires=${new Date(r).toUTCString()}`),J.isString(n)&&a.push(`path=${n}`),J.isString(i)&&a.push(`domain=${i}`),s===!0&&a.push("secure"),J.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function YX(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function GX(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function AB(t,e,r){let n=!YX(e);return t&&(n||r==!1)?GX(t,e):e}const d$=t=>t instanceof gs?{...t}:t;function Vh(t,e){e=e||{};const r={};function n(u,d,f,h){return J.isPlainObject(u)&&J.isPlainObject(d)?J.merge.call({caseless:h},u,d):J.isPlainObject(d)?J.merge({},d):J.isArray(d)?d.slice():d}function i(u,d,f,h){if(J.isUndefined(d)){if(!J.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function s(u,d){if(!J.isUndefined(d))return n(void 0,d)}function o(u,d){if(J.isUndefined(d)){if(!J.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function a(u,d,f){if(f in e)return n(u,d);if(f in t)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,d,f)=>i(d$(u),d$(d),f,!0)};return J.forEach(Object.keys({...t,...e}),function(d){const f=c[d]||i,h=f(t[d],e[d],d);J.isUndefined(h)&&f!==a||(r[d]=h)}),r}const OB=t=>{const e=Vh({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:a}=e;if(e.headers=o=gs.from(o),e.url=NB(AB(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),J.isFormData(r)){if(bi.hasStandardBrowserEnv||bi.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(J.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(bi.hasStandardBrowserEnv&&(n&&J.isFunction(n)&&(n=n(e)),n||n!==!1&&zX(e.url))){const c=i&&s&&UX.read(s);c&&o.set(i,c)}return e},KX=typeof XMLHttpRequest<"u",qX=KX&&function(t){return new Promise(function(r,n){const i=OB(t);let s=i.data;const o=gs.from(i.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:u}=i,d,f,h,m,g;function p(){m&&m(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function w(){if(!y)return;const x=gs.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),N={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:x,config:t,request:y};MB(function(E){r(E),p()},function(E){n(E),p()},N),y=null}"onloadend"in y?y.onloadend=w:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(w)},y.onabort=function(){y&&(n(new Je("Request aborted",Je.ECONNABORTED,t,y)),y=null)},y.onerror=function(S){const N=S&&S.message?S.message:"Network Error",R=new Je(N,Je.ERR_NETWORK,t,y);R.event=S||null,n(R),y=null},y.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const N=i.transitional||kB;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new Je(S,N.clarifyTimeoutError?Je.ETIMEDOUT:Je.ECONNABORTED,t,y)),y=null},s===void 0&&o.setContentType(null),"setRequestHeader"in y&&J.forEach(o.toJSON(),function(S,N){y.setRequestHeader(N,S)}),J.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),a&&a!=="json"&&(y.responseType=i.responseType),u&&([h,g]=HS(u,!0),y.addEventListener("progress",h)),c&&y.upload&&([f,m]=HS(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",m)),(i.cancelToken||i.signal)&&(d=x=>{y&&(n(!x||x.type?new zm(null,t,y):x),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const v=VX(i.url);if(v&&bi.protocols.indexOf(v)===-1){n(new Je("Unsupported protocol "+v+":",Je.ERR_BAD_REQUEST,t));return}y.send(s||null)})},XX=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,a();const d=u instanceof Error?u:this.reason;n.abort(d instanceof Je?d:new zm(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,s(new Je(`timeout ${e} of ms exceeded`,Je.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),t=null)};t.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>J.asap(a),c}},QX=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,i;for(;n<r;)i=n+e,yield t.slice(n,i),n=i},JX=async function*(t,e){for await(const r of ZX(t))yield*QX(r,e)},ZX=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},h$=(t,e,r,n)=>{const i=JX(t,e);let s=0,o,a=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await i.next();if(u){a(),c.close();return}let f=d.byteLength;if(r){let h=s+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw a(u),u}},cancel(c){return a(c),i.return()}},{highWaterMark:2})},f$=64*1024,{isFunction:_w}=J,eQ=(({Request:t,Response:e})=>({Request:t,Response:e}))(J.global),{ReadableStream:g$,TextEncoder:m$}=J.global,p$=(t,...e)=>{try{return!!t(...e)}catch{return!1}},tQ=t=>{t=J.merge.call({skipUndefined:!0},eQ,t);const{fetch:e,Request:r,Response:n}=t,i=e?_w(e):typeof fetch=="function",s=_w(r),o=_w(n);if(!i)return!1;const a=i&&_w(g$),c=i&&(typeof m$=="function"?(g=>p=>g.encode(p))(new m$):async g=>new Uint8Array(await new r(g).arrayBuffer())),u=s&&a&&p$(()=>{let g=!1;const p=new r(bi.origin,{body:new g$,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!p}),d=o&&a&&p$(()=>J.isReadableStream(new n("").body)),f={stream:d&&(g=>g.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(p,y)=>{let w=p&&p[g];if(w)return w.call(p);throw new Je(`Response type '${g}' is not supported`,Je.ERR_NOT_SUPPORT,y)})});const h=async g=>{if(g==null)return 0;if(J.isBlob(g))return g.size;if(J.isSpecCompliantForm(g))return(await new r(bi.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(J.isArrayBufferView(g)||J.isArrayBuffer(g))return g.byteLength;if(J.isURLSearchParams(g)&&(g=g+""),J.isString(g))return(await c(g)).byteLength},m=async(g,p)=>{const y=J.toFiniteNumber(g.getContentLength());return y??h(p)};return async g=>{let{url:p,method:y,data:w,signal:v,cancelToken:x,timeout:S,onDownloadProgress:N,onUploadProgress:R,responseType:E,headers:P,withCredentials:D="same-origin",fetchOptions:H}=OB(g),Z=e||fetch;E=E?(E+"").toLowerCase():"text";let I=XX([v,x&&x.toAbortSignal()],S),Y=null;const re=I&&I.unsubscribe&&(()=>{I.unsubscribe()});let ne;try{if(R&&u&&y!=="get"&&y!=="head"&&(ne=await m(P,w))!==0){let de=new r(p,{method:"POST",body:w,duplex:"half"}),se;if(J.isFormData(w)&&(se=de.headers.get("content-type"))&&P.setContentType(se),de.body){const[me,te]=c$(ne,HS(u$(R)));w=h$(de.body,f$,me,te)}}J.isString(D)||(D=D?"include":"omit");const ae=s&&"credentials"in r.prototype,ue={...H,signal:I,method:y.toUpperCase(),headers:P.normalize().toJSON(),body:w,duplex:"half",credentials:ae?D:void 0};Y=s&&new r(p,ue);let Q=await(s?Z(Y,H):Z(p,ue));const fe=d&&(E==="stream"||E==="response");if(d&&(N||fe&&re)){const de={};["status","statusText","headers"].forEach(b=>{de[b]=Q[b]});const se=J.toFiniteNumber(Q.headers.get("content-length")),[me,te]=N&&c$(se,HS(u$(N),!0))||[];Q=new n(h$(Q.body,f$,me,()=>{te&&te(),re&&re()}),de)}E=E||"text";let ye=await f[J.findKey(f,E)||"text"](Q,g);return!fe&&re&&re(),await new Promise((de,se)=>{MB(de,se,{data:ye,headers:gs.from(Q.headers),status:Q.status,statusText:Q.statusText,config:g,request:Y})})}catch(ae){throw re&&re(),ae&&ae.name==="TypeError"&&/Load failed|fetch/i.test(ae.message)?Object.assign(new Je("Network Error",Je.ERR_NETWORK,g,Y),{cause:ae.cause||ae}):Je.from(ae,ae&&ae.code,g,Y)}}},rQ=new Map,IB=t=>{let e=t&&t.env||{};const{fetch:r,Request:n,Response:i}=e,s=[n,i,r];let o=s.length,a=o,c,u,d=rQ;for(;a--;)c=s[a],u=d.get(c),u===void 0&&d.set(c,u=a?new Map:tQ(e)),d=u;return u};IB();const pA={http:wX,xhr:qX,fetch:{get:IB}};J.forEach(pA,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const y$=t=>`- ${t}`,nQ=t=>J.isFunction(t)||t===null||t===!1;function iQ(t,e){t=J.isArray(t)?t:[t];const{length:r}=t;let n,i;const s={};for(let o=0;o<r;o++){n=t[o];let a;if(i=n,!nQ(n)&&(i=pA[(a=String(n)).toLowerCase()],i===void 0))throw new Je(`Unknown adapter '${a}'`);if(i&&(J.isFunction(i)||(i=i.get(e))))break;s[a||"#"+o]=i}if(!i){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=r?o.length>1?`since :
`+o.map(y$).join(`
`):" "+y$(o[0]):"as no adapter specified";throw new Je("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i}const jB={getAdapter:iQ,adapters:pA};function cR(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new zm(null,t)}function v$(t){return cR(t),t.headers=gs.from(t.headers),t.data=lR.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),jB.getAdapter(t.adapter||Rv.adapter,t)(t).then(function(n){return cR(t),n.data=lR.call(t,t.transformResponse,n),n.headers=gs.from(n.headers),n},function(n){return PB(n)||(cR(t),n&&n.response&&(n.response.data=lR.call(t,t.transformResponse,n.response),n.response.headers=gs.from(n.response.headers))),Promise.reject(n)})}const HB="1.13.2",I1={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{I1[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const w$={};I1.transitional=function(e,r,n){function i(s,o){return"[Axios v"+HB+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,a)=>{if(e===!1)throw new Je(i(o," has been removed"+(r?" in "+r:"")),Je.ERR_DEPRECATED);return r&&!w$[o]&&(w$[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(s,o,a):!0}};I1.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function sQ(t,e,r){if(typeof t!="object")throw new Je("options must be an object",Je.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const s=n[i],o=e[s];if(o){const a=t[s],c=a===void 0||o(a,s,t);if(c!==!0)throw new Je("option "+s+" must be "+c,Je.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Je("Unknown option "+s,Je.ERR_BAD_OPTION)}}const Wx={assertOptions:sQ,validators:I1},Ia=Wx.validators;let Oh=class{constructor(e){this.defaults=e||{},this.interceptors={request:new a$,response:new a$}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Vh(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Wx.assertOptions(n,{silentJSONParsing:Ia.transitional(Ia.boolean),forcedJSONParsing:Ia.transitional(Ia.boolean),clarifyTimeoutError:Ia.transitional(Ia.boolean)},!1),i!=null&&(J.isFunction(i)?r.paramsSerializer={serialize:i}:Wx.assertOptions(i,{encode:Ia.function,serialize:Ia.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Wx.assertOptions(r,{baseUrl:Ia.spelling("baseURL"),withXsrfToken:Ia.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&J.merge(s.common,s[r.method]);s&&J.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=gs.concat(o,s);const a=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,a.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,f=0,h;if(!c){const g=[v$.bind(this),void 0];for(g.unshift(...a),g.push(...u),h=g.length,d=Promise.resolve(r);f<h;)d=d.then(g[f++],g[f++]);return d}h=a.length;let m=r;for(;f<h;){const g=a[f++],p=a[f++];try{m=g(m)}catch(y){p.call(this,y);break}}try{d=v$.call(this,m)}catch(g){return Promise.reject(g)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(e){e=Vh(this.defaults,e);const r=AB(e.baseURL,e.url,e.allowAbsoluteUrls);return NB(r,e.params,e.paramsSerializer)}};J.forEach(["delete","get","head","options"],function(e){Oh.prototype[e]=function(r,n){return this.request(Vh(n||{},{method:e,url:r,data:(n||{}).data}))}});J.forEach(["post","put","patch"],function(e){function r(n){return function(s,o,a){return this.request(Vh(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Oh.prototype[e]=r(),Oh.prototype[e+"Form"]=r(!0)});let oQ=class $B{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{n.subscribe(a),s=a}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},e(function(s,o,a){n.reason||(n.reason=new zm(s,o,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new $B(function(i){e=i}),cancel:e}}};function aQ(t){return function(r){return t.apply(null,r)}}function lQ(t){return J.isObject(t)&&t.isAxiosError===!0}const kT={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(kT).forEach(([t,e])=>{kT[e]=t});function DB(t){const e=new Oh(t),r=mB(Oh.prototype.request,e);return J.extend(r,Oh.prototype,e,{allOwnKeys:!0}),J.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return DB(Vh(t,i))},r}const Hr=DB(Rv);Hr.Axios=Oh;Hr.CanceledError=zm;Hr.CancelToken=oQ;Hr.isCancel=PB;Hr.VERSION=HB;Hr.toFormData=O1;Hr.AxiosError=Je;Hr.Cancel=Hr.CanceledError;Hr.all=function(e){return Promise.all(e)};Hr.spread=aQ;Hr.isAxiosError=lQ;Hr.mergeConfig=Vh;Hr.AxiosHeaders=gs;Hr.formToJSON=t=>TB(J.isHTMLForm(t)?new FormData(t):t);Hr.getAdapter=jB.getAdapter;Hr.HttpStatusCode=kT;Hr.default=Hr;const{Axios:EWe,AxiosError:NWe,CanceledError:kWe,isCancel:TWe,CancelToken:PWe,VERSION:MWe,all:AWe,Cancel:OWe,isAxiosError:IWe,spread:jWe,toFormData:HWe,AxiosHeaders:$We,HttpStatusCode:DWe,formToJSON:LWe,getAdapter:FWe,mergeConfig:VWe}=Hr;var cQ=function(e){return uQ(e)&&!dQ(e)};function uQ(t){return!!t&&typeof t=="object"}function dQ(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||gQ(t)}var hQ=typeof Symbol=="function"&&Symbol.for,fQ=hQ?Symbol.for("react.element"):60103;function gQ(t){return t.$$typeof===fQ}function mQ(t){return Array.isArray(t)?[]:{}}function Py(t,e){return e.clone!==!1&&e.isMergeableObject(t)?wm(mQ(t),t,e):t}function pQ(t,e,r){return t.concat(e).map(function(n){return Py(n,r)})}function yQ(t,e){if(!e.customMerge)return wm;var r=e.customMerge(t);return typeof r=="function"?r:wm}function vQ(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function b$(t){return Object.keys(t).concat(vQ(t))}function LB(t,e){try{return e in t}catch{return!1}}function wQ(t,e){return LB(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function bQ(t,e,r){var n={};return r.isMergeableObject(t)&&b$(t).forEach(function(i){n[i]=Py(t[i],r)}),b$(e).forEach(function(i){wQ(t,i)||(LB(t,i)&&r.isMergeableObject(e[i])?n[i]=yQ(i,r)(t[i],e[i],r):n[i]=Py(e[i],r))}),n}function wm(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||pQ,r.isMergeableObject=r.isMergeableObject||cQ,r.cloneUnlessOtherwiseSpecified=Py;var n=Array.isArray(e),i=Array.isArray(t),s=n===i;return s?n?r.arrayMerge(t,e,r):bQ(t,e,r):Py(e,r)}wm.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,i){return wm(n,i,r)},{})};var xQ=wm,SQ=xQ;const CQ=bv(SQ);var Um=TypeError;const _Q={},RQ=Object.freeze(Object.defineProperty({__proto__:null,default:_Q},Symbol.toStringTag,{value:"Module"})),EQ=hq(RQ);var yA=typeof Map=="function"&&Map.prototype,uR=Object.getOwnPropertyDescriptor&&yA?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,$S=yA&&uR&&typeof uR.get=="function"?uR.get:null,x$=yA&&Map.prototype.forEach,vA=typeof Set=="function"&&Set.prototype,dR=Object.getOwnPropertyDescriptor&&vA?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,DS=vA&&dR&&typeof dR.get=="function"?dR.get:null,S$=vA&&Set.prototype.forEach,NQ=typeof WeakMap=="function"&&WeakMap.prototype,G0=NQ?WeakMap.prototype.has:null,kQ=typeof WeakSet=="function"&&WeakSet.prototype,K0=kQ?WeakSet.prototype.has:null,TQ=typeof WeakRef=="function"&&WeakRef.prototype,C$=TQ?WeakRef.prototype.deref:null,PQ=Boolean.prototype.valueOf,MQ=Object.prototype.toString,AQ=Function.prototype.toString,OQ=String.prototype.match,wA=String.prototype.slice,Pu=String.prototype.replace,IQ=String.prototype.toUpperCase,_$=String.prototype.toLowerCase,FB=RegExp.prototype.test,R$=Array.prototype.concat,gl=Array.prototype.join,jQ=Array.prototype.slice,E$=Math.floor,TT=typeof BigInt=="function"?BigInt.prototype.valueOf:null,hR=Object.getOwnPropertySymbols,PT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,bm=typeof Symbol=="function"&&typeof Symbol.iterator=="object",q0=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===bm||!0)?Symbol.toStringTag:null,VB=Object.prototype.propertyIsEnumerable,N$=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function k$(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||FB.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-E$(-t):E$(t);if(n!==t){var i=String(n),s=wA.call(e,i.length+1);return Pu.call(i,r,"$&_")+"."+Pu.call(Pu.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Pu.call(e,r,"$&_")}var MT=EQ,T$=MT.custom,P$=zB(T$)?T$:null,BB={__proto__:null,double:'"',single:"'"},HQ={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},j1=function t(e,r,n,i){var s=r||{};if(nc(s,"quoteStyle")&&!nc(BB,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(nc(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=nc(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(nc(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(nc(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return YB(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return a?k$(e,c):c}if(typeof e=="bigint"){var u=String(e)+"n";return a?k$(e,u):u}var d=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof e=="object")return AT(e)?"[Array]":"[Object]";var f=eJ(s,n);if(typeof i>"u")i=[];else if(UB(i,e)>=0)return"[Circular]";function h(Y,re,ne){if(re&&(i=jQ.call(i),i.push(re)),ne){var ae={depth:s.depth};return nc(s,"quoteStyle")&&(ae.quoteStyle=s.quoteStyle),t(Y,ae,n+1,i)}return t(Y,s,n+1,i)}if(typeof e=="function"&&!M$(e)){var m=UQ(e),g=Rw(e,h);return"[Function"+(m?": "+m:" (anonymous)")+"]"+(g.length>0?" { "+gl.call(g,", ")+" }":"")}if(zB(e)){var p=bm?Pu.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):PT.call(e);return typeof e=="object"&&!bm?pp(p):p}if(QQ(e)){for(var y="<"+_$.call(String(e.nodeName)),w=e.attributes||[],v=0;v<w.length;v++)y+=" "+w[v].name+"="+WB($Q(w[v].value),"double",s);return y+=">",e.childNodes&&e.childNodes.length&&(y+="..."),y+="</"+_$.call(String(e.nodeName))+">",y}if(AT(e)){if(e.length===0)return"[]";var x=Rw(e,h);return f&&!ZQ(x)?"["+OT(x,f)+"]":"[ "+gl.call(x,", ")+" ]"}if(LQ(e)){var S=Rw(e,h);return!("cause"in Error.prototype)&&"cause"in e&&!VB.call(e,"cause")?"{ ["+String(e)+"] "+gl.call(R$.call("[cause]: "+h(e.cause),S),", ")+" }":S.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+gl.call(S,", ")+" }"}if(typeof e=="object"&&o){if(P$&&typeof e[P$]=="function"&&MT)return MT(e,{depth:d-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(YQ(e)){var N=[];return x$&&x$.call(e,function(Y,re){N.push(h(re,e,!0)+" => "+h(Y,e))}),A$("Map",$S.call(e),N,f)}if(qQ(e)){var R=[];return S$&&S$.call(e,function(Y){R.push(h(Y,e))}),A$("Set",DS.call(e),R,f)}if(GQ(e))return fR("WeakMap");if(XQ(e))return fR("WeakSet");if(KQ(e))return fR("WeakRef");if(VQ(e))return pp(h(Number(e)));if(WQ(e))return pp(h(TT.call(e)));if(BQ(e))return pp(PQ.call(e));if(FQ(e))return pp(h(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof ga<"u"&&e===ga)return"{ [object globalThis] }";if(!DQ(e)&&!M$(e)){var E=Rw(e,h),P=N$?N$(e)===Object.prototype:e instanceof Object||e.constructor===Object,D=e instanceof Object?"":"null prototype",H=!P&&q0&&Object(e)===e&&q0 in e?wA.call(od(e),8,-1):D?"Object":"",Z=P||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",I=Z+(H||D?"["+gl.call(R$.call([],H||[],D||[]),": ")+"] ":"");return E.length===0?I+"{}":f?I+"{"+OT(E,f)+"}":I+"{ "+gl.call(E,", ")+" }"}return String(e)};function WB(t,e,r){var n=r.quoteStyle||e,i=BB[n];return i+t+i}function $Q(t){return Pu.call(String(t),/"/g,"&quot;")}function af(t){return!q0||!(typeof t=="object"&&(q0 in t||typeof t[q0]<"u"))}function AT(t){return od(t)==="[object Array]"&&af(t)}function DQ(t){return od(t)==="[object Date]"&&af(t)}function M$(t){return od(t)==="[object RegExp]"&&af(t)}function LQ(t){return od(t)==="[object Error]"&&af(t)}function FQ(t){return od(t)==="[object String]"&&af(t)}function VQ(t){return od(t)==="[object Number]"&&af(t)}function BQ(t){return od(t)==="[object Boolean]"&&af(t)}function zB(t){if(bm)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!PT)return!1;try{return PT.call(t),!0}catch{}return!1}function WQ(t){if(!t||typeof t!="object"||!TT)return!1;try{return TT.call(t),!0}catch{}return!1}var zQ=Object.prototype.hasOwnProperty||function(t){return t in this};function nc(t,e){return zQ.call(t,e)}function od(t){return MQ.call(t)}function UQ(t){if(t.name)return t.name;var e=OQ.call(AQ.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function UB(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function YQ(t){if(!$S||!t||typeof t!="object")return!1;try{$S.call(t);try{DS.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function GQ(t){if(!G0||!t||typeof t!="object")return!1;try{G0.call(t,G0);try{K0.call(t,K0)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function KQ(t){if(!C$||!t||typeof t!="object")return!1;try{return C$.call(t),!0}catch{}return!1}function qQ(t){if(!DS||!t||typeof t!="object")return!1;try{DS.call(t);try{$S.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function XQ(t){if(!K0||!t||typeof t!="object")return!1;try{K0.call(t,K0);try{G0.call(t,G0)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function QQ(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function YB(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return YB(wA.call(t,0,e.maxStringLength),e)+n}var i=HQ[e.quoteStyle||"single"];i.lastIndex=0;var s=Pu.call(Pu.call(t,i,"\\$1"),/[\x00-\x1f]/g,JQ);return WB(s,"single",e)}function JQ(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+IQ.call(e.toString(16))}function pp(t){return"Object("+t+")"}function fR(t){return t+" { ? }"}function A$(t,e,r,n){var i=n?OT(r,n):gl.call(r,", ");return t+" ("+e+") {"+i+"}"}function ZQ(t){for(var e=0;e<t.length;e++)if(UB(t[e],`
`)>=0)return!1;return!0}function eJ(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=gl.call(Array(t.indent+1)," ");else return null;return{base:r,prev:gl.call(Array(e+1),r)}}function OT(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+gl.call(t,","+r)+`
`+e.prev}function Rw(t,e){var r=AT(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=nc(t,i)?e(t[i],t):""}var s=typeof hR=="function"?hR(t):[],o;if(bm){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var c in t)nc(t,c)&&(r&&String(Number(c))===c&&c<t.length||bm&&o["$"+c]instanceof Symbol||(FB.call(/[^\w$]/,c)?n.push(e(c,t)+": "+e(t[c],t)):n.push(c+": "+e(t[c],t))));if(typeof hR=="function")for(var u=0;u<s.length;u++)VB.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}var tJ=j1,rJ=Um,H1=function(t,e,r){for(var n=t,i;(i=n.next)!=null;n=i)if(i.key===e)return n.next=i.next,r||(i.next=t.next,t.next=i),i},nJ=function(t,e){if(t){var r=H1(t,e);return r&&r.value}},iJ=function(t,e,r){var n=H1(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},sJ=function(t,e){return t?!!H1(t,e):!1},oJ=function(t,e){if(t)return H1(t,e,!0)},aJ=function(){var e,r={assert:function(n){if(!r.has(n))throw new rJ("Side channel does not contain "+tJ(n))},delete:function(n){var i=e&&e.next,s=oJ(e,n);return s&&i&&i===s&&(e=void 0),!!s},get:function(n){return nJ(e,n)},has:function(n){return sJ(e,n)},set:function(n,i){e||(e={next:void 0}),iJ(e,n,i)}};return r},GB=Object,lJ=Error,cJ=EvalError,uJ=RangeError,dJ=ReferenceError,hJ=SyntaxError,fJ=URIError,gJ=Math.abs,mJ=Math.floor,pJ=Math.max,yJ=Math.min,vJ=Math.pow,wJ=Math.round,bJ=Number.isNaN||function(e){return e!==e},xJ=bJ,SJ=function(e){return xJ(e)||e===0?e:e<0?-1:1},CJ=Object.getOwnPropertyDescriptor,zx=CJ;if(zx)try{zx([],"length")}catch{zx=null}var KB=zx,Ux=Object.defineProperty||!1;if(Ux)try{Ux({},"a",{value:1})}catch{Ux=!1}var _J=Ux,gR,O$;function RJ(){return O$||(O$=1,gR=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),gR}var mR,I$;function EJ(){if(I$)return mR;I$=1;var t=typeof Symbol<"u"&&Symbol,e=RJ();return mR=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},mR}var pR,j$;function qB(){return j$||(j$=1,pR=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),pR}var yR,H$;function XB(){if(H$)return yR;H$=1;var t=GB;return yR=t.getPrototypeOf||null,yR}var vR,$$;function NJ(){if($$)return vR;$$=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,n="[object Function]",i=function(c,u){for(var d=[],f=0;f<c.length;f+=1)d[f]=c[f];for(var h=0;h<u.length;h+=1)d[h+c.length]=u[h];return d},s=function(c,u){for(var d=[],f=u,h=0;f<c.length;f+=1,h+=1)d[h]=c[f];return d},o=function(a,c){for(var u="",d=0;d<a.length;d+=1)u+=a[d],d+1<a.length&&(u+=c);return u};return vR=function(c){var u=this;if(typeof u!="function"||e.apply(u)!==n)throw new TypeError(t+u);for(var d=s(arguments,1),f,h=function(){if(this instanceof f){var w=u.apply(this,i(d,arguments));return Object(w)===w?w:this}return u.apply(c,i(d,arguments))},m=r(0,u.length-d.length),g=[],p=0;p<m;p++)g[p]="$"+p;if(f=Function("binder","return function ("+o(g,",")+"){ return binder.apply(this,arguments); }")(h),u.prototype){var y=function(){};y.prototype=u.prototype,f.prototype=new y,y.prototype=null}return f},vR}var wR,D$;function $1(){if(D$)return wR;D$=1;var t=NJ();return wR=Function.prototype.bind||t,wR}var bR,L$;function bA(){return L$||(L$=1,bR=Function.prototype.call),bR}var xR,F$;function QB(){return F$||(F$=1,xR=Function.prototype.apply),xR}var kJ=typeof Reflect<"u"&&Reflect&&Reflect.apply,TJ=$1(),PJ=QB(),MJ=bA(),AJ=kJ,OJ=AJ||TJ.call(MJ,PJ),IJ=$1(),jJ=Um,HJ=bA(),$J=OJ,JB=function(e){if(e.length<1||typeof e[0]!="function")throw new jJ("a function is required");return $J(IJ,HJ,e)},SR,V$;function DJ(){if(V$)return SR;V$=1;var t=JB,e=KB,r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return SR=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,SR}var CR,B$;function LJ(){if(B$)return CR;B$=1;var t=qB(),e=XB(),r=DJ();return CR=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,CR}var _R,W$;function FJ(){if(W$)return _R;W$=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=$1();return _R=r.call(t,e),_R}var mt,VJ=GB,BJ=lJ,WJ=cJ,zJ=uJ,UJ=dJ,xm=hJ,em=Um,YJ=fJ,GJ=gJ,KJ=mJ,qJ=pJ,XJ=yJ,QJ=vJ,JJ=wJ,ZJ=SJ,ZB=Function,RR=function(t){try{return ZB('"use strict"; return ('+t+").constructor;")()}catch{}},My=KB,eZ=_J,ER=function(){throw new em},tZ=My?function(){try{return arguments.callee,ER}catch{try{return My(arguments,"callee").get}catch{return ER}}}():ER,Cf=EJ()(),Fn=LJ(),rZ=XB(),nZ=qB(),eW=QB(),Ev=bA(),wg={},iZ=typeof Uint8Array>"u"||!Fn?mt:Fn(Uint8Array),Ih={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?mt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?mt:ArrayBuffer,"%ArrayIteratorPrototype%":Cf&&Fn?Fn([][Symbol.iterator]()):mt,"%AsyncFromSyncIteratorPrototype%":mt,"%AsyncFunction%":wg,"%AsyncGenerator%":wg,"%AsyncGeneratorFunction%":wg,"%AsyncIteratorPrototype%":wg,"%Atomics%":typeof Atomics>"u"?mt:Atomics,"%BigInt%":typeof BigInt>"u"?mt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?mt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?mt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?mt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":BJ,"%eval%":eval,"%EvalError%":WJ,"%Float16Array%":typeof Float16Array>"u"?mt:Float16Array,"%Float32Array%":typeof Float32Array>"u"?mt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?mt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?mt:FinalizationRegistry,"%Function%":ZB,"%GeneratorFunction%":wg,"%Int8Array%":typeof Int8Array>"u"?mt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?mt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?mt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Cf&&Fn?Fn(Fn([][Symbol.iterator]())):mt,"%JSON%":typeof JSON=="object"?JSON:mt,"%Map%":typeof Map>"u"?mt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Cf||!Fn?mt:Fn(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":VJ,"%Object.getOwnPropertyDescriptor%":My,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?mt:Promise,"%Proxy%":typeof Proxy>"u"?mt:Proxy,"%RangeError%":zJ,"%ReferenceError%":UJ,"%Reflect%":typeof Reflect>"u"?mt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?mt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Cf||!Fn?mt:Fn(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?mt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Cf&&Fn?Fn(""[Symbol.iterator]()):mt,"%Symbol%":Cf?Symbol:mt,"%SyntaxError%":xm,"%ThrowTypeError%":tZ,"%TypedArray%":iZ,"%TypeError%":em,"%Uint8Array%":typeof Uint8Array>"u"?mt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?mt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?mt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?mt:Uint32Array,"%URIError%":YJ,"%WeakMap%":typeof WeakMap>"u"?mt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?mt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?mt:WeakSet,"%Function.prototype.call%":Ev,"%Function.prototype.apply%":eW,"%Object.defineProperty%":eZ,"%Object.getPrototypeOf%":rZ,"%Math.abs%":GJ,"%Math.floor%":KJ,"%Math.max%":qJ,"%Math.min%":XJ,"%Math.pow%":QJ,"%Math.round%":JJ,"%Math.sign%":ZJ,"%Reflect.getPrototypeOf%":nZ};if(Fn)try{null.error}catch(t){var sZ=Fn(Fn(t));Ih["%Error.prototype%"]=sZ}var oZ=function t(e){var r;if(e==="%AsyncFunction%")r=RR("async function () {}");else if(e==="%GeneratorFunction%")r=RR("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=RR("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&Fn&&(r=Fn(i.prototype))}return Ih[e]=r,r},z$={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Nv=$1(),LS=FJ(),aZ=Nv.call(Ev,Array.prototype.concat),lZ=Nv.call(eW,Array.prototype.splice),U$=Nv.call(Ev,String.prototype.replace),FS=Nv.call(Ev,String.prototype.slice),cZ=Nv.call(Ev,RegExp.prototype.exec),uZ=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,dZ=/\\(\\)?/g,hZ=function(e){var r=FS(e,0,1),n=FS(e,-1);if(r==="%"&&n!=="%")throw new xm("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new xm("invalid intrinsic syntax, expected opening `%`");var i=[];return U$(e,uZ,function(s,o,a,c){i[i.length]=a?U$(c,dZ,"$1"):o||s}),i},fZ=function(e,r){var n=e,i;if(LS(z$,n)&&(i=z$[n],n="%"+i[0]+"%"),LS(Ih,n)){var s=Ih[n];if(s===wg&&(s=oZ(n)),typeof s>"u"&&!r)throw new em("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new xm("intrinsic "+e+" does not exist!")},xA=function(e,r){if(typeof e!="string"||e.length===0)throw new em("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new em('"allowMissing" argument must be a boolean');if(cZ(/^%?[^%]*%?$/,e)===null)throw new xm("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=hZ(e),i=n.length>0?n[0]:"",s=fZ("%"+i+"%",r),o=s.name,a=s.value,c=!1,u=s.alias;u&&(i=u[0],lZ(n,aZ([0,1],u)));for(var d=1,f=!0;d<n.length;d+=1){var h=n[d],m=FS(h,0,1),g=FS(h,-1);if((m==='"'||m==="'"||m==="`"||g==='"'||g==="'"||g==="`")&&m!==g)throw new xm("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(c=!0),i+="."+h,o="%"+i+"%",LS(Ih,o))a=Ih[o];else if(a!=null){if(!(h in a)){if(!r)throw new em("base intrinsic for "+e+" exists, but the property is not available.");return}if(My&&d+1>=n.length){var p=My(a,h);f=!!p,f&&"get"in p&&!("originalValue"in p.get)?a=p.get:a=a[h]}else f=LS(a,h),a=a[h];f&&!c&&(Ih[o]=a)}}return a},tW=xA,rW=JB,gZ=rW([tW("%String.prototype.indexOf%")]),nW=function(e,r){var n=tW(e,!!r);return typeof n=="function"&&gZ(e,".prototype.")>-1?rW([n]):n},mZ=xA,kv=nW,pZ=j1,yZ=Um,Y$=mZ("%Map%",!0),vZ=kv("Map.prototype.get",!0),wZ=kv("Map.prototype.set",!0),bZ=kv("Map.prototype.has",!0),xZ=kv("Map.prototype.delete",!0),SZ=kv("Map.prototype.size",!0),iW=!!Y$&&function(){var e,r={assert:function(n){if(!r.has(n))throw new yZ("Side channel does not contain "+pZ(n))},delete:function(n){if(e){var i=xZ(e,n);return SZ(e)===0&&(e=void 0),i}return!1},get:function(n){if(e)return vZ(e,n)},has:function(n){return e?bZ(e,n):!1},set:function(n,i){e||(e=new Y$),wZ(e,n,i)}};return r},CZ=xA,D1=nW,_Z=j1,Ew=iW,RZ=Um,_f=CZ("%WeakMap%",!0),EZ=D1("WeakMap.prototype.get",!0),NZ=D1("WeakMap.prototype.set",!0),kZ=D1("WeakMap.prototype.has",!0),TZ=D1("WeakMap.prototype.delete",!0),PZ=_f?function(){var e,r,n={assert:function(i){if(!n.has(i))throw new RZ("Side channel does not contain "+_Z(i))},delete:function(i){if(_f&&i&&(typeof i=="object"||typeof i=="function")){if(e)return TZ(e,i)}else if(Ew&&r)return r.delete(i);return!1},get:function(i){return _f&&i&&(typeof i=="object"||typeof i=="function")&&e?EZ(e,i):r&&r.get(i)},has:function(i){return _f&&i&&(typeof i=="object"||typeof i=="function")&&e?kZ(e,i):!!r&&r.has(i)},set:function(i,s){_f&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new _f),NZ(e,i,s)):Ew&&(r||(r=Ew()),r.set(i,s))}};return n}:Ew,MZ=Um,AZ=j1,OZ=aJ,IZ=iW,jZ=PZ,HZ=jZ||IZ||OZ,sW=function(){var e,r={assert:function(n){if(!r.has(n))throw new MZ("Side channel does not contain "+AZ(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,i){e||(e=HZ()),e.set(n,i)}};return r},$Z=String.prototype.replace,DZ=/%20/g,NR={RFC1738:"RFC1738",RFC3986:"RFC3986"},SA={default:NR.RFC3986,formatters:{RFC1738:function(t){return $Z.call(t,DZ,"+")},RFC3986:function(t){return String(t)}},RFC1738:NR.RFC1738,RFC3986:NR.RFC3986},LZ=SA,FZ=sW,kR=Object.prototype.hasOwnProperty,uh=Array.isArray,L1=FZ(),oW=function(e,r){return L1.set(e,r),e},VS=function(e){return L1.has(e)},IT=function(e){return L1.get(e)},aW=function(e,r){L1.set(e,r)},ja=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),VZ=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(uh(n)){for(var i=[],s=0;s<n.length;++s)typeof n[s]<"u"&&i.push(n[s]);r.obj[r.prop]=i}}},CA=function(e,r){for(var n=r&&r.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},BZ=function t(e,r,n){if(!r)return e;if(typeof r!="object"&&typeof r!="function"){if(uh(e))e.push(r);else if(e&&typeof e=="object")if(VS(e)){var i=IT(e)+1;e[i]=r,aW(e,i)}else(n&&(n.plainObjects||n.allowPrototypes)||!kR.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object"){if(VS(r)){for(var s=Object.keys(r),o=n&&n.plainObjects?{__proto__:null,0:e}:{0:e},a=0;a<s.length;a++){var c=parseInt(s[a],10);o[c+1]=r[s[a]]}return oW(o,IT(r)+1)}return[e].concat(r)}var u=e;return uh(e)&&!uh(r)&&(u=CA(e,n)),uh(e)&&uh(r)?(r.forEach(function(d,f){if(kR.call(e,f)){var h=e[f];h&&typeof h=="object"&&d&&typeof d=="object"?e[f]=t(h,d,n):e.push(d)}else e[f]=d}),e):Object.keys(r).reduce(function(d,f){var h=r[f];return kR.call(d,f)?d[f]=t(d[f],h,n):d[f]=h,d},u)},WZ=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},zZ=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},TR=1024,UZ=function(e,r,n,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(m){return"%26%23"+parseInt(m.slice(2),16)+"%3B"});for(var a="",c=0;c<o.length;c+=TR){for(var u=o.length>=TR?o.slice(c,c+TR):o,d=[],f=0;f<u.length;++f){var h=u.charCodeAt(f);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===LZ.RFC1738&&(h===40||h===41)){d[d.length]=u.charAt(f);continue}if(h<128){d[d.length]=ja[h];continue}if(h<2048){d[d.length]=ja[192|h>>6]+ja[128|h&63];continue}if(h<55296||h>=57344){d[d.length]=ja[224|h>>12]+ja[128|h>>6&63]+ja[128|h&63];continue}f+=1,h=65536+((h&1023)<<10|u.charCodeAt(f)&1023),d[d.length]=ja[240|h>>18]+ja[128|h>>12&63]+ja[128|h>>6&63]+ja[128|h&63]}a+=d.join("")}return a},YZ=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var s=r[i],o=s.obj[s.prop],a=Object.keys(o),c=0;c<a.length;++c){var u=a[c],d=o[u];typeof d=="object"&&d!==null&&n.indexOf(d)===-1&&(r.push({obj:o,prop:u}),n.push(d))}return VZ(r),e},GZ=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},KZ=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},qZ=function(e,r,n,i){if(VS(e)){var s=IT(e)+1;return e[s]=r,aW(e,s),e}var o=[].concat(e,r);return o.length>n?oW(CA(o,{plainObjects:i}),o.length-1):o},XZ=function(e,r){if(uh(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},lW={arrayToObject:CA,assign:WZ,combine:qZ,compact:YZ,decode:zZ,encode:UZ,isBuffer:KZ,isOverflow:VS,isRegExp:GZ,maybeMap:XZ,merge:BZ},cW=sW,Yx=lW,X0=SA,QZ=Object.prototype.hasOwnProperty,uW={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},dl=Array.isArray,JZ=Array.prototype.push,dW=function(t,e){JZ.apply(t,dl(e)?e:[e])},ZZ=Date.prototype.toISOString,G$=X0.default,_n={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Yx.encode,encodeValuesOnly:!1,filter:void 0,format:G$,formatter:X0.formatters[G$],indices:!1,serializeDate:function(e){return ZZ.call(e)},skipNulls:!1,strictNullHandling:!1},eee=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},PR={},tee=function t(e,r,n,i,s,o,a,c,u,d,f,h,m,g,p,y,w,v){for(var x=e,S=v,N=0,R=!1;(S=S.get(PR))!==void 0&&!R;){var E=S.get(e);if(N+=1,typeof E<"u"){if(E===N)throw new RangeError("Cyclic object value");R=!0}typeof S.get(PR)>"u"&&(N=0)}if(typeof d=="function"?x=d(r,x):x instanceof Date?x=m(x):n==="comma"&&dl(x)&&(x=Yx.maybeMap(x,function(ye){return ye instanceof Date?m(ye):ye})),x===null){if(o)return u&&!y?u(r,_n.encoder,w,"key",g):r;x=""}if(eee(x)||Yx.isBuffer(x)){if(u){var P=y?r:u(r,_n.encoder,w,"key",g);return[p(P)+"="+p(u(x,_n.encoder,w,"value",g))]}return[p(r)+"="+p(String(x))]}var D=[];if(typeof x>"u")return D;var H;if(n==="comma"&&dl(x))y&&u&&(x=Yx.maybeMap(x,u)),H=[{value:x.length>0?x.join(",")||null:void 0}];else if(dl(d))H=d;else{var Z=Object.keys(x);H=f?Z.sort(f):Z}var I=c?String(r).replace(/\./g,"%2E"):String(r),Y=i&&dl(x)&&x.length===1?I+"[]":I;if(s&&dl(x)&&x.length===0)return Y+"[]";for(var re=0;re<H.length;++re){var ne=H[re],ae=typeof ne=="object"&&ne&&typeof ne.value<"u"?ne.value:x[ne];if(!(a&&ae===null)){var ue=h&&c?String(ne).replace(/\./g,"%2E"):String(ne),Q=dl(x)?typeof n=="function"?n(Y,ue):Y:Y+(h?"."+ue:"["+ue+"]");v.set(e,N);var fe=cW();fe.set(PR,v),dW(D,t(ae,Q,n,i,s,o,a,c,n==="comma"&&y&&dl(x)?null:u,d,f,h,m,g,p,y,w,fe))}}return D},ree=function(e){if(!e)return _n;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||_n.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=X0.default;if(typeof e.format<"u"){if(!QZ.call(X0.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=X0.formatters[n],s=_n.filter;(typeof e.filter=="function"||dl(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in uW?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=_n.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:_n.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:_n.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:_n.allowEmptyArrays,arrayFormat:o,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:_n.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?_n.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:_n.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:_n.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:_n.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:_n.encodeValuesOnly,filter:s,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:_n.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:_n.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:_n.strictNullHandling}},nee=function(t,e){var r=t,n=ree(e),i,s;typeof n.filter=="function"?(s=n.filter,r=s("",r)):dl(n.filter)&&(s=n.filter,i=s);var o=[];if(typeof r!="object"||r===null)return"";var a=uW[n.arrayFormat],c=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var u=cW(),d=0;d<i.length;++d){var f=i[d],h=r[f];n.skipNulls&&h===null||dW(o,tee(h,f,a,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var m=o.join(n.delimiter),g=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),m.length>0?g+m:""},Zu=lW,Gx=Object.prototype.hasOwnProperty,K$=Array.isArray,Br={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Zu.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},iee=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},hW=function(t,e,r){if(t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&r>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return t},see="utf8=%26%2310003%3B",oee="utf8=%E2%9C%93",aee=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=r.parameterLimit===1/0?void 0:r.parameterLimit,o=i.split(r.delimiter,r.throwOnLimitExceeded?s+1:s);if(r.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,c,u=r.charset;if(r.charsetSentinel)for(c=0;c<o.length;++c)o[c].indexOf("utf8=")===0&&(o[c]===oee?u="utf-8":o[c]===see&&(u="iso-8859-1"),a=c,c=o.length);for(c=0;c<o.length;++c)if(c!==a){var d=o[c],f=d.indexOf("]="),h=f===-1?d.indexOf("="):f+1,m,g;if(h===-1?(m=r.decoder(d,Br.decoder,u,"key"),g=r.strictNullHandling?null:""):(m=r.decoder(d.slice(0,h),Br.decoder,u,"key"),m!==null&&(g=Zu.maybeMap(hW(d.slice(h+1),r,K$(n[m])?n[m].length:0),function(y){return r.decoder(y,Br.decoder,u,"value")}))),g&&r.interpretNumericEntities&&u==="iso-8859-1"&&(g=iee(String(g))),d.indexOf("[]=")>-1&&(g=K$(g)?[g]:g),m!==null){var p=Gx.call(n,m);p&&r.duplicates==="combine"?n[m]=Zu.combine(n[m],g,r.arrayLimit,r.plainObjects):(!p||r.duplicates==="last")&&(n[m]=g)}}return n},lee=function(t,e,r,n){var i=0;if(t.length>0&&t[t.length-1]==="[]"){var s=t.slice(0,-1).join("");i=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=n?e:hW(e,r,i),a=t.length-1;a>=0;--a){var c,u=t[a];if(u==="[]"&&r.parseArrays)Zu.isOverflow(o)?c=o:c=r.allowEmptyArrays&&(o===""||r.strictNullHandling&&o===null)?[]:Zu.combine([],o,r.arrayLimit,r.plainObjects);else{c=r.plainObjects?{__proto__:null}:{};var d=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,f=r.decodeDotInKeys?d.replace(/%2E/g,"."):d,h=parseInt(f,10);!r.parseArrays&&f===""?c={0:o}:!isNaN(h)&&u!==f&&String(h)===f&&h>=0&&r.parseArrays&&h<=r.arrayLimit?(c=[],c[h]=o):f!=="__proto__"&&(c[f]=o)}o=c}return o},cee=function(e,r){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e;if(r.depth<=0)return!r.plainObjects&&Gx.call(Object.prototype,n)&&!r.allowPrototypes?void 0:[n];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(n),a=o?n.slice(0,o.index):n,c=[];if(a){if(!r.plainObjects&&Gx.call(Object.prototype,a)&&!r.allowPrototypes)return;c.push(a)}for(var u=0;(o=s.exec(n))!==null&&u<r.depth;){u+=1;var d=o[1].slice(1,-1);if(!r.plainObjects&&Gx.call(Object.prototype,d)&&!r.allowPrototypes)return;c.push(o[1])}if(o){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");c.push("["+n.slice(o.index)+"]")}return c},uee=function(e,r,n,i){if(e){var s=cee(e,n);if(s)return lee(s,r,n,i)}},dee=function(e){if(!e)return Br;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=typeof e.charset>"u"?Br.charset:e.charset,n=typeof e.duplicates>"u"?Br.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Br.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Br.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Br.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Br.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Br.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Br.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Br.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Br.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Br.decoder,delimiter:typeof e.delimiter=="string"||Zu.isRegExp(e.delimiter)?e.delimiter:Br.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Br.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Br.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Br.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Br.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Br.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Br.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},hee=function(t,e){var r=dee(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?{__proto__:null}:{};for(var n=typeof t=="string"?aee(t,r):t,i=r.plainObjects?{__proto__:null}:{},s=Object.keys(n),o=0;o<s.length;++o){var a=s[o],c=uee(a,n[a],r,typeof t=="string");i=Zu.merge(i,c,r)}return r.allowSparse===!0?i:Zu.compact(i)},fee=nee,gee=hee,mee=SA,q$={formats:mee,parse:gee,stringify:fee},fW={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(t,e){(function(r,n){t.exports=n()})(ga,function(){var r={};r.version="0.2.0";var n=r.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};r.configure=function(g){var p,y;for(p in g)y=g[p],y!==void 0&&g.hasOwnProperty(p)&&(n[p]=y);return this},r.status=null,r.set=function(g){var p=r.isStarted();g=i(g,n.minimum,1),r.status=g===1?null:g;var y=r.render(!p),w=y.querySelector(n.barSelector),v=n.speed,x=n.easing;return y.offsetWidth,a(function(S){n.positionUsing===""&&(n.positionUsing=r.getPositioningCSS()),c(w,o(g,v,x)),g===1?(c(y,{transition:"none",opacity:1}),y.offsetWidth,setTimeout(function(){c(y,{transition:"all "+v+"ms linear",opacity:0}),setTimeout(function(){r.remove(),S()},v)},v)):setTimeout(S,v)}),this},r.isStarted=function(){return typeof r.status=="number"},r.start=function(){r.status||r.set(0);var g=function(){setTimeout(function(){r.status&&(r.trickle(),g())},n.trickleSpeed)};return n.trickle&&g(),this},r.done=function(g){return!g&&!r.status?this:r.inc(.3+.5*Math.random()).set(1)},r.inc=function(g){var p=r.status;return p?(typeof g!="number"&&(g=(1-p)*i(Math.random()*p,.1,.95)),p=i(p+g,0,.994),r.set(p)):r.start()},r.trickle=function(){return r.inc(Math.random()*n.trickleRate)},function(){var g=0,p=0;r.promise=function(y){return!y||y.state()==="resolved"?this:(p===0&&r.start(),g++,p++,y.always(function(){p--,p===0?(g=0,r.done()):r.set((g-p)/g)}),this)}}(),r.render=function(g){if(r.isRendered())return document.getElementById("nprogress");d(document.documentElement,"nprogress-busy");var p=document.createElement("div");p.id="nprogress",p.innerHTML=n.template;var y=p.querySelector(n.barSelector),w=g?"-100":s(r.status||0),v=document.querySelector(n.parent),x;return c(y,{transition:"all 0 linear",transform:"translate3d("+w+"%,0,0)"}),n.showSpinner||(x=p.querySelector(n.spinnerSelector),x&&m(x)),v!=document.body&&d(v,"nprogress-custom-parent"),v.appendChild(p),p},r.remove=function(){f(document.documentElement,"nprogress-busy"),f(document.querySelector(n.parent),"nprogress-custom-parent");var g=document.getElementById("nprogress");g&&m(g)},r.isRendered=function(){return!!document.getElementById("nprogress")},r.getPositioningCSS=function(){var g=document.body.style,p="WebkitTransform"in g?"Webkit":"MozTransform"in g?"Moz":"msTransform"in g?"ms":"OTransform"in g?"O":"";return p+"Perspective"in g?"translate3d":p+"Transform"in g?"translate":"margin"};function i(g,p,y){return g<p?p:g>y?y:g}function s(g){return(-1+g)*100}function o(g,p,y){var w;return n.positionUsing==="translate3d"?w={transform:"translate3d("+s(g)+"%,0,0)"}:n.positionUsing==="translate"?w={transform:"translate("+s(g)+"%,0)"}:w={"margin-left":s(g)+"%"},w.transition="all "+p+"ms "+y,w}var a=function(){var g=[];function p(){var y=g.shift();y&&y(p)}return function(y){g.push(y),g.length==1&&p()}}(),c=function(){var g=["Webkit","O","Moz","ms"],p={};function y(S){return S.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(N,R){return R.toUpperCase()})}function w(S){var N=document.body.style;if(S in N)return S;for(var R=g.length,E=S.charAt(0).toUpperCase()+S.slice(1),P;R--;)if(P=g[R]+E,P in N)return P;return S}function v(S){return S=y(S),p[S]||(p[S]=w(S))}function x(S,N,R){N=v(N),S.style[N]=R}return function(S,N){var R=arguments,E,P;if(R.length==2)for(E in N)P=N[E],P!==void 0&&N.hasOwnProperty(E)&&x(S,E,P);else x(S,R[1],R[2])}}();function u(g,p){var y=typeof g=="string"?g:h(g);return y.indexOf(" "+p+" ")>=0}function d(g,p){var y=h(g),w=y+p;u(y,p)||(g.className=w.substring(1))}function f(g,p){var y=h(g),w;u(g,p)&&(w=y.replace(" "+p+" "," "),g.className=w.substring(1,w.length-1))}function h(g){return(" "+(g.className||"")+" ").replace(/\s+/gi," ")}function m(g){g&&g.parentNode&&g.parentNode.removeChild(g)}return r})})(fW);var pee=fW.exports;const ml=bv(pee);function gW(t,e){let r;return function(...n){clearTimeout(r),r=setTimeout(()=>t.apply(this,n),e)}}function jc(t,e){return document.dispatchEvent(new CustomEvent(`inertia:${t}`,e))}var yee=t=>jc("before",{cancelable:!0,detail:{visit:t}}),vee=t=>jc("error",{detail:{errors:t}}),wee=t=>jc("exception",{cancelable:!0,detail:{exception:t}}),X$=t=>jc("finish",{detail:{visit:t}}),bee=t=>jc("invalid",{cancelable:!0,detail:{response:t}}),yp=t=>jc("navigate",{detail:{page:t}}),xee=t=>jc("progress",{detail:{progress:t}}),See=t=>jc("start",{detail:{visit:t}}),Cee=t=>jc("success",{detail:{page:t}});function jT(t){return t instanceof File||t instanceof Blob||t instanceof FileList&&t.length>0||t instanceof FormData&&Array.from(t.values()).some(e=>jT(e))||typeof t=="object"&&t!==null&&Object.values(t).some(e=>jT(e))}function mW(t,e=new FormData,r=null){t=t||{};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&yW(e,pW(r,n),t[n]);return e}function pW(t,e){return t?t+"["+e+"]":e}function yW(t,e,r){if(Array.isArray(r))return Array.from(r.keys()).forEach(n=>yW(t,pW(e,n.toString()),r[n]));if(r instanceof Date)return t.append(e,r.toISOString());if(r instanceof File)return t.append(e,r,r.name);if(r instanceof Blob)return t.append(e,r);if(typeof r=="boolean")return t.append(e,r?"1":"0");if(typeof r=="string")return t.append(e,r);if(typeof r=="number")return t.append(e,`${r}`);if(r==null)return t.append(e,"");mW(r,t,e)}var _ee={modal:null,listener:null,show(t){typeof t=="object"&&(t=`All Inertia requests must receive a valid Inertia response, however a plain JSON response was received.<hr>${JSON.stringify(t)}`);let e=document.createElement("html");e.innerHTML=t,e.querySelectorAll("a").forEach(n=>n.setAttribute("target","_top")),this.modal=document.createElement("div"),this.modal.style.position="fixed",this.modal.style.width="100vw",this.modal.style.height="100vh",this.modal.style.padding="50px",this.modal.style.boxSizing="border-box",this.modal.style.backgroundColor="rgba(0, 0, 0, .6)",this.modal.style.zIndex=2e5,this.modal.addEventListener("click",()=>this.hide());let r=document.createElement("iframe");if(r.style.backgroundColor="white",r.style.borderRadius="5px",r.style.width="100%",r.style.height="100%",this.modal.appendChild(r),document.body.prepend(this.modal),document.body.style.overflow="hidden",!r.contentWindow)throw new Error("iframe not yet ready.");r.contentWindow.document.open(),r.contentWindow.document.write(e.outerHTML),r.contentWindow.document.close(),this.listener=this.hideOnEscape.bind(this),document.addEventListener("keydown",this.listener)},hide(){this.modal.outerHTML="",this.modal=null,document.body.style.overflow="visible",document.removeEventListener("keydown",this.listener)},hideOnEscape(t){t.keyCode===27&&this.hide()}};function Rf(t){return new URL(t.toString(),window.location.toString())}function vW(t,e,r,n="brackets"){let i=/^https?:\/\//.test(e.toString()),s=i||e.toString().startsWith("/"),o=!s&&!e.toString().startsWith("#")&&!e.toString().startsWith("?"),a=e.toString().includes("?")||t==="get"&&Object.keys(r).length,c=e.toString().includes("#"),u=new URL(e.toString(),"http://localhost");return t==="get"&&Object.keys(r).length&&(u.search=q$.stringify(CQ(q$.parse(u.search,{ignoreQueryPrefix:!0}),r),{encodeValuesOnly:!0,arrayFormat:n}),r={}),[[i?`${u.protocol}//${u.host}`:"",s?u.pathname:"",o?u.pathname.substring(1):"",a?u.search:"",c?u.hash:""].join(""),r]}function vp(t){return t=new URL(t.href),t.hash="",t}var Kx=typeof window>"u",Q$=!Kx&&/CriOS/.test(window.navigator.userAgent),J$=t=>{requestAnimationFrame(()=>{requestAnimationFrame(t)})},Ree=class{constructor(){this.visitId=null}init({initialPage:t,resolveComponent:e,swapComponent:r}){this.page=t,this.resolveComponent=e,this.swapComponent=r,this.setNavigationType(),this.clearRememberedStateOnReload(),this.isBackForwardVisit()?this.handleBackForwardVisit(this.page):this.isLocationVisit()?this.handleLocationVisit(this.page):this.handleInitialPageVisit(this.page),this.setupEventListeners()}setNavigationType(){this.navigationType=window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType("navigation").length>0?window.performance.getEntriesByType("navigation")[0].type:"navigate"}clearRememberedStateOnReload(){var t;this.navigationType==="reload"&&((t=window.history.state)!=null&&t.rememberedState)&&delete window.history.state.rememberedState}handleInitialPageVisit(t){let e=window.location.hash;this.page.url.includes(e)||(this.page.url+=e),this.setPage(t,{preserveScroll:!0,preserveState:!0}).then(()=>yp(t))}setupEventListeners(){window.addEventListener("popstate",this.handlePopstateEvent.bind(this)),document.addEventListener("scroll",gW(this.handleScrollEvent.bind(this),100),!0)}scrollRegions(){return document.querySelectorAll("[scroll-region]")}handleScrollEvent(t){typeof t.target.hasAttribute=="function"&&t.target.hasAttribute("scroll-region")&&this.saveScrollPositions()}saveScrollPositions(){this.replaceState({...this.page,scrollRegions:Array.from(this.scrollRegions()).map(t=>({top:t.scrollTop,left:t.scrollLeft}))})}resetScrollPositions(){J$(()=>{var t;window.scrollTo(0,0),this.scrollRegions().forEach(e=>{typeof e.scrollTo=="function"?e.scrollTo(0,0):(e.scrollTop=0,e.scrollLeft=0)}),this.saveScrollPositions(),window.location.hash&&((t=document.getElementById(window.location.hash.slice(1)))==null||t.scrollIntoView())})}restoreScrollPositions(){J$(()=>{this.page.scrollRegions&&this.scrollRegions().forEach((t,e)=>{let r=this.page.scrollRegions[e];if(r)typeof t.scrollTo=="function"?t.scrollTo(r.left,r.top):(t.scrollTop=r.top,t.scrollLeft=r.left);else return})})}isBackForwardVisit(){return window.history.state&&this.navigationType==="back_forward"}handleBackForwardVisit(t){window.history.state.version=t.version,this.setPage(window.history.state,{preserveScroll:!0,preserveState:!0}).then(()=>{this.restoreScrollPositions(),yp(t)})}locationVisit(t,e){try{let r={preserveScroll:e};window.sessionStorage.setItem("inertiaLocationVisit",JSON.stringify(r)),window.location.href=t.href,vp(window.location).href===vp(t).href&&window.location.reload()}catch{return!1}}isLocationVisit(){try{return window.sessionStorage.getItem("inertiaLocationVisit")!==null}catch{return!1}}handleLocationVisit(t){var r,n;let e=JSON.parse(window.sessionStorage.getItem("inertiaLocationVisit")||"");window.sessionStorage.removeItem("inertiaLocationVisit"),t.url+=window.location.hash,t.rememberedState=((r=window.history.state)==null?void 0:r.rememberedState)??{},t.scrollRegions=((n=window.history.state)==null?void 0:n.scrollRegions)??[],this.setPage(t,{preserveScroll:e.preserveScroll,preserveState:!0}).then(()=>{e.preserveScroll&&this.restoreScrollPositions(),yp(t)})}isLocationVisitResponse(t){return!!(t&&t.status===409&&t.headers["x-inertia-location"])}isInertiaResponse(t){return!!(t!=null&&t.headers["x-inertia"])}createVisitId(){return this.visitId={},this.visitId}cancelVisit(t,{cancelled:e=!1,interrupted:r=!1}){t&&!t.completed&&!t.cancelled&&!t.interrupted&&(t.cancelToken.abort(),t.onCancel(),t.completed=!1,t.cancelled=e,t.interrupted=r,X$(t),t.onFinish(t))}finishVisit(t){!t.cancelled&&!t.interrupted&&(t.completed=!0,t.cancelled=!1,t.interrupted=!1,X$(t),t.onFinish(t))}resolvePreserveOption(t,e){return typeof t=="function"?t(e):t==="errors"?Object.keys(e.props.errors||{}).length>0:t}cancel(){this.activeVisit&&this.cancelVisit(this.activeVisit,{cancelled:!0})}visit(t,{method:e="get",data:r={},replace:n=!1,preserveScroll:i=!1,preserveState:s=!1,only:o=[],except:a=[],headers:c={},errorBag:u="",forceFormData:d=!1,onCancelToken:f=()=>{},onBefore:h=()=>{},onStart:m=()=>{},onProgress:g=()=>{},onFinish:p=()=>{},onCancel:y=()=>{},onSuccess:w=()=>{},onError:v=()=>{},queryStringArrayFormat:x="brackets"}={}){let S=typeof t=="string"?Rf(t):t;if((jT(r)||d)&&!(r instanceof FormData)&&(r=mW(r)),!(r instanceof FormData)){let[P,D]=vW(e,S,r,x);S=Rf(P),r=D}let N={url:S,method:e,data:r,replace:n,preserveScroll:i,preserveState:s,only:o,except:a,headers:c,errorBag:u,forceFormData:d,queryStringArrayFormat:x,cancelled:!1,completed:!1,interrupted:!1};if(h(N)===!1||!yee(N))return;this.activeVisit&&this.cancelVisit(this.activeVisit,{interrupted:!0}),this.saveScrollPositions();let R=this.createVisitId();this.activeVisit={...N,onCancelToken:f,onBefore:h,onStart:m,onProgress:g,onFinish:p,onCancel:y,onSuccess:w,onError:v,queryStringArrayFormat:x,cancelToken:new AbortController},f({cancel:()=>{this.activeVisit&&this.cancelVisit(this.activeVisit,{cancelled:!0})}}),See(N),m(N);let E=!!(o.length||a.length);Hr({method:e,url:vp(S).href,data:e==="get"?{}:r,params:e==="get"?r:{},signal:this.activeVisit.cancelToken.signal,headers:{...c,Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Inertia":!0,...E?{"X-Inertia-Partial-Component":this.page.component}:{},...o.length?{"X-Inertia-Partial-Data":o.join(",")}:{},...a.length?{"X-Inertia-Partial-Except":a.join(",")}:{},...u&&u.length?{"X-Inertia-Error-Bag":u}:{},...this.page.version?{"X-Inertia-Version":this.page.version}:{}},onUploadProgress:P=>{r instanceof FormData&&(P.percentage=P.progress?Math.round(P.progress*100):0,xee(P),g(P))}}).then(P=>{var I;if(!this.isInertiaResponse(P))return Promise.reject({response:P});let D=P.data;E&&D.component===this.page.component&&(D.props={...this.page.props,...D.props}),i=this.resolvePreserveOption(i,D),s=this.resolvePreserveOption(s,D),s&&((I=window.history.state)!=null&&I.rememberedState)&&D.component===this.page.component&&(D.rememberedState=window.history.state.rememberedState);let H=S,Z=Rf(D.url);return H.hash&&!Z.hash&&vp(H).href===Z.href&&(Z.hash=H.hash,D.url=Z.href),this.setPage(D,{visitId:R,replace:n,preserveScroll:i,preserveState:s})}).then(()=>{let P=this.page.props.errors||{};if(Object.keys(P).length>0){let D=u?P[u]?P[u]:{}:P;return vee(D),v(D)}return Cee(this.page),w(this.page)}).catch(P=>{if(this.isInertiaResponse(P.response))return this.setPage(P.response.data,{visitId:R});if(this.isLocationVisitResponse(P.response)){let D=Rf(P.response.headers["x-inertia-location"]),H=S;H.hash&&!D.hash&&vp(H).href===D.href&&(D.hash=H.hash),this.locationVisit(D,i===!0)}else if(P.response)bee(P.response)&&_ee.show(P.response.data);else return Promise.reject(P)}).then(()=>{this.activeVisit&&this.finishVisit(this.activeVisit)}).catch(P=>{if(!Hr.isCancel(P)){let D=wee(P);if(this.activeVisit&&this.finishVisit(this.activeVisit),D)return Promise.reject(P)}})}setPage(t,{visitId:e=this.createVisitId(),replace:r=!1,preserveScroll:n=!1,preserveState:i=!1}={}){return Promise.resolve(this.resolveComponent(t.component)).then(s=>{e===this.visitId&&(t.scrollRegions=this.page.scrollRegions||[],t.rememberedState=t.rememberedState||{},r=r||Rf(t.url).href===window.location.href,r?this.replaceState(t):this.pushState(t),this.swapComponent({component:s,page:t,preserveState:i}).then(()=>{n?this.restoreScrollPositions():this.resetScrollPositions(),r||yp(t)}))})}pushState(t){this.page=t,Q$?setTimeout(()=>window.history.pushState(t,"",t.url)):window.history.pushState(t,"",t.url)}replaceState(t){this.page=t,Q$?setTimeout(()=>window.history.replaceState(t,"",t.url)):window.history.replaceState(t,"",t.url)}handlePopstateEvent(t){if(t.state!==null){let e=t.state,r=this.createVisitId();Promise.resolve(this.resolveComponent(e.component)).then(n=>{r===this.visitId&&(this.page=e,this.swapComponent({component:n,page:e,preserveState:!1}).then(()=>{this.restoreScrollPositions(),yp(e)}))})}else{let e=Rf(this.page.url);e.hash=window.location.hash,this.replaceState({...this.page,url:e.href}),this.resetScrollPositions()}}get(t,e={},r={}){return this.visit(t,{...r,method:"get",data:e})}reload(t={}){return this.visit(window.location.href,{...t,preserveScroll:!0,preserveState:!0})}replace(t,e={}){return console.warn(`Inertia.replace() has been deprecated and will be removed in a future release. Please use Inertia.${e.method??"get"}() instead.`),this.visit(t,{preserveState:!0,...e,replace:!0})}post(t,e={},r={}){return this.visit(t,{preserveState:!0,...r,method:"post",data:e})}put(t,e={},r={}){return this.visit(t,{preserveState:!0,...r,method:"put",data:e})}patch(t,e={},r={}){return this.visit(t,{preserveState:!0,...r,method:"patch",data:e})}delete(t,e={}){return this.visit(t,{preserveState:!0,...e,method:"delete"})}remember(t,e="default"){var r;Kx||this.replaceState({...this.page,rememberedState:{...(r=this.page)==null?void 0:r.rememberedState,[e]:t}})}restore(t="default"){var e,r;if(!Kx)return(r=(e=window.history.state)==null?void 0:e.rememberedState)==null?void 0:r[t]}on(t,e){if(Kx)return()=>{};let r=n=>{let i=e(n);n.cancelable&&!n.defaultPrevented&&i===!1&&n.preventDefault()};return document.addEventListener(`inertia:${t}`,r),()=>document.removeEventListener(`inertia:${t}`,r)}},Eee={buildDOMElement(t){let e=document.createElement("template");e.innerHTML=t;let r=e.content.firstChild;if(!t.startsWith("<script "))return r;let n=document.createElement("script");return n.innerHTML=r.innerHTML,r.getAttributeNames().forEach(i=>{n.setAttribute(i,r.getAttribute(i)||"")}),n},isInertiaManagedElement(t){return t.nodeType===Node.ELEMENT_NODE&&t.getAttribute("inertia")!==null},findMatchingElementIndex(t,e){let r=t.getAttribute("inertia");return r!==null?e.findIndex(n=>n.getAttribute("inertia")===r):-1},update:gW(function(t){let e=t.map(r=>this.buildDOMElement(r));Array.from(document.head.childNodes).filter(r=>this.isInertiaManagedElement(r)).forEach(r=>{var s,o;let n=this.findMatchingElementIndex(r,e);if(n===-1){(s=r==null?void 0:r.parentNode)==null||s.removeChild(r);return}let i=e.splice(n,1)[0];i&&!r.isEqualNode(i)&&((o=r==null?void 0:r.parentNode)==null||o.replaceChild(i,r))}),e.forEach(r=>document.head.appendChild(r))},1)};function Nee(t,e,r){let n={},i=0;function s(){let d=i+=1;return n[d]=[],d.toString()}function o(d){d===null||Object.keys(n).indexOf(d)===-1||(delete n[d],u())}function a(d,f=[]){d!==null&&Object.keys(n).indexOf(d)>-1&&(n[d]=f),u()}function c(){let d=e(""),f={...d?{title:`<title inertia="">${d}</title>`}:{}},h=Object.values(n).reduce((m,g)=>m.concat(g),[]).reduce((m,g)=>{if(g.indexOf("<")===-1)return m;if(g.indexOf("<title ")===0){let y=g.match(/(<title [^>]+>)(.*?)(<\/title>)/);return m.title=y?`${y[1]}${e(y[2])}${y[3]}`:g,m}let p=g.match(/ inertia="[^"]+"/);return p?m[p[0]]=g:m[Object.keys(m).length]=g,m},f);return Object.values(h)}function u(){t?r(c()):Eee.update(c())}return u(),{forceUpdate:u,createProvider:function(){let d=s();return{update:f=>a(d,f),disconnect:()=>o(d)}}}}var wW=null;function kee(t){document.addEventListener("inertia:start",Tee.bind(null,t)),document.addEventListener("inertia:progress",Pee),document.addEventListener("inertia:finish",Mee)}function Tee(t){wW=setTimeout(()=>ml.start(),t)}function Pee(t){var e;ml.isStarted()&&((e=t.detail.progress)!=null&&e.percentage)&&ml.set(Math.max(ml.status,t.detail.progress.percentage/100*.9))}function Mee(t){if(clearTimeout(wW),ml.isStarted())t.detail.visit.completed?ml.done():t.detail.visit.interrupted?ml.set(0):t.detail.visit.cancelled&&(ml.done(),ml.remove());else return}function Aee(t){let e=document.createElement("style");e.type="text/css",e.textContent=`
    #nprogress {
      pointer-events: none;
    }

    #nprogress .bar {
      background: ${t};

      position: fixed;
      z-index: 1031;
      top: 0;
      left: 0;

      width: 100%;
      height: 2px;
    }

    #nprogress .peg {
      display: block;
      position: absolute;
      right: 0px;
      width: 100px;
      height: 100%;
      box-shadow: 0 0 10px ${t}, 0 0 5px ${t};
      opacity: 1.0;

      -webkit-transform: rotate(3deg) translate(0px, -4px);
          -ms-transform: rotate(3deg) translate(0px, -4px);
              transform: rotate(3deg) translate(0px, -4px);
    }

    #nprogress .spinner {
      display: block;
      position: fixed;
      z-index: 1031;
      top: 15px;
      right: 15px;
    }

    #nprogress .spinner-icon {
      width: 18px;
      height: 18px;
      box-sizing: border-box;

      border: solid 2px transparent;
      border-top-color: ${t};
      border-left-color: ${t};
      border-radius: 50%;

      -webkit-animation: nprogress-spinner 400ms linear infinite;
              animation: nprogress-spinner 400ms linear infinite;
    }

    .nprogress-custom-parent {
      overflow: hidden;
      position: relative;
    }

    .nprogress-custom-parent #nprogress .spinner,
    .nprogress-custom-parent #nprogress .bar {
      position: absolute;
    }

    @-webkit-keyframes nprogress-spinner {
      0%   { -webkit-transform: rotate(0deg); }
      100% { -webkit-transform: rotate(360deg); }
    }
    @keyframes nprogress-spinner {
      0%   { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `,document.head.appendChild(e)}function Oee({delay:t=250,color:e="#29d",includeCSS:r=!0,showSpinner:n=!1}={}){kee(t),ml.configure({showSpinner:n}),r&&Aee(e)}function Iee(t){let e=t.currentTarget.tagName.toLowerCase()==="a";return!(t.target&&(t==null?void 0:t.target).isContentEditable||t.defaultPrevented||e&&t.altKey||e&&t.ctrlKey||e&&t.metaKey||e&&t.shiftKey||e&&"button"in t&&t.button!==0)}var ed=new Ree,BS={exports:{}};BS.exports;(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,a="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",d="[object Boolean]",f="[object Date]",h="[object Error]",m="[object Function]",g="[object GeneratorFunction]",p="[object Map]",y="[object Number]",w="[object Null]",v="[object Object]",x="[object Promise]",S="[object Proxy]",N="[object RegExp]",R="[object Set]",E="[object String]",P="[object Symbol]",D="[object Undefined]",H="[object WeakMap]",Z="[object ArrayBuffer]",I="[object DataView]",Y="[object Float32Array]",re="[object Float64Array]",ne="[object Int8Array]",ae="[object Int16Array]",ue="[object Int32Array]",Q="[object Uint8Array]",fe="[object Uint8ClampedArray]",ye="[object Uint16Array]",de="[object Uint32Array]",se=/[\\^$.*+?()[\]{}|]/g,me=/^\[object .+?Constructor\]$/,te=/^(?:0|[1-9]\d*)$/,b={};b[Y]=b[re]=b[ne]=b[ae]=b[ue]=b[Q]=b[fe]=b[ye]=b[de]=!0,b[a]=b[c]=b[Z]=b[d]=b[I]=b[f]=b[h]=b[m]=b[p]=b[y]=b[v]=b[N]=b[R]=b[E]=b[H]=!1;var _=typeof ga=="object"&&ga&&ga.Object===Object&&ga,T=typeof self=="object"&&self&&self.Object===Object&&self,F=_||T||Function("return this")(),K=e&&!e.nodeType&&e,C=K&&!0&&t&&!t.nodeType&&t,k=C&&C.exports===K,M=k&&_.process,V=function(){try{return M&&M.binding&&M.binding("util")}catch{}}(),j=V&&V.isTypedArray;function A(O,G){for(var le=-1,Te=O==null?0:O.length,lr=0,Ze=[];++le<Te;){var Fr=O[le];G(Fr,le,O)&&(Ze[lr++]=Fr)}return Ze}function U(O,G){for(var le=-1,Te=G.length,lr=O.length;++le<Te;)O[lr+le]=G[le];return O}function L(O,G){for(var le=-1,Te=O==null?0:O.length;++le<Te;)if(G(O[le],le,O))return!0;return!1}function W(O,G){for(var le=-1,Te=Array(O);++le<O;)Te[le]=G(le);return Te}function X(O){return function(G){return O(G)}}function q(O,G){return O.has(G)}function ie(O,G){return O==null?void 0:O[G]}function we(O){var G=-1,le=Array(O.size);return O.forEach(function(Te,lr){le[++G]=[lr,Te]}),le}function ve(O,G){return function(le){return O(G(le))}}function je(O){var G=-1,le=Array(O.size);return O.forEach(function(Te){le[++G]=Te}),le}var oe=Array.prototype,Ee=Function.prototype,Se=Object.prototype,He=F["__core-js_shared__"],ze=Ee.toString,Ge=Se.hasOwnProperty,Zt=function(){var O=/[^.]+$/.exec(He&&He.keys&&He.keys.IE_PROTO||"");return O?"Symbol(src)_1."+O:""}(),Qr=Se.toString,$t=RegExp("^"+ze.call(Ge).replace(se,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gt=k?F.Buffer:void 0,Ue=F.Symbol,ct=F.Uint8Array,Be=Se.propertyIsEnumerable,yr=oe.splice,Kt=Ue?Ue.toStringTag:void 0,Gn=Object.getOwnPropertySymbols,Pa=Gt?Gt.isBuffer:void 0,Gi=ve(Object.keys,Object),Jr=Sf(F,"DataView"),Ma=Sf(F,"Map"),Wc=Sf(F,"Promise"),_r=Sf(F,"Set"),Aa=Sf(F,"WeakMap"),gd=Sf(Object,"create"),lw=md(Jr),up=md(Ma),cw=md(Wc),uw=md(_r),nR=md(Aa),Rs=Ue?Ue.prototype:void 0,Lo=Rs?Rs.valueOf:void 0;function Oa(O){var G=-1,le=O==null?0:O.length;for(this.clear();++G<le;){var Te=O[G];this.set(Te[0],Te[1])}}function dw(){this.__data__=gd?gd(null):{},this.size=0}function dp(O){var G=this.has(O)&&delete this.__data__[O];return this.size-=G?1:0,G}function hw(O){var G=this.__data__;if(gd){var le=G[O];return le===n?void 0:le}return Ge.call(G,O)?G[O]:void 0}function Fo(O){var G=this.__data__;return gd?G[O]!==void 0:Ge.call(G,O)}function fw(O,G){var le=this.__data__;return this.size+=this.has(O)?0:1,le[O]=gd&&G===void 0?n:G,this}Oa.prototype.clear=dw,Oa.prototype.delete=dp,Oa.prototype.get=hw,Oa.prototype.has=Fo,Oa.prototype.set=fw;function no(O){var G=-1,le=O==null?0:O.length;for(this.clear();++G<le;){var Te=O[G];this.set(Te[0],Te[1])}}function gw(){this.__data__=[],this.size=0}function mw(O){var G=this.__data__,le=vw(G,O);if(le<0)return!1;var Te=G.length-1;return le==Te?G.pop():yr.call(G,le,1),--this.size,!0}function iR(O){var G=this.__data__,le=vw(G,O);return le<0?void 0:G[le][1]}function $e(O){return vw(this.__data__,O)>-1}function z(O,G){var le=this.__data__,Te=vw(le,O);return Te<0?(++this.size,le.push([O,G])):le[Te][1]=G,this}no.prototype.clear=gw,no.prototype.delete=mw,no.prototype.get=iR,no.prototype.has=$e,no.prototype.set=z;function he(O){var G=-1,le=O==null?0:O.length;for(this.clear();++G<le;){var Te=O[G];this.set(Te[0],Te[1])}}function Ae(){this.size=0,this.__data__={hash:new Oa,map:new(Ma||no),string:new Oa}}function er(O){var G=ww(this,O).delete(O);return this.size-=G?1:0,G}function An(O){return ww(this,O).get(O)}function Lr(O){return ww(this,O).has(O)}function si(O,G){var le=ww(this,O),Te=le.size;return le.set(O,G),this.size+=le.size==Te?0:1,this}he.prototype.clear=Ae,he.prototype.delete=er,he.prototype.get=An,he.prototype.has=Lr,he.prototype.set=si;function Ki(O){var G=-1,le=O==null?0:O.length;for(this.__data__=new he;++G<le;)this.add(O[G])}function zc(O){return this.__data__.set(O,n),this}function hp(O){return this.__data__.has(O)}Ki.prototype.add=Ki.prototype.push=zc,Ki.prototype.has=hp;function tr(O){var G=this.__data__=new no(O);this.size=G.size}function pw(){this.__data__=new no,this.size=0}function yw(O){var G=this.__data__,le=G.delete(O);return this.size=G.size,le}function VK(O){return this.__data__.get(O)}function BK(O){return this.__data__.has(O)}function WK(O,G){var le=this.__data__;if(le instanceof no){var Te=le.__data__;if(!Ma||Te.length<r-1)return Te.push([O,G]),this.size=++le.size,this;le=this.__data__=new he(Te)}return le.set(O,G),this.size=le.size,this}tr.prototype.clear=pw,tr.prototype.delete=yw,tr.prototype.get=VK,tr.prototype.has=BK,tr.prototype.set=WK;function zK(O,G){var le=bw(O),Te=!le&&sq(O),lr=!le&&!Te&&sR(O),Ze=!le&&!Te&&!lr&&ZH(O),Fr=le||Te||lr||Ze,On=Fr?W(O.length,String):[],Kn=On.length;for(var Rr in O)Ge.call(O,Rr)&&!(Fr&&(Rr=="length"||lr&&(Rr=="offset"||Rr=="parent")||Ze&&(Rr=="buffer"||Rr=="byteLength"||Rr=="byteOffset")||eq(Rr,Kn)))&&On.push(Rr);return On}function vw(O,G){for(var le=O.length;le--;)if(qH(O[le][0],G))return le;return-1}function UK(O,G,le){var Te=G(O);return bw(O)?Te:U(Te,le(O))}function fp(O){return O==null?O===void 0?D:w:Kt&&Kt in Object(O)?JK(O):iq(O)}function UH(O){return gp(O)&&fp(O)==a}function YH(O,G,le,Te,lr){return O===G?!0:O==null||G==null||!gp(O)&&!gp(G)?O!==O&&G!==G:YK(O,G,le,Te,YH,lr)}function YK(O,G,le,Te,lr,Ze){var Fr=bw(O),On=bw(G),Kn=Fr?c:Uc(O),Rr=On?c:Uc(G);Kn=Kn==a?v:Kn,Rr=Rr==a?v:Rr;var Es=Kn==v,Vo=Rr==v,oi=Kn==Rr;if(oi&&sR(O)){if(!sR(G))return!1;Fr=!0,Es=!1}if(oi&&!Es)return Ze||(Ze=new tr),Fr||ZH(O)?GH(O,G,le,Te,lr,Ze):XK(O,G,Kn,le,Te,lr,Ze);if(!(le&i)){var io=Es&&Ge.call(O,"__wrapped__"),so=Vo&&Ge.call(G,"__wrapped__");if(io||so){var Yc=io?O.value():O,$l=so?G.value():G;return Ze||(Ze=new tr),lr(Yc,$l,le,Te,Ze)}}return oi?(Ze||(Ze=new tr),QK(O,G,le,Te,lr,Ze)):!1}function GK(O){if(!JH(O)||rq(O))return!1;var G=XH(O)?$t:me;return G.test(md(O))}function KK(O){return gp(O)&&QH(O.length)&&!!b[fp(O)]}function qK(O){if(!nq(O))return Gi(O);var G=[];for(var le in Object(O))Ge.call(O,le)&&le!="constructor"&&G.push(le);return G}function GH(O,G,le,Te,lr,Ze){var Fr=le&i,On=O.length,Kn=G.length;if(On!=Kn&&!(Fr&&Kn>On))return!1;var Rr=Ze.get(O);if(Rr&&Ze.get(G))return Rr==G;var Es=-1,Vo=!0,oi=le&s?new Ki:void 0;for(Ze.set(O,G),Ze.set(G,O);++Es<On;){var io=O[Es],so=G[Es];if(Te)var Yc=Fr?Te(so,io,Es,G,O,Ze):Te(io,so,Es,O,G,Ze);if(Yc!==void 0){if(Yc)continue;Vo=!1;break}if(oi){if(!L(G,function($l,pd){if(!q(oi,pd)&&(io===$l||lr(io,$l,le,Te,Ze)))return oi.push(pd)})){Vo=!1;break}}else if(!(io===so||lr(io,so,le,Te,Ze))){Vo=!1;break}}return Ze.delete(O),Ze.delete(G),Vo}function XK(O,G,le,Te,lr,Ze,Fr){switch(le){case I:if(O.byteLength!=G.byteLength||O.byteOffset!=G.byteOffset)return!1;O=O.buffer,G=G.buffer;case Z:return!(O.byteLength!=G.byteLength||!Ze(new ct(O),new ct(G)));case d:case f:case y:return qH(+O,+G);case h:return O.name==G.name&&O.message==G.message;case N:case E:return O==G+"";case p:var On=we;case R:var Kn=Te&i;if(On||(On=je),O.size!=G.size&&!Kn)return!1;var Rr=Fr.get(O);if(Rr)return Rr==G;Te|=s,Fr.set(O,G);var Es=GH(On(O),On(G),Te,lr,Ze,Fr);return Fr.delete(O),Es;case P:if(Lo)return Lo.call(O)==Lo.call(G)}return!1}function QK(O,G,le,Te,lr,Ze){var Fr=le&i,On=KH(O),Kn=On.length,Rr=KH(G),Es=Rr.length;if(Kn!=Es&&!Fr)return!1;for(var Vo=Kn;Vo--;){var oi=On[Vo];if(!(Fr?oi in G:Ge.call(G,oi)))return!1}var io=Ze.get(O);if(io&&Ze.get(G))return io==G;var so=!0;Ze.set(O,G),Ze.set(G,O);for(var Yc=Fr;++Vo<Kn;){oi=On[Vo];var $l=O[oi],pd=G[oi];if(Te)var e$=Fr?Te(pd,$l,oi,G,O,Ze):Te($l,pd,oi,O,G,Ze);if(!(e$===void 0?$l===pd||lr($l,pd,le,Te,Ze):e$)){so=!1;break}Yc||(Yc=oi=="constructor")}if(so&&!Yc){var xw=O.constructor,Sw=G.constructor;xw!=Sw&&"constructor"in O&&"constructor"in G&&!(typeof xw=="function"&&xw instanceof xw&&typeof Sw=="function"&&Sw instanceof Sw)&&(so=!1)}return Ze.delete(O),Ze.delete(G),so}function KH(O){return UK(O,lq,ZK)}function ww(O,G){var le=O.__data__;return tq(G)?le[typeof G=="string"?"string":"hash"]:le.map}function Sf(O,G){var le=ie(O,G);return GK(le)?le:void 0}function JK(O){var G=Ge.call(O,Kt),le=O[Kt];try{O[Kt]=void 0;var Te=!0}catch{}var lr=Qr.call(O);return Te&&(G?O[Kt]=le:delete O[Kt]),lr}var ZK=Gn?function(O){return O==null?[]:(O=Object(O),A(Gn(O),function(G){return Be.call(O,G)}))}:cq,Uc=fp;(Jr&&Uc(new Jr(new ArrayBuffer(1)))!=I||Ma&&Uc(new Ma)!=p||Wc&&Uc(Wc.resolve())!=x||_r&&Uc(new _r)!=R||Aa&&Uc(new Aa)!=H)&&(Uc=function(O){var G=fp(O),le=G==v?O.constructor:void 0,Te=le?md(le):"";if(Te)switch(Te){case lw:return I;case up:return p;case cw:return x;case uw:return R;case nR:return H}return G});function eq(O,G){return G=G??o,!!G&&(typeof O=="number"||te.test(O))&&O>-1&&O%1==0&&O<G}function tq(O){var G=typeof O;return G=="string"||G=="number"||G=="symbol"||G=="boolean"?O!=="__proto__":O===null}function rq(O){return!!Zt&&Zt in O}function nq(O){var G=O&&O.constructor,le=typeof G=="function"&&G.prototype||Se;return O===le}function iq(O){return Qr.call(O)}function md(O){if(O!=null){try{return ze.call(O)}catch{}try{return O+""}catch{}}return""}function qH(O,G){return O===G||O!==O&&G!==G}var sq=UH(function(){return arguments}())?UH:function(O){return gp(O)&&Ge.call(O,"callee")&&!Be.call(O,"callee")},bw=Array.isArray;function oq(O){return O!=null&&QH(O.length)&&!XH(O)}var sR=Pa||uq;function aq(O,G){return YH(O,G)}function XH(O){if(!JH(O))return!1;var G=fp(O);return G==m||G==g||G==u||G==S}function QH(O){return typeof O=="number"&&O>-1&&O%1==0&&O<=o}function JH(O){var G=typeof O;return O!=null&&(G=="object"||G=="function")}function gp(O){return O!=null&&typeof O=="object"}var ZH=j?X(j):KK;function lq(O){return oq(O)?zK(O):qK(O)}function cq(){return[]}function uq(){return!1}t.exports=aq})(BS,BS.exports);var jee=BS.exports;const Hee=bv(jee);var bW=$.createContext(void 0);bW.displayName="InertiaHeadContext";var HT=bW,xW=$.createContext(void 0);xW.displayName="InertiaPageContext";var $T=xW;function SW({children:t,initialPage:e,initialComponent:r,resolveComponent:n,titleCallback:i,onHeadUpdate:s}){let[o,a]=$.useState({component:r||null,page:e,key:null}),c=$.useMemo(()=>Nee(typeof window>"u",i||(d=>d),s||(()=>{})),[]);if($.useEffect(()=>{ed.init({initialPage:e,resolveComponent:n,swapComponent:async({component:d,page:f,preserveState:h})=>{a(m=>({component:d,page:f,key:h?m.key:Date.now()}))}}),ed.on("navigate",()=>c.forceUpdate())},[]),!o.component)return $.createElement(HT.Provider,{value:c},$.createElement($T.Provider,{value:o.page},null));let u=t||(({Component:d,props:f,key:h})=>{let m=$.createElement(d,{key:h,...f});return typeof d.layout=="function"?d.layout(m):Array.isArray(d.layout)?d.layout.concat(m).reverse().reduce((g,p)=>$.createElement(p,{children:g,...f})):m});return $.createElement(HT.Provider,{value:c},$.createElement($T.Provider,{value:o.page},u({Component:o.component,key:o.key,props:o.page.props})))}SW.displayName="Inertia";async function $ee({id:t="app",resolve:e,setup:r,title:n,progress:i={},page:s,render:o}){let a=typeof window>"u",c=a?null:document.getElementById(t),u=s||JSON.parse(c.dataset.page),d=m=>Promise.resolve(e(m)).then(g=>g.default||g),f=[],h=await d(u.component).then(m=>r({el:c,App:SW,props:{initialPage:u,initialComponent:m,resolveComponent:d,titleCallback:n,onHeadUpdate:a?g=>f=g:null}}));if(!a&&i&&Oee(i),a){let m=await o($.createElement("div",{id:t,"data-page":JSON.stringify(u)},h));return{head:f,body:m}}}var Dee=function({children:t,title:e}){let r=$.useContext(HT),n=$.useMemo(()=>r.createProvider(),[r]);$.useEffect(()=>()=>{n.disconnect()},[n]);function i(f){return["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"].indexOf(f.type)>-1}function s(f){let h=Object.keys(f.props).reduce((m,g)=>{if(["head-key","children","dangerouslySetInnerHTML"].includes(g))return m;let p=f.props[g];return p===""?m+` ${g}`:m+` ${g}="${p}"`},"");return`<${f.type}${h}>`}function o(f){return typeof f.props.children=="string"?f.props.children:f.props.children.reduce((h,m)=>h+a(m),"")}function a(f){let h=s(f);return f.props.children&&(h+=o(f)),f.props.dangerouslySetInnerHTML&&(h+=f.props.dangerouslySetInnerHTML.__html),i(f)||(h+=`</${f.type}>`),h}function c(f){return Pt.cloneElement(f,{inertia:f.props["head-key"]!==void 0?f.props["head-key"]:""})}function u(f){return a(c(f))}function d(f){let h=Pt.Children.toArray(f).filter(m=>m).map(m=>u(m));return e&&!h.find(m=>m.startsWith("<title"))&&h.push(`<title inertia>${e}</title>`),h}return n.update(d(t)),null},_A=Dee,Dl=()=>{},CW=$.forwardRef(({children:t,as:e="a",data:r={},href:n,method:i="get",preserveScroll:s=!1,preserveState:o=null,replace:a=!1,only:c=[],except:u=[],headers:d={},queryStringArrayFormat:f="brackets",onClick:h=Dl,onCancelToken:m=Dl,onBefore:g=Dl,onStart:p=Dl,onProgress:y=Dl,onFinish:w=Dl,onCancel:v=Dl,onSuccess:x=Dl,onError:S=Dl,...N},R)=>{let E=$.useCallback(H=>{h(H),Iee(H)&&(H.preventDefault(),ed.visit(n,{data:r,method:i,preserveScroll:s,preserveState:o??i!=="get",replace:a,only:c,except:u,headers:d,onCancelToken:m,onBefore:g,onStart:p,onProgress:y,onFinish:w,onCancel:v,onSuccess:x,onError:S}))},[r,n,i,s,o,a,c,u,d,h,m,g,p,y,w,v,x,S]);e=e.toLowerCase(),i=i.toLowerCase();let[P,D]=vW(i,n||"",r,f);return n=P,r=D,e==="a"&&i!=="get"&&console.warn(`Creating POST/PUT/PATCH/DELETE <a> links is discouraged as it causes "Open Link in New Tab/Window" accessibility issues.

Please specify a more appropriate element using the "as" attribute. For example:

<Link href="${n}" method="${i}" as="button">...</Link>`),$.createElement(e,{...N,...e==="a"?{href:n}:{},ref:R,onClick:E},t)});CW.displayName="InertiaLink";var yt=CW;function Z$(t,e){let[r,n]=$.useState(()=>{let i=ed.restore(e);return i!==void 0?i:t});return $.useEffect(()=>{ed.remember(r,e)},[r,e]),[r,n]}function Oo(t,e){let r=$.useRef(null),n=typeof t=="string"?t:null,[i,s]=$.useState((typeof t=="string"?e:t)||{}),o=$.useRef(null),a=$.useRef(null),[c,u]=n?Z$(i,`${n}:data`):$.useState(i),[d,f]=n?Z$({},`${n}:errors`):$.useState({}),[h,m]=$.useState(!1),[g,p]=$.useState(!1),[y,w]=$.useState(null),[v,x]=$.useState(!1),[S,N]=$.useState(!1),R=$.useRef(de=>de);$.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[]);let E=$.useCallback((de,se,me={})=>{let te={...me,onCancelToken:b=>{if(o.current=b,me.onCancelToken)return me.onCancelToken(b)},onBefore:b=>{if(x(!1),N(!1),clearTimeout(a.current),me.onBefore)return me.onBefore(b)},onStart:b=>{if(p(!0),me.onStart)return me.onStart(b)},onProgress:b=>{if(w(b),me.onProgress)return me.onProgress(b)},onSuccess:b=>{if(r.current&&(p(!1),w(null),f({}),m(!1),x(!0),N(!0),a.current=setTimeout(()=>{r.current&&N(!1)},2e3)),me.onSuccess)return me.onSuccess(b)},onError:b=>{if(r.current&&(p(!1),w(null),f(b),m(!0)),me.onError)return me.onError(b)},onCancel:()=>{if(r.current&&(p(!1),w(null)),me.onCancel)return me.onCancel()},onFinish:()=>{if(r.current&&(p(!1),w(null)),o.current=null,me.onFinish)return me.onFinish()}};de==="delete"?ed.delete(se,{...te,data:R.current(c)}):ed[de](se,R.current(c),te)},[c,f]),P=$.useCallback((de,se)=>{u(typeof de=="string"?me=>({...me,[de]:se}):typeof de=="function"?me=>de(me):de)},[u]),D=$.useCallback((de,se)=>{s(typeof de>"u"?()=>c:me=>({...me,...typeof de=="string"?{[de]:se}:de}))},[c,s]),H=$.useCallback((...de)=>{de.length===0?u(i):u(se=>Object.keys(i).filter(me=>de.includes(me)).reduce((me,te)=>(me[te]=i[te],me),{...se}))},[u,i]),Z=$.useCallback((de,se)=>{f(me=>{let te={...me,...typeof de=="string"?{[de]:se}:de};return m(Object.keys(te).length>0),te})},[f,m]),I=$.useCallback((...de)=>{f(se=>{let me=Object.keys(se).reduce((te,b)=>({...te,...de.length>0&&!de.includes(b)?{[b]:se[b]}:{}}),{});return m(Object.keys(me).length>0),me})},[f,m]),Y=de=>(se,me)=>{E(de,se,me)},re=$.useCallback(Y("get"),[E]),ne=$.useCallback(Y("post"),[E]),ae=$.useCallback(Y("put"),[E]),ue=$.useCallback(Y("patch"),[E]),Q=$.useCallback(Y("delete"),[E]),fe=$.useCallback(()=>{o.current&&o.current.cancel()},[]),ye=$.useCallback(de=>{R.current=de},[]);return{data:c,setData:P,isDirty:!Hee(c,i),errors:d,hasErrors:h,processing:g,progress:y,wasSuccessful:v,recentlySuccessful:S,transform:ye,setDefaults:D,reset:H,setError:Z,clearErrors:I,submit:E,get:re,post:ne,put:ae,patch:ue,delete:Q,cancel:fe}}function RA(){let t=$.useContext($T);if(!t)throw new Error("usePage must be used within the Inertia component");return t}var lt=ed;const _W=()=>{const{auth:t}=RA().props;return{user:(t==null?void 0:t.user)||null,isAuthenticated:!!(t!=null&&t.user),isLoading:!1}},tm={SUPER_ADMIN:"superadmin",ADMIN:"admin",HEI:"hei"},Lee={[tm.SUPER_ADMIN]:"Super Administrator",[tm.ADMIN]:"CHED Administrator",[tm.HEI]:"HEI User"},Fee=()=>{const t=()=>{confirm("Are you sure you want to logout?")&&lt.post("/logout")};return l.jsx("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Logout"})},Vee=({user:t})=>{var i;const[e,r]=$.useState(!1),n=$.useRef(null);return $.useEffect(()=>{const s=o=>{n.current&&!n.current.contains(o.target)&&r(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),l.jsxs("div",{className:"relative",ref:n,children:[l.jsxs("button",{onClick:()=>r(!e),className:"flex items-center gap-3 px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:((i=t.name)==null?void 0:i.charAt(0).toUpperCase())||"U"}),l.jsxs("div",{className:"text-left",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Lee[t.role]||t.role})]}),l.jsx("svg",{className:`w-4 h-4 text-gray-500 dark:text-gray-400 transition-transform ${e?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e&&l.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 z-50",children:[l.jsx(yt,{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Profile Settings"}),l.jsx(yt,{href:"/change-password",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Change Password"}),l.jsx("hr",{className:"my-2 border-gray-200 dark:border-gray-700"}),l.jsx(Fee,{})]})]})},Nw={DRAFT:"draft",SUBMITTED:"submitted",APPROVED:"approved",REJECTED:"rejected"},MR={PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"},Bee={[Nw.DRAFT]:"gray",[Nw.SUBMITTED]:"blue",[Nw.APPROVED]:"green",[Nw.REJECTED]:"red",[MR.PENDING]:"yellow",[MR.APPROVED]:"green",[MR.REJECTED]:"red"},St=window.__ACADEMIC_YEAR_START__||new Date().getFullYear(),A0={LIGHT:"light",DARK:"dark"},RW=$.createContext(),eD={mode:A0.LIGHT,colors:{primary:"#1e40af",secondary:"#64748b",success:"#16a34a",warning:"#f59e0b",danger:"#dc2626",info:"#0891b2"}},Wee=({children:t})=>{const[e,r]=$.useState(()=>{const a=localStorage.getItem("ched_theme");return a?JSON.parse(a):eD});$.useEffect(()=>{localStorage.setItem("ched_theme",JSON.stringify(e)),n(e)},[e]);const n=a=>{const c=document.documentElement;c.classList.remove("light","dark"),c.classList.add(a.mode),Object.entries(a.colors).forEach(([u,d])=>{c.style.setProperty(`--color-${u}`,d)})},i=()=>{r(a=>({...a,mode:a.mode===A0.LIGHT?A0.DARK:A0.LIGHT}))},s=a=>{r(c=>({...c,colors:{...c.colors,...a}}))},o=()=>{r(eD)};return l.jsx(RW.Provider,{value:{theme:e,toggleMode:i,updateColors:s,resetTheme:o,isDark:e.mode===A0.DARK},children:t})},EW=()=>{const t=$.useContext(RW);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t},zee=()=>{const{isDark:t,toggleMode:e}=EW();return l.jsx("button",{onClick:e,className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors","aria-label":"Toggle theme",children:t?l.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):l.jsx("svg",{className:"w-5 h-5 text-gray-700",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})})},Uee=({isOpen:t,onClose:e})=>{const{theme:r,updateColors:n,resetTheme:i}=EW(),[s,o]=$.useState(r.colors);if(!t)return null;const a=(d,f)=>{o(h=>({...h,[d]:f}))},c=()=>{n(s),e()},u=()=>{i(),o(r.colors)};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Theme Editor"}),l.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsx("div",{className:"space-y-4 mb-6",children:Object.entries(s).map(([d,f])=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize",children:d}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{type:"color",value:f,onChange:h=>a(d,h.target.value),className:"w-12 h-10 rounded border border-gray-300 dark:border-gray-600 cursor-pointer"}),l.jsx("input",{type:"text",value:f,onChange:h=>a(d,h.target.value),className:"w-28 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),l.jsx("div",{className:"w-10 h-10 rounded border border-gray-300 dark:border-gray-600",style:{backgroundColor:f}})]})]},d))}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"Reset to Default"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"Cancel"}),l.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-white rounded",style:{backgroundColor:"var(--color-primary)"},children:"Save Changes"})]})]})]})})},Yee=()=>{const{user:t}=_W(),[e,r]=$.useState(!1);return l.jsxs(l.Fragment,{children:[l.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("img",{src:"/images/ched_logo.png",alt:"CHED Logo",className:"h-10 w-10 object-contain"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"CHED HEI SASIS Management System - IX"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Student Affair and Sevices Information System"})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:()=>r(!0),className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"Theme Editor",children:l.jsx("svg",{className:"w-5 h-5 text-gray-700 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),l.jsx(zee,{}),t&&l.jsx(Vee,{user:t})]})]})}),l.jsx(Uee,{isOpen:e,onClose:()=>r(!1)})]})},Gee=()=>{const{flash:t}=RA().props,[e,r]=$.useState([]);$.useEffect(()=>{t!=null&&t.success&&n("success",t.success),t!=null&&t.error&&n("error",t.error),t!=null&&t.info&&n("info",t.info),t!=null&&t.warning&&n("warning",t.warning)},[t]);const n=(s,o)=>{const a=Date.now();r(c=>[...c,{id:a,type:s,message:o}]),setTimeout(()=>{i(a)},5e3)},i=s=>{r(o=>o.filter(a=>a.id!==s))};return{notifications:e,addNotification:n,removeNotification:i}},Kee=({notification:t,onRemove:e})=>{$.useEffect(()=>{const i=setTimeout(()=>{e(t.id)},5e3);return()=>clearTimeout(i)},[t.id,e]);const r={success:"bg-green-500",error:"bg-red-500",warning:"bg-yellow-500",info:"bg-blue-500"},n={success:"",error:"",warning:"!",info:"i"};return l.jsxs("div",{className:`${r[t.type]} text-white p-4 rounded-lg shadow-lg flex items-center justify-between min-w-80`,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-bold text-lg",children:n[t.type]}),l.jsx("span",{children:t.message})]}),l.jsx("button",{onClick:()=>e(t.id),className:"ml-4 hover:bg-white hover:bg-opacity-20 rounded p-1",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})},Tv=({title:t,children:e})=>{const{notifications:r,removeNotification:n}=Gee();return l.jsxs(l.Fragment,{children:[l.jsx(_A,{title:t}),l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[l.jsx(Yee,{}),l.jsx("main",{children:e}),l.jsx("div",{className:"fixed bottom-4 right-4 z-50 space-y-2",children:r.map(i=>l.jsx(Kee,{notification:i,onRemove:n},i.id))})]})]})};var NW={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},tD=Pt.createContext&&Pt.createContext(NW),qee=["attr","size","title"];function Xee(t,e){if(t==null)return{};var r=Qee(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Qee(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function WS(){return WS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WS.apply(this,arguments)}function rD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rD(Object(r),!0).forEach(function(n){Jee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jee(t,e,r){return e=Zee(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zee(t){var e=ete(t,"string");return typeof e=="symbol"?e:e+""}function ete(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kW(t){return t&&t.map((e,r)=>Pt.createElement(e.tag,zS({key:r},e.attr),kW(e.child)))}function jt(t){return e=>Pt.createElement(tte,WS({attr:zS({},t.attr)},e),kW(t.child))}function tte(t){var e=r=>{var{attr:n,size:i,title:s}=t,o=Xee(t,qee),a=i||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),Pt.createElement("svg",WS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:zS(zS({color:t.color||r.color},r.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&Pt.createElement("title",null,s),t.children)};return tD!==void 0?Pt.createElement(tD.Consumer,null,r=>e(r)):e(NW)}function ei(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm80 224h-64v64a16 16 0 0 1-32 0v-64h-64a16 16 0 0 1 0-32h64v-64a16 16 0 0 1 32 0v64h64a16 16 0 0 1 0 32z"},child:[]}]})(t)}function rte(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288m144-144H112"},child:[]}]})(t)}function nte(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M480 496H48a32 32 0 0 1-32-32V32a16 16 0 0 1 32 0v432h432a16 16 0 0 1 0 32z"},child:[]},{tag:"path",attr:{d:"M156 432h-40a36 36 0 0 1-36-36V244a36 36 0 0 1 36-36h40a36 36 0 0 1 36 36v152a36 36 0 0 1-36 36zm144 0h-40a36 36 0 0 1-36-36V196a36 36 0 0 1 36-36h40a36 36 0 0 1 36 36v200a36 36 0 0 1-36 36zm143.64 0h-40a36 36 0 0 1-36-36V132a36 36 0 0 1 36-36h40a36 36 0 0 1 36 36v264a36 36 0 0 1-36 36z"},child:[]}]})(t)}function TW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M202.24 74C166.11 56.75 115.61 48.3 48 48a31.36 31.36 0 0 0-17.92 5.33A32 32 0 0 0 16 79.9V366c0 19.34 13.76 33.93 32 33.93 71.07 0 142.36 6.64 185.06 47a4.11 4.11 0 0 0 6.94-3V106.82a15.89 15.89 0 0 0-5.46-12A143 143 0 0 0 202.24 74zm279.68-20.7A31.33 31.33 0 0 0 464 48c-67.61.3-118.11 8.71-154.24 26a143.31 143.31 0 0 0-32.31 20.78 15.93 15.93 0 0 0-5.45 12v337.13a3.93 3.93 0 0 0 6.68 2.81c25.67-25.5 70.72-46.82 185.36-46.81a32 32 0 0 0 32-32v-288a32 32 0 0 0-14.12-26.61z"},child:[]}]})(t)}function PW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 80a48.05 48.05 0 0 0-48-48H144a48.05 48.05 0 0 0-48 48v352a48.05 48.05 0 0 0 48 48h224a48.05 48.05 0 0 0 48-48zM168 432a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm0-80a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm0-80a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm88 160a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm0-80a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm0-80a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm112 136a24 24 0 0 1-48 0v-80a24 24 0 0 1 48 0zm-24-136a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm19.31-100.69A16 16 0 0 1 352 176H160a16 16 0 0 1-16-16V96a16 16 0 0 1 16-16h192a16 16 0 0 1 16 16v64a16 16 0 0 1-4.69 11.31z"},child:[]}]})(t)}function MW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M391 480c-19.52 0-46.94-7.06-88-30-49.93-28-88.55-53.85-138.21-103.38C116.91 298.77 93.61 267.79 61 208.45c-36.84-67-30.56-102.12-23.54-117.13C45.82 73.38 58.16 62.65 74.11 52a176.3 176.3 0 0 1 28.64-15.2c1-.43 1.93-.84 2.76-1.21 4.95-2.23 12.45-5.6 21.95-2 6.34 2.38 12 7.25 20.86 16 18.17 17.92 43 57.83 52.16 77.43 6.15 13.21 10.22 21.93 10.23 31.71 0 11.45-5.76 20.28-12.75 29.81-1.31 1.79-2.61 3.5-3.87 5.16-7.61 10-9.28 12.89-8.18 18.05 2.23 10.37 18.86 41.24 46.19 68.51s57.31 42.85 67.72 45.07c5.38 1.15 8.33-.59 18.65-8.47 1.48-1.13 3-2.3 4.59-3.47 10.66-7.93 19.08-13.54 30.26-13.54h.06c9.73 0 18.06 4.22 31.86 11.18 18 9.08 59.11 33.59 77.14 51.78 8.77 8.84 13.66 14.48 16.05 20.81 3.6 9.53.21 17-2 22-.37.83-.78 1.74-1.21 2.75a176.49 176.49 0 0 1-15.29 28.58c-10.63 15.9-21.4 28.21-39.38 36.58A67.42 67.42 0 0 1 391 480z"},child:[]}]})(t)}function rr(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm108.25 138.29-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32 122.59-145.91a16 16 0 0 1 24.5 20.58z"},child:[]}]})(t)}function ri(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"m112 184 144 144 144-144"},child:[]}]})(t)}function ni(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"m184 112 144 144-144 144"},child:[]}]})(t)}function ite(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm75.31 260.69a16 16 0 1 1-22.62 22.62L256 278.63l-52.69 52.68a16 16 0 0 1-22.62-22.62L233.37 256l-52.68-52.69a16 16 0 0 1 22.62-22.62L256 233.37l52.69-52.68a16 16 0 0 1 22.62 22.62L278.63 256z"},child:[]}]})(t)}function AW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(t)}function ai(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.94 53.25a16.06 16.06 0 0 0-23.22-.56L424.35 65a8 8 0 0 0 0 11.31l11.34 11.32a8 8 0 0 0 11.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90 218.82 270.2a9 9 0 0 0-2.31 3.93L208.16 299a3.91 3.91 0 0 0 4.86 4.86l24.85-8.35a9 9 0 0 0 3.93-2.31L422 112.66a9 9 0 0 0 0-12.66l-9.95-10a9 9 0 0 0-12.71 0z"},child:[]},{tag:"path",attr:{d:"M386.34 193.66 264.45 315.79A41.08 41.08 0 0 1 247.58 326l-25.9 8.67a35.92 35.92 0 0 1-44.33-44.33l8.67-25.9a41.08 41.08 0 0 1 10.19-16.87l122.13-121.91a8 8 0 0 0-5.65-13.66H104a56 56 0 0 0-56 56v240a56 56 0 0 0 56 56h240a56 56 0 0 0 56-56V199.31a8 8 0 0 0-13.66-5.65z"},child:[]}]})(t)}function ba(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M428 224H288a48 48 0 0 1-48-48V36a4 4 0 0 0-4-4h-92a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h224a64 64 0 0 0 64-64V228a4 4 0 0 0-4-4zm-92 160H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32zm0-80H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32z"},child:[]},{tag:"path",attr:{d:"M419.22 188.59 275.41 44.78a2 2 0 0 0-3.41 1.41V176a16 16 0 0 0 16 16h129.81a2 2 0 0 0 1.41-3.41z"},child:[]}]})(t)}function pt(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M428 224H288a48 48 0 0 1-48-48V36a4 4 0 0 0-4-4h-92a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h224a64 64 0 0 0 64-64V228a4 4 0 0 0-4-4z"},child:[]},{tag:"path",attr:{d:"M419.22 188.59 275.41 44.78a2 2 0 0 0-3.41 1.41V176a16 16 0 0 0 16 16h129.81a2 2 0 0 0 1.41-3.41z"},child:[]}]})(t)}function Ay(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448zM248 315.85l-51.79-51.79a2 2 0 0 0-3.39 1.69 64.11 64.11 0 0 0 53.49 53.49 2 2 0 0 0 1.69-3.39zm16-119.7L315.87 248a2 2 0 0 0 3.4-1.69 64.13 64.13 0 0 0-53.55-53.55 2 2 0 0 0-1.72 3.39z"},child:[]},{tag:"path",attr:{d:"M491 273.36a32.2 32.2 0 0 0-.1-34.76c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.68 96a226.54 226.54 0 0 0-71.82 11.79 4 4 0 0 0-1.56 6.63l47.24 47.24a4 4 0 0 0 3.82 1.05 96 96 0 0 1 116 116 4 4 0 0 0 1.05 3.81l67.95 68a4 4 0 0 0 5.4.24 343.81 343.81 0 0 0 67.24-77.4zM256 352a96 96 0 0 1-93.3-118.63 4 4 0 0 0-1.05-3.81l-66.84-66.87a4 4 0 0 0-5.41-.23c-24.39 20.81-47 46.13-67.67 75.72a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.39 76.14 98.28 100.65C162.06 402 207.92 416 255.68 416a238.22 238.22 0 0 0 72.64-11.55 4 4 0 0 0 1.61-6.64l-47.47-47.46a4 4 0 0 0-3.81-1.05A96 96 0 0 1 256 352z"},child:[]}]})(t)}function Sm(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"256",r:"64"},child:[]},{tag:"path",attr:{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96c-42.52 0-84.33 12.15-124.27 36.11-40.73 24.43-77.63 60.12-109.68 106.07a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416c46.71 0 93.81-14.43 136.2-41.72 38.46-24.77 72.72-59.66 99.08-100.92a32.2 32.2 0 0 0-.1-34.76zM256 352a96 96 0 1 1 96-96 96.11 96.11 0 0 1-96 96z"},child:[]}]})(t)}function OW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M430 190c0-95.94-78.06-174-174-174S82 94.06 82 190c0 88.49 66.4 161.77 152 172.61V394h-36a22 22 0 0 0 0 44h36v36a22 22 0 0 0 44 0v-36h36a22 22 0 0 0 0-44h-36v-31.39c85.6-10.84 152-84.12 152-172.61zm-304 0c0-71.68 58.32-130 130-130s130 58.32 130 130-58.32 130-130 130-130-58.32-130-130z"},child:[]}]})(t)}function IW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M340.75 344.49c5.91-20.7 9.82-44.75 11.31-67.84a4.41 4.41 0 0 0-4.46-4.65h-71.06a4.43 4.43 0 0 0-4.47 4.39v55.3a4.44 4.44 0 0 0 4.14 4.38 273.51 273.51 0 0 1 59 11.39 4.45 4.45 0 0 0 5.54-2.97zm-17.17 32.82a260.05 260.05 0 0 0-46.6-9.09 4.42 4.42 0 0 0-4.91 4.29v65.24a4.47 4.47 0 0 0 6.76 3.7c15.9-9.27 29-24.84 40.84-45.43 1.94-3.36 4.89-9.15 6.67-12.69a4.29 4.29 0 0 0-2.76-6.02zm-88.29-8.91a256.85 256.85 0 0 0-46.56 8.82c-2.64.76-3.75 4.4-2.55 6.79 1.79 3.56 4 8.11 5.89 11.51 13 23 26.84 37.5 41.24 45.93a4.47 4.47 0 0 0 6.76-3.7v-65.27a4.16 4.16 0 0 0-4.78-4.08zm.31-96.4h-71.06a4.41 4.41 0 0 0-4.46 4.64c1.48 23.06 5.37 47.16 11.26 67.84a4.46 4.46 0 0 0 5.59 3 272.2 272.2 0 0 1 59-11.36 4.44 4.44 0 0 0 4.15-4.38V276.4a4.43 4.43 0 0 0-4.48-4.4zM277 143.78a235.8 235.8 0 0 0 46.5-9.14 4.3 4.3 0 0 0 2.76-6c-1.79-3.57-4.27-8.68-6.17-12.09-12.29-22-26.14-37.35-41.24-46a4.48 4.48 0 0 0-6.76 3.7v65.23a4.43 4.43 0 0 0 4.91 4.3zm-.46 96.22h71.06a4.39 4.39 0 0 0 4.46-4.58c-1.48-22.77-5.27-47.8-11.16-68.22a4.46 4.46 0 0 0-5.59-2.95c-19 5.74-38.79 10.43-59.09 12a4.4 4.4 0 0 0-4.15 4.32v55.11a4.4 4.4 0 0 0 4.47 4.32zM233.31 70.56c-15.42 8.57-29.17 24.43-41.47 46.37-1.91 3.41-4.19 8.11-6 11.67a4.31 4.31 0 0 0 2.76 6 225.42 225.42 0 0 0 46.54 9.17 4.43 4.43 0 0 0 4.91-4.29V74.26a4.49 4.49 0 0 0-6.74-3.7zm2.61 105.7c-20.3-1.55-40.11-6.24-59.09-12a4.46 4.46 0 0 0-5.59 2.95c-5.89 20.42-9.68 45.45-11.16 68.22a4.39 4.39 0 0 0 4.46 4.58h71.06a4.4 4.4 0 0 0 4.47-4.34v-55.09a4.4 4.4 0 0 0-4.15-4.32z"},child:[]},{tag:"path",attr:{d:"M414.39 97.61A224 224 0 1 0 97.61 414.39 224 224 0 1 0 414.39 97.61zM176.6 430.85a219.08 219.08 0 0 1-12.48-19.66c-2-3.69-4.84-9.26-6.73-13.13a7.29 7.29 0 0 0-10.31-3.16c-4.3 2.41-10 5.72-14.13 8.43a147.29 147.29 0 0 1-23.57-22.43 248.83 248.83 0 0 1 30.41-18.36c1.86-1 2.77-2.14 2.18-4.18a374.8 374.8 0 0 1-14.09-82.17 4.36 4.36 0 0 0-4.3-4.17H66.84a2 2 0 0 1-2-1.7A98.28 98.28 0 0 1 64 256a96.27 96.27 0 0 1 .86-14.29 2 2 0 0 1 2-1.7h56.74c2.29 0 4.17-1.32 4.29-3.63a372.71 372.71 0 0 1 14-81.83 4.36 4.36 0 0 0-2.19-5.11 260.63 260.63 0 0 1-29.84-17.9 169.82 169.82 0 0 1 23.14-22.8c4.08 2.68 9.4 5.71 13.66 8.11a7.89 7.89 0 0 0 11-3.42c1.88-3.87 4-8.18 6.06-11.88a221.93 221.93 0 0 1 12.54-19.91A185 185 0 0 1 256 64c28.94 0 55.9 7 80.53 18.46a202.23 202.23 0 0 1 12 19c2.59 4.66 5.34 10.37 7.66 15.32a4.29 4.29 0 0 0 5.92 1.94c5.38-2.91 11.21-6.26 16.34-9.63a171.36 171.36 0 0 1 23.2 23 244.89 244.89 0 0 1-29.06 17.31 4.35 4.35 0 0 0-2.18 5.12 348.68 348.68 0 0 1 13.85 81.4 4.33 4.33 0 0 0 4.3 4.12l56.62-.07a2 2 0 0 1 2 1.7 117.46 117.46 0 0 1 0 28.62 2 2 0 0 1-2 1.72h-56.67a4.35 4.35 0 0 0-4.3 4.17 367.4 367.4 0 0 1-13.87 81.3 4.45 4.45 0 0 0 2.19 5.19c5 2.59 10.57 5.48 15.37 8.42s9.55 6.08 14.13 9.34a172.73 172.73 0 0 1-23 22.93c-2.44-1.61-5.34-3.44-7.84-4.94-1.72-1-4.89-2.77-6.65-3.76-3.82-2.14-7.88-.54-9.79 3.4s-4.83 9.59-6.87 13.25a212.42 212.42 0 0 1-12.35 19.53C310.91 442.37 284.94 448 256 448s-54.77-5.63-79.4-17.15z"},child:[]}]})(t)}function EA(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M204 240H68a36 36 0 0 1-36-36V68a36 36 0 0 1 36-36h136a36 36 0 0 1 36 36v136a36 36 0 0 1-36 36zm240 0H308a36 36 0 0 1-36-36V68a36 36 0 0 1 36-36h136a36 36 0 0 1 36 36v136a36 36 0 0 1-36 36zM204 480H68a36 36 0 0 1-36-36V308a36 36 0 0 1 36-36h136a36 36 0 0 1 36 36v136a36 36 0 0 1-36 36zm240 0H308a36 36 0 0 1-36-36V308a36 36 0 0 1 36-36h136a36 36 0 0 1 36 36v136a36 36 0 0 1-36 36z"},child:[]}]})(t)}function jW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 56C145.72 56 56 145.72 56 256s89.72 200 200 200 200-89.72 200-200S366.28 56 256 56zm0 82a26 26 0 1 1-26 26 26 26 0 0 1 26-26zm48 226h-88a16 16 0 0 1 0-32h28v-88h-16a16 16 0 0 1 0-32h32a16 16 0 0 1 16 16v104h28a16 16 0 0 1 0 32z"},child:[]}]})(t)}function ste(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M424 80H88a56.06 56.06 0 0 0-56 56v240a56.06 56.06 0 0 0 56 56h336a56.06 56.06 0 0 0 56-56V136a56.06 56.06 0 0 0-56-56zm-14.18 92.63-144 112a16 16 0 0 1-19.64 0l-144-112a16 16 0 1 1 19.64-25.26L256 251.73l134.18-104.36a16 16 0 0 1 19.64 25.26z"},child:[]}]})(t)}function HW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M426 16h-74a22 22 0 0 0 0 44h20.89l-37.1 37.09A157.68 157.68 0 0 0 216 42c-87.12 0-158 70.88-158 158 0 79.66 59.26 145.72 136 156.46V394h-28a22 22 0 0 0 0 44h28v36a22 22 0 0 0 44 0v-36h28a22 22 0 0 0 0-44h-28v-37.54c76.74-10.74 136-76.8 136-156.46a157.15 157.15 0 0 0-14-64.92l44-44V112a22 22 0 0 0 44 0V38a22 22 0 0 0-22-22zM216 314a114 114 0 1 1 114-114 114.13 114.13 0 0 1-114 114z"},child:[]}]})(t)}function $W(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M442 48h-90a22 22 0 0 0 0 44h36.89l-60.39 60.39c-68.19-52.86-167-48-229.54 14.57C31.12 234.81 31.12 345.19 99 413a174.21 174.21 0 0 0 246 0c62.57-62.58 67.43-161.35 14.57-229.54L420 123.11V160a22 22 0 0 0 44 0V70a22 22 0 0 0-22-22zM313.92 381.92a130.13 130.13 0 0 1-183.84 0c-50.69-50.68-50.69-133.16 0-183.84s133.16-50.69 183.84 0 50.69 133.16 0 183.84z"},child:[]}]})(t)}function DW(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"44",d:"M358.62 129.28 86.49 402.08 70 442l39.92-16.49 272.8-272.13-24.1-24.1zm54.45-54.44-11.79 11.78 24.1 24.1 11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z"},child:[]}]})(t)}function F1(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M336 256c-20.56 0-40.44-9.18-56-25.84-15.13-16.25-24.37-37.92-26-61-1.74-24.62 5.77-47.26 21.14-63.76S312 80 336 80c23.83 0 45.38 9.06 60.7 25.52 15.47 16.62 23 39.22 21.26 63.63-1.67 23.11-10.9 44.77-26 61C376.44 246.82 356.57 256 336 256zm66-88zm65.83 264H204.18a27.71 27.71 0 0 1-22-10.67 30.22 30.22 0 0 1-5.26-25.79c8.42-33.81 29.28-61.85 60.32-81.08C264.79 297.4 299.86 288 336 288c36.85 0 71 9 98.71 26.05 31.11 19.13 52 47.33 60.38 81.55a30.27 30.27 0 0 1-5.32 25.78A27.68 27.68 0 0 1 467.83 432zM147 260c-35.19 0-66.13-32.72-69-72.93-1.42-20.6 5-39.65 18-53.62 12.86-13.83 31-21.45 51-21.45s38 7.66 50.93 21.57c13.1 14.08 19.5 33.09 18 53.52-2.87 40.2-33.8 72.91-68.93 72.91zm65.66 31.45c-17.59-8.6-40.42-12.9-65.65-12.9-29.46 0-58.07 7.68-80.57 21.62-25.51 15.83-42.67 38.88-49.6 66.71a27.39 27.39 0 0 0 4.79 23.36A25.32 25.32 0 0 0 41.72 400h111a8 8 0 0 0 7.87-6.57c.11-.63.25-1.26.41-1.88 8.48-34.06 28.35-62.84 57.71-83.82a8 8 0 0 0-.63-13.39c-1.57-.92-3.37-1.89-5.42-2.89z"},child:[]}]})(t)}function zi(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m465.94 119.76-73.7-73.7A47.68 47.68 0 0 0 358.3 32H96a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h320a64 64 0 0 0 64-64V153.7a47.68 47.68 0 0 0-14.06-33.94zM120 112h176a8 8 0 0 1 8 8v48a8 8 0 0 1-8 8H120a8 8 0 0 1-8-8v-48a8 8 0 0 1 8-8zm139.75 319.91a80 80 0 1 1 76.16-76.16 80.06 80.06 0 0 1-76.16 76.16z"},child:[]},{tag:"circle",attr:{cx:"256",cy:"352",r:"48"},child:[]}]})(t)}function NA(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 368a16 16 0 0 1-7.94-2.11L108 285.84a8 8 0 0 0-12 6.94V368a16 16 0 0 0 8.23 14l144 80a16 16 0 0 0 15.54 0l144-80a16 16 0 0 0 8.23-14v-75.22a8 8 0 0 0-12-6.94l-140.06 80.05A16 16 0 0 1 256 368z"},child:[]},{tag:"path",attr:{d:"M495.92 190.5v-.11a16 16 0 0 0-8-12.28l-224-128a16 16 0 0 0-15.88 0l-224 128a16 16 0 0 0 0 27.78l224 128a16 16 0 0 0 15.88 0L461 221.28a2 2 0 0 1 3 1.74v144.53c0 8.61 6.62 16 15.23 16.43A16 16 0 0 0 496 368V192a14.76 14.76 0 0 0-.08-1.5z"},child:[]}]})(t)}function ote(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"256",r:"48"},child:[]},{tag:"path",attr:{d:"m470.39 300-.47-.38-31.56-24.75a16.11 16.11 0 0 1-6.1-13.33v-11.56a16 16 0 0 1 6.11-13.22L469.92 212l.47-.38a26.68 26.68 0 0 0 5.9-34.06l-42.71-73.9a1.59 1.59 0 0 1-.13-.22A26.86 26.86 0 0 0 401 92.14l-.35.13-37.1 14.93a15.94 15.94 0 0 1-14.47-1.29q-4.92-3.1-10-5.86a15.94 15.94 0 0 1-8.19-11.82l-5.59-39.59-.12-.72A27.22 27.22 0 0 0 298.76 26h-85.52a26.92 26.92 0 0 0-26.45 22.39l-.09.56-5.57 39.67a16 16 0 0 1-8.13 11.82 175.21 175.21 0 0 0-10 5.82 15.92 15.92 0 0 1-14.43 1.27l-37.13-15-.35-.14a26.87 26.87 0 0 0-32.48 11.34l-.13.22-42.77 73.95a26.71 26.71 0 0 0 5.9 34.1l.47.38 31.56 24.75a16.11 16.11 0 0 1 6.1 13.33v11.56a16 16 0 0 1-6.11 13.22L42.08 300l-.47.38a26.68 26.68 0 0 0-5.9 34.06l42.71 73.9a1.59 1.59 0 0 1 .13.22 26.86 26.86 0 0 0 32.45 11.3l.35-.13 37.07-14.93a15.94 15.94 0 0 1 14.47 1.29q4.92 3.11 10 5.86a15.94 15.94 0 0 1 8.19 11.82l5.56 39.59.12.72A27.22 27.22 0 0 0 213.24 486h85.52a26.92 26.92 0 0 0 26.45-22.39l.09-.56 5.57-39.67a16 16 0 0 1 8.18-11.82c3.42-1.84 6.76-3.79 10-5.82a15.92 15.92 0 0 1 14.43-1.27l37.13 14.95.35.14a26.85 26.85 0 0 0 32.48-11.34 2.53 2.53 0 0 1 .13-.22l42.71-73.89a26.7 26.7 0 0 0-5.89-34.11zm-134.48-40.24a80 80 0 1 1-83.66-83.67 80.21 80.21 0 0 1 83.66 83.67z"},child:[]}]})(t)}function Ln(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm96 240h-96a16 16 0 0 1-16-16V128a16 16 0 0 1 32 0v128h80a16 16 0 0 1 0 32z"},child:[]}]})(t)}function Cm(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",d:"M296 64h-80a7.91 7.91 0 0 0-8 8v24h96V72a7.91 7.91 0 0 0-8-8z"},child:[]},{tag:"path",attr:{d:"M432 96h-96V72a40 40 0 0 0-40-40h-80a40 40 0 0 0-40 40v24H80a16 16 0 0 0 0 32h17l19 304.92c1.42 26.85 22 47.08 48 47.08h184c26.13 0 46.3-19.78 48-47l19-305h17a16 16 0 0 0 0-32zM192.57 416H192a16 16 0 0 1-16-15.43l-8-224a16 16 0 1 1 32-1.14l8 224A16 16 0 0 1 192.57 416zM272 400a16 16 0 0 1-32 0V176a16 16 0 0 1 32 0zm32-304h-96V72a7.91 7.91 0 0 1 8-8h80a7.91 7.91 0 0 1 8 8zm32 304.57A16 16 0 0 1 320 416h-.58A16 16 0 0 1 304 399.43l8-224a16 16 0 1 1 32 1.14z"},child:[]}]})(t)}function ate(t){return jt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M449.07 399.08 278.64 82.58c-12.08-22.44-44.26-22.44-56.35 0L51.87 399.08A32 32 0 0 0 80 446.25h340.89a32 32 0 0 0 28.18-47.17zm-198.6-1.83a20 20 0 1 1 20-20 20 20 0 0 1-20 20zm21.72-201.15-5.74 122a16 16 0 0 1-32 0l-5.74-121.95a21.73 21.73 0 0 1 21.5-22.69h.21a21.74 21.74 0 0 1 21.73 22.7z"},child:[]}]})(t)}const kA=({links:t})=>{const{url:e}=RA(),[r,n]=$.useState({}),i=a=>e===a||e.startsWith(a+"/"),s=a=>a.some(c=>c.href?i(c.href):c.children?s(c.children):!1),o=a=>{n(c=>({...c,[a]:!c[a]}))};return l.jsx("aside",{className:"w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 min-h-screen",children:l.jsx("nav",{className:"p-4 space-y-2",children:t.map(a=>{if(a.divider)return l.jsxs("div",{className:"pt-4 first:pt-0 pb-3",children:[l.jsx("div",{className:"px-4 pb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a.label}),l.jsx("div",{className:"space-y-1 ml-2 pl-3 border-l-2 border-gray-200 dark:border-gray-700",children:a.children.map(c=>{if(c.children){const u=r[c.label]??s(c.children),d=s(c.children);return l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>o(c.label),className:`flex items-center gap-3 px-4 py-2 rounded-lg transition-colors w-full ${d?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[c.icon&&l.jsx("span",{className:"text-lg",children:(typeof c.icon=="string",c.icon)}),l.jsx("span",{className:"flex-1 text-left",children:c.label}),u?l.jsx(ri,{className:"text-sm"}):l.jsx(ni,{className:"text-sm"})]}),u&&l.jsx("div",{className:"ml-4 mt-1 space-y-1",children:c.children.map(f=>l.jsxs(yt,{href:f.href,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition-colors text-sm ${i(f.href)?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[f.icon&&l.jsx("span",{className:"text-base",children:(typeof f.icon=="string",f.icon)}),l.jsx("span",{children:f.label})]},f.href))})]},c.label)}return l.jsxs(yt,{href:c.href,className:`flex items-center gap-3 px-4 py-2 rounded-lg transition-colors ${i(c.href)?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[c.icon&&l.jsx("span",{className:"text-lg",children:(typeof c.icon=="string",c.icon)}),l.jsx("span",{children:c.label}),c.badge&&l.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:c.badge})]},c.href)})})]},a.label);if(a.children){const c=r[a.label]??s(a.children),u=s(a.children);return l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>o(a.label),className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors w-full ${u?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[a.icon&&l.jsx("span",{className:"text-xl",children:(typeof a.icon=="string",a.icon)}),l.jsx("span",{className:"flex-1 text-left",children:a.label}),c?l.jsx(ri,{className:"text-lg"}):l.jsx(ni,{className:"text-lg"})]}),c&&l.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.children.map(d=>l.jsxs(yt,{href:d.href,className:`flex items-center gap-3 px-4 py-2 rounded-lg transition-colors ${i(d.href)?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[d.icon&&l.jsx("span",{className:"text-lg",children:(typeof d.icon=="string",d.icon)}),l.jsx("span",{children:d.label}),d.badge&&l.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:d.badge})]},d.href))})]},a.label)}return l.jsxs(yt,{href:a.href,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${i(a.href)?"bg-blue-50 dark:bg-blue-900 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[a.icon&&l.jsx("span",{className:"text-xl",children:(typeof a.icon=="string",a.icon)}),l.jsx("span",{children:a.label}),a.badge&&l.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:a.badge})]},a.href)})})})},fn={MANAGE_ADMINS:"manage_admins",VIEW_SYSTEM_AUDIT:"view_system_audit",MANAGE_SYSTEM_SETTINGS:"manage_system_settings",MANAGE_HEI_ACCOUNTS:"manage_hei_accounts",REVIEW_SUBMISSIONS:"review_submissions",APPROVE_OVERWRITES:"approve_overwrites",VIEW_AUDIT_LOGS:"view_audit_logs",EXPORT_DATA:"export_data",CREATE_SUBMISSION:"create_submission",VIEW_OWN_SUBMISSIONS:"view_own_submissions",REQUEST_OVERWRITE:"request_overwrite",VIEW_NOTIFICATIONS:"view_notifications"},lte={[tm.SUPER_ADMIN]:[fn.MANAGE_ADMINS,fn.VIEW_SYSTEM_AUDIT,fn.MANAGE_SYSTEM_SETTINGS,fn.MANAGE_HEI_ACCOUNTS,fn.REVIEW_SUBMISSIONS,fn.APPROVE_OVERWRITES,fn.VIEW_AUDIT_LOGS,fn.EXPORT_DATA],[tm.ADMIN]:[fn.MANAGE_HEI_ACCOUNTS,fn.REVIEW_SUBMISSIONS,fn.APPROVE_OVERWRITES,fn.VIEW_AUDIT_LOGS,fn.EXPORT_DATA],[tm.HEI]:[fn.CREATE_SUBMISSION,fn.VIEW_OWN_SUBMISSIONS,fn.REQUEST_OVERWRITE,fn.VIEW_NOTIFICATIONS]},nD=(t,e)=>!t||!t.role?!1:(lte[t.role]||[]).includes(e),cte=()=>{const{user:t}=_W();return{hasPermission:e=>nD(t,e),checkPermissions:e=>e.every(r=>nD(t,r))}},TA=({permission:t,permissions:e,children:r,fallback:n=null})=>{const{hasPermission:i,checkPermissions:s}=cte();return t&&!i(t)||e&&!s(e)?n:l.jsx(l.Fragment,{children:r})},Tl=({title:t,children:e,pendingCount:r=0})=>{const n=[{href:"/admin/dashboard",label:"Dashboard",icon:l.jsx(EA,{})},{href:"/admin/hei-accounts",label:"HEI Accounts",icon:l.jsx(NA,{})},{label:"Submissions",divider:!0,children:[{href:"/admin/submissions",label:"All Submissions",icon:l.jsx(ba,{})},{href:"/admin/submissions/requests",label:"Pending Requests",icon:l.jsx(ba,{}),badge:r>0?r:null}]},{href:"/admin/audit-logs",label:"Audit Logs",icon:l.jsx(pt,{})},{href:"/admin/ched-contacts",label:"CHED Contacts",icon:l.jsx(MW,{})}];return l.jsx(TA,{permission:fn.MANAGE_HEI_ACCOUNTS,children:l.jsx(Tv,{title:t,children:l.jsxs("div",{className:"flex",children:[l.jsx(kA,{links:n}),l.jsx("div",{className:"flex-1 p-6",children:e})]})})})},PA=({columns:t,data:e,onRowClick:r=null,emptyMessage:n="No data available"})=>l.jsx("div",{className:"overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:l.jsx("tr",{children:t.map((i,s)=>l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i.header},s))})}),l.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:e.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:t.length,className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:n})}):e.map((i,s)=>l.jsx("tr",{onClick:()=>r&&r(i),className:r?"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700":"",children:t.map((o,a)=>l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:o.render?o.render(i):i[o.accessor]},a))},s))})]})}),MA=({status:t,label:e=null})=>{const r={gray:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300",blue:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300",green:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300",red:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300",yellow:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300",purple:"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-300"},n=Bee[t]||"gray",i=e||t;return l.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${r[n]}`,children:i})},an=t=>t?new Date(t).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",LW=async(t,e="export.xlsx")=>{var r;try{const n=await fetch(t,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content")}});if(!n.ok)throw new Error("Export failed");const i=await n.blob(),s=window.URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(s)}catch(n){throw console.error("Export error:",n),n}},ute=({logs:t})=>{const e=[{header:"Action",render:n=>l.jsx(MA,{status:n.action,label:n.action})},{header:"User",accessor:"user.name"},{header:"Model",accessor:"model"},{header:"Reason",render:n=>n.reason||"N/A"},{header:"Timestamp",render:n=>an(n.created_at)}],r=()=>{LW("/admin/audit-logs/export","audit-logs.xlsx")};return l.jsx(Tl,{title:"Audit Logs",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Audit Logs"}),l.jsx("button",{onClick:r,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Export to Excel"})]}),l.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4",children:l.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Audit logs are immutable and can only be modified via direct database access."})}),l.jsx(PA,{columns:e,data:(t==null?void 0:t.data)||[],emptyMessage:"No audit logs found"})]})})},dte=Object.freeze(Object.defineProperty({__proto__:null,default:ute},Symbol.toStringTag,{value:"Module"})),hte=()=>{const t=[{name:"Central Office",address:"Higher Education Development Center Building, C.P. Garcia Ave., U.P. Campus, Diliman, Quezon City",phone:"(02) 8441-1143",email:"ched@ched.gov.ph"}];return l.jsx(Tl,{title:"CHED Contacts",children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"CHED Contact Information"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map((e,r)=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:e.name}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Address"}),l.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:e.address})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Phone"}),l.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:e.phone})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Email"}),l.jsx("p",{className:"mt-1 text-blue-600 dark:text-blue-400",children:e.email})]})]})]},r))})]})})},fte=Object.freeze(Object.defineProperty({__proto__:null,default:hte},Symbol.toStringTag,{value:"Module"})),ma=({title:t,value:e,icon:r,color:n="blue",trend:i=null})=>{const s={blue:"bg-blue-500",green:"bg-green-500",red:"bg-red-500",yellow:"bg-yellow-500",purple:"bg-purple-500",indigo:"bg-indigo-500"};return l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t}),l.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900 dark:text-white",children:e}),i&&l.jsx("p",{className:`mt-2 text-sm ${i.positive?"text-green-600":"text-red-600"}`,children:i.value})]}),r&&l.jsx("div",{className:`p-3 rounded-full ${s[n]||s.blue}`,children:l.jsx("span",{className:"text-white text-2xl",children:r})})]})})},Et=({type:t="info",title:e,message:r,children:n})=>{const i={info:"bg-blue-50 dark:bg-blue-900 border-blue-200 dark:border-blue-700 text-blue-800 dark:text-blue-200",success:"bg-green-50 dark:bg-green-900 border-green-200 dark:border-green-700 text-green-800 dark:text-green-200",warning:"bg-yellow-50 dark:bg-yellow-900 border-yellow-200 dark:border-yellow-700 text-yellow-800 dark:text-yellow-200",error:"bg-red-50 dark:bg-red-900 border-red-200 dark:border-red-700 text-red-800 dark:text-red-200"},s={info:l.jsx(jW,{}),success:l.jsx(rr,{}),warning:l.jsx(ate,{}),error:l.jsx(ite,{})};return l.jsx("div",{className:`border rounded-lg p-4 ${i[t]}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-xl",children:s[t]}),l.jsxs("div",{className:"flex-1",children:[e&&l.jsx("h4",{className:"font-semibold mb-1",children:e}),r&&l.jsx("p",{className:"text-sm",children:r}),n]})]})})},gte=({stats:t,pendingOverwrites:e})=>l.jsx(Tl,{title:"Admin Dashboard",pendingCount:(t==null?void 0:t.pending_overwrites)||0,children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Admin Dashboard"}),(t==null?void 0:t.pending_overwrites)>0&&l.jsx(Et,{type:"warning",title:"Pending Overwrites",message:`You have ${t.pending_overwrites} pending overwrite request(s) that require review.`}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx(ma,{title:"Total HEIs",value:(t==null?void 0:t.total_heis)||0,icon:l.jsx(NA,{}),color:"blue"}),l.jsx(ma,{title:"Active Submissions",value:(t==null?void 0:t.active_submissions)||0,icon:l.jsx(ba,{}),color:"green"}),l.jsx(ma,{title:"Pending Overwrites",value:(t==null?void 0:t.pending_overwrites)||0,icon:l.jsx(Ln,{}),color:"yellow"}),l.jsx(ma,{title:"Total for Current Year",value:(t==null?void 0:t.current_year_total)||0,icon:l.jsx(nte,{}),color:"purple"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("a",{href:"/admin/hei-accounts/create",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Create HEI Account"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add a new HEI to the system"})]}),l.jsxs("a",{href:"/admin/submissions",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Review Submissions"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"View and approve submissions"})]}),l.jsxs("a",{href:"/admin/audit-logs",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"View Audit Logs"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Track all system changes"})]})]})]})]})}),mte=Object.freeze(Object.defineProperty({__proto__:null,default:gte},Symbol.toStringTag,{value:"Module"})),pte=({heis:t=[]})=>{const[e,r]=$.useState(!1),[n,i]=$.useState(!1),[s,o]=$.useState(null),[a,c]=$.useState(null),[u,d]=$.useState(!1),[f,h]=$.useState(!1),[m,g]=$.useState([]),[p,y]=$.useState(!1),[w,v]=$.useState(null),[x,S]=$.useState(!1),[N,R]=$.useState(!1),{data:E,setData:P,post:D,put:H,delete:Z,processing:I,errors:Y,reset:re}=Oo({uii:"",name:"",type:"",code:"",email:"",address:"",password:"",password_confirmation:"",is_active:!0}),ne=async se=>{if(se.length<3){g([]),S(!1),R(!1);return}y(!0),S(!0),R(!1);try{const te=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(se)}&limit=5&countrycodes=ph`,{headers:{Accept:"application/json"}})).json();g(te),R(!0)}catch(me){console.error("Error searching address:",me),g([]),R(!0)}finally{y(!1)}},ae=se=>{const me=se.target.value;P("address",me),w&&clearTimeout(w);const te=setTimeout(()=>{ne(me)},500);v(te)},ue=se=>{P("address",se.display_name),g([]),S(!1)},Q=se=>{se.preventDefault(),n&&s?H(`/admin/heis/${s.uii}`,{onSuccess:()=>{r(!1),i(!1),o(null),re()}}):D("/admin/heis",{onSuccess:()=>{r(!1),re()}})},fe=se=>{o(se),i(!0),P({uii:se.uii,name:se.name,type:se.type,code:se.code,email:se.email,address:se.address||"",password:"",password_confirmation:"",is_active:se.is_active}),r(!0)},ye=se=>{Z(`/admin/heis/${se}`,{onSuccess:()=>{c(null)}})},de=()=>{i(!1),o(null),re(),r(!0)};return l.jsx(Tl,{title:"HEI Accounts",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"HEI Account Management"}),l.jsx("button",{onClick:de,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add New HEI"})]}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700",children:l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"UII"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Name of HEI"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Type"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Code"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Email"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Status"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Actions"})]})}),l.jsx("tbody",{children:t.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:"7",className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No HEI accounts found"})}):t.map(se=>l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:se.uii}),l.jsx("td",{className:"py-3 px-4 text-gray-900 dark:text-white",children:se.name}),l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:se.type}),l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:se.code}),l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:se.email}),l.jsx("td",{className:"py-3 px-4",children:l.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${se.is_active?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:se.is_active?"Active":"Inactive"})}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>fe(se),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Edit HEI",children:l.jsx(DW,{size:18})}),l.jsx("button",{onClick:()=>c(se.uii),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete HEI",children:l.jsx(Cm,{size:18})})]})})]},se.uii))})]})})})}),e&&l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 dark:bg-gray-900 dark:bg-opacity-75",onClick:()=>r(!1)}),l.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",children:l.jsxs("form",{onSubmit:Q,children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:l.jsxs("div",{className:"mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:n?"Edit HEI Account":"Add New HEI Account"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"UII"}),l.jsx("input",{type:"text",value:E.uii,onChange:se=>{const me=se.target.value.slice(0,6);P("uii",me)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"09001a",maxLength:"8",required:!0}),Y.uii&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.uii})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name of HEI"}),l.jsx("input",{type:"text",value:E.name,onChange:se=>P("name",se.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),Y.name&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),l.jsxs("select",{value:E.type,onChange:se=>P("type",se.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[l.jsx("option",{value:"",children:"Select Type"}),l.jsx("option",{value:"Private",children:"Private"}),l.jsx("option",{value:"SUC",children:"SUC"}),l.jsx("option",{value:"LUC",children:"LUC"})]}),Y.type&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.type})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"HEI Code"}),l.jsx("input",{type:"text",value:E.code,onChange:se=>P("code",se.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),Y.code&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.code})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),l.jsx("input",{type:"email",value:E.email,onChange:se=>P("email",se.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),Y.email&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.email})]}),l.jsxs("div",{className:"md:col-span-2 relative",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Address"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",value:E.address,onChange:ae,onFocus:()=>E.address.length>=3&&S(!0),onBlur:()=>setTimeout(()=>S(!1),200),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Start typing to search for an address..."}),p&&l.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:l.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-500 border-t-transparent rounded-full"})})]}),Y.address&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.address}),x&&l.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:p?l.jsxs("div",{className:"px-4 py-3 text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[l.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"}),"Searching..."]}):N&&m.length===0?l.jsxs("div",{className:"px-4 py-3 text-gray-500 dark:text-gray-400 text-center",children:[l.jsx("p",{className:"text-sm",children:"No addresses found"}),l.jsx("p",{className:"text-xs mt-1",children:"Try a different search term"})]}):m.map((se,me)=>l.jsx("button",{type:"button",onMouseDown:te=>te.preventDefault(),onClick:()=>ue(se),className:"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-600 last:border-0 transition-colors",children:l.jsx("div",{className:"text-sm",children:se.display_name})},me))})]}),n&&l.jsx("div",{className:"md:col-span-2",children:l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:E.is_active,onChange:se=>P("is_active",se.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Active"})]})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:u?"text":"password",value:E.password,onChange:se=>P("password",se.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:n?"Leave blank to keep current password":"password"}),l.jsx("button",{type:"button",onClick:()=>d(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none transition-colors",children:u?l.jsx(Ay,{size:20}):l.jsx(Sm,{size:20})})]}),l.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n?"If left blank, current password will be kept":`If left blank, it'll default to "password"`}),Y.password&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.password})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm Password"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:f?"text":"password",value:E.password_confirmation,onChange:se=>P("password_confirmation",se.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:n?"Leave blank to keep current password":"Confirm password"}),l.jsx("button",{type:"button",onClick:()=>h(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none transition-colors",children:f?l.jsx(Ay,{size:20}):l.jsx(Sm,{size:20})})]}),Y.password_confirmation&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:Y.password_confirmation})]})]})]})}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[l.jsx("button",{type:"submit",disabled:I,className:"w-full inline-flex justify-center rounded-lg border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50",children:I?n?"Updating...":"Creating...":n?"Update HEI":"Create HEI"}),l.jsx("button",{type:"button",onClick:()=>r(!1),className:"mt-3 w-full inline-flex justify-center rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})})]})}),a&&l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 dark:bg-gray-900 dark:bg-opacity-75",onClick:()=>c(null)}),l.jsxs("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:l.jsxs("div",{className:"sm:flex sm:items-start",children:[l.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/20 sm:mx-0 sm:h-10 sm:w-10",children:l.jsx(Cm,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),l.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white",children:"Delete HEI Account"}),l.jsx("div",{className:"mt-2",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this HEI account? This will also delete all associated user accounts. This action cannot be undone."})})]})]})}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[l.jsx("button",{type:"button",onClick:()=>ye(a),disabled:I,className:"w-full inline-flex justify-center rounded-lg border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50",children:I?"Deleting...":"Delete"}),l.jsx("button",{type:"button",onClick:()=>c(null),className:"mt-3 w-full inline-flex justify-center rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})]})})},yte=Object.freeze(Object.defineProperty({__proto__:null,default:pte},Symbol.toStringTag,{value:"Module"})),qt=({label:t,name:e,type:r="text",value:n,onChange:i,error:s=null,placeholder:o="",required:a=!1,disabled:c=!1,className:u="",helperText:d=null})=>{const[f,h]=$.useState(!1),m=r==="password",g=m&&f?"text":r;return l.jsxs("div",{className:u,children:[t&&l.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t,a&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:g,id:e,name:e,value:n,onChange:i,placeholder:o,required:a,disabled:c,className:`w-full px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 ${s?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} ${c?"bg-gray-100 dark:bg-gray-800 cursor-not-allowed":""} ${m?"pr-12":""}`}),m&&l.jsx("button",{type:"button",onClick:()=>h(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none transition-colors","aria-label":f?"Hide password":"Show password",children:f?l.jsx(Ay,{size:20}):l.jsx(Sm,{size:20})})]}),s&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s}),d&&!s&&l.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:d})]})},V1=({label:t,name:e,value:r,onChange:n,options:i=[],error:s=null,required:o=!1,disabled:a=!1,className:c="",placeholder:u="Select an option"})=>l.jsxs("div",{className:c,children:[t&&l.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t,o&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsxs("select",{id:e,name:e,value:r,onChange:n,required:o,disabled:a,className:`w-full px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 ${s?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} ${a?"bg-gray-100 dark:bg-gray-800 cursor-not-allowed":""}`,children:[l.jsx("option",{value:"",children:u}),i.map(d=>l.jsx("option",{value:d.value,children:d.label},d.value))]}),s&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s})]}),vte=()=>{const{data:t,setData:e,post:r,processing:n,errors:i}=Oo({name:"",type:"",email:"",password:"",password_confirmation:""}),s=[{value:"university",label:"University"},{value:"college",label:"College"},{value:"technical",label:"Technical Institute"}],o=a=>{a.preventDefault(),r("/admin/hei-accounts")};return l.jsx(Tl,{title:"Create HEI Account",children:l.jsxs("div",{className:"max-w-2xl",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Create HEI Account"}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:l.jsxs("form",{onSubmit:o,className:"space-y-6",children:[l.jsx(qt,{label:"HEI Name",name:"name",value:t.name,onChange:a=>e("name",a.target.value),error:i.name,required:!0,placeholder:"e.g., University of the Philippines"}),l.jsx(V1,{label:"HEI Type",name:"type",value:t.type,onChange:a=>e("type",a.target.value),options:s,error:i.type,required:!0}),l.jsx(qt,{label:"Email Address",name:"email",type:"email",value:t.email,onChange:a=>e("email",a.target.value),error:i.email,required:!0,placeholder:"hei@example.com"}),l.jsx(qt,{label:"Password",name:"password",type:"password",value:t.password,onChange:a=>e("password",a.target.value),error:i.password,required:!0}),l.jsx(qt,{label:"Confirm Password",name:"password_confirmation",type:"password",value:t.password_confirmation,onChange:a=>e("password_confirmation",a.target.value),error:i.password_confirmation,required:!0}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Creating...":"Create Account"})]})]})})]})})},wte=Object.freeze(Object.defineProperty({__proto__:null,default:vte},Symbol.toStringTag,{value:"Module"})),bte=({hei:t})=>{const{data:e,setData:r,put:n,processing:i,errors:s}=Oo({name:t.name||"",type:t.type||"",email:t.email||""}),o=[{value:"university",label:"University"},{value:"college",label:"College"},{value:"technical",label:"Technical Institute"}],a=c=>{c.preventDefault(),n(`/admin/hei-accounts/${t.id}`)};return l.jsx(Tl,{title:"Edit HEI Account",children:l.jsxs("div",{className:"max-w-2xl",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Edit HEI Account"}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:l.jsxs("form",{onSubmit:a,className:"space-y-6",children:[l.jsx(qt,{label:"HEI Name",name:"name",value:e.name,onChange:c=>r("name",c.target.value),error:s.name,required:!0}),l.jsx(V1,{label:"HEI Type",name:"type",value:e.type,onChange:c=>r("type",c.target.value),options:o,error:s.type,required:!0}),l.jsx(qt,{label:"Email Address",name:"email",type:"email",value:e.email,onChange:c=>r("email",c.target.value),error:s.email,required:!0}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Updating...":"Update Account"})]})]})})]})})},xte=Object.freeze(Object.defineProperty({__proto__:null,default:bte},Symbol.toStringTag,{value:"Module"})),Ste=({heis:t})=>{const e=[{header:"HEI Name",accessor:"name"},{header:"Type",accessor:"type"},{header:"Email",accessor:"email"},{header:"Status",render:n=>l.jsx(MA,{status:n.is_active?"active":"inactive"})},{header:"Created At",render:n=>an(n.created_at)},{header:"Actions",render:n=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx(yt,{href:`/admin/hei-accounts/${n.id}/edit`,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Edit"}),l.jsx("button",{onClick:()=>r(n.id),className:"text-yellow-600 hover:text-yellow-800 dark:text-yellow-400",children:n.is_active?"Deactivate":"Activate"})]})}],r=n=>{confirm("Are you sure you want to change this HEI's status?")&&lt.post(`/admin/hei-accounts/${n}/toggle-status`)};return l.jsx(Tl,{title:"HEI Accounts",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"HEI Accounts"}),l.jsx(yt,{href:"/admin/hei-accounts/create",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create HEI Account"})]}),l.jsx(PA,{columns:e,data:(t==null?void 0:t.data)||[],emptyMessage:"No HEI accounts found"})]})})},Cte=Object.freeze(Object.defineProperty({__proto__:null,default:Ste},Symbol.toStringTag,{value:"Module"})),_te=({submissions:t=[],stats:e={}})=>l.jsx(Tl,{title:"Submissions",pendingCount:e.pending||0,children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Submission Management"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:"Pending Review"}),l.jsx("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400 mt-2",children:e.pending||0})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:"Approved"}),l.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400 mt-2",children:e.approved||0})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:"Rejected"}),l.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400 mt-2",children:e.rejected||0})]})]}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Recent Submissions"}),l.jsx("div",{className:"flex gap-2",children:l.jsxs("select",{className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"all",children:"All Status"}),l.jsx("option",{value:"pending",children:"Pending"}),l.jsx("option",{value:"approved",children:"Approved"}),l.jsx("option",{value:"rejected",children:"Rejected"})]})})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"HEI Name"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Academic Year"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Submitted Date"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Status"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Actions"})]})}),l.jsx("tbody",{children:t.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:"5",className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No submissions found"})}):t.map(r=>l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[l.jsx("td",{className:"py-3 px-4 text-gray-900 dark:text-white",children:r.hei_name}),l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:r.academic_year}),l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:r.submitted_date}),l.jsx("td",{className:"py-3 px-4",children:l.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${r.status==="approved"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":r.status==="rejected"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400"}`,children:r.status})}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Review submission",children:l.jsx(ba,{size:18})}),l.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-700 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"View submission",children:l.jsx(Sm,{size:18})})]})})]},r.id))})]})})]})})]})}),Rte=Object.freeze(Object.defineProperty({__proto__:null,default:_te},Symbol.toStringTag,{value:"Module"}));var FW={exports:{}},Js={},VW={exports:{}},BW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,fe){var ye=Q.length;Q.push(fe);e:for(;0<ye;){var de=ye-1>>>1,se=Q[de];if(0<i(se,fe))Q[de]=fe,Q[ye]=se,ye=de;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var fe=Q[0],ye=Q.pop();if(ye!==fe){Q[0]=ye;e:for(var de=0,se=Q.length,me=se>>>1;de<me;){var te=2*(de+1)-1,b=Q[te],_=te+1,T=Q[_];if(0>i(b,ye))_<se&&0>i(T,b)?(Q[de]=T,Q[_]=ye,de=_):(Q[de]=b,Q[te]=ye,de=te);else if(_<se&&0>i(T,ye))Q[de]=T,Q[_]=ye,de=_;else break e}}return fe}function i(Q,fe){var ye=Q.sortIndex-fe.sortIndex;return ye!==0?ye:Q.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,f=null,h=3,m=!1,g=!1,p=!1,y=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(Q){for(var fe=r(u);fe!==null;){if(fe.callback===null)n(u);else if(fe.startTime<=Q)n(u),fe.sortIndex=fe.expirationTime,e(c,fe);else break;fe=r(u)}}function S(Q){if(p=!1,x(Q),!g)if(r(c)!==null)g=!0,ae(N);else{var fe=r(u);fe!==null&&ue(S,fe.startTime-Q)}}function N(Q,fe){g=!1,p&&(p=!1,w(P),P=-1),m=!0;var ye=h;try{for(x(fe),f=r(c);f!==null&&(!(f.expirationTime>fe)||Q&&!Z());){var de=f.callback;if(typeof de=="function"){f.callback=null,h=f.priorityLevel;var se=de(f.expirationTime<=fe);fe=t.unstable_now(),typeof se=="function"?f.callback=se:f===r(c)&&n(c),x(fe)}else n(c);f=r(c)}if(f!==null)var me=!0;else{var te=r(u);te!==null&&ue(S,te.startTime-fe),me=!1}return me}finally{f=null,h=ye,m=!1}}var R=!1,E=null,P=-1,D=5,H=-1;function Z(){return!(t.unstable_now()-H<D)}function I(){if(E!==null){var Q=t.unstable_now();H=Q;var fe=!0;try{fe=E(!0,Q)}finally{fe?Y():(R=!1,E=null)}}else R=!1}var Y;if(typeof v=="function")Y=function(){v(I)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ne=re.port2;re.port1.onmessage=I,Y=function(){ne.postMessage(null)}}else Y=function(){y(I,0)};function ae(Q){E=Q,R||(R=!0,Y())}function ue(Q,fe){P=y(function(){Q(t.unstable_now())},fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,ae(N))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(Q){switch(h){case 1:case 2:case 3:var fe=3;break;default:fe=h}var ye=h;h=fe;try{return Q()}finally{h=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,fe){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ye=h;h=Q;try{return fe()}finally{h=ye}},t.unstable_scheduleCallback=function(Q,fe,ye){var de=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?de+ye:de):ye=de,Q){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=ye+se,Q={id:d++,callback:fe,priorityLevel:Q,startTime:ye,expirationTime:se,sortIndex:-1},ye>de?(Q.sortIndex=ye,e(u,Q),r(c)===null&&Q===r(u)&&(p?(w(P),P=-1):p=!0,ue(S,ye-de))):(Q.sortIndex=se,e(c,Q),g||m||(g=!0,ae(N))),Q},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(Q){var fe=h;return function(){var ye=h;h=fe;try{return Q.apply(this,arguments)}finally{h=ye}}}})(BW);VW.exports=BW;var Ete=VW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nte=$,Qs=Ete;function ge(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var WW=new Set,Oy={};function lf(t,e){_m(t,e),_m(t+"Capture",e)}function _m(t,e){for(Oy[t]=e,t=0;t<e.length;t++)WW.add(e[t])}var Ec=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),DT=Object.prototype.hasOwnProperty,kte=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iD={},sD={};function Tte(t){return DT.call(sD,t)?!0:DT.call(iD,t)?!1:kte.test(t)?sD[t]=!0:(iD[t]=!0,!1)}function Pte(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Mte(t,e,r,n){if(e===null||typeof e>"u"||Pte(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ui(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ii={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ii[t]=new Ui(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ii[e]=new Ui(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ii[t]=new Ui(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ii[t]=new Ui(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ii[t]=new Ui(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ii[t]=new Ui(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ii[t]=new Ui(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ii[t]=new Ui(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ii[t]=new Ui(t,5,!1,t.toLowerCase(),null,!1,!1)});var AA=/[\-:]([a-z])/g;function OA(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(AA,OA);ii[e]=new Ui(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(AA,OA);ii[e]=new Ui(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(AA,OA);ii[e]=new Ui(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ii[t]=new Ui(t,1,!1,t.toLowerCase(),null,!1,!1)});ii.xlinkHref=new Ui("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ii[t]=new Ui(t,1,!1,t.toLowerCase(),null,!0,!0)});function IA(t,e,r,n){var i=ii.hasOwnProperty(e)?ii[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Mte(e,r,i,n)&&(r=null),n||i===null?Tte(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Hc=Nte.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kw=Symbol.for("react.element"),Mg=Symbol.for("react.portal"),Ag=Symbol.for("react.fragment"),jA=Symbol.for("react.strict_mode"),LT=Symbol.for("react.profiler"),zW=Symbol.for("react.provider"),UW=Symbol.for("react.context"),HA=Symbol.for("react.forward_ref"),FT=Symbol.for("react.suspense"),VT=Symbol.for("react.suspense_list"),$A=Symbol.for("react.memo"),wu=Symbol.for("react.lazy"),YW=Symbol.for("react.offscreen"),oD=Symbol.iterator;function wp(t){return t===null||typeof t!="object"?null:(t=oD&&t[oD]||t["@@iterator"],typeof t=="function"?t:null)}var $r=Object.assign,AR;function O0(t){if(AR===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);AR=e&&e[1]||""}return`
`+AR+t}var OR=!1;function IR(t,e){if(!t||OR)return"";OR=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{OR=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?O0(t):""}function Ate(t){switch(t.tag){case 5:return O0(t.type);case 16:return O0("Lazy");case 13:return O0("Suspense");case 19:return O0("SuspenseList");case 0:case 2:case 15:return t=IR(t.type,!1),t;case 11:return t=IR(t.type.render,!1),t;case 1:return t=IR(t.type,!0),t;default:return""}}function BT(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ag:return"Fragment";case Mg:return"Portal";case LT:return"Profiler";case jA:return"StrictMode";case FT:return"Suspense";case VT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case UW:return(t.displayName||"Context")+".Consumer";case zW:return(t._context.displayName||"Context")+".Provider";case HA:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $A:return e=t.displayName||null,e!==null?e:BT(t.type)||"Memo";case wu:e=t._payload,t=t._init;try{return BT(t(e))}catch{}}return null}function Ote(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return BT(e);case 8:return e===jA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function td(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function GW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ite(t){var e=GW(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Tw(t){t._valueTracker||(t._valueTracker=Ite(t))}function KW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=GW(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function US(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function WT(t,e){var r=e.checked;return $r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function aD(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=td(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qW(t,e){e=e.checked,e!=null&&IA(t,"checked",e,!1)}function zT(t,e){qW(t,e);var r=td(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?UT(t,e.type,r):e.hasOwnProperty("defaultValue")&&UT(t,e.type,td(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function lD(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function UT(t,e,r){(e!=="number"||US(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var I0=Array.isArray;function rm(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+td(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function YT(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ge(91));return $r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function cD(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ge(92));if(I0(r)){if(1<r.length)throw Error(ge(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:td(r)}}function XW(t,e){var r=td(e.value),n=td(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function uD(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function QW(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function GT(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?QW(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pw,JW=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pw=Pw||document.createElement("div"),Pw.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pw.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Iy(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Q0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jte=["Webkit","ms","Moz","O"];Object.keys(Q0).forEach(function(t){jte.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Q0[e]=Q0[t]})});function ZW(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Q0.hasOwnProperty(t)&&Q0[t]?(""+e).trim():e+"px"}function e5(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ZW(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Hte=$r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function KT(t,e){if(e){if(Hte[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ge(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ge(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ge(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ge(62))}}function qT(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var XT=null;function DA(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var QT=null,nm=null,im=null;function dD(t){if(t=Av(t)){if(typeof QT!="function")throw Error(ge(280));var e=t.stateNode;e&&(e=Y1(e),QT(t.stateNode,t.type,e))}}function t5(t){nm?im?im.push(t):im=[t]:nm=t}function r5(){if(nm){var t=nm,e=im;if(im=nm=null,dD(t),e)for(t=0;t<e.length;t++)dD(e[t])}}function n5(t,e){return t(e)}function i5(){}var jR=!1;function s5(t,e,r){if(jR)return t(e,r);jR=!0;try{return n5(t,e,r)}finally{jR=!1,(nm!==null||im!==null)&&(i5(),r5())}}function jy(t,e){var r=t.stateNode;if(r===null)return null;var n=Y1(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ge(231,e,typeof r));return r}var JT=!1;if(Ec)try{var bp={};Object.defineProperty(bp,"passive",{get:function(){JT=!0}}),window.addEventListener("test",bp,bp),window.removeEventListener("test",bp,bp)}catch{JT=!1}function $te(t,e,r,n,i,s,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var J0=!1,YS=null,GS=!1,ZT=null,Dte={onError:function(t){J0=!0,YS=t}};function Lte(t,e,r,n,i,s,o,a,c){J0=!1,YS=null,$te.apply(Dte,arguments)}function Fte(t,e,r,n,i,s,o,a,c){if(Lte.apply(this,arguments),J0){if(J0){var u=YS;J0=!1,YS=null}else throw Error(ge(198));GS||(GS=!0,ZT=u)}}function cf(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function o5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function hD(t){if(cf(t)!==t)throw Error(ge(188))}function Vte(t){var e=t.alternate;if(!e){if(e=cf(t),e===null)throw Error(ge(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return hD(i),t;if(s===n)return hD(i),e;s=s.sibling}throw Error(ge(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(ge(189))}}if(r.alternate!==n)throw Error(ge(190))}if(r.tag!==3)throw Error(ge(188));return r.stateNode.current===r?t:e}function a5(t){return t=Vte(t),t!==null?l5(t):null}function l5(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=l5(t);if(e!==null)return e;t=t.sibling}return null}var c5=Qs.unstable_scheduleCallback,fD=Qs.unstable_cancelCallback,Bte=Qs.unstable_shouldYield,Wte=Qs.unstable_requestPaint,nn=Qs.unstable_now,zte=Qs.unstable_getCurrentPriorityLevel,LA=Qs.unstable_ImmediatePriority,u5=Qs.unstable_UserBlockingPriority,KS=Qs.unstable_NormalPriority,Ute=Qs.unstable_LowPriority,d5=Qs.unstable_IdlePriority,B1=null,Cl=null;function Yte(t){if(Cl&&typeof Cl.onCommitFiberRoot=="function")try{Cl.onCommitFiberRoot(B1,t,void 0,(t.current.flags&128)===128)}catch{}}var ya=Math.clz32?Math.clz32:qte,Gte=Math.log,Kte=Math.LN2;function qte(t){return t>>>=0,t===0?32:31-(Gte(t)/Kte|0)|0}var Mw=64,Aw=4194304;function j0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function qS(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=j0(a):(s&=o,s!==0&&(n=j0(s)))}else o=r&~i,o!==0?n=j0(o):s!==0&&(n=j0(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ya(e),i=1<<r,n|=t[r],e&=~i;return n}function Xte(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qte(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-ya(s),a=1<<o,c=i[o];c===-1?(!(a&r)||a&n)&&(i[o]=Xte(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function eP(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function h5(){var t=Mw;return Mw<<=1,!(Mw&4194240)&&(Mw=64),t}function HR(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Pv(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ya(e),t[e]=r}function Jte(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ya(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function FA(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ya(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Ut=0;function f5(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var g5,VA,m5,p5,y5,tP=!1,Ow=[],Fu=null,Vu=null,Bu=null,Hy=new Map,$y=new Map,Ru=[],Zte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gD(t,e){switch(t){case"focusin":case"focusout":Fu=null;break;case"dragenter":case"dragleave":Vu=null;break;case"mouseover":case"mouseout":Bu=null;break;case"pointerover":case"pointerout":Hy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$y.delete(e.pointerId)}}function xp(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Av(e),e!==null&&VA(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ere(t,e,r,n,i){switch(e){case"focusin":return Fu=xp(Fu,t,e,r,n,i),!0;case"dragenter":return Vu=xp(Vu,t,e,r,n,i),!0;case"mouseover":return Bu=xp(Bu,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Hy.set(s,xp(Hy.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,$y.set(s,xp($y.get(s)||null,t,e,r,n,i)),!0}return!1}function v5(t){var e=wh(t.target);if(e!==null){var r=cf(e);if(r!==null){if(e=r.tag,e===13){if(e=o5(r),e!==null){t.blockedOn=e,y5(t.priority,function(){m5(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function qx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=rP(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);XT=n,r.target.dispatchEvent(n),XT=null}else return e=Av(r),e!==null&&VA(e),t.blockedOn=r,!1;e.shift()}return!0}function mD(t,e,r){qx(t)&&r.delete(e)}function tre(){tP=!1,Fu!==null&&qx(Fu)&&(Fu=null),Vu!==null&&qx(Vu)&&(Vu=null),Bu!==null&&qx(Bu)&&(Bu=null),Hy.forEach(mD),$y.forEach(mD)}function Sp(t,e){t.blockedOn===e&&(t.blockedOn=null,tP||(tP=!0,Qs.unstable_scheduleCallback(Qs.unstable_NormalPriority,tre)))}function Dy(t){function e(i){return Sp(i,t)}if(0<Ow.length){Sp(Ow[0],t);for(var r=1;r<Ow.length;r++){var n=Ow[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Fu!==null&&Sp(Fu,t),Vu!==null&&Sp(Vu,t),Bu!==null&&Sp(Bu,t),Hy.forEach(e),$y.forEach(e),r=0;r<Ru.length;r++)n=Ru[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ru.length&&(r=Ru[0],r.blockedOn===null);)v5(r),r.blockedOn===null&&Ru.shift()}var sm=Hc.ReactCurrentBatchConfig,XS=!0;function rre(t,e,r,n){var i=Ut,s=sm.transition;sm.transition=null;try{Ut=1,BA(t,e,r,n)}finally{Ut=i,sm.transition=s}}function nre(t,e,r,n){var i=Ut,s=sm.transition;sm.transition=null;try{Ut=4,BA(t,e,r,n)}finally{Ut=i,sm.transition=s}}function BA(t,e,r,n){if(XS){var i=rP(t,e,r,n);if(i===null)YR(t,e,n,QS,r),gD(t,n);else if(ere(i,t,e,r,n))n.stopPropagation();else if(gD(t,n),e&4&&-1<Zte.indexOf(t)){for(;i!==null;){var s=Av(i);if(s!==null&&g5(s),s=rP(t,e,r,n),s===null&&YR(t,e,n,QS,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else YR(t,e,n,null,r)}}var QS=null;function rP(t,e,r,n){if(QS=null,t=DA(n),t=wh(t),t!==null)if(e=cf(t),e===null)t=null;else if(r=e.tag,r===13){if(t=o5(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return QS=t,null}function w5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zte()){case LA:return 1;case u5:return 4;case KS:case Ute:return 16;case d5:return 536870912;default:return 16}default:return 16}}var Mu=null,WA=null,Xx=null;function b5(){if(Xx)return Xx;var t,e=WA,r=e.length,n,i="value"in Mu?Mu.value:Mu.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return Xx=i.slice(t,1<n?1-n:void 0)}function Qx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Iw(){return!0}function pD(){return!1}function Zs(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Iw:pD,this.isPropagationStopped=pD,this}return $r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Iw)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Iw)},persist:function(){},isPersistent:Iw}),e}var Ym={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zA=Zs(Ym),Mv=$r({},Ym,{view:0,detail:0}),ire=Zs(Mv),$R,DR,Cp,W1=$r({},Mv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:UA,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Cp&&(Cp&&t.type==="mousemove"?($R=t.screenX-Cp.screenX,DR=t.screenY-Cp.screenY):DR=$R=0,Cp=t),$R)},movementY:function(t){return"movementY"in t?t.movementY:DR}}),yD=Zs(W1),sre=$r({},W1,{dataTransfer:0}),ore=Zs(sre),are=$r({},Mv,{relatedTarget:0}),LR=Zs(are),lre=$r({},Ym,{animationName:0,elapsedTime:0,pseudoElement:0}),cre=Zs(lre),ure=$r({},Ym,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dre=Zs(ure),hre=$r({},Ym,{data:0}),vD=Zs(hre),fre={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gre={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mre={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pre(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mre[t])?!!e[t]:!1}function UA(){return pre}var yre=$r({},Mv,{key:function(t){if(t.key){var e=fre[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gre[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:UA,charCode:function(t){return t.type==="keypress"?Qx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),vre=Zs(yre),wre=$r({},W1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wD=Zs(wre),bre=$r({},Mv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:UA}),xre=Zs(bre),Sre=$r({},Ym,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cre=Zs(Sre),_re=$r({},W1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Rre=Zs(_re),Ere=[9,13,27,32],YA=Ec&&"CompositionEvent"in window,Z0=null;Ec&&"documentMode"in document&&(Z0=document.documentMode);var Nre=Ec&&"TextEvent"in window&&!Z0,x5=Ec&&(!YA||Z0&&8<Z0&&11>=Z0),bD=" ",xD=!1;function S5(t,e){switch(t){case"keyup":return Ere.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Og=!1;function kre(t,e){switch(t){case"compositionend":return C5(e);case"keypress":return e.which!==32?null:(xD=!0,bD);case"textInput":return t=e.data,t===bD&&xD?null:t;default:return null}}function Tre(t,e){if(Og)return t==="compositionend"||!YA&&S5(t,e)?(t=b5(),Xx=WA=Mu=null,Og=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return x5&&e.locale!=="ko"?null:e.data;default:return null}}var Pre={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function SD(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Pre[t.type]:e==="textarea"}function _5(t,e,r,n){t5(n),e=JS(e,"onChange"),0<e.length&&(r=new zA("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ey=null,Ly=null;function Mre(t){j5(t,0)}function z1(t){var e=Hg(t);if(KW(e))return t}function Are(t,e){if(t==="change")return e}var R5=!1;if(Ec){var FR;if(Ec){var VR="oninput"in document;if(!VR){var CD=document.createElement("div");CD.setAttribute("oninput","return;"),VR=typeof CD.oninput=="function"}FR=VR}else FR=!1;R5=FR&&(!document.documentMode||9<document.documentMode)}function _D(){ey&&(ey.detachEvent("onpropertychange",E5),Ly=ey=null)}function E5(t){if(t.propertyName==="value"&&z1(Ly)){var e=[];_5(e,Ly,t,DA(t)),s5(Mre,e)}}function Ore(t,e,r){t==="focusin"?(_D(),ey=e,Ly=r,ey.attachEvent("onpropertychange",E5)):t==="focusout"&&_D()}function Ire(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return z1(Ly)}function jre(t,e){if(t==="click")return z1(e)}function Hre(t,e){if(t==="input"||t==="change")return z1(e)}function $re(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xa=typeof Object.is=="function"?Object.is:$re;function Fy(t,e){if(xa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!DT.call(e,i)||!xa(t[i],e[i]))return!1}return!0}function RD(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ED(t,e){var r=RD(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=RD(r)}}function N5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?N5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function k5(){for(var t=window,e=US();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=US(t.document)}return e}function GA(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Dre(t){var e=k5(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&N5(r.ownerDocument.documentElement,r)){if(n!==null&&GA(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=ED(r,s);var o=ED(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Lre=Ec&&"documentMode"in document&&11>=document.documentMode,Ig=null,nP=null,ty=null,iP=!1;function ND(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;iP||Ig==null||Ig!==US(n)||(n=Ig,"selectionStart"in n&&GA(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ty&&Fy(ty,n)||(ty=n,n=JS(nP,"onSelect"),0<n.length&&(e=new zA("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ig)))}function jw(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var jg={animationend:jw("Animation","AnimationEnd"),animationiteration:jw("Animation","AnimationIteration"),animationstart:jw("Animation","AnimationStart"),transitionend:jw("Transition","TransitionEnd")},BR={},T5={};Ec&&(T5=document.createElement("div").style,"AnimationEvent"in window||(delete jg.animationend.animation,delete jg.animationiteration.animation,delete jg.animationstart.animation),"TransitionEvent"in window||delete jg.transitionend.transition);function U1(t){if(BR[t])return BR[t];if(!jg[t])return t;var e=jg[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in T5)return BR[t]=e[r];return t}var P5=U1("animationend"),M5=U1("animationiteration"),A5=U1("animationstart"),O5=U1("transitionend"),I5=new Map,kD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ad(t,e){I5.set(t,e),lf(e,[t])}for(var WR=0;WR<kD.length;WR++){var zR=kD[WR],Fre=zR.toLowerCase(),Vre=zR[0].toUpperCase()+zR.slice(1);ad(Fre,"on"+Vre)}ad(P5,"onAnimationEnd");ad(M5,"onAnimationIteration");ad(A5,"onAnimationStart");ad("dblclick","onDoubleClick");ad("focusin","onFocus");ad("focusout","onBlur");ad(O5,"onTransitionEnd");_m("onMouseEnter",["mouseout","mouseover"]);_m("onMouseLeave",["mouseout","mouseover"]);_m("onPointerEnter",["pointerout","pointerover"]);_m("onPointerLeave",["pointerout","pointerover"]);lf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));lf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));lf("onBeforeInput",["compositionend","keypress","textInput","paste"]);lf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));lf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));lf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var H0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bre=new Set("cancel close invalid load scroll toggle".split(" ").concat(H0));function TD(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Fte(n,e,void 0,t),t.currentTarget=null}function j5(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;TD(i,a,u),s=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;TD(i,a,u),s=c}}}if(GS)throw t=ZT,GS=!1,ZT=null,t}function ur(t,e){var r=e[cP];r===void 0&&(r=e[cP]=new Set);var n=t+"__bubble";r.has(n)||(H5(e,t,2,!1),r.add(n))}function UR(t,e,r){var n=0;e&&(n|=4),H5(r,t,n,e)}var Hw="_reactListening"+Math.random().toString(36).slice(2);function Vy(t){if(!t[Hw]){t[Hw]=!0,WW.forEach(function(r){r!=="selectionchange"&&(Bre.has(r)||UR(r,!1,t),UR(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hw]||(e[Hw]=!0,UR("selectionchange",!1,e))}}function H5(t,e,r,n){switch(w5(e)){case 1:var i=rre;break;case 4:i=nre;break;default:i=BA}r=i.bind(null,e,r,t),i=void 0,!JT||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function YR(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=wh(a),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}a=a.parentNode}}n=n.return}s5(function(){var u=s,d=DA(r),f=[];e:{var h=I5.get(t);if(h!==void 0){var m=zA,g=t;switch(t){case"keypress":if(Qx(r)===0)break e;case"keydown":case"keyup":m=vre;break;case"focusin":g="focus",m=LR;break;case"focusout":g="blur",m=LR;break;case"beforeblur":case"afterblur":m=LR;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=yD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ore;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=xre;break;case P5:case M5:case A5:m=cre;break;case O5:m=Cre;break;case"scroll":m=ire;break;case"wheel":m=Rre;break;case"copy":case"cut":case"paste":m=dre;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=wD}var p=(e&4)!==0,y=!p&&t==="scroll",w=p?h!==null?h+"Capture":null:h;p=[];for(var v=u,x;v!==null;){x=v;var S=x.stateNode;if(x.tag===5&&S!==null&&(x=S,w!==null&&(S=jy(v,w),S!=null&&p.push(By(v,S,x)))),y)break;v=v.return}0<p.length&&(h=new m(h,g,null,r,d),f.push({event:h,listeners:p}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&r!==XT&&(g=r.relatedTarget||r.fromElement)&&(wh(g)||g[Nc]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=u,g=g?wh(g):null,g!==null&&(y=cf(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(p=yD,S="onMouseLeave",w="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(p=wD,S="onPointerLeave",w="onPointerEnter",v="pointer"),y=m==null?h:Hg(m),x=g==null?h:Hg(g),h=new p(S,v+"leave",m,r,d),h.target=y,h.relatedTarget=x,S=null,wh(d)===u&&(p=new p(w,v+"enter",g,r,d),p.target=x,p.relatedTarget=y,S=p),y=S,m&&g)t:{for(p=m,w=g,v=0,x=p;x;x=Ef(x))v++;for(x=0,S=w;S;S=Ef(S))x++;for(;0<v-x;)p=Ef(p),v--;for(;0<x-v;)w=Ef(w),x--;for(;v--;){if(p===w||w!==null&&p===w.alternate)break t;p=Ef(p),w=Ef(w)}p=null}else p=null;m!==null&&PD(f,h,m,p,!1),g!==null&&y!==null&&PD(f,y,g,p,!0)}}e:{if(h=u?Hg(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var N=Are;else if(SD(h))if(R5)N=Hre;else{N=Ire;var R=Ore}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=jre);if(N&&(N=N(t,u))){_5(f,N,r,d);break e}R&&R(t,h,u),t==="focusout"&&(R=h._wrapperState)&&R.controlled&&h.type==="number"&&UT(h,"number",h.value)}switch(R=u?Hg(u):window,t){case"focusin":(SD(R)||R.contentEditable==="true")&&(Ig=R,nP=u,ty=null);break;case"focusout":ty=nP=Ig=null;break;case"mousedown":iP=!0;break;case"contextmenu":case"mouseup":case"dragend":iP=!1,ND(f,r,d);break;case"selectionchange":if(Lre)break;case"keydown":case"keyup":ND(f,r,d)}var E;if(YA)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Og?S5(t,r)&&(P="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(x5&&r.locale!=="ko"&&(Og||P!=="onCompositionStart"?P==="onCompositionEnd"&&Og&&(E=b5()):(Mu=d,WA="value"in Mu?Mu.value:Mu.textContent,Og=!0)),R=JS(u,P),0<R.length&&(P=new vD(P,t,null,r,d),f.push({event:P,listeners:R}),E?P.data=E:(E=C5(r),E!==null&&(P.data=E)))),(E=Nre?kre(t,r):Tre(t,r))&&(u=JS(u,"onBeforeInput"),0<u.length&&(d=new vD("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=E))}j5(f,e)})}function By(t,e,r){return{instance:t,listener:e,currentTarget:r}}function JS(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=jy(t,r),s!=null&&n.unshift(By(t,s,i)),s=jy(t,e),s!=null&&n.push(By(t,s,i))),t=t.return}return n}function Ef(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function PD(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&u!==null&&(a=u,i?(c=jy(r,s),c!=null&&o.unshift(By(r,c,a))):i||(c=jy(r,s),c!=null&&o.push(By(r,c,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Wre=/\r\n?/g,zre=/\u0000|\uFFFD/g;function MD(t){return(typeof t=="string"?t:""+t).replace(Wre,`
`).replace(zre,"")}function $w(t,e,r){if(e=MD(e),MD(t)!==e&&r)throw Error(ge(425))}function ZS(){}var sP=null,oP=null;function aP(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lP=typeof setTimeout=="function"?setTimeout:void 0,Ure=typeof clearTimeout=="function"?clearTimeout:void 0,AD=typeof Promise=="function"?Promise:void 0,Yre=typeof queueMicrotask=="function"?queueMicrotask:typeof AD<"u"?function(t){return AD.resolve(null).then(t).catch(Gre)}:lP;function Gre(t){setTimeout(function(){throw t})}function GR(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Dy(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Dy(e)}function Wu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function OD(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Gm=Math.random().toString(36).slice(2),pl="__reactFiber$"+Gm,Wy="__reactProps$"+Gm,Nc="__reactContainer$"+Gm,cP="__reactEvents$"+Gm,Kre="__reactListeners$"+Gm,qre="__reactHandles$"+Gm;function wh(t){var e=t[pl];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Nc]||r[pl]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=OD(t);t!==null;){if(r=t[pl])return r;t=OD(t)}return e}t=r,r=t.parentNode}return null}function Av(t){return t=t[pl]||t[Nc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hg(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ge(33))}function Y1(t){return t[Wy]||null}var uP=[],$g=-1;function ld(t){return{current:t}}function gr(t){0>$g||(t.current=uP[$g],uP[$g]=null,$g--)}function ir(t,e){$g++,uP[$g]=t.current,t.current=e}var rd={},Ci=ld(rd),ms=ld(!1),Bh=rd;function Rm(t,e){var r=t.type.contextTypes;if(!r)return rd;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ps(t){return t=t.childContextTypes,t!=null}function eC(){gr(ms),gr(Ci)}function ID(t,e,r){if(Ci.current!==rd)throw Error(ge(168));ir(Ci,e),ir(ms,r)}function $5(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ge(108,Ote(t)||"Unknown",i));return $r({},r,n)}function tC(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||rd,Bh=Ci.current,ir(Ci,t),ir(ms,ms.current),!0}function jD(t,e,r){var n=t.stateNode;if(!n)throw Error(ge(169));r?(t=$5(t,e,Bh),n.__reactInternalMemoizedMergedChildContext=t,gr(ms),gr(Ci),ir(Ci,t)):gr(ms),ir(ms,r)}var uc=null,G1=!1,KR=!1;function D5(t){uc===null?uc=[t]:uc.push(t)}function Xre(t){G1=!0,D5(t)}function cd(){if(!KR&&uc!==null){KR=!0;var t=0,e=Ut;try{var r=uc;for(Ut=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}uc=null,G1=!1}catch(i){throw uc!==null&&(uc=uc.slice(t+1)),c5(LA,cd),i}finally{Ut=e,KR=!1}}return null}var Dg=[],Lg=0,rC=null,nC=0,xo=[],So=0,Wh=null,dc=1,hc="";function ih(t,e){Dg[Lg++]=nC,Dg[Lg++]=rC,rC=t,nC=e}function L5(t,e,r){xo[So++]=dc,xo[So++]=hc,xo[So++]=Wh,Wh=t;var n=dc;t=hc;var i=32-ya(n)-1;n&=~(1<<i),r+=1;var s=32-ya(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,dc=1<<32-ya(e)+i|r<<i|n,hc=s+t}else dc=1<<s|r<<i|n,hc=t}function KA(t){t.return!==null&&(ih(t,1),L5(t,1,0))}function qA(t){for(;t===rC;)rC=Dg[--Lg],Dg[Lg]=null,nC=Dg[--Lg],Dg[Lg]=null;for(;t===Wh;)Wh=xo[--So],xo[So]=null,hc=xo[--So],xo[So]=null,dc=xo[--So],xo[So]=null}var qs=null,Ys=null,Cr=!1,da=null;function F5(t,e){var r=Eo(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function HD(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,qs=t,Ys=Wu(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,qs=t,Ys=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Wh!==null?{id:dc,overflow:hc}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Eo(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,qs=t,Ys=null,!0):!1;default:return!1}}function dP(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hP(t){if(Cr){var e=Ys;if(e){var r=e;if(!HD(t,e)){if(dP(t))throw Error(ge(418));e=Wu(r.nextSibling);var n=qs;e&&HD(t,e)?F5(n,r):(t.flags=t.flags&-4097|2,Cr=!1,qs=t)}}else{if(dP(t))throw Error(ge(418));t.flags=t.flags&-4097|2,Cr=!1,qs=t}}}function $D(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qs=t}function Dw(t){if(t!==qs)return!1;if(!Cr)return $D(t),Cr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!aP(t.type,t.memoizedProps)),e&&(e=Ys)){if(dP(t))throw V5(),Error(ge(418));for(;e;)F5(t,e),e=Wu(e.nextSibling)}if($D(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ge(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ys=Wu(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ys=null}}else Ys=qs?Wu(t.stateNode.nextSibling):null;return!0}function V5(){for(var t=Ys;t;)t=Wu(t.nextSibling)}function Em(){Ys=qs=null,Cr=!1}function XA(t){da===null?da=[t]:da.push(t)}var Qre=Hc.ReactCurrentBatchConfig;function _p(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ge(309));var n=r.stateNode}if(!n)throw Error(ge(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ge(284));if(!r._owner)throw Error(ge(290,t))}return t}function Lw(t,e){throw t=Object.prototype.toString.call(e),Error(ge(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function DD(t){var e=t._init;return e(t._payload)}function B5(t){function e(w,v){if(t){var x=w.deletions;x===null?(w.deletions=[v],w.flags|=16):x.push(v)}}function r(w,v){if(!t)return null;for(;v!==null;)e(w,v),v=v.sibling;return null}function n(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function i(w,v){return w=Gu(w,v),w.index=0,w.sibling=null,w}function s(w,v,x){return w.index=x,t?(x=w.alternate,x!==null?(x=x.index,x<v?(w.flags|=2,v):x):(w.flags|=2,v)):(w.flags|=1048576,v)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,v,x,S){return v===null||v.tag!==6?(v=tE(x,w.mode,S),v.return=w,v):(v=i(v,x),v.return=w,v)}function c(w,v,x,S){var N=x.type;return N===Ag?d(w,v,x.props.children,S,x.key):v!==null&&(v.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===wu&&DD(N)===v.type)?(S=i(v,x.props),S.ref=_p(w,v,x),S.return=w,S):(S=iS(x.type,x.key,x.props,null,w.mode,S),S.ref=_p(w,v,x),S.return=w,S)}function u(w,v,x,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=rE(x,w.mode,S),v.return=w,v):(v=i(v,x.children||[]),v.return=w,v)}function d(w,v,x,S,N){return v===null||v.tag!==7?(v=Hh(x,w.mode,S,N),v.return=w,v):(v=i(v,x),v.return=w,v)}function f(w,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=tE(""+v,w.mode,x),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case kw:return x=iS(v.type,v.key,v.props,null,w.mode,x),x.ref=_p(w,null,v),x.return=w,x;case Mg:return v=rE(v,w.mode,x),v.return=w,v;case wu:var S=v._init;return f(w,S(v._payload),x)}if(I0(v)||wp(v))return v=Hh(v,w.mode,x,null),v.return=w,v;Lw(w,v)}return null}function h(w,v,x,S){var N=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return N!==null?null:a(w,v,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case kw:return x.key===N?c(w,v,x,S):null;case Mg:return x.key===N?u(w,v,x,S):null;case wu:return N=x._init,h(w,v,N(x._payload),S)}if(I0(x)||wp(x))return N!==null?null:d(w,v,x,S,null);Lw(w,x)}return null}function m(w,v,x,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return w=w.get(x)||null,a(v,w,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case kw:return w=w.get(S.key===null?x:S.key)||null,c(v,w,S,N);case Mg:return w=w.get(S.key===null?x:S.key)||null,u(v,w,S,N);case wu:var R=S._init;return m(w,v,x,R(S._payload),N)}if(I0(S)||wp(S))return w=w.get(x)||null,d(v,w,S,N,null);Lw(v,S)}return null}function g(w,v,x,S){for(var N=null,R=null,E=v,P=v=0,D=null;E!==null&&P<x.length;P++){E.index>P?(D=E,E=null):D=E.sibling;var H=h(w,E,x[P],S);if(H===null){E===null&&(E=D);break}t&&E&&H.alternate===null&&e(w,E),v=s(H,v,P),R===null?N=H:R.sibling=H,R=H,E=D}if(P===x.length)return r(w,E),Cr&&ih(w,P),N;if(E===null){for(;P<x.length;P++)E=f(w,x[P],S),E!==null&&(v=s(E,v,P),R===null?N=E:R.sibling=E,R=E);return Cr&&ih(w,P),N}for(E=n(w,E);P<x.length;P++)D=m(E,w,P,x[P],S),D!==null&&(t&&D.alternate!==null&&E.delete(D.key===null?P:D.key),v=s(D,v,P),R===null?N=D:R.sibling=D,R=D);return t&&E.forEach(function(Z){return e(w,Z)}),Cr&&ih(w,P),N}function p(w,v,x,S){var N=wp(x);if(typeof N!="function")throw Error(ge(150));if(x=N.call(x),x==null)throw Error(ge(151));for(var R=N=null,E=v,P=v=0,D=null,H=x.next();E!==null&&!H.done;P++,H=x.next()){E.index>P?(D=E,E=null):D=E.sibling;var Z=h(w,E,H.value,S);if(Z===null){E===null&&(E=D);break}t&&E&&Z.alternate===null&&e(w,E),v=s(Z,v,P),R===null?N=Z:R.sibling=Z,R=Z,E=D}if(H.done)return r(w,E),Cr&&ih(w,P),N;if(E===null){for(;!H.done;P++,H=x.next())H=f(w,H.value,S),H!==null&&(v=s(H,v,P),R===null?N=H:R.sibling=H,R=H);return Cr&&ih(w,P),N}for(E=n(w,E);!H.done;P++,H=x.next())H=m(E,w,P,H.value,S),H!==null&&(t&&H.alternate!==null&&E.delete(H.key===null?P:H.key),v=s(H,v,P),R===null?N=H:R.sibling=H,R=H);return t&&E.forEach(function(I){return e(w,I)}),Cr&&ih(w,P),N}function y(w,v,x,S){if(typeof x=="object"&&x!==null&&x.type===Ag&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case kw:e:{for(var N=x.key,R=v;R!==null;){if(R.key===N){if(N=x.type,N===Ag){if(R.tag===7){r(w,R.sibling),v=i(R,x.props.children),v.return=w,w=v;break e}}else if(R.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===wu&&DD(N)===R.type){r(w,R.sibling),v=i(R,x.props),v.ref=_p(w,R,x),v.return=w,w=v;break e}r(w,R);break}else e(w,R);R=R.sibling}x.type===Ag?(v=Hh(x.props.children,w.mode,S,x.key),v.return=w,w=v):(S=iS(x.type,x.key,x.props,null,w.mode,S),S.ref=_p(w,v,x),S.return=w,w=S)}return o(w);case Mg:e:{for(R=x.key;v!==null;){if(v.key===R)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){r(w,v.sibling),v=i(v,x.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else e(w,v);v=v.sibling}v=rE(x,w.mode,S),v.return=w,w=v}return o(w);case wu:return R=x._init,y(w,v,R(x._payload),S)}if(I0(x))return g(w,v,x,S);if(wp(x))return p(w,v,x,S);Lw(w,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(r(w,v.sibling),v=i(v,x),v.return=w,w=v):(r(w,v),v=tE(x,w.mode,S),v.return=w,w=v),o(w)):r(w,v)}return y}var Nm=B5(!0),W5=B5(!1),iC=ld(null),sC=null,Fg=null,QA=null;function JA(){QA=Fg=sC=null}function ZA(t){var e=iC.current;gr(iC),t._currentValue=e}function fP(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function om(t,e){sC=t,QA=Fg=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(hs=!0),t.firstContext=null)}function To(t){var e=t._currentValue;if(QA!==t)if(t={context:t,memoizedValue:e,next:null},Fg===null){if(sC===null)throw Error(ge(308));Fg=t,sC.dependencies={lanes:0,firstContext:t}}else Fg=Fg.next=t;return e}var bh=null;function eO(t){bh===null?bh=[t]:bh.push(t)}function z5(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,eO(e)):(r.next=i.next,i.next=r),e.interleaved=r,kc(t,n)}function kc(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var bu=!1;function tO(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U5(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function bc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zu(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,kt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,kc(t,r)}return i=n.interleaved,i===null?(e.next=e,eO(n)):(e.next=i.next,i.next=e),n.interleaved=e,kc(t,r)}function Jx(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,FA(t,r)}}function LD(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function oC(t,e,r,n){var i=t.updateQueue;bu=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,d=u=c=null,a=s;do{var h=a.lane,m=a.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,p=a;switch(h=e,m=r,p.tag){case 1:if(g=p.payload,typeof g=="function"){f=g.call(m,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,h=typeof g=="function"?g.call(m,f,h):g,h==null)break e;f=$r({},f,h);break e;case 2:bu=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else m={eventTime:m,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Uh|=o,t.lanes=o,t.memoizedState=f}}function FD(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ge(191,i));i.call(n)}}}var Ov={},_l=ld(Ov),zy=ld(Ov),Uy=ld(Ov);function xh(t){if(t===Ov)throw Error(ge(174));return t}function rO(t,e){switch(ir(Uy,e),ir(zy,t),ir(_l,Ov),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:GT(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=GT(e,t)}gr(_l),ir(_l,e)}function km(){gr(_l),gr(zy),gr(Uy)}function Y5(t){xh(Uy.current);var e=xh(_l.current),r=GT(e,t.type);e!==r&&(ir(zy,t),ir(_l,r))}function nO(t){zy.current===t&&(gr(_l),gr(zy))}var Mr=ld(0);function aC(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qR=[];function iO(){for(var t=0;t<qR.length;t++)qR[t]._workInProgressVersionPrimary=null;qR.length=0}var Zx=Hc.ReactCurrentDispatcher,XR=Hc.ReactCurrentBatchConfig,zh=0,jr=null,En=null,zn=null,lC=!1,ry=!1,Yy=0,Jre=0;function li(){throw Error(ge(321))}function sO(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!xa(t[r],e[r]))return!1;return!0}function oO(t,e,r,n,i,s){if(zh=s,jr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Zx.current=t===null||t.memoizedState===null?rne:nne,t=r(n,i),ry){s=0;do{if(ry=!1,Yy=0,25<=s)throw Error(ge(301));s+=1,zn=En=null,e.updateQueue=null,Zx.current=ine,t=r(n,i)}while(ry)}if(Zx.current=cC,e=En!==null&&En.next!==null,zh=0,zn=En=jr=null,lC=!1,e)throw Error(ge(300));return t}function aO(){var t=Yy!==0;return Yy=0,t}function ol(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?jr.memoizedState=zn=t:zn=zn.next=t,zn}function Po(){if(En===null){var t=jr.alternate;t=t!==null?t.memoizedState:null}else t=En.next;var e=zn===null?jr.memoizedState:zn.next;if(e!==null)zn=e,En=t;else{if(t===null)throw Error(ge(310));En=t,t={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null},zn===null?jr.memoizedState=zn=t:zn=zn.next=t}return zn}function Gy(t,e){return typeof e=="function"?e(t):e}function QR(t){var e=Po(),r=e.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=t;var n=En,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,c=null,u=s;do{var d=u.lane;if((zh&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=f,o=n):c=c.next=f,jr.lanes|=d,Uh|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=a,xa(n,e.memoizedState)||(hs=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,jr.lanes|=s,Uh|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function JR(t){var e=Po(),r=e.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);xa(s,e.memoizedState)||(hs=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function G5(){}function K5(t,e){var r=jr,n=Po(),i=e(),s=!xa(n.memoizedState,i);if(s&&(n.memoizedState=i,hs=!0),n=n.queue,lO(Q5.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||zn!==null&&zn.memoizedState.tag&1){if(r.flags|=2048,Ky(9,X5.bind(null,r,n,i,e),void 0,null),Yn===null)throw Error(ge(349));zh&30||q5(r,e,i)}return i}function q5(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=jr.updateQueue,e===null?(e={lastEffect:null,stores:null},jr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function X5(t,e,r,n){e.value=r,e.getSnapshot=n,J5(e)&&Z5(t)}function Q5(t,e,r){return r(function(){J5(e)&&Z5(t)})}function J5(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!xa(t,r)}catch{return!0}}function Z5(t){var e=kc(t,1);e!==null&&va(e,t,1,-1)}function VD(t){var e=ol();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gy,lastRenderedState:t},e.queue=t,t=t.dispatch=tne.bind(null,jr,t),[e.memoizedState,t]}function Ky(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=jr.updateQueue,e===null?(e={lastEffect:null,stores:null},jr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function ez(){return Po().memoizedState}function eS(t,e,r,n){var i=ol();jr.flags|=t,i.memoizedState=Ky(1|e,r,void 0,n===void 0?null:n)}function K1(t,e,r,n){var i=Po();n=n===void 0?null:n;var s=void 0;if(En!==null){var o=En.memoizedState;if(s=o.destroy,n!==null&&sO(n,o.deps)){i.memoizedState=Ky(e,r,s,n);return}}jr.flags|=t,i.memoizedState=Ky(1|e,r,s,n)}function BD(t,e){return eS(8390656,8,t,e)}function lO(t,e){return K1(2048,8,t,e)}function tz(t,e){return K1(4,2,t,e)}function rz(t,e){return K1(4,4,t,e)}function nz(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function iz(t,e,r){return r=r!=null?r.concat([t]):null,K1(4,4,nz.bind(null,e,t),r)}function cO(){}function sz(t,e){var r=Po();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&sO(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function oz(t,e){var r=Po();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&sO(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function az(t,e,r){return zh&21?(xa(r,e)||(r=h5(),jr.lanes|=r,Uh|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,hs=!0),t.memoizedState=r)}function Zre(t,e){var r=Ut;Ut=r!==0&&4>r?r:4,t(!0);var n=XR.transition;XR.transition={};try{t(!1),e()}finally{Ut=r,XR.transition=n}}function lz(){return Po().memoizedState}function ene(t,e,r){var n=Yu(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},cz(t))uz(e,r);else if(r=z5(t,e,r,n),r!==null){var i=Li();va(r,t,n,i),dz(r,e,n)}}function tne(t,e,r){var n=Yu(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(cz(t))uz(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,xa(a,o)){var c=e.interleaved;c===null?(i.next=i,eO(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=z5(t,e,i,n),r!==null&&(i=Li(),va(r,t,n,i),dz(r,e,n))}}function cz(t){var e=t.alternate;return t===jr||e!==null&&e===jr}function uz(t,e){ry=lC=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function dz(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,FA(t,r)}}var cC={readContext:To,useCallback:li,useContext:li,useEffect:li,useImperativeHandle:li,useInsertionEffect:li,useLayoutEffect:li,useMemo:li,useReducer:li,useRef:li,useState:li,useDebugValue:li,useDeferredValue:li,useTransition:li,useMutableSource:li,useSyncExternalStore:li,useId:li,unstable_isNewReconciler:!1},rne={readContext:To,useCallback:function(t,e){return ol().memoizedState=[t,e===void 0?null:e],t},useContext:To,useEffect:BD,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,eS(4194308,4,nz.bind(null,e,t),r)},useLayoutEffect:function(t,e){return eS(4194308,4,t,e)},useInsertionEffect:function(t,e){return eS(4,2,t,e)},useMemo:function(t,e){var r=ol();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=ol();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=ene.bind(null,jr,t),[n.memoizedState,t]},useRef:function(t){var e=ol();return t={current:t},e.memoizedState=t},useState:VD,useDebugValue:cO,useDeferredValue:function(t){return ol().memoizedState=t},useTransition:function(){var t=VD(!1),e=t[0];return t=Zre.bind(null,t[1]),ol().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=jr,i=ol();if(Cr){if(r===void 0)throw Error(ge(407));r=r()}else{if(r=e(),Yn===null)throw Error(ge(349));zh&30||q5(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,BD(Q5.bind(null,n,s,t),[t]),n.flags|=2048,Ky(9,X5.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=ol(),e=Yn.identifierPrefix;if(Cr){var r=hc,n=dc;r=(n&~(1<<32-ya(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Yy++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Jre++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nne={readContext:To,useCallback:sz,useContext:To,useEffect:lO,useImperativeHandle:iz,useInsertionEffect:tz,useLayoutEffect:rz,useMemo:oz,useReducer:QR,useRef:ez,useState:function(){return QR(Gy)},useDebugValue:cO,useDeferredValue:function(t){var e=Po();return az(e,En.memoizedState,t)},useTransition:function(){var t=QR(Gy)[0],e=Po().memoizedState;return[t,e]},useMutableSource:G5,useSyncExternalStore:K5,useId:lz,unstable_isNewReconciler:!1},ine={readContext:To,useCallback:sz,useContext:To,useEffect:lO,useImperativeHandle:iz,useInsertionEffect:tz,useLayoutEffect:rz,useMemo:oz,useReducer:JR,useRef:ez,useState:function(){return JR(Gy)},useDebugValue:cO,useDeferredValue:function(t){var e=Po();return En===null?e.memoizedState=t:az(e,En.memoizedState,t)},useTransition:function(){var t=JR(Gy)[0],e=Po().memoizedState;return[t,e]},useMutableSource:G5,useSyncExternalStore:K5,useId:lz,unstable_isNewReconciler:!1};function ia(t,e){if(t&&t.defaultProps){e=$r({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function gP(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:$r({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var q1={isMounted:function(t){return(t=t._reactInternals)?cf(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Li(),i=Yu(t),s=bc(n,i);s.payload=e,r!=null&&(s.callback=r),e=zu(t,s,i),e!==null&&(va(e,t,i,n),Jx(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Li(),i=Yu(t),s=bc(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=zu(t,s,i),e!==null&&(va(e,t,i,n),Jx(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Li(),n=Yu(t),i=bc(r,n);i.tag=2,e!=null&&(i.callback=e),e=zu(t,i,n),e!==null&&(va(e,t,n,r),Jx(e,t,n))}};function WD(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Fy(r,n)||!Fy(i,s):!0}function hz(t,e,r){var n=!1,i=rd,s=e.contextType;return typeof s=="object"&&s!==null?s=To(s):(i=ps(e)?Bh:Ci.current,n=e.contextTypes,s=(n=n!=null)?Rm(t,i):rd),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=q1,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function zD(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&q1.enqueueReplaceState(e,e.state,null)}function mP(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},tO(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=To(s):(s=ps(e)?Bh:Ci.current,i.context=Rm(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(gP(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&q1.enqueueReplaceState(i,i.state,null),oC(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Tm(t,e){try{var r="",n=e;do r+=Ate(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function ZR(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function pP(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var sne=typeof WeakMap=="function"?WeakMap:Map;function fz(t,e,r){r=bc(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){dC||(dC=!0,EP=n),pP(t,e)},r}function gz(t,e,r){r=bc(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){pP(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){pP(t,e),typeof n!="function"&&(Uu===null?Uu=new Set([this]):Uu.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function UD(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new sne;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=wne.bind(null,t,e,r),e.then(t,t))}function YD(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function GD(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=bc(-1,1),e.tag=2,zu(r,e,1))),r.lanes|=1),t)}var one=Hc.ReactCurrentOwner,hs=!1;function Oi(t,e,r,n){e.child=t===null?W5(e,null,r,n):Nm(e,t.child,r,n)}function KD(t,e,r,n,i){r=r.render;var s=e.ref;return om(e,i),n=oO(t,e,r,n,s,i),r=aO(),t!==null&&!hs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Tc(t,e,i)):(Cr&&r&&KA(e),e.flags|=1,Oi(t,e,n,i),e.child)}function qD(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!yO(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,mz(t,e,s,n,i)):(t=iS(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Fy,r(o,n)&&t.ref===e.ref)return Tc(t,e,i)}return e.flags|=1,t=Gu(s,n),t.ref=e.ref,t.return=e,e.child=t}function mz(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Fy(s,n)&&t.ref===e.ref)if(hs=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(hs=!0);else return e.lanes=t.lanes,Tc(t,e,i)}return yP(t,e,r,n,i)}function pz(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ir(Bg,Bs),Bs|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ir(Bg,Bs),Bs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ir(Bg,Bs),Bs|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,ir(Bg,Bs),Bs|=n;return Oi(t,e,i,r),e.child}function yz(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function yP(t,e,r,n,i){var s=ps(r)?Bh:Ci.current;return s=Rm(e,s),om(e,i),r=oO(t,e,r,n,s,i),n=aO(),t!==null&&!hs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Tc(t,e,i)):(Cr&&n&&KA(e),e.flags|=1,Oi(t,e,r,i),e.child)}function XD(t,e,r,n,i){if(ps(r)){var s=!0;tC(e)}else s=!1;if(om(e,i),e.stateNode===null)tS(t,e),hz(e,r,n),mP(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=To(u):(u=ps(r)?Bh:Ci.current,u=Rm(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==u)&&zD(e,o,n,u),bu=!1;var h=e.memoizedState;o.state=h,oC(e,n,o,i),c=e.memoizedState,a!==n||h!==c||ms.current||bu?(typeof d=="function"&&(gP(e,r,d,n),c=e.memoizedState),(a=bu||WD(e,r,a,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,U5(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:ia(e.type,a),o.props=u,f=e.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=To(c):(c=ps(r)?Bh:Ci.current,c=Rm(e,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==c)&&zD(e,o,n,c),bu=!1,h=e.memoizedState,o.state=h,oC(e,n,o,i);var g=e.memoizedState;a!==f||h!==g||ms.current||bu?(typeof m=="function"&&(gP(e,r,m,n),g=e.memoizedState),(u=bu||WD(e,r,u,n,h,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),o.props=n,o.state=g,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return vP(t,e,r,n,s,i)}function vP(t,e,r,n,i,s){yz(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&jD(e,r,!1),Tc(t,e,s);n=e.stateNode,one.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Nm(e,t.child,null,s),e.child=Nm(e,null,a,s)):Oi(t,e,a,s),e.memoizedState=n.state,i&&jD(e,r,!0),e.child}function vz(t){var e=t.stateNode;e.pendingContext?ID(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ID(t,e.context,!1),rO(t,e.containerInfo)}function QD(t,e,r,n,i){return Em(),XA(i),e.flags|=256,Oi(t,e,r,n),e.child}var wP={dehydrated:null,treeContext:null,retryLane:0};function bP(t){return{baseLanes:t,cachePool:null,transitions:null}}function wz(t,e,r){var n=e.pendingProps,i=Mr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ir(Mr,i&1),t===null)return hP(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=J1(o,n,0,null),t=Hh(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=bP(r),e.memoizedState=wP,t):uO(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ane(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Gu(i,c),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Gu(a,s):(s=Hh(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?bP(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=wP,n}return s=t.child,t=s.sibling,n=Gu(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function uO(t,e){return e=J1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fw(t,e,r,n){return n!==null&&XA(n),Nm(e,t.child,null,r),t=uO(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ane(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=ZR(Error(ge(422))),Fw(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=J1({mode:"visible",children:n.children},i,0,null),s=Hh(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Nm(e,t.child,null,o),e.child.memoizedState=bP(o),e.memoizedState=wP,s);if(!(e.mode&1))return Fw(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(ge(419)),n=ZR(s,n,void 0),Fw(t,e,o,n)}if(a=(o&t.childLanes)!==0,hs||a){if(n=Yn,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,kc(t,i),va(n,t,i,-1))}return pO(),n=ZR(Error(ge(421))),Fw(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=bne.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ys=Wu(i.nextSibling),qs=e,Cr=!0,da=null,t!==null&&(xo[So++]=dc,xo[So++]=hc,xo[So++]=Wh,dc=t.id,hc=t.overflow,Wh=e),e=uO(e,n.children),e.flags|=4096,e)}function JD(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),fP(t.return,e,r)}function eE(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function bz(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Oi(t,e,n.children,r),n=Mr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&JD(t,r,e);else if(t.tag===19)JD(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ir(Mr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&aC(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),eE(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&aC(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}eE(e,!0,r,null,s);break;case"together":eE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function tS(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Tc(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Uh|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ge(153));if(e.child!==null){for(t=e.child,r=Gu(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Gu(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function lne(t,e,r){switch(e.tag){case 3:vz(e),Em();break;case 5:Y5(e);break;case 1:ps(e.type)&&tC(e);break;case 4:rO(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ir(iC,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ir(Mr,Mr.current&1),e.flags|=128,null):r&e.child.childLanes?wz(t,e,r):(ir(Mr,Mr.current&1),t=Tc(t,e,r),t!==null?t.sibling:null);ir(Mr,Mr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return bz(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ir(Mr,Mr.current),n)break;return null;case 22:case 23:return e.lanes=0,pz(t,e,r)}return Tc(t,e,r)}var xz,xP,Sz,Cz;xz=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};xP=function(){};Sz=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,xh(_l.current);var s=null;switch(r){case"input":i=WT(t,i),n=WT(t,n),s=[];break;case"select":i=$r({},i,{value:void 0}),n=$r({},n,{value:void 0}),s=[];break;case"textarea":i=YT(t,i),n=YT(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=ZS)}KT(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Oy.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Oy.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ur("scroll",t),s||a===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Cz=function(t,e,r,n){r!==n&&(e.flags|=4)};function Rp(t,e){if(!Cr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ci(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function cne(t,e,r){var n=e.pendingProps;switch(qA(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ci(e),null;case 1:return ps(e.type)&&eC(),ci(e),null;case 3:return n=e.stateNode,km(),gr(ms),gr(Ci),iO(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Dw(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,da!==null&&(TP(da),da=null))),xP(t,e),ci(e),null;case 5:nO(e);var i=xh(Uy.current);if(r=e.type,t!==null&&e.stateNode!=null)Sz(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ge(166));return ci(e),null}if(t=xh(_l.current),Dw(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[pl]=e,n[Wy]=s,t=(e.mode&1)!==0,r){case"dialog":ur("cancel",n),ur("close",n);break;case"iframe":case"object":case"embed":ur("load",n);break;case"video":case"audio":for(i=0;i<H0.length;i++)ur(H0[i],n);break;case"source":ur("error",n);break;case"img":case"image":case"link":ur("error",n),ur("load",n);break;case"details":ur("toggle",n);break;case"input":aD(n,s),ur("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ur("invalid",n);break;case"textarea":cD(n,s),ur("invalid",n)}KT(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&$w(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&$w(n.textContent,a,t),i=["children",""+a]):Oy.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ur("scroll",n)}switch(r){case"input":Tw(n),lD(n,s,!0);break;case"textarea":Tw(n),uD(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ZS)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=QW(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[pl]=e,t[Wy]=n,xz(t,e,!1,!1),e.stateNode=t;e:{switch(o=qT(r,n),r){case"dialog":ur("cancel",t),ur("close",t),i=n;break;case"iframe":case"object":case"embed":ur("load",t),i=n;break;case"video":case"audio":for(i=0;i<H0.length;i++)ur(H0[i],t);i=n;break;case"source":ur("error",t),i=n;break;case"img":case"image":case"link":ur("error",t),ur("load",t),i=n;break;case"details":ur("toggle",t),i=n;break;case"input":aD(t,n),i=WT(t,n),ur("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=$r({},n,{value:void 0}),ur("invalid",t);break;case"textarea":cD(t,n),i=YT(t,n),ur("invalid",t);break;default:i=n}KT(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?e5(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&JW(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Iy(t,c):typeof c=="number"&&Iy(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Oy.hasOwnProperty(s)?c!=null&&s==="onScroll"&&ur("scroll",t):c!=null&&IA(t,s,c,o))}switch(r){case"input":Tw(t),lD(t,n,!1);break;case"textarea":Tw(t),uD(t);break;case"option":n.value!=null&&t.setAttribute("value",""+td(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?rm(t,!!n.multiple,s,!1):n.defaultValue!=null&&rm(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ZS)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ci(e),null;case 6:if(t&&e.stateNode!=null)Cz(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ge(166));if(r=xh(Uy.current),xh(_l.current),Dw(e)){if(n=e.stateNode,r=e.memoizedProps,n[pl]=e,(s=n.nodeValue!==r)&&(t=qs,t!==null))switch(t.tag){case 3:$w(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$w(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[pl]=e,e.stateNode=n}return ci(e),null;case 13:if(gr(Mr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Cr&&Ys!==null&&e.mode&1&&!(e.flags&128))V5(),Em(),e.flags|=98560,s=!1;else if(s=Dw(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(ge(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ge(317));s[pl]=e}else Em(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ci(e),s=!1}else da!==null&&(TP(da),da=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Mr.current&1?kn===0&&(kn=3):pO())),e.updateQueue!==null&&(e.flags|=4),ci(e),null);case 4:return km(),xP(t,e),t===null&&Vy(e.stateNode.containerInfo),ci(e),null;case 10:return ZA(e.type._context),ci(e),null;case 17:return ps(e.type)&&eC(),ci(e),null;case 19:if(gr(Mr),s=e.memoizedState,s===null)return ci(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)Rp(s,!1);else{if(kn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=aC(t),o!==null){for(e.flags|=128,Rp(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ir(Mr,Mr.current&1|2),e.child}t=t.sibling}s.tail!==null&&nn()>Pm&&(e.flags|=128,n=!0,Rp(s,!1),e.lanes=4194304)}else{if(!n)if(t=aC(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Rp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Cr)return ci(e),null}else 2*nn()-s.renderingStartTime>Pm&&r!==1073741824&&(e.flags|=128,n=!0,Rp(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=nn(),e.sibling=null,r=Mr.current,ir(Mr,n?r&1|2:r&1),e):(ci(e),null);case 22:case 23:return mO(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Bs&1073741824&&(ci(e),e.subtreeFlags&6&&(e.flags|=8192)):ci(e),null;case 24:return null;case 25:return null}throw Error(ge(156,e.tag))}function une(t,e){switch(qA(e),e.tag){case 1:return ps(e.type)&&eC(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return km(),gr(ms),gr(Ci),iO(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return nO(e),null;case 13:if(gr(Mr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ge(340));Em()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gr(Mr),null;case 4:return km(),null;case 10:return ZA(e.type._context),null;case 22:case 23:return mO(),null;case 24:return null;default:return null}}var Vw=!1,vi=!1,dne=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function Vg(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Gr(t,e,n)}else r.current=null}function SP(t,e,r){try{r()}catch(n){Gr(t,e,n)}}var ZD=!1;function hne(t,e){if(sP=XS,t=k5(),GA(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,c=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var m;f!==r||i!==0&&f.nodeType!==3||(a=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===r&&++u===i&&(a=o),h===s&&++d===n&&(c=o),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(oP={focusedElem:t,selectionRange:r},XS=!1,Pe=e;Pe!==null;)if(e=Pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Pe=t;else for(;Pe!==null;){e=Pe;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,y=g.memoizedState,w=e.stateNode,v=w.getSnapshotBeforeUpdate(e.elementType===e.type?p:ia(e.type,p),y);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(S){Gr(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Pe=t;break}Pe=e.return}return g=ZD,ZD=!1,g}function ny(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&SP(e,r,s)}i=i.next}while(i!==n)}}function X1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function CP(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function _z(t){var e=t.alternate;e!==null&&(t.alternate=null,_z(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[pl],delete e[Wy],delete e[cP],delete e[Kre],delete e[qre])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Rz(t){return t.tag===5||t.tag===3||t.tag===4}function eL(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Rz(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _P(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=ZS));else if(n!==4&&(t=t.child,t!==null))for(_P(t,e,r),t=t.sibling;t!==null;)_P(t,e,r),t=t.sibling}function RP(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(RP(t,e,r),t=t.sibling;t!==null;)RP(t,e,r),t=t.sibling}var Qn=null,la=!1;function Gc(t,e,r){for(r=r.child;r!==null;)Ez(t,e,r),r=r.sibling}function Ez(t,e,r){if(Cl&&typeof Cl.onCommitFiberUnmount=="function")try{Cl.onCommitFiberUnmount(B1,r)}catch{}switch(r.tag){case 5:vi||Vg(r,e);case 6:var n=Qn,i=la;Qn=null,Gc(t,e,r),Qn=n,la=i,Qn!==null&&(la?(t=Qn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Qn.removeChild(r.stateNode));break;case 18:Qn!==null&&(la?(t=Qn,r=r.stateNode,t.nodeType===8?GR(t.parentNode,r):t.nodeType===1&&GR(t,r),Dy(t)):GR(Qn,r.stateNode));break;case 4:n=Qn,i=la,Qn=r.stateNode.containerInfo,la=!0,Gc(t,e,r),Qn=n,la=i;break;case 0:case 11:case 14:case 15:if(!vi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&SP(r,e,o),i=i.next}while(i!==n)}Gc(t,e,r);break;case 1:if(!vi&&(Vg(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Gr(r,e,a)}Gc(t,e,r);break;case 21:Gc(t,e,r);break;case 22:r.mode&1?(vi=(n=vi)||r.memoizedState!==null,Gc(t,e,r),vi=n):Gc(t,e,r);break;default:Gc(t,e,r)}}function tL(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new dne),e.forEach(function(n){var i=xne.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Bo(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Qn=a.stateNode,la=!1;break e;case 3:Qn=a.stateNode.containerInfo,la=!0;break e;case 4:Qn=a.stateNode.containerInfo,la=!0;break e}a=a.return}if(Qn===null)throw Error(ge(160));Ez(s,o,i),Qn=null,la=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Gr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Nz(e,t),e=e.sibling}function Nz(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Bo(e,t),Ha(t),n&4){try{ny(3,t,t.return),X1(3,t)}catch(p){Gr(t,t.return,p)}try{ny(5,t,t.return)}catch(p){Gr(t,t.return,p)}}break;case 1:Bo(e,t),Ha(t),n&512&&r!==null&&Vg(r,r.return);break;case 5:if(Bo(e,t),Ha(t),n&512&&r!==null&&Vg(r,r.return),t.flags&32){var i=t.stateNode;try{Iy(i,"")}catch(p){Gr(t,t.return,p)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&qW(i,s),qT(a,o);var u=qT(a,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?e5(i,f):d==="dangerouslySetInnerHTML"?JW(i,f):d==="children"?Iy(i,f):IA(i,d,f,u)}switch(a){case"input":zT(i,s);break;case"textarea":XW(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?rm(i,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?rm(i,!!s.multiple,s.defaultValue,!0):rm(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wy]=s}catch(p){Gr(t,t.return,p)}}break;case 6:if(Bo(e,t),Ha(t),n&4){if(t.stateNode===null)throw Error(ge(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(p){Gr(t,t.return,p)}}break;case 3:if(Bo(e,t),Ha(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Dy(e.containerInfo)}catch(p){Gr(t,t.return,p)}break;case 4:Bo(e,t),Ha(t);break;case 13:Bo(e,t),Ha(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(fO=nn())),n&4&&tL(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(vi=(u=vi)||d,Bo(e,t),vi=u):Bo(e,t),Ha(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Pe=t,d=t.child;d!==null;){for(f=Pe=d;Pe!==null;){switch(h=Pe,m=h.child,h.tag){case 0:case 11:case 14:case 15:ny(4,h,h.return);break;case 1:Vg(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(p){Gr(n,r,p)}}break;case 5:Vg(h,h.return);break;case 22:if(h.memoizedState!==null){nL(f);continue}}m!==null?(m.return=h,Pe=m):nL(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=ZW("display",o))}catch(p){Gr(t,t.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Gr(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Bo(e,t),Ha(t),n&4&&tL(t);break;case 21:break;default:Bo(e,t),Ha(t)}}function Ha(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Rz(r)){var n=r;break e}r=r.return}throw Error(ge(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Iy(i,""),n.flags&=-33);var s=eL(t);RP(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=eL(t);_P(t,a,o);break;default:throw Error(ge(161))}}catch(c){Gr(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function fne(t,e,r){Pe=t,kz(t)}function kz(t,e,r){for(var n=(t.mode&1)!==0;Pe!==null;){var i=Pe,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Vw;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||vi;a=Vw;var u=vi;if(Vw=o,(vi=c)&&!u)for(Pe=i;Pe!==null;)o=Pe,c=o.child,o.tag===22&&o.memoizedState!==null?iL(i):c!==null?(c.return=o,Pe=c):iL(i);for(;s!==null;)Pe=s,kz(s),s=s.sibling;Pe=i,Vw=a,vi=u}rL(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Pe=s):rL(t)}}function rL(t){for(;Pe!==null;){var e=Pe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vi||X1(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!vi)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ia(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&FD(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}FD(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Dy(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}vi||e.flags&512&&CP(e)}catch(h){Gr(e,e.return,h)}}if(e===t){Pe=null;break}if(r=e.sibling,r!==null){r.return=e.return,Pe=r;break}Pe=e.return}}function nL(t){for(;Pe!==null;){var e=Pe;if(e===t){Pe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Pe=r;break}Pe=e.return}}function iL(t){for(;Pe!==null;){var e=Pe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{X1(4,e)}catch(c){Gr(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){Gr(e,i,c)}}var s=e.return;try{CP(e)}catch(c){Gr(e,s,c)}break;case 5:var o=e.return;try{CP(e)}catch(c){Gr(e,o,c)}}}catch(c){Gr(e,e.return,c)}if(e===t){Pe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Pe=a;break}Pe=e.return}}var gne=Math.ceil,uC=Hc.ReactCurrentDispatcher,dO=Hc.ReactCurrentOwner,No=Hc.ReactCurrentBatchConfig,kt=0,Yn=null,pn=null,ti=0,Bs=0,Bg=ld(0),kn=0,qy=null,Uh=0,Q1=0,hO=0,iy=null,ds=null,fO=0,Pm=1/0,ic=null,dC=!1,EP=null,Uu=null,Bw=!1,Au=null,hC=0,sy=0,NP=null,rS=-1,nS=0;function Li(){return kt&6?nn():rS!==-1?rS:rS=nn()}function Yu(t){return t.mode&1?kt&2&&ti!==0?ti&-ti:Qre.transition!==null?(nS===0&&(nS=h5()),nS):(t=Ut,t!==0||(t=window.event,t=t===void 0?16:w5(t.type)),t):1}function va(t,e,r,n){if(50<sy)throw sy=0,NP=null,Error(ge(185));Pv(t,r,n),(!(kt&2)||t!==Yn)&&(t===Yn&&(!(kt&2)&&(Q1|=r),kn===4&&Eu(t,ti)),ys(t,n),r===1&&kt===0&&!(e.mode&1)&&(Pm=nn()+500,G1&&cd()))}function ys(t,e){var r=t.callbackNode;Qte(t,e);var n=qS(t,t===Yn?ti:0);if(n===0)r!==null&&fD(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&fD(r),e===1)t.tag===0?Xre(sL.bind(null,t)):D5(sL.bind(null,t)),Yre(function(){!(kt&6)&&cd()}),r=null;else{switch(f5(n)){case 1:r=LA;break;case 4:r=u5;break;case 16:r=KS;break;case 536870912:r=d5;break;default:r=KS}r=Hz(r,Tz.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Tz(t,e){if(rS=-1,nS=0,kt&6)throw Error(ge(327));var r=t.callbackNode;if(am()&&t.callbackNode!==r)return null;var n=qS(t,t===Yn?ti:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=fC(t,n);else{e=n;var i=kt;kt|=2;var s=Mz();(Yn!==t||ti!==e)&&(ic=null,Pm=nn()+500,jh(t,e));do try{yne();break}catch(a){Pz(t,a)}while(!0);JA(),uC.current=s,kt=i,pn!==null?e=0:(Yn=null,ti=0,e=kn)}if(e!==0){if(e===2&&(i=eP(t),i!==0&&(n=i,e=kP(t,i))),e===1)throw r=qy,jh(t,0),Eu(t,n),ys(t,nn()),r;if(e===6)Eu(t,n);else{if(i=t.current.alternate,!(n&30)&&!mne(i)&&(e=fC(t,n),e===2&&(s=eP(t),s!==0&&(n=s,e=kP(t,s))),e===1))throw r=qy,jh(t,0),Eu(t,n),ys(t,nn()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ge(345));case 2:sh(t,ds,ic);break;case 3:if(Eu(t,n),(n&130023424)===n&&(e=fO+500-nn(),10<e)){if(qS(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Li(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=lP(sh.bind(null,t,ds,ic),e);break}sh(t,ds,ic);break;case 4:if(Eu(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-ya(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=nn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gne(n/1960))-n,10<n){t.timeoutHandle=lP(sh.bind(null,t,ds,ic),n);break}sh(t,ds,ic);break;case 5:sh(t,ds,ic);break;default:throw Error(ge(329))}}}return ys(t,nn()),t.callbackNode===r?Tz.bind(null,t):null}function kP(t,e){var r=iy;return t.current.memoizedState.isDehydrated&&(jh(t,e).flags|=256),t=fC(t,e),t!==2&&(e=ds,ds=r,e!==null&&TP(e)),t}function TP(t){ds===null?ds=t:ds.push.apply(ds,t)}function mne(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!xa(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Eu(t,e){for(e&=~hO,e&=~Q1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ya(e),n=1<<r;t[r]=-1,e&=~n}}function sL(t){if(kt&6)throw Error(ge(327));am();var e=qS(t,0);if(!(e&1))return ys(t,nn()),null;var r=fC(t,e);if(t.tag!==0&&r===2){var n=eP(t);n!==0&&(e=n,r=kP(t,n))}if(r===1)throw r=qy,jh(t,0),Eu(t,e),ys(t,nn()),r;if(r===6)throw Error(ge(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,sh(t,ds,ic),ys(t,nn()),null}function gO(t,e){var r=kt;kt|=1;try{return t(e)}finally{kt=r,kt===0&&(Pm=nn()+500,G1&&cd())}}function Yh(t){Au!==null&&Au.tag===0&&!(kt&6)&&am();var e=kt;kt|=1;var r=No.transition,n=Ut;try{if(No.transition=null,Ut=1,t)return t()}finally{Ut=n,No.transition=r,kt=e,!(kt&6)&&cd()}}function mO(){Bs=Bg.current,gr(Bg)}function jh(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Ure(r)),pn!==null)for(r=pn.return;r!==null;){var n=r;switch(qA(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&eC();break;case 3:km(),gr(ms),gr(Ci),iO();break;case 5:nO(n);break;case 4:km();break;case 13:gr(Mr);break;case 19:gr(Mr);break;case 10:ZA(n.type._context);break;case 22:case 23:mO()}r=r.return}if(Yn=t,pn=t=Gu(t.current,null),ti=Bs=e,kn=0,qy=null,hO=Q1=Uh=0,ds=iy=null,bh!==null){for(e=0;e<bh.length;e++)if(r=bh[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}bh=null}return t}function Pz(t,e){do{var r=pn;try{if(JA(),Zx.current=cC,lC){for(var n=jr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}lC=!1}if(zh=0,zn=En=jr=null,ry=!1,Yy=0,dO.current=null,r===null||r.return===null){kn=1,qy=e,pn=null;break}e:{var s=t,o=r.return,a=r,c=e;if(e=ti,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=YD(o);if(m!==null){m.flags&=-257,GD(m,o,a,s,e),m.mode&1&&UD(s,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var p=new Set;p.add(c),e.updateQueue=p}else g.add(c);break e}else{if(!(e&1)){UD(s,u,e),pO();break e}c=Error(ge(426))}}else if(Cr&&a.mode&1){var y=YD(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),GD(y,o,a,s,e),XA(Tm(c,a));break e}}s=c=Tm(c,a),kn!==4&&(kn=2),iy===null?iy=[s]:iy.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=fz(s,c,e);LD(s,w);break e;case 1:a=c;var v=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Uu===null||!Uu.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=gz(s,a,e);LD(s,S);break e}}s=s.return}while(s!==null)}Oz(r)}catch(N){e=N,pn===r&&r!==null&&(pn=r=r.return);continue}break}while(!0)}function Mz(){var t=uC.current;return uC.current=cC,t===null?cC:t}function pO(){(kn===0||kn===3||kn===2)&&(kn=4),Yn===null||!(Uh&268435455)&&!(Q1&268435455)||Eu(Yn,ti)}function fC(t,e){var r=kt;kt|=2;var n=Mz();(Yn!==t||ti!==e)&&(ic=null,jh(t,e));do try{pne();break}catch(i){Pz(t,i)}while(!0);if(JA(),kt=r,uC.current=n,pn!==null)throw Error(ge(261));return Yn=null,ti=0,kn}function pne(){for(;pn!==null;)Az(pn)}function yne(){for(;pn!==null&&!Bte();)Az(pn)}function Az(t){var e=jz(t.alternate,t,Bs);t.memoizedProps=t.pendingProps,e===null?Oz(t):pn=e,dO.current=null}function Oz(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=une(r,e),r!==null){r.flags&=32767,pn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{kn=6,pn=null;return}}else if(r=cne(r,e,Bs),r!==null){pn=r;return}if(e=e.sibling,e!==null){pn=e;return}pn=e=t}while(e!==null);kn===0&&(kn=5)}function sh(t,e,r){var n=Ut,i=No.transition;try{No.transition=null,Ut=1,vne(t,e,r,n)}finally{No.transition=i,Ut=n}return null}function vne(t,e,r,n){do am();while(Au!==null);if(kt&6)throw Error(ge(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ge(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Jte(t,s),t===Yn&&(pn=Yn=null,ti=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Bw||(Bw=!0,Hz(KS,function(){return am(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=No.transition,No.transition=null;var o=Ut;Ut=1;var a=kt;kt|=4,dO.current=null,hne(t,r),Nz(r,t),Dre(oP),XS=!!sP,oP=sP=null,t.current=r,fne(r),Wte(),kt=a,Ut=o,No.transition=s}else t.current=r;if(Bw&&(Bw=!1,Au=t,hC=i),s=t.pendingLanes,s===0&&(Uu=null),Yte(r.stateNode),ys(t,nn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(dC)throw dC=!1,t=EP,EP=null,t;return hC&1&&t.tag!==0&&am(),s=t.pendingLanes,s&1?t===NP?sy++:(sy=0,NP=t):sy=0,cd(),null}function am(){if(Au!==null){var t=f5(hC),e=No.transition,r=Ut;try{if(No.transition=null,Ut=16>t?16:t,Au===null)var n=!1;else{if(t=Au,Au=null,hC=0,kt&6)throw Error(ge(331));var i=kt;for(kt|=4,Pe=t.current;Pe!==null;){var s=Pe,o=s.child;if(Pe.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(Pe=u;Pe!==null;){var d=Pe;switch(d.tag){case 0:case 11:case 15:ny(8,d,s)}var f=d.child;if(f!==null)f.return=d,Pe=f;else for(;Pe!==null;){d=Pe;var h=d.sibling,m=d.return;if(_z(d),d===u){Pe=null;break}if(h!==null){h.return=m,Pe=h;break}Pe=m}}}var g=s.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var y=p.sibling;p.sibling=null,p=y}while(p!==null)}}Pe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Pe=o;else e:for(;Pe!==null;){if(s=Pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ny(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Pe=w;break e}Pe=s.return}}var v=t.current;for(Pe=v;Pe!==null;){o=Pe;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,Pe=x;else e:for(o=v;Pe!==null;){if(a=Pe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:X1(9,a)}}catch(N){Gr(a,a.return,N)}if(a===o){Pe=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,Pe=S;break e}Pe=a.return}}if(kt=i,cd(),Cl&&typeof Cl.onPostCommitFiberRoot=="function")try{Cl.onPostCommitFiberRoot(B1,t)}catch{}n=!0}return n}finally{Ut=r,No.transition=e}}return!1}function oL(t,e,r){e=Tm(r,e),e=fz(t,e,1),t=zu(t,e,1),e=Li(),t!==null&&(Pv(t,1,e),ys(t,e))}function Gr(t,e,r){if(t.tag===3)oL(t,t,r);else for(;e!==null;){if(e.tag===3){oL(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Uu===null||!Uu.has(n))){t=Tm(r,t),t=gz(e,t,1),e=zu(e,t,1),t=Li(),e!==null&&(Pv(e,1,t),ys(e,t));break}}e=e.return}}function wne(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Li(),t.pingedLanes|=t.suspendedLanes&r,Yn===t&&(ti&r)===r&&(kn===4||kn===3&&(ti&130023424)===ti&&500>nn()-fO?jh(t,0):hO|=r),ys(t,e)}function Iz(t,e){e===0&&(t.mode&1?(e=Aw,Aw<<=1,!(Aw&130023424)&&(Aw=4194304)):e=1);var r=Li();t=kc(t,e),t!==null&&(Pv(t,e,r),ys(t,r))}function bne(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Iz(t,r)}function xne(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ge(314))}n!==null&&n.delete(e),Iz(t,r)}var jz;jz=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ms.current)hs=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return hs=!1,lne(t,e,r);hs=!!(t.flags&131072)}else hs=!1,Cr&&e.flags&1048576&&L5(e,nC,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;tS(t,e),t=e.pendingProps;var i=Rm(e,Ci.current);om(e,r),i=oO(null,e,n,t,i,r);var s=aO();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ps(n)?(s=!0,tC(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,tO(e),i.updater=q1,e.stateNode=i,i._reactInternals=e,mP(e,n,t,r),e=vP(null,e,n,!0,s,r)):(e.tag=0,Cr&&s&&KA(e),Oi(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(tS(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Cne(n),t=ia(n,t),i){case 0:e=yP(null,e,n,t,r);break e;case 1:e=XD(null,e,n,t,r);break e;case 11:e=KD(null,e,n,t,r);break e;case 14:e=qD(null,e,n,ia(n.type,t),r);break e}throw Error(ge(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ia(n,i),yP(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ia(n,i),XD(t,e,n,i,r);case 3:e:{if(vz(e),t===null)throw Error(ge(387));n=e.pendingProps,s=e.memoizedState,i=s.element,U5(t,e),oC(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Tm(Error(ge(423)),e),e=QD(t,e,n,r,i);break e}else if(n!==i){i=Tm(Error(ge(424)),e),e=QD(t,e,n,r,i);break e}else for(Ys=Wu(e.stateNode.containerInfo.firstChild),qs=e,Cr=!0,da=null,r=W5(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Em(),n===i){e=Tc(t,e,r);break e}Oi(t,e,n,r)}e=e.child}return e;case 5:return Y5(e),t===null&&hP(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,aP(n,i)?o=null:s!==null&&aP(n,s)&&(e.flags|=32),yz(t,e),Oi(t,e,o,r),e.child;case 6:return t===null&&hP(e),null;case 13:return wz(t,e,r);case 4:return rO(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Nm(e,null,n,r):Oi(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ia(n,i),KD(t,e,n,i,r);case 7:return Oi(t,e,e.pendingProps,r),e.child;case 8:return Oi(t,e,e.pendingProps.children,r),e.child;case 12:return Oi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ir(iC,n._currentValue),n._currentValue=o,s!==null)if(xa(s.value,o)){if(s.children===i.children&&!ms.current){e=Tc(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=bc(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),fP(s.return,r,e),a.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ge(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),fP(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Oi(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,om(e,r),i=To(i),n=n(i),e.flags|=1,Oi(t,e,n,r),e.child;case 14:return n=e.type,i=ia(n,e.pendingProps),i=ia(n.type,i),qD(t,e,n,i,r);case 15:return mz(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ia(n,i),tS(t,e),e.tag=1,ps(n)?(t=!0,tC(e)):t=!1,om(e,r),hz(e,n,i),mP(e,n,i,r),vP(null,e,n,!0,t,r);case 19:return bz(t,e,r);case 22:return pz(t,e,r)}throw Error(ge(156,e.tag))};function Hz(t,e){return c5(t,e)}function Sne(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Eo(t,e,r,n){return new Sne(t,e,r,n)}function yO(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Cne(t){if(typeof t=="function")return yO(t)?1:0;if(t!=null){if(t=t.$$typeof,t===HA)return 11;if(t===$A)return 14}return 2}function Gu(t,e){var r=t.alternate;return r===null?(r=Eo(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function iS(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")yO(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ag:return Hh(r.children,i,s,e);case jA:o=8,i|=8;break;case LT:return t=Eo(12,r,e,i|2),t.elementType=LT,t.lanes=s,t;case FT:return t=Eo(13,r,e,i),t.elementType=FT,t.lanes=s,t;case VT:return t=Eo(19,r,e,i),t.elementType=VT,t.lanes=s,t;case YW:return J1(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case zW:o=10;break e;case UW:o=9;break e;case HA:o=11;break e;case $A:o=14;break e;case wu:o=16,n=null;break e}throw Error(ge(130,t==null?t:typeof t,""))}return e=Eo(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Hh(t,e,r,n){return t=Eo(7,t,n,e),t.lanes=r,t}function J1(t,e,r,n){return t=Eo(22,t,n,e),t.elementType=YW,t.lanes=r,t.stateNode={isHidden:!1},t}function tE(t,e,r){return t=Eo(6,t,null,e),t.lanes=r,t}function rE(t,e,r){return e=Eo(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _ne(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=HR(0),this.expirationTimes=HR(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=HR(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function vO(t,e,r,n,i,s,o,a,c){return t=new _ne(t,e,r,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Eo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},tO(s),t}function Rne(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mg,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function $z(t){if(!t)return rd;t=t._reactInternals;e:{if(cf(t)!==t||t.tag!==1)throw Error(ge(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ps(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ge(171))}if(t.tag===1){var r=t.type;if(ps(r))return $5(t,r,e)}return e}function Dz(t,e,r,n,i,s,o,a,c){return t=vO(r,n,!0,t,i,s,o,a,c),t.context=$z(null),r=t.current,n=Li(),i=Yu(r),s=bc(n,i),s.callback=e??null,zu(r,s,i),t.current.lanes=i,Pv(t,i,n),ys(t,n),t}function Z1(t,e,r,n){var i=e.current,s=Li(),o=Yu(i);return r=$z(r),e.context===null?e.context=r:e.pendingContext=r,e=bc(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=zu(i,e,o),t!==null&&(va(t,i,o,s),Jx(t,i,o)),o}function gC(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function aL(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function wO(t,e){aL(t,e),(t=t.alternate)&&aL(t,e)}function Ene(){return null}var Lz=typeof reportError=="function"?reportError:function(t){console.error(t)};function bO(t){this._internalRoot=t}e_.prototype.render=bO.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ge(409));Z1(t,e,null,null)};e_.prototype.unmount=bO.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Yh(function(){Z1(null,t,null,null)}),e[Nc]=null}};function e_(t){this._internalRoot=t}e_.prototype.unstable_scheduleHydration=function(t){if(t){var e=p5();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ru.length&&e!==0&&e<Ru[r].priority;r++);Ru.splice(r,0,t),r===0&&v5(t)}};function xO(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function t_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function lL(){}function Nne(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=gC(o);s.call(u)}}var o=Dz(e,n,t,0,null,!1,!1,"",lL);return t._reactRootContainer=o,t[Nc]=o.current,Vy(t.nodeType===8?t.parentNode:t),Yh(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=gC(c);a.call(u)}}var c=vO(t,0,!1,null,null,!1,!1,"",lL);return t._reactRootContainer=c,t[Nc]=c.current,Vy(t.nodeType===8?t.parentNode:t),Yh(function(){Z1(e,c,r,n)}),c}function r_(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=gC(o);a.call(c)}}Z1(e,o,t,i)}else o=Nne(r,e,t,i,n);return gC(o)}g5=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=j0(e.pendingLanes);r!==0&&(FA(e,r|1),ys(e,nn()),!(kt&6)&&(Pm=nn()+500,cd()))}break;case 13:Yh(function(){var n=kc(t,1);if(n!==null){var i=Li();va(n,t,1,i)}}),wO(t,1)}};VA=function(t){if(t.tag===13){var e=kc(t,134217728);if(e!==null){var r=Li();va(e,t,134217728,r)}wO(t,134217728)}};m5=function(t){if(t.tag===13){var e=Yu(t),r=kc(t,e);if(r!==null){var n=Li();va(r,t,e,n)}wO(t,e)}};p5=function(){return Ut};y5=function(t,e){var r=Ut;try{return Ut=t,e()}finally{Ut=r}};QT=function(t,e,r){switch(e){case"input":if(zT(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Y1(n);if(!i)throw Error(ge(90));KW(n),zT(n,i)}}}break;case"textarea":XW(t,r);break;case"select":e=r.value,e!=null&&rm(t,!!r.multiple,e,!1)}};n5=gO;i5=Yh;var kne={usingClientEntryPoint:!1,Events:[Av,Hg,Y1,t5,r5,gO]},Ep={findFiberByHostInstance:wh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tne={bundleType:Ep.bundleType,version:Ep.version,rendererPackageName:Ep.rendererPackageName,rendererConfig:Ep.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=a5(t),t===null?null:t.stateNode},findFiberByHostInstance:Ep.findFiberByHostInstance||Ene,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ww=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ww.isDisabled&&Ww.supportsFiber)try{B1=Ww.inject(Tne),Cl=Ww}catch{}}Js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kne;Js.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xO(e))throw Error(ge(200));return Rne(t,e,null,r)};Js.createRoot=function(t,e){if(!xO(t))throw Error(ge(299));var r=!1,n="",i=Lz;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=vO(t,1,!1,null,null,r,!1,n,i),t[Nc]=e.current,Vy(t.nodeType===8?t.parentNode:t),new bO(e)};Js.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ge(188)):(t=Object.keys(t).join(","),Error(ge(268,t)));return t=a5(e),t=t===null?null:t.stateNode,t};Js.flushSync=function(t){return Yh(t)};Js.hydrate=function(t,e,r){if(!t_(e))throw Error(ge(200));return r_(null,t,e,!0,r)};Js.hydrateRoot=function(t,e,r){if(!xO(t))throw Error(ge(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Lz;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Dz(e,null,t,1,r??null,i,!1,s,o),t[Nc]=e.current,Vy(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new e_(e)};Js.render=function(t,e,r){if(!t_(e))throw Error(ge(200));return r_(null,t,e,!1,r)};Js.unmountComponentAtNode=function(t){if(!t_(t))throw Error(ge(40));return t._reactRootContainer?(Yh(function(){r_(null,null,t,!1,function(){t._reactRootContainer=null,t[Nc]=null})}),!0):!1};Js.unstable_batchedUpdates=gO;Js.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!t_(r))throw Error(ge(200));if(t==null||t._reactInternals===void 0)throw Error(ge(38));return r_(t,e,r,!1,n)};Js.version="18.3.1-next-f1338f8080-20240426";function Fz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fz)}catch(t){console.error(t)}}Fz(),FW.exports=Js;var Vz=FW.exports;const Bz=bv(Vz);var Np=function(t){return t&&t.Math===Math&&t},ln=Np(typeof globalThis=="object"&&globalThis)||Np(typeof window=="object"&&window)||Np(typeof self=="object"&&self)||Np(typeof ga=="object"&&ga)||Np(typeof ga=="object"&&ga)||function(){return this}()||Function("return this")(),SO={},cn=function(t){try{return!!t()}catch{return!0}},Pne=cn,Io=!Pne(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Mne=cn,n_=!Mne(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Ane=n_,zw=Function.prototype.call,wn=Ane?zw.bind(zw):function(){return zw.apply(zw,arguments)},Wz={},zz={}.propertyIsEnumerable,Uz=Object.getOwnPropertyDescriptor,One=Uz&&!zz.call({1:2},1);Wz.f=One?function(e){var r=Uz(this,e);return!!r&&r.enumerable}:zz;var i_=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},Yz=n_,Gz=Function.prototype,PP=Gz.call,Ine=Yz&&Gz.bind.bind(PP,PP),un=Yz?Ine:function(t){return function(){return PP.apply(t,arguments)}},Kz=un,jne=Kz({}.toString),Hne=Kz("".slice),uf=function(t){return Hne(jne(t),8,-1)},$ne=un,Dne=cn,Lne=uf,nE=Object,Fne=$ne("".split),Vne=Dne(function(){return!nE("z").propertyIsEnumerable(0)})?function(t){return Lne(t)==="String"?Fne(t,""):nE(t)}:nE,CO=function(t){return t==null},Bne=CO,Wne=TypeError,Iv=function(t){if(Bne(t))throw new Wne("Can't call method on "+t);return t},zne=Vne,Une=Iv,jv=function(t){return zne(Une(t))},iE=typeof document=="object"&&document.all,Pn=typeof iE>"u"&&iE!==void 0?function(t){return typeof t=="function"||t===iE}:function(t){return typeof t=="function"},Yne=Pn,eo=function(t){return typeof t=="object"?t!==null:Yne(t)},sE=ln,Gne=Pn,Kne=function(t){return Gne(t)?t:void 0},Km=function(t,e){return arguments.length<2?Kne(sE[t]):sE[t]&&sE[t][e]},qne=un,Hv=qne({}.isPrototypeOf),Xne=ln,cL=Xne.navigator,uL=cL&&cL.userAgent,s_=uL?String(uL):"",qz=ln,oE=s_,dL=qz.process,hL=qz.Deno,fL=dL&&dL.versions||hL&&hL.version,gL=fL&&fL.v8,ha,mC;gL&&(ha=gL.split("."),mC=ha[0]>0&&ha[0]<4?1:+(ha[0]+ha[1]));!mC&&oE&&(ha=oE.match(/Edge\/(\d+)/),(!ha||ha[1]>=74)&&(ha=oE.match(/Chrome\/(\d+)/),ha&&(mC=+ha[1])));var Qne=mC,mL=Qne,Jne=cn,Zne=ln,eie=Zne.String,_O=!!Object.getOwnPropertySymbols&&!Jne(function(){var t=Symbol("symbol detection");return!eie(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&mL&&mL<41}),tie=_O,Xz=tie&&!Symbol.sham&&typeof Symbol.iterator=="symbol",rie=Km,nie=Pn,iie=Hv,sie=Xz,oie=Object,RO=sie?function(t){return typeof t=="symbol"}:function(t){var e=rie("Symbol");return nie(e)&&iie(e.prototype,oie(t))},aie=String,o_=function(t){try{return aie(t)}catch{return"Object"}},lie=Pn,cie=o_,uie=TypeError,vs=function(t){if(lie(t))return t;throw new uie(cie(t)+" is not a function")},die=vs,hie=CO,$v=function(t,e){var r=t[e];return hie(r)?void 0:die(r)},aE=wn,lE=Pn,cE=eo,fie=TypeError,gie=function(t,e){var r,n;if(e==="string"&&lE(r=t.toString)&&!cE(n=aE(r,t))||lE(r=t.valueOf)&&!cE(n=aE(r,t))||e!=="string"&&lE(r=t.toString)&&!cE(n=aE(r,t)))return n;throw new fie("Can't convert object to primitive value")},Qz={exports:{}},pL=ln,mie=Object.defineProperty,EO=function(t,e){try{mie(pL,t,{value:e,configurable:!0,writable:!0})}catch{pL[t]=e}return e},pie=ln,yie=EO,yL="__core-js_shared__",vL=Qz.exports=pie[yL]||yie(yL,{});(vL.versions||(vL.versions=[])).push({version:"3.47.0",mode:"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"});var NO=Qz.exports,wL=NO,Jz=function(t,e){return wL[t]||(wL[t]=e||{})},vie=Iv,wie=Object,qm=function(t){return wie(vie(t))},bie=un,xie=qm,Sie=bie({}.hasOwnProperty),to=Object.hasOwn||function(e,r){return Sie(xie(e),r)},Cie=un,_ie=0,Rie=Math.random(),Eie=Cie(1.1.toString),kO=function(t){return"Symbol("+(t===void 0?"":t)+")_"+Eie(++_ie+Rie,36)},Nie=ln,kie=Jz,bL=to,Tie=kO,Pie=_O,Mie=Xz,Wg=Nie.Symbol,uE=kie("wks"),Aie=Mie?Wg.for||Wg:Wg&&Wg.withoutSetter||Tie,ka=function(t){return bL(uE,t)||(uE[t]=Pie&&bL(Wg,t)?Wg[t]:Aie("Symbol."+t)),uE[t]},Oie=wn,xL=eo,SL=RO,Iie=$v,jie=gie,Hie=ka,$ie=TypeError,Die=Hie("toPrimitive"),Lie=function(t,e){if(!xL(t)||SL(t))return t;var r=Iie(t,Die),n;if(r){if(e===void 0&&(e="default"),n=Oie(r,t,e),!xL(n)||SL(n))return n;throw new $ie("Can't convert object to primitive value")}return e===void 0&&(e="number"),jie(t,e)},Fie=Lie,Vie=RO,Zz=function(t){var e=Fie(t,"string");return Vie(e)?e:e+""},Bie=ln,CL=eo,MP=Bie.document,Wie=CL(MP)&&CL(MP.createElement),TO=function(t){return Wie?MP.createElement(t):{}},zie=Io,Uie=cn,Yie=TO,e8=!zie&&!Uie(function(){return Object.defineProperty(Yie("div"),"a",{get:function(){return 7}}).a!==7}),Gie=Io,Kie=wn,qie=Wz,Xie=i_,Qie=jv,Jie=Zz,Zie=to,ese=e8,_L=Object.getOwnPropertyDescriptor;SO.f=Gie?_L:function(e,r){if(e=Qie(e),r=Jie(r),ese)try{return _L(e,r)}catch{}if(Zie(e,r))return Xie(!Kie(qie.f,e,r),e[r])};var $c={},tse=Io,rse=cn,t8=tse&&rse(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),nse=eo,ise=String,sse=TypeError,bn=function(t){if(nse(t))return t;throw new sse(ise(t)+" is not an object")},ose=Io,ase=e8,lse=t8,Uw=bn,RL=Zz,cse=TypeError,dE=Object.defineProperty,use=Object.getOwnPropertyDescriptor,hE="enumerable",fE="configurable",gE="writable";$c.f=ose?lse?function(e,r,n){if(Uw(e),r=RL(r),Uw(n),typeof e=="function"&&r==="prototype"&&"value"in n&&gE in n&&!n[gE]){var i=use(e,r);i&&i[gE]&&(e[r]=n.value,n={configurable:fE in n?n[fE]:i[fE],enumerable:hE in n?n[hE]:i[hE],writable:!1})}return dE(e,r,n)}:dE:function(e,r,n){if(Uw(e),r=RL(r),Uw(n),ase)try{return dE(e,r,n)}catch{}if("get"in n||"set"in n)throw new cse("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var dse=Io,hse=$c,fse=i_,Xm=dse?function(t,e,r){return hse.f(t,e,fse(1,r))}:function(t,e,r){return t[e]=r,t},r8={exports:{}},AP=Io,gse=to,n8=Function.prototype,mse=AP&&Object.getOwnPropertyDescriptor,pse=gse(n8,"name"),yse=pse&&(!AP||AP&&mse(n8,"name").configurable),vse={CONFIGURABLE:yse},wse=un,bse=Pn,OP=NO,xse=wse(Function.toString);bse(OP.inspectSource)||(OP.inspectSource=function(t){return xse(t)});var Sse=OP.inspectSource,Cse=ln,_se=Pn,EL=Cse.WeakMap,Rse=_se(EL)&&/native code/.test(String(EL)),Ese=Jz,Nse=kO,NL=Ese("keys"),PO=function(t){return NL[t]||(NL[t]=Nse(t))},MO={},kse=Rse,i8=ln,Tse=eo,Pse=Xm,mE=to,pE=NO,Mse=PO,Ase=MO,kL="Object already initialized",IP=i8.TypeError,Ose=i8.WeakMap,pC,Xy,yC,Ise=function(t){return yC(t)?Xy(t):pC(t,{})},jse=function(t){return function(e){var r;if(!Tse(e)||(r=Xy(e)).type!==t)throw new IP("Incompatible receiver, "+t+" required");return r}};if(kse||pE.state){var $a=pE.state||(pE.state=new Ose);$a.get=$a.get,$a.has=$a.has,$a.set=$a.set,pC=function(t,e){if($a.has(t))throw new IP(kL);return e.facade=t,$a.set(t,e),e},Xy=function(t){return $a.get(t)||{}},yC=function(t){return $a.has(t)}}else{var Nf=Mse("state");Ase[Nf]=!0,pC=function(t,e){if(mE(t,Nf))throw new IP(kL);return e.facade=t,Pse(t,Nf,e),e},Xy=function(t){return mE(t,Nf)?t[Nf]:{}},yC=function(t){return mE(t,Nf)}}var AO={set:pC,get:Xy,has:yC,enforce:Ise,getterFor:jse},OO=un,Hse=cn,$se=Pn,Yw=to,jP=Io,Dse=vse.CONFIGURABLE,Lse=Sse,s8=AO,Fse=s8.enforce,Vse=s8.get,TL=String,sS=Object.defineProperty,Bse=OO("".slice),Wse=OO("".replace),zse=OO([].join),Use=jP&&!Hse(function(){return sS(function(){},"length",{value:8}).length!==8}),Yse=String(String).split("String"),Gse=r8.exports=function(t,e,r){Bse(TL(e),0,7)==="Symbol("&&(e="["+Wse(TL(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!Yw(t,"name")||Dse&&t.name!==e)&&(jP?sS(t,"name",{value:e,configurable:!0}):t.name=e),Use&&r&&Yw(r,"arity")&&t.length!==r.arity&&sS(t,"length",{value:r.arity});try{r&&Yw(r,"constructor")&&r.constructor?jP&&sS(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=Fse(t);return Yw(n,"source")||(n.source=zse(Yse,typeof e=="string"?e:"")),t};Function.prototype.toString=Gse(function(){return $se(this)&&Vse(this).source||Lse(this)},"toString");var o8=r8.exports,Kse=Pn,qse=$c,Xse=o8,Qse=EO,IO=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(Kse(r)&&Xse(r,s,n),n.global)i?t[e]=r:Qse(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:qse.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},a8={},Jse=Math.ceil,Zse=Math.floor,eoe=Math.trunc||function(e){var r=+e;return(r>0?Zse:Jse)(r)},toe=eoe,Dv=function(t){var e=+t;return e!==e||e===0?0:toe(e)},roe=Dv,noe=Math.max,ioe=Math.min,soe=function(t,e){var r=roe(t);return r<0?noe(r+e,0):ioe(r,e)},ooe=Dv,aoe=Math.min,loe=function(t){var e=ooe(t);return e>0?aoe(e,9007199254740991):0},coe=loe,Qm=function(t){return coe(t.length)},uoe=jv,doe=soe,hoe=Qm,foe=function(t){return function(e,r,n){var i=uoe(e),s=hoe(i);if(s===0)return!t&&-1;var o=doe(n,s),a;if(t&&r!==r){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}},goe={indexOf:foe(!1)},moe=un,yE=to,poe=jv,yoe=goe.indexOf,voe=MO,PL=moe([].push),l8=function(t,e){var r=poe(t),n=0,i=[],s;for(s in r)!yE(voe,s)&&yE(r,s)&&PL(i,s);for(;e.length>n;)yE(r,s=e[n++])&&(~yoe(i,s)||PL(i,s));return i},jO=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],woe=l8,boe=jO,xoe=boe.concat("length","prototype");a8.f=Object.getOwnPropertyNames||function(e){return woe(e,xoe)};var c8={};c8.f=Object.getOwnPropertySymbols;var Soe=Km,Coe=un,_oe=a8,Roe=c8,Eoe=bn,Noe=Coe([].concat),koe=Soe("Reflect","ownKeys")||function(e){var r=_oe.f(Eoe(e)),n=Roe.f;return n?Noe(r,n(e)):r},ML=to,Toe=koe,Poe=SO,Moe=$c,u8=function(t,e,r){for(var n=Toe(e),i=Moe.f,s=Poe.f,o=0;o<n.length;o++){var a=n[o];!ML(t,a)&&!(r&&ML(r,a))&&i(t,a,s(e,a))}},Aoe=cn,Ooe=Pn,Ioe=/#|\.prototype\./,Lv=function(t,e){var r=Hoe[joe(t)];return r===Doe?!0:r===$oe?!1:Ooe(e)?Aoe(e):!!e},joe=Lv.normalize=function(t){return String(t).replace(Ioe,".").toLowerCase()},Hoe=Lv.data={},$oe=Lv.NATIVE="N",Doe=Lv.POLYFILL="P",Loe=Lv,Gw=ln,Foe=SO.f,Voe=Xm,Boe=IO,Woe=EO,zoe=u8,Uoe=Loe,Jt=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,a,c,u,d;if(n?o=Gw:i?o=Gw[r]||Woe(r,{}):o=Gw[r]&&Gw[r].prototype,o)for(a in e){if(u=e[a],t.dontCallGetSet?(d=Foe(o,a),c=d&&d.value):c=o[a],s=Uoe(n?a:r+(i?".":"#")+a,t.forced),!s&&c!==void 0){if(typeof u==typeof c)continue;zoe(u,c)}(t.sham||c&&c.sham)&&Voe(u,"sham",!0),Boe(o,a,u,t)}},Yoe=n_,d8=Function.prototype,AL=d8.apply,OL=d8.call,Fv=typeof Reflect=="object"&&Reflect.apply||(Yoe?OL.bind(AL):function(){return OL.apply(AL,arguments)}),Goe=un,Koe=vs,h8=function(t,e,r){try{return Goe(Koe(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},qoe=eo,Xoe=function(t){return qoe(t)||t===null},Qoe=Xoe,Joe=String,Zoe=TypeError,eae=function(t){if(Qoe(t))return t;throw new Zoe("Can't set "+Joe(t)+" as a prototype")},tae=h8,rae=eo,nae=Iv,iae=eae,f8=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=tae(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return nae(i),iae(s),rae(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0),sae=$c.f,oae=function(t,e,r){r in t||sae(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},aae=Pn,lae=eo,IL=f8,cae=function(t,e,r){var n,i;return IL&&aae(n=e.constructor)&&n!==r&&lae(i=n.prototype)&&i!==r.prototype&&IL(t,i),t},uae=ka,dae=uae("toStringTag"),g8={};g8[dae]="z";var hae=String(g8)==="[object z]",fae=hae,gae=Pn,oS=uf,mae=ka,pae=mae("toStringTag"),yae=Object,vae=oS(function(){return arguments}())==="Arguments",wae=function(t,e){try{return t[e]}catch{}},m8=fae?oS:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=wae(e=yae(t),pae))=="string"?r:vae?oS(e):(n=oS(e))==="Object"&&gae(e.callee)?"Arguments":n},bae=m8,xae=String,a_=function(t){if(bae(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return xae(t)},Sae=a_,Cae=function(t,e){return t===void 0?arguments.length<2?"":e:Sae(t)},_ae=eo,Rae=Xm,Eae=function(t,e){_ae(e)&&"cause"in e&&Rae(t,"cause",e.cause)},Nae=un,p8=Error,kae=Nae("".replace),Tae=function(t){return String(new p8(t).stack)}("zxcasd"),y8=/\n\s*at [^:]*:[^\n]*/,Pae=y8.test(Tae),Mae=function(t,e){if(Pae&&typeof t=="string"&&!p8.prepareStackTrace)for(;e--;)t=kae(t,y8,"");return t},Aae=cn,Oae=i_,Iae=!Aae(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",Oae(1,7)),t.stack!==7):!0}),jae=Xm,Hae=Mae,$ae=Iae,jL=Error.captureStackTrace,Dae=function(t,e,r,n){$ae&&(jL?jL(t,e):jae(t,"stack",Hae(r,n)))},HL=Km,Lae=to,$L=Xm,Fae=Hv,DL=f8,LL=u8,FL=oae,Vae=cae,Bae=Cae,Wae=Eae,zae=Dae,Uae=Io,Yae=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),a=o[o.length-1],c=HL.apply(null,o);if(c){var u=c.prototype;if(Lae(u,"cause")&&delete u.cause,!r)return c;var d=HL("Error"),f=e(function(h,m){var g=Bae(n?m:h,void 0),p=n?new c(h):new c;return g!==void 0&&$L(p,"message",g),zae(p,f,p.stack,2),this&&Fae(u,this)&&Vae(p,this,f),arguments.length>s&&Wae(p,arguments[s]),p});f.prototype=u,a!=="Error"?DL?DL(f,d):LL(f,d,{name:!0}):Uae&&i in c&&(FL(f,c,i),FL(f,c,"prepareStackTrace")),LL(f,c);try{u.name!==a&&$L(u,"name",a),u.constructor=f}catch{}return f}},v8=Jt,Gae=ln,Pl=Fv,w8=Yae,HP="WebAssembly",VL=Gae[HP],vC=new Error("e",{cause:7}).cause!==7,df=function(t,e){var r={};r[t]=w8(t,e,vC),v8({global:!0,constructor:!0,arity:1,forced:vC},r)},HO=function(t,e){if(VL&&VL[t]){var r={};r[t]=w8(HP+"."+t,e,vC),v8({target:HP,stat:!0,constructor:!0,arity:1,forced:vC},r)}};df("Error",function(t){return function(r){return Pl(t,this,arguments)}});df("EvalError",function(t){return function(r){return Pl(t,this,arguments)}});df("RangeError",function(t){return function(r){return Pl(t,this,arguments)}});df("ReferenceError",function(t){return function(r){return Pl(t,this,arguments)}});df("SyntaxError",function(t){return function(r){return Pl(t,this,arguments)}});df("TypeError",function(t){return function(r){return Pl(t,this,arguments)}});df("URIError",function(t){return function(r){return Pl(t,this,arguments)}});HO("CompileError",function(t){return function(r){return Pl(t,this,arguments)}});HO("LinkError",function(t){return function(r){return Pl(t,this,arguments)}});HO("RuntimeError",function(t){return function(r){return Pl(t,this,arguments)}});var Kae=uf,b8=Array.isArray||function(e){return Kae(e)==="Array"},qae=Io,Xae=b8,Qae=TypeError,Jae=Object.getOwnPropertyDescriptor,Zae=qae&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),x8=Zae?function(t,e){if(Xae(t)&&!Jae(t,"length").writable)throw new Qae("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ele=TypeError,tle=9007199254740991,S8=function(t){if(t>tle)throw ele("Maximum allowed index exceeded");return t},rle=Jt,nle=qm,ile=Qm,sle=x8,ole=S8,ale=cn,lle=ale(function(){return[].push.call({length:4294967296},1)!==4294967297}),cle=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},ule=lle||!cle();rle({target:"Array",proto:!0,arity:1,forced:ule},{push:function(e){var r=nle(this),n=ile(r),i=arguments.length;ole(n+i);for(var s=0;s<i;s++)r[n]=arguments[s],n++;return sle(r,n),n}});var dle=uf,hle=un,fle=function(t){if(dle(t)==="Function")return hle(t)},BL=fle,gle=vs,mle=n_,ple=BL(BL.bind),C8=function(t,e){return gle(t),e===void 0?t:mle?ple(t,e):function(){return t.apply(e,arguments)}},_8={},yle=ka,vle=_8,wle=yle("iterator"),ble=Array.prototype,xle=function(t){return t!==void 0&&(vle.Array===t||ble[wle]===t)},Sle=m8,WL=$v,Cle=CO,_le=_8,Rle=ka,Ele=Rle("iterator"),$O=function(t){if(!Cle(t))return WL(t,Ele)||WL(t,"@@iterator")||_le[Sle(t)]},Nle=wn,kle=vs,Tle=bn,Ple=o_,Mle=$O,Ale=TypeError,Ole=function(t,e){var r=arguments.length<2?Mle(t):e;if(kle(r))return Tle(Nle(r,t));throw new Ale(Ple(t)+" is not iterable")},Ile=wn,zL=bn,jle=$v,ws=function(t,e,r){var n,i;zL(t);try{if(n=jle(t,"return"),!n){if(e==="throw")throw r;return r}n=Ile(n,t)}catch(s){i=!0,n=s}if(e==="throw")throw r;if(i)throw n;return zL(n),r},Hle=C8,$le=wn,Dle=bn,Lle=o_,Fle=xle,Vle=Qm,UL=Hv,Ble=Ole,Wle=$O,YL=ws,zle=TypeError,aS=function(t,e){this.stopped=t,this.result=e},GL=aS.prototype,Jm=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),c=Hle(e,n),u,d,f,h,m,g,p,y=function(v){return u&&YL(u,"normal"),new aS(!0,v)},w=function(v){return i?(Dle(v),a?c(v[0],v[1],y):c(v[0],v[1])):a?c(v,y):c(v)};if(s)u=t.iterator;else if(o)u=t;else{if(d=Wle(t),!d)throw new zle(Lle(t)+" is not iterable");if(Fle(d)){for(f=0,h=Vle(t);h>f;f++)if(m=w(t[f]),m&&UL(GL,m))return m;return new aS(!1)}u=Ble(t,d)}for(g=s?t.next:u.next;!(p=$le(g,u)).done;){try{m=w(p.value)}catch(v){YL(u,"throw",v)}if(typeof m=="object"&&m&&UL(GL,m))return m}return new aS(!1)},Ule=Io,Yle=$c,Gle=i_,R8=function(t,e,r){Ule?Yle.f(t,e,Gle(0,r)):t[e]=r},Kle=Jt,qle=Jm,Xle=R8;Kle({target:"Object",stat:!0},{fromEntries:function(e){var r={};return qle(e,function(n,i){Xle(r,n,i)},{AS_ENTRIES:!0}),r}});var vE=un,Kw=Set.prototype,Ml={Set,add:vE(Kw.add),has:vE(Kw.has),remove:vE(Kw.delete),proto:Kw},Qle=Ml.has,hf=function(t){return Qle(t),t},Jle=wn,ff=function(t,e,r){for(var n=r?t:t.iterator,i=t.next,s,o;!(s=Jle(i,n)).done;)if(o=e(s.value),o!==void 0)return o},E8=un,Zle=ff,N8=Ml,ece=N8.Set,k8=N8.proto,tce=E8(k8.forEach),T8=E8(k8.keys),rce=T8(new ece).next,Vv=function(t,e,r){return r?Zle({iterator:T8(t),next:rce},e):tce(t,e)},P8=Ml,nce=Vv,ice=P8.Set,sce=P8.add,DO=function(t){var e=new ice;return nce(t,function(r){sce(e,r)}),e},oce=h8,ace=Ml,Bv=oce(ace.proto,"size","get")||function(t){return t.size},Al=function(t){return{iterator:t,next:t.next,done:!1}},KL=vs,M8=bn,qL=wn,lce=Dv,cce=Al,XL="Invalid size",uce=RangeError,dce=TypeError,hce=Math.max,A8=function(t,e){this.set=t,this.size=hce(e,0),this.has=KL(t.has),this.keys=KL(t.keys)};A8.prototype={getIterator:function(){return cce(M8(qL(this.keys,this.set)))},includes:function(t){return qL(this.has,this.set,t)}};var gf=function(t){M8(t);var e=+t.size;if(e!==e)throw new dce(XL);var r=lce(e);if(r<0)throw new uce(XL);return new A8(t,r)},fce=hf,O8=Ml,gce=DO,mce=Bv,pce=gf,yce=Vv,vce=ff,wce=O8.has,QL=O8.remove,bce=function(e){var r=fce(this),n=pce(e),i=gce(r);return mce(r)<=n.size?yce(r,function(s){n.includes(s)&&QL(i,s)}):vce(n.getIterator(),function(s){wce(i,s)&&QL(i,s)}),i},xce=Km,JL=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},ZL=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},mf=function(t,e){var r=xce("Set");try{new r()[t](JL(0));try{return new r()[t](JL(-1)),!1}catch{if(!e)return!0;try{return new r()[t](ZL(-1/0)),!1}catch{var n=new r([1,2]);return e(n[t](ZL(1/0)))}}}catch{return!1}},Sce=Jt,Cce=bce,_ce=cn,Rce=mf,Ece=!Rce("difference",function(t){return t.size===0}),Nce=Ece||_ce(function(){var t={size:1,has:function(){return!0},keys:function(){var r=0;return{next:function(){var n=r++>1;return e.has(1)&&e.clear(),{done:n,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(t).size!==3});Sce({target:"Set",proto:!0,real:!0,forced:Nce},{difference:Cce});var kce=hf,LO=Ml,Tce=Bv,Pce=gf,Mce=Vv,Ace=ff,Oce=LO.Set,e3=LO.add,Ice=LO.has,jce=function(e){var r=kce(this),n=Pce(e),i=new Oce;return Tce(r)>n.size?Ace(n.getIterator(),function(s){Ice(r,s)&&e3(i,s)}):Mce(r,function(s){n.includes(s)&&e3(i,s)}),i},Hce=Jt,$ce=cn,Dce=jce,Lce=mf,Fce=!Lce("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||$ce(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});Hce({target:"Set",proto:!0,real:!0,forced:Fce},{intersection:Dce});var Vce=hf,Bce=Ml.has,Wce=Bv,zce=gf,Uce=Vv,Yce=ff,Gce=ws,Kce=function(e){var r=Vce(this),n=zce(e);if(Wce(r)<=n.size)return Uce(r,function(s){if(n.includes(s))return!1},!0)!==!1;var i=n.getIterator();return Yce(i,function(s){if(Bce(r,s))return Gce(i,"normal",!1)})!==!1},qce=Jt,Xce=Kce,Qce=mf,Jce=!Qce("isDisjointFrom",function(t){return!t});qce({target:"Set",proto:!0,real:!0,forced:Jce},{isDisjointFrom:Xce});var Zce=hf,eue=Bv,tue=Vv,rue=gf,nue=function(e){var r=Zce(this),n=rue(e);return eue(r)>n.size?!1:tue(r,function(i){if(!n.includes(i))return!1},!0)!==!1},iue=Jt,sue=nue,oue=mf,aue=!oue("isSubsetOf",function(t){return t});iue({target:"Set",proto:!0,real:!0,forced:aue},{isSubsetOf:sue});var lue=hf,cue=Ml.has,uue=Bv,due=gf,hue=ff,fue=ws,gue=function(e){var r=lue(this),n=due(e);if(uue(r)<n.size)return!1;var i=n.getIterator();return hue(i,function(s){if(!cue(r,s))return fue(i,"normal",!1)})!==!1},mue=Jt,pue=gue,yue=mf,vue=!yue("isSupersetOf",function(t){return!t});mue({target:"Set",proto:!0,real:!0,forced:vue},{isSupersetOf:pue});var wue=hf,FO=Ml,bue=DO,xue=gf,Sue=ff,Cue=FO.add,_ue=FO.has,Rue=FO.remove,Eue=function(e){var r=wue(this),n=xue(e).getIterator(),i=bue(r);return Sue(n,function(s){_ue(r,s)?Rue(i,s):Cue(i,s)}),i},I8=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size===1&&n.values().next().value===4}catch{return!1}},Nue=Jt,kue=Eue,Tue=I8,Pue=mf,Mue=!Pue("symmetricDifference")||!Tue("symmetricDifference");Nue({target:"Set",proto:!0,real:!0,forced:Mue},{symmetricDifference:kue});var Aue=hf,Oue=Ml.add,Iue=DO,jue=gf,Hue=ff,$ue=function(e){var r=Aue(this),n=jue(e).getIterator(),i=Iue(r);return Hue(n,function(s){Oue(i,s)}),i},Due=Jt,Lue=$ue,Fue=I8,Vue=mf,Bue=!Vue("union")||!Fue("union");Due({target:"Set",proto:!0,real:!0,forced:Bue},{union:Lue});var Wue=Hv,zue=TypeError,Uue=function(t,e){if(Wue(e,t))return t;throw new zue("Incorrect invocation")},Yue=cn,Gue=!Yue(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Kue=to,que=Pn,Xue=qm,Que=PO,Jue=Gue,t3=Que("IE_PROTO"),$P=Object,Zue=$P.prototype,j8=Jue?$P.getPrototypeOf:function(t){var e=Xue(t);if(Kue(e,t3))return e[t3];var r=e.constructor;return que(r)&&e instanceof r?r.prototype:e instanceof $P?Zue:null},r3=o8,ede=$c,tde=function(t,e,r){return r.get&&r3(r.get,e,{getter:!0}),r.set&&r3(r.set,e,{setter:!0}),ede.f(t,e,r)},H8={},rde=l8,nde=jO,ide=Object.keys||function(e){return rde(e,nde)},sde=Io,ode=t8,ade=$c,lde=bn,cde=jv,ude=ide;H8.f=sde&&!ode?Object.defineProperties:function(e,r){lde(e);for(var n=cde(r),i=ude(r),s=i.length,o=0,a;s>o;)ade.f(e,a=i[o++],n[a]);return e};var dde=Km,$8=dde("document","documentElement"),hde=bn,fde=H8,n3=jO,gde=MO,mde=$8,pde=TO,yde=PO,i3=">",s3="<",DP="prototype",LP="script",D8=yde("IE_PROTO"),wE=function(){},L8=function(t){return s3+LP+i3+t+s3+"/"+LP+i3},o3=function(t){t.write(L8("")),t.close();var e=t.parentWindow.Object;return t=null,e},vde=function(){var t=pde("iframe"),e="java"+LP+":",r;return t.style.display="none",mde.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(L8("document.F=Object")),r.close(),r.F},qw,lS=function(){try{qw=new ActiveXObject("htmlfile")}catch{}lS=typeof document<"u"?document.domain&&qw?o3(qw):vde():o3(qw);for(var t=n3.length;t--;)delete lS[DP][n3[t]];return lS()};gde[D8]=!0;var F8=Object.create||function(e,r){var n;return e!==null?(wE[DP]=hde(e),n=new wE,wE[DP]=null,n[D8]=e):n=lS(),r===void 0?n:fde.f(n,r)},wde=cn,bde=Pn,xde=eo,a3=j8,Sde=IO,Cde=ka,FP=Cde("iterator"),Gh,bE,xE;[].keys&&(xE=[].keys(),"next"in xE&&(bE=a3(a3(xE)),bE!==Object.prototype&&(Gh=bE)));var _de=!xde(Gh)||wde(function(){var t={};return Gh[FP].call(t)!==t});_de&&(Gh={});bde(Gh[FP])||Sde(Gh,FP,function(){return this});var V8={IteratorPrototype:Gh},Rde=Jt,Ede=ln,Nde=Uue,kde=bn,Tde=Pn,Pde=j8,Mde=tde,Ade=R8,Ode=cn,VO=to,Ide=ka,Rl=V8.IteratorPrototype,jde=Io,SE="constructor",B8="Iterator",l3=Ide("toStringTag"),W8=TypeError,CE=Ede[B8],z8=!Tde(CE)||CE.prototype!==Rl||!Ode(function(){CE({})}),BO=function(){if(Nde(this,Rl),Pde(this)===Rl)throw new W8("Abstract class Iterator not directly constructable")},U8=function(t,e){jde?Mde(Rl,t,{configurable:!0,get:function(){return e},set:function(r){if(kde(this),this===Rl)throw new W8("You can't redefine this property");VO(this,t)?this[t]=r:Ade(this,t,r)}}):Rl[t]=e};VO(Rl,l3)||U8(l3,B8);(z8||!VO(Rl,SE)||Rl[SE]===Object)&&U8(SE,BO);BO.prototype=Rl;Rde({global:!0,constructor:!0,forced:z8},{Iterator:BO});var Hde=IO,$de=function(t,e,r){for(var n in e)Hde(t,n,e[n],r);return t},Dde=function(t,e){return{value:t,done:e}},Lde=ws,Fde=function(t,e,r){for(var n=t.length-1;n>=0;n--)if(t[n]!==void 0)try{r=Lde(t[n].iterator,e,r)}catch(i){e="throw",r=i}if(e==="throw")throw r;return r},Vde=wn,Bde=F8,Wde=Xm,zde=$de,Ude=ka,Y8=AO,Yde=$v,Gde=V8.IteratorPrototype,Xw=Dde,Qw=ws,Kde=Fde,qde=Ude("toStringTag"),G8="IteratorHelper",K8="WrapForValidIterator",_E="normal",c3="throw",Xde=Y8.set,q8=function(t){var e=Y8.getterFor(t?K8:G8);return zde(Bde(Gde),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return Xw(void 0,!0);try{var i=n.nextHandler();return n.returnHandlerResult?i:Xw(i,n.done)}catch(s){throw n.done=!0,s}},return:function(){var r=e(this),n=r.iterator;if(r.done=!0,t){var i=Yde(n,"return");return i?Vde(i,n):Xw(void 0,!0)}if(r.inner)try{Qw(r.inner.iterator,_E)}catch(s){return Qw(n,c3,s)}if(r.openIters)try{Kde(r.openIters,_E)}catch(s){return Qw(n,c3,s)}return n&&Qw(n,_E),Xw(void 0,!0)}})},Qde=q8(!0),X8=q8(!1);Wde(X8,qde,"Iterator Helper");var WO=function(t,e,r){var n=function(s,o){o?(o.iterator=s.iterator,o.next=s.next):o=s,o.type=e?K8:G8,o.returnHandlerResult=!!r,o.nextHandler=t,o.counter=0,o.done=!1,Xde(this,o)};return n.prototype=e?Qde:X8,n},Jde=bn,Zde=ws,Q8=function(t,e,r,n){try{return n?e(Jde(r)[0],r[1]):e(r)}catch(i){Zde(t,"throw",i)}},zO=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}},ehe=ln,ud=function(t,e){var r=ehe.Iterator,n=r&&r.prototype,i=n&&n[t],s=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(o){o instanceof e||(s=!1)}if(!s)return i},the=Jt,J8=wn,rhe=vs,Z8=bn,nhe=Al,ihe=WO,she=Q8,ohe=ws,ahe=zO,lhe=ud,e7=!ahe("filter",function(){}),VP=!e7&&lhe("filter",TypeError),che=e7||VP,uhe=ihe(function(){for(var t=this.iterator,e=this.predicate,r=this.next,n,i,s;;){if(n=Z8(J8(r,t)),i=this.done=!!n.done,i)return;if(s=n.value,she(t,e,[s,this.counter++],!0))return s}});the({target:"Iterator",proto:!0,real:!0,forced:che},{filter:function(e){Z8(this);try{rhe(e)}catch(r){ohe(this,"throw",r)}return VP?J8(VP,this,e):new uhe(nhe(this),{predicate:e})}});var dhe=Jt,hhe=wn,fhe=Jm,ghe=vs,mhe=bn,phe=Al,yhe=ws,vhe=ud,RE=vhe("forEach",TypeError);dhe({target:"Iterator",proto:!0,real:!0,forced:RE},{forEach:function(e){mhe(this);try{ghe(e)}catch(i){yhe(this,"throw",i)}if(RE)return hhe(RE,this,e);var r=phe(this),n=0;fhe(r,function(i){e(i,n++)},{IS_RECORD:!0})}});var whe=Jt,t7=wn,bhe=vs,r7=bn,xhe=Al,She=WO,Che=Q8,_he=ws,Rhe=zO,Ehe=ud,n7=!Rhe("map",function(){}),BP=!n7&&Ehe("map",TypeError),Nhe=n7||BP,khe=She(function(){var t=this.iterator,e=r7(t7(this.next,t)),r=this.done=!!e.done;if(!r)return Che(t,this.mapper,[e.value,this.counter++],!0)});whe({target:"Iterator",proto:!0,real:!0,forced:Nhe},{map:function(e){r7(this);try{bhe(e)}catch(r){_he(this,"throw",r)}return BP?t7(BP,this,e):new khe(xhe(this),{mapper:e})}});var The=un,UO=The([].slice),Phe=TypeError,i7=function(t,e){if(t<e)throw new Phe("Not enough arguments");return t},Mhe=s_,Ahe=/(?:ipad|iphone|ipod).*applewebkit/i.test(Mhe),kp=ln,Ohe=s_,Ihe=uf,Jw=function(t){return Ohe.slice(0,t.length)===t},s7=function(){return Jw("Bun/")?"BUN":Jw("Cloudflare-Workers")?"CLOUDFLARE":Jw("Deno/")?"DENO":Jw("Node.js/")?"NODE":kp.Bun&&typeof Bun.version=="string"?"BUN":kp.Deno&&typeof Deno.version=="object"?"DENO":Ihe(kp.process)==="process"?"NODE":kp.window&&kp.document?"BROWSER":"REST"}(),jhe=s7,Hhe=jhe==="NODE",Gs=ln,$he=Fv,Dhe=C8,u3=Pn,Lhe=to,o7=cn,d3=$8,Fhe=UO,h3=TO,Vhe=i7,Bhe=Ahe,Whe=Hhe,WP=Gs.setImmediate,zP=Gs.clearImmediate,zhe=Gs.process,EE=Gs.Dispatch,Uhe=Gs.Function,f3=Gs.MessageChannel,Yhe=Gs.String,NE=0,oy={},g3="onreadystatechange",Qy,yd,kE,TE;o7(function(){Qy=Gs.location});var YO=function(t){if(Lhe(oy,t)){var e=oy[t];delete oy[t],e()}},PE=function(t){return function(){YO(t)}},m3=function(t){YO(t.data)},p3=function(t){Gs.postMessage(Yhe(t),Qy.protocol+"//"+Qy.host)};(!WP||!zP)&&(WP=function(e){Vhe(arguments.length,1);var r=u3(e)?e:Uhe(e),n=Fhe(arguments,1);return oy[++NE]=function(){$he(r,void 0,n)},yd(NE),NE},zP=function(e){delete oy[e]},Whe?yd=function(t){zhe.nextTick(PE(t))}:EE&&EE.now?yd=function(t){EE.now(PE(t))}:f3&&!Bhe?(kE=new f3,TE=kE.port2,kE.port1.onmessage=m3,yd=Dhe(TE.postMessage,TE)):Gs.addEventListener&&u3(Gs.postMessage)&&!Gs.importScripts&&Qy&&Qy.protocol!=="file:"&&!o7(p3)?(yd=p3,Gs.addEventListener("message",m3,!1)):g3 in h3("script")?yd=function(t){d3.appendChild(h3("script"))[g3]=function(){d3.removeChild(this),YO(t)}}:yd=function(t){setTimeout(PE(t),0)});var a7={set:WP,clear:zP},Ghe=Jt,Khe=ln,y3=a7.clear;Ghe({global:!0,bind:!0,enumerable:!0,forced:Khe.clearImmediate!==y3},{clearImmediate:y3});var l7=ln,qhe=Fv,Xhe=Pn,Qhe=s7,Jhe=s_,Zhe=UO,efe=i7,tfe=l7.Function,rfe=/MSIE .\./.test(Jhe)||Qhe==="BUN"&&function(){var t=l7.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),nfe=function(t,e){var r=e?2:1;return rfe?function(n,i){var s=efe(arguments.length,1)>r,o=Xhe(n)?n:tfe(n),a=s?Zhe(arguments,r):[],c=s?function(){qhe(o,this,a)}:o;return e?t(c,i):t(c)}:t},ife=Jt,c7=ln,v3=a7.set,sfe=nfe,w3=c7.setImmediate?sfe(v3,!1):v3;ife({global:!0,bind:!0,enumerable:!0,forced:c7.setImmediate!==w3},{setImmediate:w3});/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:u7,setPrototypeOf:b3,isFrozen:ofe,getPrototypeOf:afe,getOwnPropertyDescriptor:lfe}=Object;let{freeze:Fi,seal:Mo,create:UP}=Object,{apply:YP,construct:GP}=typeof Reflect<"u"&&Reflect;Fi||(Fi=function(e){return e});Mo||(Mo=function(e){return e});YP||(YP=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return e.apply(r,i)});GP||(GP=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return new e(...n)});const Zw=Vi(Array.prototype.forEach),cfe=Vi(Array.prototype.lastIndexOf),x3=Vi(Array.prototype.pop),Tp=Vi(Array.prototype.push),ufe=Vi(Array.prototype.splice),cS=Vi(String.prototype.toLowerCase),ME=Vi(String.prototype.toString),AE=Vi(String.prototype.match),Pp=Vi(String.prototype.replace),dfe=Vi(String.prototype.indexOf),hfe=Vi(String.prototype.trim),ea=Vi(Object.prototype.hasOwnProperty),Ri=Vi(RegExp.prototype.test),Mp=ffe(TypeError);function Vi(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return YP(t,e,n)}}function ffe(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return GP(t,r)}}function dt(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cS;b3&&b3(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=r(i);s!==i&&(ofe(e)||(e[n]=s),i=s)}t[i]=!0}return t}function gfe(t){for(let e=0;e<t.length;e++)ea(t,e)||(t[e]=null);return t}function rl(t){const e=UP(null);for(const[r,n]of u7(t))ea(t,r)&&(Array.isArray(n)?e[r]=gfe(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=rl(n):e[r]=n);return e}function Ap(t,e){for(;t!==null;){const n=lfe(t,e);if(n){if(n.get)return Vi(n.get);if(typeof n.value=="function")return Vi(n.value)}t=afe(t)}function r(){return null}return r}const S3=Fi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),OE=Fi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),IE=Fi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),mfe=Fi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),jE=Fi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),pfe=Fi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),C3=Fi(["#text"]),_3=Fi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),HE=Fi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),R3=Fi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),eb=Fi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),yfe=Mo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),vfe=Mo(/<%[\w\W]*|[\w\W]*%>/gm),wfe=Mo(/\$\{[\w\W]*/gm),bfe=Mo(/^data-[\-\w.\u00B7-\uFFFF]+$/),xfe=Mo(/^aria-[\-\w]+$/),d7=Mo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Sfe=Mo(/^(?:\w+script|data):/i),Cfe=Mo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),h7=Mo(/^html$/i),_fe=Mo(/^[a-z][.\w]*(-[.\w]+)+$/i);var E3=Object.freeze({__proto__:null,ARIA_ATTR:xfe,ATTR_WHITESPACE:Cfe,CUSTOM_ELEMENT:_fe,DATA_ATTR:bfe,DOCTYPE_NAME:h7,ERB_EXPR:vfe,IS_ALLOWED_URI:d7,IS_SCRIPT_OR_DATA:Sfe,MUSTACHE_EXPR:yfe,TMPLIT_EXPR:wfe});const Op={element:1,text:3,progressingInstruction:7,comment:8,document:9},Rfe=function(){return typeof window>"u"?null:window},Efe=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},N3=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function f7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rfe();const e=$e=>f7($e);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==Op.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:c,NodeFilter:u,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:f,DOMParser:h,trustedTypes:m}=t,g=c.prototype,p=Ap(g,"cloneNode"),y=Ap(g,"remove"),w=Ap(g,"nextSibling"),v=Ap(g,"childNodes"),x=Ap(g,"parentNode");if(typeof o=="function"){const $e=r.createElement("template");$e.content&&$e.content.ownerDocument&&(r=$e.content.ownerDocument)}let S,N="";const{implementation:R,createNodeIterator:E,createDocumentFragment:P,getElementsByTagName:D}=r,{importNode:H}=n;let Z=N3();e.isSupported=typeof u7=="function"&&typeof x=="function"&&R&&R.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:I,ERB_EXPR:Y,TMPLIT_EXPR:re,DATA_ATTR:ne,ARIA_ATTR:ae,IS_SCRIPT_OR_DATA:ue,ATTR_WHITESPACE:Q,CUSTOM_ELEMENT:fe}=E3;let{IS_ALLOWED_URI:ye}=E3,de=null;const se=dt({},[...S3,...OE,...IE,...jE,...C3]);let me=null;const te=dt({},[..._3,...HE,...R3,...eb]);let b=Object.seal(UP(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_=null,T=null;const F=Object.seal(UP(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let K=!0,C=!0,k=!1,M=!0,V=!1,j=!0,A=!1,U=!1,L=!1,W=!1,X=!1,q=!1,ie=!0,we=!1;const ve="user-content-";let je=!0,oe=!1,Ee={},Se=null;const He=dt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ze=null;const Ge=dt({},["audio","video","img","source","image","track"]);let Zt=null;const Qr=dt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$t="http://www.w3.org/1998/Math/MathML",Gt="http://www.w3.org/2000/svg",Ue="http://www.w3.org/1999/xhtml";let ct=Ue,Be=!1,yr=null;const Kt=dt({},[$t,Gt,Ue],ME);let Gn=dt({},["mi","mo","mn","ms","mtext"]),Pa=dt({},["annotation-xml"]);const Gi=dt({},["title","style","font","a","script"]);let Jr=null;const Ma=["application/xhtml+xml","text/html"],Wc="text/html";let _r=null,Aa=null;const gd=r.createElement("form"),lw=function(z){return z instanceof RegExp||z instanceof Function},up=function(){let z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Aa&&Aa===z)){if((!z||typeof z!="object")&&(z={}),z=rl(z),Jr=Ma.indexOf(z.PARSER_MEDIA_TYPE)===-1?Wc:z.PARSER_MEDIA_TYPE,_r=Jr==="application/xhtml+xml"?ME:cS,de=ea(z,"ALLOWED_TAGS")?dt({},z.ALLOWED_TAGS,_r):se,me=ea(z,"ALLOWED_ATTR")?dt({},z.ALLOWED_ATTR,_r):te,yr=ea(z,"ALLOWED_NAMESPACES")?dt({},z.ALLOWED_NAMESPACES,ME):Kt,Zt=ea(z,"ADD_URI_SAFE_ATTR")?dt(rl(Qr),z.ADD_URI_SAFE_ATTR,_r):Qr,ze=ea(z,"ADD_DATA_URI_TAGS")?dt(rl(Ge),z.ADD_DATA_URI_TAGS,_r):Ge,Se=ea(z,"FORBID_CONTENTS")?dt({},z.FORBID_CONTENTS,_r):He,_=ea(z,"FORBID_TAGS")?dt({},z.FORBID_TAGS,_r):rl({}),T=ea(z,"FORBID_ATTR")?dt({},z.FORBID_ATTR,_r):rl({}),Ee=ea(z,"USE_PROFILES")?z.USE_PROFILES:!1,K=z.ALLOW_ARIA_ATTR!==!1,C=z.ALLOW_DATA_ATTR!==!1,k=z.ALLOW_UNKNOWN_PROTOCOLS||!1,M=z.ALLOW_SELF_CLOSE_IN_ATTR!==!1,V=z.SAFE_FOR_TEMPLATES||!1,j=z.SAFE_FOR_XML!==!1,A=z.WHOLE_DOCUMENT||!1,W=z.RETURN_DOM||!1,X=z.RETURN_DOM_FRAGMENT||!1,q=z.RETURN_TRUSTED_TYPE||!1,L=z.FORCE_BODY||!1,ie=z.SANITIZE_DOM!==!1,we=z.SANITIZE_NAMED_PROPS||!1,je=z.KEEP_CONTENT!==!1,oe=z.IN_PLACE||!1,ye=z.ALLOWED_URI_REGEXP||d7,ct=z.NAMESPACE||Ue,Gn=z.MATHML_TEXT_INTEGRATION_POINTS||Gn,Pa=z.HTML_INTEGRATION_POINTS||Pa,b=z.CUSTOM_ELEMENT_HANDLING||{},z.CUSTOM_ELEMENT_HANDLING&&lw(z.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=z.CUSTOM_ELEMENT_HANDLING.tagNameCheck),z.CUSTOM_ELEMENT_HANDLING&&lw(z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),z.CUSTOM_ELEMENT_HANDLING&&typeof z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),V&&(C=!1),X&&(W=!0),Ee&&(de=dt({},C3),me=[],Ee.html===!0&&(dt(de,S3),dt(me,_3)),Ee.svg===!0&&(dt(de,OE),dt(me,HE),dt(me,eb)),Ee.svgFilters===!0&&(dt(de,IE),dt(me,HE),dt(me,eb)),Ee.mathMl===!0&&(dt(de,jE),dt(me,R3),dt(me,eb))),z.ADD_TAGS&&(typeof z.ADD_TAGS=="function"?F.tagCheck=z.ADD_TAGS:(de===se&&(de=rl(de)),dt(de,z.ADD_TAGS,_r))),z.ADD_ATTR&&(typeof z.ADD_ATTR=="function"?F.attributeCheck=z.ADD_ATTR:(me===te&&(me=rl(me)),dt(me,z.ADD_ATTR,_r))),z.ADD_URI_SAFE_ATTR&&dt(Zt,z.ADD_URI_SAFE_ATTR,_r),z.FORBID_CONTENTS&&(Se===He&&(Se=rl(Se)),dt(Se,z.FORBID_CONTENTS,_r)),z.ADD_FORBID_CONTENTS&&(Se===He&&(Se=rl(Se)),dt(Se,z.ADD_FORBID_CONTENTS,_r)),je&&(de["#text"]=!0),A&&dt(de,["html","head","body"]),de.table&&(dt(de,["tbody"]),delete _.tbody),z.TRUSTED_TYPES_POLICY){if(typeof z.TRUSTED_TYPES_POLICY.createHTML!="function")throw Mp('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof z.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Mp('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=z.TRUSTED_TYPES_POLICY,N=S.createHTML("")}else S===void 0&&(S=Efe(m,i)),S!==null&&typeof N=="string"&&(N=S.createHTML(""));Fi&&Fi(z),Aa=z}},cw=dt({},[...OE,...IE,...mfe]),uw=dt({},[...jE,...pfe]),nR=function(z){let he=x(z);(!he||!he.tagName)&&(he={namespaceURI:ct,tagName:"template"});const Ae=cS(z.tagName),er=cS(he.tagName);return yr[z.namespaceURI]?z.namespaceURI===Gt?he.namespaceURI===Ue?Ae==="svg":he.namespaceURI===$t?Ae==="svg"&&(er==="annotation-xml"||Gn[er]):!!cw[Ae]:z.namespaceURI===$t?he.namespaceURI===Ue?Ae==="math":he.namespaceURI===Gt?Ae==="math"&&Pa[er]:!!uw[Ae]:z.namespaceURI===Ue?he.namespaceURI===Gt&&!Pa[er]||he.namespaceURI===$t&&!Gn[er]?!1:!uw[Ae]&&(Gi[Ae]||!cw[Ae]):!!(Jr==="application/xhtml+xml"&&yr[z.namespaceURI]):!1},Rs=function(z){Tp(e.removed,{element:z});try{x(z).removeChild(z)}catch{y(z)}},Lo=function(z,he){try{Tp(e.removed,{attribute:he.getAttributeNode(z),from:he})}catch{Tp(e.removed,{attribute:null,from:he})}if(he.removeAttribute(z),z==="is")if(W||X)try{Rs(he)}catch{}else try{he.setAttribute(z,"")}catch{}},Oa=function(z){let he=null,Ae=null;if(L)z="<remove></remove>"+z;else{const Lr=AE(z,/^[\r\n\t ]+/);Ae=Lr&&Lr[0]}Jr==="application/xhtml+xml"&&ct===Ue&&(z='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+z+"</body></html>");const er=S?S.createHTML(z):z;if(ct===Ue)try{he=new h().parseFromString(er,Jr)}catch{}if(!he||!he.documentElement){he=R.createDocument(ct,"template",null);try{he.documentElement.innerHTML=Be?N:er}catch{}}const An=he.body||he.documentElement;return z&&Ae&&An.insertBefore(r.createTextNode(Ae),An.childNodes[0]||null),ct===Ue?D.call(he,A?"html":"body")[0]:A?he.documentElement:An},dw=function(z){return E.call(z.ownerDocument||z,z,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},dp=function(z){return z instanceof f&&(typeof z.nodeName!="string"||typeof z.textContent!="string"||typeof z.removeChild!="function"||!(z.attributes instanceof d)||typeof z.removeAttribute!="function"||typeof z.setAttribute!="function"||typeof z.namespaceURI!="string"||typeof z.insertBefore!="function"||typeof z.hasChildNodes!="function")},hw=function(z){return typeof a=="function"&&z instanceof a};function Fo($e,z,he){Zw($e,Ae=>{Ae.call(e,z,he,Aa)})}const fw=function(z){let he=null;if(Fo(Z.beforeSanitizeElements,z,null),dp(z))return Rs(z),!0;const Ae=_r(z.nodeName);if(Fo(Z.uponSanitizeElement,z,{tagName:Ae,allowedTags:de}),j&&z.hasChildNodes()&&!hw(z.firstElementChild)&&Ri(/<[/\w!]/g,z.innerHTML)&&Ri(/<[/\w!]/g,z.textContent)||z.nodeType===Op.progressingInstruction||j&&z.nodeType===Op.comment&&Ri(/<[/\w]/g,z.data))return Rs(z),!0;if(!(F.tagCheck instanceof Function&&F.tagCheck(Ae))&&(!de[Ae]||_[Ae])){if(!_[Ae]&&gw(Ae)&&(b.tagNameCheck instanceof RegExp&&Ri(b.tagNameCheck,Ae)||b.tagNameCheck instanceof Function&&b.tagNameCheck(Ae)))return!1;if(je&&!Se[Ae]){const er=x(z)||z.parentNode,An=v(z)||z.childNodes;if(An&&er){const Lr=An.length;for(let si=Lr-1;si>=0;--si){const Ki=p(An[si],!0);Ki.__removalCount=(z.__removalCount||0)+1,er.insertBefore(Ki,w(z))}}}return Rs(z),!0}return z instanceof c&&!nR(z)||(Ae==="noscript"||Ae==="noembed"||Ae==="noframes")&&Ri(/<\/no(script|embed|frames)/i,z.innerHTML)?(Rs(z),!0):(V&&z.nodeType===Op.text&&(he=z.textContent,Zw([I,Y,re],er=>{he=Pp(he,er," ")}),z.textContent!==he&&(Tp(e.removed,{element:z.cloneNode()}),z.textContent=he)),Fo(Z.afterSanitizeElements,z,null),!1)},no=function(z,he,Ae){if(ie&&(he==="id"||he==="name")&&(Ae in r||Ae in gd))return!1;if(!(C&&!T[he]&&Ri(ne,he))){if(!(K&&Ri(ae,he))){if(!(F.attributeCheck instanceof Function&&F.attributeCheck(he,z))){if(!me[he]||T[he]){if(!(gw(z)&&(b.tagNameCheck instanceof RegExp&&Ri(b.tagNameCheck,z)||b.tagNameCheck instanceof Function&&b.tagNameCheck(z))&&(b.attributeNameCheck instanceof RegExp&&Ri(b.attributeNameCheck,he)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(he,z))||he==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&Ri(b.tagNameCheck,Ae)||b.tagNameCheck instanceof Function&&b.tagNameCheck(Ae))))return!1}else if(!Zt[he]){if(!Ri(ye,Pp(Ae,Q,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&z!=="script"&&dfe(Ae,"data:")===0&&ze[z])){if(!(k&&!Ri(ue,Pp(Ae,Q,"")))){if(Ae)return!1}}}}}}}return!0},gw=function(z){return z!=="annotation-xml"&&AE(z,fe)},mw=function(z){Fo(Z.beforeSanitizeAttributes,z,null);const{attributes:he}=z;if(!he||dp(z))return;const Ae={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:me,forceKeepAttr:void 0};let er=he.length;for(;er--;){const An=he[er],{name:Lr,namespaceURI:si,value:Ki}=An,zc=_r(Lr),hp=Ki;let tr=Lr==="value"?hp:hfe(hp);if(Ae.attrName=zc,Ae.attrValue=tr,Ae.keepAttr=!0,Ae.forceKeepAttr=void 0,Fo(Z.uponSanitizeAttribute,z,Ae),tr=Ae.attrValue,we&&(zc==="id"||zc==="name")&&(Lo(Lr,z),tr=ve+tr),j&&Ri(/((--!?|])>)|<\/(style|title|textarea)/i,tr)){Lo(Lr,z);continue}if(zc==="attributename"&&AE(tr,"href")){Lo(Lr,z);continue}if(Ae.forceKeepAttr)continue;if(!Ae.keepAttr){Lo(Lr,z);continue}if(!M&&Ri(/\/>/i,tr)){Lo(Lr,z);continue}V&&Zw([I,Y,re],yw=>{tr=Pp(tr,yw," ")});const pw=_r(z.nodeName);if(!no(pw,zc,tr)){Lo(Lr,z);continue}if(S&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!si)switch(m.getAttributeType(pw,zc)){case"TrustedHTML":{tr=S.createHTML(tr);break}case"TrustedScriptURL":{tr=S.createScriptURL(tr);break}}if(tr!==hp)try{si?z.setAttributeNS(si,Lr,tr):z.setAttribute(Lr,tr),dp(z)?Rs(z):x3(e.removed)}catch{Lo(Lr,z)}}Fo(Z.afterSanitizeAttributes,z,null)},iR=function $e(z){let he=null;const Ae=dw(z);for(Fo(Z.beforeSanitizeShadowDOM,z,null);he=Ae.nextNode();)Fo(Z.uponSanitizeShadowNode,he,null),fw(he),mw(he),he.content instanceof s&&$e(he.content);Fo(Z.afterSanitizeShadowDOM,z,null)};return e.sanitize=function($e){let z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he=null,Ae=null,er=null,An=null;if(Be=!$e,Be&&($e="<!-->"),typeof $e!="string"&&!hw($e))if(typeof $e.toString=="function"){if($e=$e.toString(),typeof $e!="string")throw Mp("dirty is not a string, aborting")}else throw Mp("toString is not a function");if(!e.isSupported)return $e;if(U||up(z),e.removed=[],typeof $e=="string"&&(oe=!1),oe){if($e.nodeName){const Ki=_r($e.nodeName);if(!de[Ki]||_[Ki])throw Mp("root node is forbidden and cannot be sanitized in-place")}}else if($e instanceof a)he=Oa("<!---->"),Ae=he.ownerDocument.importNode($e,!0),Ae.nodeType===Op.element&&Ae.nodeName==="BODY"||Ae.nodeName==="HTML"?he=Ae:he.appendChild(Ae);else{if(!W&&!V&&!A&&$e.indexOf("<")===-1)return S&&q?S.createHTML($e):$e;if(he=Oa($e),!he)return W?null:q?N:""}he&&L&&Rs(he.firstChild);const Lr=dw(oe?$e:he);for(;er=Lr.nextNode();)fw(er),mw(er),er.content instanceof s&&iR(er.content);if(oe)return $e;if(W){if(X)for(An=P.call(he.ownerDocument);he.firstChild;)An.appendChild(he.firstChild);else An=he;return(me.shadowroot||me.shadowrootmode)&&(An=H.call(n,An,!0)),An}let si=A?he.outerHTML:he.innerHTML;return A&&de["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&Ri(h7,he.ownerDocument.doctype.name)&&(si="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+si),V&&Zw([I,Y,re],Ki=>{si=Pp(si,Ki," ")}),S&&q?S.createHTML(si):si},e.setConfig=function(){let $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};up($e),U=!0},e.clearConfig=function(){Aa=null,U=!1},e.isValidAttribute=function($e,z,he){Aa||up({});const Ae=_r($e),er=_r(z);return no(Ae,er,he)},e.addHook=function($e,z){typeof z=="function"&&Tp(Z[$e],z)},e.removeHook=function($e,z){if(z!==void 0){const he=cfe(Z[$e],z);return he===-1?void 0:ufe(Z[$e],he,1)[0]}return x3(Z[$e])},e.removeHooks=function($e){Z[$e]=[]},e.removeAllHooks=function(){Z=N3()},e}var Nfe=f7();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var g7;function ce(){return g7.apply(null,arguments)}function kfe(t){g7=t}function Sa(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function $h(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Mt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function GO(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Mt(t,e))return!1;return!0}function ns(t){return t===void 0}function Pc(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Wv(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function m7(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Ou(t,e){for(var r in e)Mt(e,r)&&(t[r]=e[r]);return Mt(e,"toString")&&(t.toString=e.toString),Mt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ol(t,e,r,n){return D7(t,e,r,n,!0).utc()}function Tfe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function rt(t){return t._pf==null&&(t._pf=Tfe()),t._pf}var KP;Array.prototype.some?KP=Array.prototype.some:KP=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function KO(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=rt(t),r=KP.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function l_(t){var e=Ol(NaN);return t!=null?Ou(rt(e),t):rt(e).userInvalidated=!0,e}var k3=ce.momentProperties=[],$E=!1;function qO(t,e){var r,n,i,s=k3.length;if(ns(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ns(e._i)||(t._i=e._i),ns(e._f)||(t._f=e._f),ns(e._l)||(t._l=e._l),ns(e._strict)||(t._strict=e._strict),ns(e._tzm)||(t._tzm=e._tzm),ns(e._isUTC)||(t._isUTC=e._isUTC),ns(e._offset)||(t._offset=e._offset),ns(e._pf)||(t._pf=rt(e)),ns(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=k3[r],i=e[n],ns(i)||(t[n]=i);return t}function zv(t){qO(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),$E===!1&&($E=!0,ce.updateOffset(this),$E=!1)}function Ca(t){return t instanceof zv||t!=null&&t._isAMomentObject!=null}function p7(t){ce.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function jo(t,e){var r=!0;return Ou(function(){if(ce.deprecationHandler!=null&&ce.deprecationHandler(null,t),r){var n=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Mt(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}p7(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var T3={};function y7(t,e){ce.deprecationHandler!=null&&ce.deprecationHandler(t,e),T3[t]||(p7(e),T3[t]=!0)}ce.suppressDeprecationWarnings=!1;ce.deprecationHandler=null;function Il(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Pfe(t){var e,r;for(r in t)Mt(t,r)&&(e=t[r],Il(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function qP(t,e){var r=Ou({},t),n;for(n in e)Mt(e,n)&&($h(t[n])&&$h(e[n])?(r[n]={},Ou(r[n],t[n]),Ou(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Mt(t,n)&&!Mt(e,n)&&$h(t[n])&&(r[n]=Ou({},r[n]));return r}function XO(t){t!=null&&this.set(t)}var XP;Object.keys?XP=Object.keys:XP=function(t){var e,r=[];for(e in t)Mt(t,e)&&r.push(e);return r};var Mfe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Afe(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Il(n)?n.call(e,r):n}function Nl(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var QO=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,tb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,DE={},lm={};function Fe(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(lm[t]=i),e&&(lm[e[0]]=function(){return Nl(i.apply(this,arguments),e[1],e[2])}),r&&(lm[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function Ofe(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Ife(t){var e=t.match(QO),r,n;for(r=0,n=e.length;r<n;r++)lm[e[r]]?e[r]=lm[e[r]]:e[r]=Ofe(e[r]);return function(i){var s="",o;for(o=0;o<n;o++)s+=Il(e[o])?e[o].call(i,t):e[o];return s}}function uS(t,e){return t.isValid()?(e=v7(e,t.localeData()),DE[e]=DE[e]||Ife(e),DE[e](t)):t.localeData().invalidDate()}function v7(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(tb.lastIndex=0;r>=0&&tb.test(t);)t=t.replace(tb,n),tb.lastIndex=0,r-=1;return t}var jfe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Hfe(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(QO).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var $fe="Invalid date";function Dfe(){return this._invalidDate}var Lfe="%d",Ffe=/\d{1,2}/;function Vfe(t){return this._ordinal.replace("%d",t)}var Bfe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Wfe(t,e,r,n){var i=this._relativeTime[r];return Il(i)?i(t,e,r,n):i.replace(/%d/i,t)}function zfe(t,e){var r=this._relativeTime[t>0?"future":"past"];return Il(r)?r(e):r.replace(/%s/i,e)}var P3={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ho(t){return typeof t=="string"?P3[t]||P3[t.toLowerCase()]:void 0}function JO(t){var e={},r,n;for(n in t)Mt(t,n)&&(r=Ho(n),r&&(e[r]=t[n]));return e}var Ufe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Yfe(t){var e=[],r;for(r in t)Mt(t,r)&&e.push({unit:r,priority:Ufe[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var w7=/\d/,ro=/\d\d/,b7=/\d{3}/,ZO=/\d{4}/,c_=/[+-]?\d{6}/,pr=/\d\d?/,x7=/\d\d\d\d?/,S7=/\d\d\d\d\d\d?/,u_=/\d{1,3}/,eI=/\d{1,4}/,d_=/[+-]?\d{1,6}/,Zm=/\d+/,h_=/[+-]?\d+/,Gfe=/Z|[+-]\d\d:?\d\d/gi,f_=/Z|[+-]\d\d(?::?\d\d)?/gi,Kfe=/[+-]?\d+(\.\d{1,3})?/,Uv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ep=/^[1-9]\d?/,tI=/^([1-9]\d|\d)/,wC;wC={};function ke(t,e,r){wC[t]=Il(e)?e:function(n,i){return n&&r?r:e}}function qfe(t,e){return Mt(wC,t)?wC[t](e._strict,e._locale):new RegExp(Xfe(t))}function Xfe(t){return xc(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function xc(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Co(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function bt(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Co(e)),r}var QP={};function Xt(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Pc(e)&&(n=function(s,o){o[e]=bt(s)}),i=t.length,r=0;r<i;r++)QP[t[r]]=n}function Yv(t,e){Xt(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function Qfe(t,e,r){e!=null&&Mt(QP,t)&&QP[t](e,r._a,r,t)}function g_(t){return t%4===0&&t%100!==0||t%400===0}var Si=0,fc=1,yl=2,Tn=3,pa=4,gc=5,Sh=6,Jfe=7,Zfe=8;Fe("Y",0,0,function(){var t=this.year();return t<=9999?Nl(t,4):"+"+t});Fe(0,["YY",2],0,function(){return this.year()%100});Fe(0,["YYYY",4],0,"year");Fe(0,["YYYYY",5],0,"year");Fe(0,["YYYYYY",6,!0],0,"year");ke("Y",h_);ke("YY",pr,ro);ke("YYYY",eI,ZO);ke("YYYYY",d_,c_);ke("YYYYYY",d_,c_);Xt(["YYYYY","YYYYYY"],Si);Xt("YYYY",function(t,e){e[Si]=t.length===2?ce.parseTwoDigitYear(t):bt(t)});Xt("YY",function(t,e){e[Si]=ce.parseTwoDigitYear(t)});Xt("Y",function(t,e){e[Si]=parseInt(t,10)});function ay(t){return g_(t)?366:365}ce.parseTwoDigitYear=function(t){return bt(t)+(bt(t)>68?1900:2e3)};var C7=tp("FullYear",!0);function ege(){return g_(this.year())}function tp(t,e){return function(r){return r!=null?(_7(this,t,r),ce.updateOffset(this,e),this):Jy(this,t)}}function Jy(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function _7(t,e,r){var n,i,s,o,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,o=t.month(),a=t.date(),a=a===29&&o===1&&!g_(s)?28:a,i?n.setUTCFullYear(s,o,a):n.setFullYear(s,o,a)}}function tge(t){return t=Ho(t),Il(this[t])?this[t]():this}function rge(t,e){if(typeof t=="object"){t=JO(t);var r=Yfe(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Ho(t),Il(this[t]))return this[t](e);return this}function nge(t,e){return(t%e+e)%e}var tn;Array.prototype.indexOf?tn=Array.prototype.indexOf:tn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function rI(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=nge(e,12);return t+=(e-r)/12,r===1?g_(t)?29:28:31-r%7%2}Fe("M",["MM",2],"Mo",function(){return this.month()+1});Fe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Fe("MMMM",0,0,function(t){return this.localeData().months(this,t)});ke("M",pr,ep);ke("MM",pr,ro);ke("MMM",function(t,e){return e.monthsShortRegex(t)});ke("MMMM",function(t,e){return e.monthsRegex(t)});Xt(["M","MM"],function(t,e){e[fc]=bt(t)-1});Xt(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[fc]=i:rt(r).invalidMonth=t});var ige="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),R7="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),E7=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,sge=Uv,oge=Uv;function age(t,e){return t?Sa(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||E7).test(e)?"format":"standalone"][t.month()]:Sa(this._months)?this._months:this._months.standalone}function lge(t,e){return t?Sa(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[E7.test(e)?"format":"standalone"][t.month()]:Sa(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function cge(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Ol([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=tn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=tn.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=tn.call(this._shortMonthsParse,o),i!==-1?i:(i=tn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=tn.call(this._longMonthsParse,o),i!==-1?i:(i=tn.call(this._shortMonthsParse,o),i!==-1?i:null))}function uge(t,e,r){var n,i,s;if(this._monthsParseExact)return cge.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Ol([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function N7(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=bt(e);else if(e=t.localeData().monthsParse(e),!Pc(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,rI(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function k7(t){return t!=null?(N7(this,t),ce.updateOffset(this,!0),this):Jy(this,"Month")}function dge(){return rI(this.year(),this.month())}function hge(t){return this._monthsParseExact?(Mt(this,"_monthsRegex")||T7.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Mt(this,"_monthsShortRegex")||(this._monthsShortRegex=sge),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function fge(t){return this._monthsParseExact?(Mt(this,"_monthsRegex")||T7.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Mt(this,"_monthsRegex")||(this._monthsRegex=oge),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function T7(){function t(c,u){return u.length-c.length}var e=[],r=[],n=[],i,s,o,a;for(i=0;i<12;i++)s=Ol([2e3,i]),o=xc(this.monthsShort(s,"")),a=xc(this.months(s,"")),e.push(o),r.push(a),n.push(a),n.push(o);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function gge(t,e,r,n,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,s,o),a}function Zy(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function bC(t,e,r){var n=7+e-r,i=(7+Zy(t,0,n).getUTCDay()-e)%7;return-i+n-1}function P7(t,e,r,n,i){var s=(7+r-n)%7,o=bC(t,n,i),a=1+7*(e-1)+s+o,c,u;return a<=0?(c=t-1,u=ay(c)+a):a>ay(t)?(c=t+1,u=a-ay(t)):(c=t,u=a),{year:c,dayOfYear:u}}function ev(t,e,r){var n=bC(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+Sc(o,e,r)):i>Sc(t.year(),e,r)?(s=i-Sc(t.year(),e,r),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function Sc(t,e,r){var n=bC(t,e,r),i=bC(t+1,e,r);return(ay(t)-n+i)/7}Fe("w",["ww",2],"wo","week");Fe("W",["WW",2],"Wo","isoWeek");ke("w",pr,ep);ke("ww",pr,ro);ke("W",pr,ep);ke("WW",pr,ro);Yv(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=bt(t)});function mge(t){return ev(t,this._week.dow,this._week.doy).week}var pge={dow:0,doy:6};function yge(){return this._week.dow}function vge(){return this._week.doy}function wge(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function bge(t){var e=ev(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Fe("d",0,"do","day");Fe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Fe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Fe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Fe("e",0,0,"weekday");Fe("E",0,0,"isoWeekday");ke("d",pr);ke("e",pr);ke("E",pr);ke("dd",function(t,e){return e.weekdaysMinRegex(t)});ke("ddd",function(t,e){return e.weekdaysShortRegex(t)});ke("dddd",function(t,e){return e.weekdaysRegex(t)});Yv(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:rt(r).invalidWeekday=t});Yv(["d","e","E"],function(t,e,r,n){e[n]=bt(t)});function xge(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Sge(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function nI(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Cge="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),M7="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),_ge="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Rge=Uv,Ege=Uv,Nge=Uv;function kge(t,e){var r=Sa(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?nI(r,this._week.dow):t?r[t.day()]:r}function Tge(t){return t===!0?nI(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Pge(t){return t===!0?nI(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Mge(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Ol([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=tn.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=tn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=tn.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=tn.call(this._weekdaysParse,o),i!==-1||(i=tn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=tn.call(this._shortWeekdaysParse,o),i!==-1||(i=tn.call(this._weekdaysParse,o),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=tn.call(this._minWeekdaysParse,o),i!==-1||(i=tn.call(this._weekdaysParse,o),i!==-1)?i:(i=tn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function Age(t,e,r){var n,i,s;if(this._weekdaysParseExact)return Mge.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Ol([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function Oge(t){if(!this.isValid())return t!=null?this:NaN;var e=Jy(this,"Day");return t!=null?(t=xge(t,this.localeData()),this.add(t-e,"d")):e}function Ige(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function jge(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Sge(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Hge(t){return this._weekdaysParseExact?(Mt(this,"_weekdaysRegex")||iI.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Mt(this,"_weekdaysRegex")||(this._weekdaysRegex=Rge),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function $ge(t){return this._weekdaysParseExact?(Mt(this,"_weekdaysRegex")||iI.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Mt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ege),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Dge(t){return this._weekdaysParseExact?(Mt(this,"_weekdaysRegex")||iI.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Mt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Nge),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function iI(){function t(d,f){return f.length-d.length}var e=[],r=[],n=[],i=[],s,o,a,c,u;for(s=0;s<7;s++)o=Ol([2e3,1]).day(s),a=xc(this.weekdaysMin(o,"")),c=xc(this.weekdaysShort(o,"")),u=xc(this.weekdays(o,"")),e.push(a),r.push(c),n.push(u),i.push(a),i.push(c),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function sI(){return this.hours()%12||12}function Lge(){return this.hours()||24}Fe("H",["HH",2],0,"hour");Fe("h",["hh",2],0,sI);Fe("k",["kk",2],0,Lge);Fe("hmm",0,0,function(){return""+sI.apply(this)+Nl(this.minutes(),2)});Fe("hmmss",0,0,function(){return""+sI.apply(this)+Nl(this.minutes(),2)+Nl(this.seconds(),2)});Fe("Hmm",0,0,function(){return""+this.hours()+Nl(this.minutes(),2)});Fe("Hmmss",0,0,function(){return""+this.hours()+Nl(this.minutes(),2)+Nl(this.seconds(),2)});function A7(t,e){Fe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}A7("a",!0);A7("A",!1);function O7(t,e){return e._meridiemParse}ke("a",O7);ke("A",O7);ke("H",pr,tI);ke("h",pr,ep);ke("k",pr,ep);ke("HH",pr,ro);ke("hh",pr,ro);ke("kk",pr,ro);ke("hmm",x7);ke("hmmss",S7);ke("Hmm",x7);ke("Hmmss",S7);Xt(["H","HH"],Tn);Xt(["k","kk"],function(t,e,r){var n=bt(t);e[Tn]=n===24?0:n});Xt(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Xt(["h","hh"],function(t,e,r){e[Tn]=bt(t),rt(r).bigHour=!0});Xt("hmm",function(t,e,r){var n=t.length-2;e[Tn]=bt(t.substr(0,n)),e[pa]=bt(t.substr(n)),rt(r).bigHour=!0});Xt("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Tn]=bt(t.substr(0,n)),e[pa]=bt(t.substr(n,2)),e[gc]=bt(t.substr(i)),rt(r).bigHour=!0});Xt("Hmm",function(t,e,r){var n=t.length-2;e[Tn]=bt(t.substr(0,n)),e[pa]=bt(t.substr(n))});Xt("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Tn]=bt(t.substr(0,n)),e[pa]=bt(t.substr(n,2)),e[gc]=bt(t.substr(i))});function Fge(t){return(t+"").toLowerCase().charAt(0)==="p"}var Vge=/[ap]\.?m?\.?/i,Bge=tp("Hours",!0);function Wge(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var I7={calendar:Mfe,longDateFormat:jfe,invalidDate:$fe,ordinal:Lfe,dayOfMonthOrdinalParse:Ffe,relativeTime:Bfe,months:ige,monthsShort:R7,week:pge,weekdays:Cge,weekdaysMin:_ge,weekdaysShort:M7,meridiemParse:Vge},Sr={},Ip={},tv;function zge(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function M3(t){return t&&t.toLowerCase().replace("_","-")}function Uge(t){for(var e=0,r,n,i,s;e<t.length;){for(s=M3(t[e]).split("-"),r=s.length,n=M3(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=m_(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&zge(s,n)>=r-1)break;r--}e++}return tv}function Yge(t){return!!(t&&t.match("^[^/\\\\]*$"))}function m_(t){var e=null,r;if(Sr[t]===void 0&&typeof jS<"u"&&jS&&jS.exports&&Yge(t))try{e=tv._abbr,r=require,r("./locale/"+t),Ku(e)}catch{Sr[t]=null}return Sr[t]}function Ku(t,e){var r;return t&&(ns(e)?r=Dc(t):r=oI(t,e),r?tv=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),tv._abbr}function oI(t,e){if(e!==null){var r,n=I7;if(e.abbr=t,Sr[t]!=null)y7("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Sr[t]._config;else if(e.parentLocale!=null)if(Sr[e.parentLocale]!=null)n=Sr[e.parentLocale]._config;else if(r=m_(e.parentLocale),r!=null)n=r._config;else return Ip[e.parentLocale]||(Ip[e.parentLocale]=[]),Ip[e.parentLocale].push({name:t,config:e}),null;return Sr[t]=new XO(qP(n,e)),Ip[t]&&Ip[t].forEach(function(i){oI(i.name,i.config)}),Ku(t),Sr[t]}else return delete Sr[t],null}function Gge(t,e){if(e!=null){var r,n,i=I7;Sr[t]!=null&&Sr[t].parentLocale!=null?Sr[t].set(qP(Sr[t]._config,e)):(n=m_(t),n!=null&&(i=n._config),e=qP(i,e),n==null&&(e.abbr=t),r=new XO(e),r.parentLocale=Sr[t],Sr[t]=r),Ku(t)}else Sr[t]!=null&&(Sr[t].parentLocale!=null?(Sr[t]=Sr[t].parentLocale,t===Ku()&&Ku(t)):Sr[t]!=null&&delete Sr[t]);return Sr[t]}function Dc(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return tv;if(!Sa(t)){if(e=m_(t),e)return e;t=[t]}return Uge(t)}function Kge(){return XP(Sr)}function aI(t){var e,r=t._a;return r&&rt(t).overflow===-2&&(e=r[fc]<0||r[fc]>11?fc:r[yl]<1||r[yl]>rI(r[Si],r[fc])?yl:r[Tn]<0||r[Tn]>24||r[Tn]===24&&(r[pa]!==0||r[gc]!==0||r[Sh]!==0)?Tn:r[pa]<0||r[pa]>59?pa:r[gc]<0||r[gc]>59?gc:r[Sh]<0||r[Sh]>999?Sh:-1,rt(t)._overflowDayOfYear&&(e<Si||e>yl)&&(e=yl),rt(t)._overflowWeeks&&e===-1&&(e=Jfe),rt(t)._overflowWeekday&&e===-1&&(e=Zfe),rt(t).overflow=e),t}var qge=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Xge=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Qge=/Z|[+-]\d\d(?::?\d\d)?/,rb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],LE=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Jge=/^\/?Date\((-?\d+)/i,Zge=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,eme={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function j7(t){var e,r,n=t._i,i=qge.exec(n)||Xge.exec(n),s,o,a,c,u=rb.length,d=LE.length;if(i){for(rt(t).iso=!0,e=0,r=u;e<r;e++)if(rb[e][1].exec(i[1])){o=rb[e][0],s=rb[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,r=d;e<r;e++)if(LE[e][1].exec(i[3])){a=(i[2]||" ")+LE[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(Qge.exec(i[4]))c="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(c||""),cI(t)}else t._isValid=!1}function tme(t,e,r,n,i,s){var o=[rme(t),R7.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function rme(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function nme(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function ime(t,e,r){if(t){var n=M7.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return rt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function sme(t,e,r){if(t)return eme[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function H7(t){var e=Zge.exec(nme(t._i)),r;if(e){if(r=tme(e[4],e[3],e[2],e[5],e[6],e[7]),!ime(e[1],r,t))return;t._a=r,t._tzm=sme(e[8],e[9],e[10]),t._d=Zy.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),rt(t).rfc2822=!0}else t._isValid=!1}function ome(t){var e=Jge.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(j7(t),t._isValid===!1)delete t._isValid;else return;if(H7(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:ce.createFromInputFallback(t)}ce.createFromInputFallback=jo("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function bg(t,e,r){return t??e??r}function ame(t){var e=new Date(ce.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function lI(t){var e,r,n=[],i,s,o;if(!t._d){for(i=ame(t),t._w&&t._a[yl]==null&&t._a[fc]==null&&lme(t),t._dayOfYear!=null&&(o=bg(t._a[Si],i[Si]),(t._dayOfYear>ay(o)||t._dayOfYear===0)&&(rt(t)._overflowDayOfYear=!0),r=Zy(o,0,t._dayOfYear),t._a[fc]=r.getUTCMonth(),t._a[yl]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Tn]===24&&t._a[pa]===0&&t._a[gc]===0&&t._a[Sh]===0&&(t._nextDay=!0,t._a[Tn]=0),t._d=(t._useUTC?Zy:gge).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Tn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(rt(t).weekdayMismatch=!0)}}function lme(t){var e,r,n,i,s,o,a,c,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,r=bg(e.GG,t._a[Si],ev(mr(),1,4).year),n=bg(e.W,1),i=bg(e.E,1),(i<1||i>7)&&(c=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=ev(mr(),s,o),r=bg(e.gg,t._a[Si],u.year),n=bg(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(c=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(c=!0)):i=s),n<1||n>Sc(r,s,o)?rt(t)._overflowWeeks=!0:c!=null?rt(t)._overflowWeekday=!0:(a=P7(r,n,i,s,o),t._a[Si]=a.year,t._dayOfYear=a.dayOfYear)}ce.ISO_8601=function(){};ce.RFC_2822=function(){};function cI(t){if(t._f===ce.ISO_8601){j7(t);return}if(t._f===ce.RFC_2822){H7(t);return}t._a=[],rt(t).empty=!0;var e=""+t._i,r,n,i,s,o,a=e.length,c=0,u,d;for(i=v7(t._f,t._locale).match(QO)||[],d=i.length,r=0;r<d;r++)s=i[r],n=(e.match(qfe(s,t))||[])[0],n&&(o=e.substr(0,e.indexOf(n)),o.length>0&&rt(t).unusedInput.push(o),e=e.slice(e.indexOf(n)+n.length),c+=n.length),lm[s]?(n?rt(t).empty=!1:rt(t).unusedTokens.push(s),Qfe(s,n,t)):t._strict&&!n&&rt(t).unusedTokens.push(s);rt(t).charsLeftOver=a-c,e.length>0&&rt(t).unusedInput.push(e),t._a[Tn]<=12&&rt(t).bigHour===!0&&t._a[Tn]>0&&(rt(t).bigHour=void 0),rt(t).parsedDateParts=t._a.slice(0),rt(t).meridiem=t._meridiem,t._a[Tn]=cme(t._locale,t._a[Tn],t._meridiem),u=rt(t).era,u!==null&&(t._a[Si]=t._locale.erasConvertYear(u,t._a[Si])),lI(t),aI(t)}function cme(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function ume(t){var e,r,n,i,s,o,a=!1,c=t._f.length;if(c===0){rt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<c;i++)s=0,o=!1,e=qO({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],cI(e),KO(e)&&(o=!0),s+=rt(e).charsLeftOver,s+=rt(e).unusedTokens.length*10,rt(e).score=s,a?s<n&&(n=s,r=e):(n==null||s<n||o)&&(n=s,r=e,o&&(a=!0));Ou(t,r||e)}function dme(t){if(!t._d){var e=JO(t._i),r=e.day===void 0?e.date:e.day;t._a=m7([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),lI(t)}}function hme(t){var e=new zv(aI($7(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function $7(t){var e=t._i,r=t._f;return t._locale=t._locale||Dc(t._l),e===null||r===void 0&&e===""?l_({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Ca(e)?new zv(aI(e)):(Wv(e)?t._d=e:Sa(r)?ume(t):r?cI(t):fme(t),KO(t)||(t._d=null),t))}function fme(t){var e=t._i;ns(e)?t._d=new Date(ce.now()):Wv(e)?t._d=new Date(e.valueOf()):typeof e=="string"?ome(t):Sa(e)?(t._a=m7(e.slice(0),function(r){return parseInt(r,10)}),lI(t)):$h(e)?dme(t):Pc(e)?t._d=new Date(e):ce.createFromInputFallback(t)}function D7(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),($h(t)&&GO(t)||Sa(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,hme(s)}function mr(t,e,r,n){return D7(t,e,r,n,!1)}var gme=jo("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=mr.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:l_()}),mme=jo("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=mr.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:l_()});function L7(t,e){var r,n;if(e.length===1&&Sa(e[0])&&(e=e[0]),!e.length)return mr();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function pme(){var t=[].slice.call(arguments,0);return L7("isBefore",t)}function yme(){var t=[].slice.call(arguments,0);return L7("isAfter",t)}var vme=function(){return Date.now?Date.now():+new Date},jp=["year","quarter","month","week","day","hour","minute","second","millisecond"];function wme(t){var e,r=!1,n,i=jp.length;for(e in t)if(Mt(t,e)&&!(tn.call(jp,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[jp[n]]){if(r)return!1;parseFloat(t[jp[n]])!==bt(t[jp[n]])&&(r=!0)}return!0}function bme(){return this._isValid}function xme(){return Ta(NaN)}function p_(t){var e=JO(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,c=e.minute||0,u=e.second||0,d=e.millisecond||0;this._isValid=wme(e),this._milliseconds=+d+u*1e3+c*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=Dc(),this._bubble()}function dS(t){return t instanceof p_}function JP(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Sme(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<n;o++)bt(t[o])!==bt(e[o])&&s++;return s+i}function F7(t,e){Fe(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Nl(~~(r/60),2)+e+Nl(~~r%60,2)})}F7("Z",":");F7("ZZ","");ke("Z",f_);ke("ZZ",f_);Xt(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=uI(f_,t)});var Cme=/([\+\-]|\d\d)/gi;function uI(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(Cme)||["-",0,0],s=+(i[1]*60)+bt(i[2]),s===0?0:i[0]==="+"?s:-s)}function dI(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(Ca(t)||Wv(t)?t.valueOf():mr(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ce.updateOffset(r,!1),r):mr(t).local()}function ZP(t){return-Math.round(t._d.getTimezoneOffset())}ce.updateOffset=function(){};function _me(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=uI(f_,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=ZP(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?W7(this,Ta(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ce.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:ZP(this)}function Rme(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Eme(t){return this.utcOffset(0,t)}function Nme(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(ZP(this),"m")),this}function kme(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=uI(Gfe,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Tme(t){return this.isValid()?(t=t?mr(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Pme(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Mme(){if(!ns(this._isDSTShifted))return this._isDSTShifted;var t={},e;return qO(t,this),t=$7(t),t._a?(e=t._isUTC?Ol(t._a):mr(t._a),this._isDSTShifted=this.isValid()&&Sme(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ame(){return this.isValid()?!this._isUTC:!1}function Ome(){return this.isValid()?this._isUTC:!1}function V7(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Ime=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,jme=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ta(t,e){var r=t,n=null,i,s,o;return dS(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Pc(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=Ime.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:bt(n[yl])*i,h:bt(n[Tn])*i,m:bt(n[pa])*i,s:bt(n[gc])*i,ms:bt(JP(n[Sh]*1e3))*i}):(n=jme.exec(t))?(i=n[1]==="-"?-1:1,r={y:vd(n[2],i),M:vd(n[3],i),w:vd(n[4],i),d:vd(n[5],i),h:vd(n[6],i),m:vd(n[7],i),s:vd(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=Hme(mr(r.from),mr(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new p_(r),dS(t)&&Mt(t,"_locale")&&(s._locale=t._locale),dS(t)&&Mt(t,"_isValid")&&(s._isValid=t._isValid),s}Ta.fn=p_.prototype;Ta.invalid=xme;function vd(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function A3(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function Hme(t,e){var r;return t.isValid()&&e.isValid()?(e=dI(e,t),t.isBefore(e)?r=A3(t,e):(r=A3(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function B7(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(y7(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=Ta(r,n),W7(this,i,t),this}}function W7(t,e,r,n){var i=e._milliseconds,s=JP(e._days),o=JP(e._months);t.isValid()&&(n=n??!0,o&&N7(t,Jy(t,"Month")+o*r),s&&_7(t,"Date",Jy(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&ce.updateOffset(t,s||o))}var $me=B7(1,"add"),Dme=B7(-1,"subtract");function z7(t){return typeof t=="string"||t instanceof String}function Lme(t){return Ca(t)||Wv(t)||z7(t)||Pc(t)||Vme(t)||Fme(t)||t===null||t===void 0}function Fme(t){var e=$h(t)&&!GO(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=n.length;for(i=0;i<o;i+=1)s=n[i],r=r||Mt(t,s);return e&&r}function Vme(t){var e=Sa(t),r=!1;return e&&(r=t.filter(function(n){return!Pc(n)&&z7(t)}).length===0),e&&r}function Bme(t){var e=$h(t)&&!GO(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||Mt(t,s);return e&&r}function Wme(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function zme(t,e){arguments.length===1&&(arguments[0]?Lme(arguments[0])?(t=arguments[0],e=void 0):Bme(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||mr(),n=dI(r,this).startOf("day"),i=ce.calendarFormat(this,n)||"sameElse",s=e&&(Il(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,mr(r)))}function Ume(){return new zv(this)}function Yme(t,e){var r=Ca(t)?t:mr(t);return this.isValid()&&r.isValid()?(e=Ho(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function Gme(t,e){var r=Ca(t)?t:mr(t);return this.isValid()&&r.isValid()?(e=Ho(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function Kme(t,e,r,n){var i=Ca(t)?t:mr(t),s=Ca(e)?e:mr(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function qme(t,e){var r=Ca(t)?t:mr(t),n;return this.isValid()&&r.isValid()?(e=Ho(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function Xme(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function Qme(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function Jme(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=dI(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Ho(e),e){case"year":s=hS(this,n)/12;break;case"month":s=hS(this,n);break;case"quarter":s=hS(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:Co(s)}function hS(t,e){if(t.date()<e.date())return-hS(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}ce.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ce.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Zme(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function epe(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?uS(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Il(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",uS(r,"Z")):uS(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function tpe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function rpe(t){t||(t=this.isUtc()?ce.defaultFormatUtc:ce.defaultFormat);var e=uS(this,t);return this.localeData().postformat(e)}function npe(t,e){return this.isValid()&&(Ca(t)&&t.isValid()||mr(t).isValid())?Ta({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function ipe(t){return this.from(mr(),t)}function spe(t,e){return this.isValid()&&(Ca(t)&&t.isValid()||mr(t).isValid())?Ta({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function ope(t){return this.to(mr(),t)}function U7(t){var e;return t===void 0?this._locale._abbr:(e=Dc(t),e!=null&&(this._locale=e),this)}var Y7=jo("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function G7(){return this._locale}var xC=1e3,cm=60*xC,SC=60*cm,K7=(365*400+97)*24*SC;function um(t,e){return(t%e+e)%e}function q7(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-K7:new Date(t,e,r).valueOf()}function X7(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-K7:Date.UTC(t,e,r)}function ape(t){var e,r;if(t=Ho(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?X7:q7,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=um(e+(this._isUTC?0:this.utcOffset()*cm),SC);break;case"minute":e=this._d.valueOf(),e-=um(e,cm);break;case"second":e=this._d.valueOf(),e-=um(e,xC);break}return this._d.setTime(e),ce.updateOffset(this,!0),this}function lpe(t){var e,r;if(t=Ho(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?X7:q7,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=SC-um(e+(this._isUTC?0:this.utcOffset()*cm),SC)-1;break;case"minute":e=this._d.valueOf(),e+=cm-um(e,cm)-1;break;case"second":e=this._d.valueOf(),e+=xC-um(e,xC)-1;break}return this._d.setTime(e),ce.updateOffset(this,!0),this}function cpe(){return this._d.valueOf()-(this._offset||0)*6e4}function upe(){return Math.floor(this.valueOf()/1e3)}function dpe(){return new Date(this.valueOf())}function hpe(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function fpe(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function gpe(){return this.isValid()?this.toISOString():null}function mpe(){return KO(this)}function ppe(){return Ou({},rt(this))}function ype(){return rt(this).overflow}function vpe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Fe("N",0,0,"eraAbbr");Fe("NN",0,0,"eraAbbr");Fe("NNN",0,0,"eraAbbr");Fe("NNNN",0,0,"eraName");Fe("NNNNN",0,0,"eraNarrow");Fe("y",["y",1],"yo","eraYear");Fe("y",["yy",2],0,"eraYear");Fe("y",["yyy",3],0,"eraYear");Fe("y",["yyyy",4],0,"eraYear");ke("N",hI);ke("NN",hI);ke("NNN",hI);ke("NNNN",Tpe);ke("NNNNN",Ppe);Xt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?rt(r).era=i:rt(r).invalidEra=t});ke("y",Zm);ke("yy",Zm);ke("yyy",Zm);ke("yyyy",Zm);ke("yo",Mpe);Xt(["y","yy","yyy","yyyy"],Si);Xt(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Si]=r._locale.eraYearOrdinalParse(t,i):e[Si]=parseInt(t,10)});function wpe(t,e){var r,n,i,s=this._eras||Dc("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=ce(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=ce(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function bpe(t,e,r){var n,i,s=this.eras(),o,a,c;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(o=s[n].name.toUpperCase(),a=s[n].abbr.toUpperCase(),c=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[n];break;case"NNNN":if(o===t)return s[n];break;case"NNNNN":if(c===t)return s[n];break}else if([o,a,c].indexOf(t)>=0)return s[n]}function xpe(t,e){var r=t.since<=t.until?1:-1;return e===void 0?ce(t.since).year():ce(t.since).year()+(e-t.offset)*r}function Spe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function Cpe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function _pe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function Rpe(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-ce(i[t].since).year())*r+i[t].offset;return this.year()}function Epe(t){return Mt(this,"_erasNameRegex")||fI.call(this),t?this._erasNameRegex:this._erasRegex}function Npe(t){return Mt(this,"_erasAbbrRegex")||fI.call(this),t?this._erasAbbrRegex:this._erasRegex}function kpe(t){return Mt(this,"_erasNarrowRegex")||fI.call(this),t?this._erasNarrowRegex:this._erasRegex}function hI(t,e){return e.erasAbbrRegex(t)}function Tpe(t,e){return e.erasNameRegex(t)}function Ppe(t,e){return e.erasNarrowRegex(t)}function Mpe(t,e){return e._eraYearOrdinalRegex||Zm}function fI(){var t=[],e=[],r=[],n=[],i,s,o,a,c,u=this.eras();for(i=0,s=u.length;i<s;++i)o=xc(u[i].name),a=xc(u[i].abbr),c=xc(u[i].narrow),e.push(o),t.push(a),r.push(c),n.push(o),n.push(a),n.push(c);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Fe(0,["gg",2],0,function(){return this.weekYear()%100});Fe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function y_(t,e){Fe(0,[t,t.length],0,e)}y_("gggg","weekYear");y_("ggggg","weekYear");y_("GGGG","isoWeekYear");y_("GGGGG","isoWeekYear");ke("G",h_);ke("g",h_);ke("GG",pr,ro);ke("gg",pr,ro);ke("GGGG",eI,ZO);ke("gggg",eI,ZO);ke("GGGGG",d_,c_);ke("ggggg",d_,c_);Yv(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=bt(t)});Yv(["gg","GG"],function(t,e,r,n){e[n]=ce.parseTwoDigitYear(t)});function Ape(t){return Q7.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Ope(t){return Q7.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Ipe(){return Sc(this.year(),1,4)}function jpe(){return Sc(this.isoWeekYear(),1,4)}function Hpe(){var t=this.localeData()._week;return Sc(this.year(),t.dow,t.doy)}function $pe(){var t=this.localeData()._week;return Sc(this.weekYear(),t.dow,t.doy)}function Q7(t,e,r,n,i){var s;return t==null?ev(this,n,i).year:(s=Sc(t,n,i),e>s&&(e=s),Dpe.call(this,t,e,r,n,i))}function Dpe(t,e,r,n,i){var s=P7(t,e,r,n,i),o=Zy(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Fe("Q",0,"Qo","quarter");ke("Q",w7);Xt("Q",function(t,e){e[fc]=(bt(t)-1)*3});function Lpe(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Fe("D",["DD",2],"Do","date");ke("D",pr,ep);ke("DD",pr,ro);ke("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Xt(["D","DD"],yl);Xt("Do",function(t,e){e[yl]=bt(t.match(pr)[0])});var J7=tp("Date",!0);Fe("DDD",["DDDD",3],"DDDo","dayOfYear");ke("DDD",u_);ke("DDDD",b7);Xt(["DDD","DDDD"],function(t,e,r){r._dayOfYear=bt(t)});function Fpe(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Fe("m",["mm",2],0,"minute");ke("m",pr,tI);ke("mm",pr,ro);Xt(["m","mm"],pa);var Vpe=tp("Minutes",!1);Fe("s",["ss",2],0,"second");ke("s",pr,tI);ke("ss",pr,ro);Xt(["s","ss"],gc);var Bpe=tp("Seconds",!1);Fe("S",0,0,function(){return~~(this.millisecond()/100)});Fe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Fe(0,["SSS",3],0,"millisecond");Fe(0,["SSSS",4],0,function(){return this.millisecond()*10});Fe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Fe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Fe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Fe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Fe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ke("S",u_,w7);ke("SS",u_,ro);ke("SSS",u_,b7);var Iu,Z7;for(Iu="SSSS";Iu.length<=9;Iu+="S")ke(Iu,Zm);function Wpe(t,e){e[Sh]=bt(("0."+t)*1e3)}for(Iu="S";Iu.length<=9;Iu+="S")Xt(Iu,Wpe);Z7=tp("Milliseconds",!1);Fe("z",0,0,"zoneAbbr");Fe("zz",0,0,"zoneName");function zpe(){return this._isUTC?"UTC":""}function Upe(){return this._isUTC?"Coordinated Universal Time":""}var pe=zv.prototype;pe.add=$me;pe.calendar=zme;pe.clone=Ume;pe.diff=Jme;pe.endOf=lpe;pe.format=rpe;pe.from=npe;pe.fromNow=ipe;pe.to=spe;pe.toNow=ope;pe.get=tge;pe.invalidAt=ype;pe.isAfter=Yme;pe.isBefore=Gme;pe.isBetween=Kme;pe.isSame=qme;pe.isSameOrAfter=Xme;pe.isSameOrBefore=Qme;pe.isValid=mpe;pe.lang=Y7;pe.locale=U7;pe.localeData=G7;pe.max=mme;pe.min=gme;pe.parsingFlags=ppe;pe.set=rge;pe.startOf=ape;pe.subtract=Dme;pe.toArray=hpe;pe.toObject=fpe;pe.toDate=dpe;pe.toISOString=epe;pe.inspect=tpe;typeof Symbol<"u"&&Symbol.for!=null&&(pe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});pe.toJSON=gpe;pe.toString=Zme;pe.unix=upe;pe.valueOf=cpe;pe.creationData=vpe;pe.eraName=Spe;pe.eraNarrow=Cpe;pe.eraAbbr=_pe;pe.eraYear=Rpe;pe.year=C7;pe.isLeapYear=ege;pe.weekYear=Ape;pe.isoWeekYear=Ope;pe.quarter=pe.quarters=Lpe;pe.month=k7;pe.daysInMonth=dge;pe.week=pe.weeks=wge;pe.isoWeek=pe.isoWeeks=bge;pe.weeksInYear=Hpe;pe.weeksInWeekYear=$pe;pe.isoWeeksInYear=Ipe;pe.isoWeeksInISOWeekYear=jpe;pe.date=J7;pe.day=pe.days=Oge;pe.weekday=Ige;pe.isoWeekday=jge;pe.dayOfYear=Fpe;pe.hour=pe.hours=Bge;pe.minute=pe.minutes=Vpe;pe.second=pe.seconds=Bpe;pe.millisecond=pe.milliseconds=Z7;pe.utcOffset=_me;pe.utc=Eme;pe.local=Nme;pe.parseZone=kme;pe.hasAlignedHourOffset=Tme;pe.isDST=Pme;pe.isLocal=Ame;pe.isUtcOffset=Ome;pe.isUtc=V7;pe.isUTC=V7;pe.zoneAbbr=zpe;pe.zoneName=Upe;pe.dates=jo("dates accessor is deprecated. Use date instead.",J7);pe.months=jo("months accessor is deprecated. Use month instead",k7);pe.years=jo("years accessor is deprecated. Use year instead",C7);pe.zone=jo("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Rme);pe.isDSTShifted=jo("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Mme);function Ype(t){return mr(t*1e3)}function Gpe(){return mr.apply(null,arguments).parseZone()}function eU(t){return t}var At=XO.prototype;At.calendar=Afe;At.longDateFormat=Hfe;At.invalidDate=Dfe;At.ordinal=Vfe;At.preparse=eU;At.postformat=eU;At.relativeTime=Wfe;At.pastFuture=zfe;At.set=Pfe;At.eras=wpe;At.erasParse=bpe;At.erasConvertYear=xpe;At.erasAbbrRegex=Npe;At.erasNameRegex=Epe;At.erasNarrowRegex=kpe;At.months=age;At.monthsShort=lge;At.monthsParse=uge;At.monthsRegex=fge;At.monthsShortRegex=hge;At.week=mge;At.firstDayOfYear=vge;At.firstDayOfWeek=yge;At.weekdays=kge;At.weekdaysMin=Pge;At.weekdaysShort=Tge;At.weekdaysParse=Age;At.weekdaysRegex=Hge;At.weekdaysShortRegex=$ge;At.weekdaysMinRegex=Dge;At.isPM=Fge;At.meridiem=Wge;function CC(t,e,r,n){var i=Dc(),s=Ol().set(n,e);return i[r](s,t)}function tU(t,e,r){if(Pc(t)&&(e=t,t=void 0),t=t||"",e!=null)return CC(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=CC(t,n,r,"month");return i}function gI(t,e,r,n){typeof t=="boolean"?(Pc(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Pc(e)&&(r=e,e=void 0),e=e||"");var i=Dc(),s=t?i._week.dow:0,o,a=[];if(r!=null)return CC(e,(r+s)%7,n,"day");for(o=0;o<7;o++)a[o]=CC(e,(o+s)%7,n,"day");return a}function Kpe(t,e){return tU(t,e,"months")}function qpe(t,e){return tU(t,e,"monthsShort")}function Xpe(t,e,r){return gI(t,e,r,"weekdays")}function Qpe(t,e,r){return gI(t,e,r,"weekdaysShort")}function Jpe(t,e,r){return gI(t,e,r,"weekdaysMin")}Ku("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=bt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});ce.lang=jo("moment.lang is deprecated. Use moment.locale instead.",Ku);ce.langData=jo("moment.langData is deprecated. Use moment.localeData instead.",Dc);var Ll=Math.abs;function Zpe(){var t=this._data;return this._milliseconds=Ll(this._milliseconds),this._days=Ll(this._days),this._months=Ll(this._months),t.milliseconds=Ll(t.milliseconds),t.seconds=Ll(t.seconds),t.minutes=Ll(t.minutes),t.hours=Ll(t.hours),t.months=Ll(t.months),t.years=Ll(t.years),this}function rU(t,e,r,n){var i=Ta(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function e0e(t,e){return rU(this,t,e,1)}function t0e(t,e){return rU(this,t,e,-1)}function O3(t){return t<0?Math.floor(t):Math.ceil(t)}function r0e(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,o,a,c;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=O3(eM(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Co(t/1e3),n.seconds=i%60,s=Co(i/60),n.minutes=s%60,o=Co(s/60),n.hours=o%24,e+=Co(o/24),c=Co(nU(e)),r+=c,e-=O3(eM(c)),a=Co(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function nU(t){return t*4800/146097}function eM(t){return t*146097/4800}function n0e(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Ho(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+nU(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(eM(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Lc(t){return function(){return this.as(t)}}var iU=Lc("ms"),i0e=Lc("s"),s0e=Lc("m"),o0e=Lc("h"),a0e=Lc("d"),l0e=Lc("w"),c0e=Lc("M"),u0e=Lc("Q"),d0e=Lc("y"),h0e=iU;function f0e(){return Ta(this)}function g0e(t){return t=Ho(t),this.isValid()?this[t+"s"]():NaN}function pf(t){return function(){return this.isValid()?this._data[t]:NaN}}var m0e=pf("milliseconds"),p0e=pf("seconds"),y0e=pf("minutes"),v0e=pf("hours"),w0e=pf("days"),b0e=pf("months"),x0e=pf("years");function S0e(){return Co(this.days()/7)}var sc=Math.round,zg={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function C0e(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function _0e(t,e,r,n){var i=Ta(t).abs(),s=sc(i.as("s")),o=sc(i.as("m")),a=sc(i.as("h")),c=sc(i.as("d")),u=sc(i.as("M")),d=sc(i.as("w")),f=sc(i.as("y")),h=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||a<=1&&["h"]||a<r.h&&["hh",a]||c<=1&&["d"]||c<r.d&&["dd",c];return r.w!=null&&(h=h||d<=1&&["w"]||d<r.w&&["ww",d]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],h[2]=e,h[3]=+t>0,h[4]=n,C0e.apply(null,h)}function R0e(t){return t===void 0?sc:typeof t=="function"?(sc=t,!0):!1}function E0e(t,e){return zg[t]===void 0?!1:e===void 0?zg[t]:(zg[t]=e,t==="s"&&(zg.ss=e-1),!0)}function N0e(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=zg,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},zg,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=_0e(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var FE=Math.abs;function kf(t){return(t>0)-(t<0)||+t}function v_(){if(!this.isValid())return this.localeData().invalidDate();var t=FE(this._milliseconds)/1e3,e=FE(this._days),r=FE(this._months),n,i,s,o,a=this.asSeconds(),c,u,d,f;return a?(n=Co(t/60),i=Co(n/60),t%=60,n%=60,s=Co(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",c=a<0?"-":"",u=kf(this._months)!==kf(a)?"-":"",d=kf(this._days)!==kf(a)?"-":"",f=kf(this._milliseconds)!==kf(a)?"-":"",c+"P"+(s?u+s+"Y":"")+(r?u+r+"M":"")+(e?d+e+"D":"")+(i||n||t?"T":"")+(i?f+i+"H":"")+(n?f+n+"M":"")+(t?f+o+"S":"")):"P0D"}var Nt=p_.prototype;Nt.isValid=bme;Nt.abs=Zpe;Nt.add=e0e;Nt.subtract=t0e;Nt.as=n0e;Nt.asMilliseconds=iU;Nt.asSeconds=i0e;Nt.asMinutes=s0e;Nt.asHours=o0e;Nt.asDays=a0e;Nt.asWeeks=l0e;Nt.asMonths=c0e;Nt.asQuarters=u0e;Nt.asYears=d0e;Nt.valueOf=h0e;Nt._bubble=r0e;Nt.clone=f0e;Nt.get=g0e;Nt.milliseconds=m0e;Nt.seconds=p0e;Nt.minutes=y0e;Nt.hours=v0e;Nt.days=w0e;Nt.weeks=S0e;Nt.months=b0e;Nt.years=x0e;Nt.humanize=N0e;Nt.toISOString=v_;Nt.toString=v_;Nt.toJSON=v_;Nt.locale=U7;Nt.localeData=G7;Nt.toIsoString=jo("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",v_);Nt.lang=Y7;Fe("X",0,0,"unix");Fe("x",0,0,"valueOf");ke("x",h_);ke("X",Kfe);Xt("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Xt("x",function(t,e,r){r._d=new Date(bt(t))});//! moment.js
ce.version="2.30.1";kfe(mr);ce.fn=pe;ce.min=pme;ce.max=yme;ce.now=vme;ce.utc=Ol;ce.unix=Ype;ce.months=Kpe;ce.isDate=Wv;ce.locale=Ku;ce.invalid=l_;ce.duration=Ta;ce.isMoment=Ca;ce.weekdays=Xpe;ce.parseZone=Gpe;ce.localeData=Dc;ce.isDuration=dS;ce.monthsShort=qpe;ce.weekdaysMin=Jpe;ce.defineLocale=oI;ce.updateLocale=Gge;ce.locales=Kge;ce.weekdaysShort=Qpe;ce.normalizeUnits=Ho;ce.relativeTimeRounding=R0e;ce.relativeTimeThreshold=E0e;ce.calendarFormat=Wme;ce.prototype=pe;ce.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var k0e=Jt,T0e=Jm,P0e=vs,M0e=bn,A0e=Al,O0e=ws,I0e=ud,j0e=Fv,H0e=cn,sU=TypeError,oU=H0e(function(){[].keys().reduce(function(){},void 0)}),VE=!oU&&I0e("reduce",sU);k0e({target:"Iterator",proto:!0,real:!0,forced:oU||VE},{reduce:function(e){M0e(this);try{P0e(e)}catch(o){O0e(this,"throw",o)}var r=arguments.length<2,n=r?void 0:arguments[1];if(VE)return j0e(VE,this,r?[e]:[e,n]);var i=A0e(this),s=0;if(T0e(i,function(o){r?(r=!1,n=o):n=e(n,o,s),s++},{IS_RECORD:!0}),r)throw new sU("Reduce of empty iterator with no initial value");return n}});function $0e(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function I3(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function fS(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function bs(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Kh(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function _t(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function B(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function D0e(t){const e=[];return B(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function j3(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return B(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function H3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Rt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return bs(t,(s,o,a)=>{const c=o.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return s+c+u},"").trim()}function Mm(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];const i=document.createElement("template");i.innerHTML=t.reduce((a,c,u)=>{var d;return a+c+((d=r[u])!==null&&d!==void 0?d:"")},"");const s=i.content.cloneNode(!0),o={};return s.querySelectorAll("[data-ref]").forEach(a=>{const c=a.getAttribute("data-ref");a.removeAttribute("data-ref"),o[c]=a}),{fragment:s,refs:o}}function sr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function xe(t){return typeof t<"u"}function fr(t){return typeof t>"u"}function qr(t){return t===null||t===""||fr(t)}function L0e(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const $0="length",ly=t=>parseInt(t,16),$3=t=>parseInt(t,10),_C=(t,e,r)=>t.substr(e,r),cy=t=>t.codePointAt(0)-65,tM=t=>`${t}`.replace(/\-/g,""),F0e=t=>ly(_C(tM(t),ly("12"),cy("F")))/(ly(_C(tM(t),cy("B"),~~![][$0]))||9),V0e=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let D3=!1;const L3={invalid:()=>Rt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Rt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Rt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},F3={invalid:()=>Rt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Rt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Rt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function B0e(t,e){const r=!qr(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.2.0";let s,o="invalid",a="invalid";t=tM(t||"");const c=W0e(t);if(r||n||c)if(c){const u=ce("25/11/2025","DD/MM/YYYY"),d=Math.floor(u.toDate().getTime()/864e5),f=F0e(t);s=ce((f+1)*864e5,"x").format("MMMM DD, YYYY"),d>f?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(V0e()&&(o="valid",a="valid"),!D3&&o!=="valid"&&(L3[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](L3[o]({keyValidityDate:s,hotVersion:i})),D3=!0),a!=="valid"&&e&&F3[a]({keyValidityDate:s,hotVersion:i})){const d=document.createElement("div");d.className="handsontable hot-display-license-info",d.innerHTML=F3[a]({keyValidityDate:s,hotVersion:i}),e.appendChild(d)}}function W0e(t){let e=[][$0],r=e;if(t[$0]!==cy("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=cy(i.shift());s;s=cy(i.shift()||"A"))--s<""[$0]?r=r|($3(`${$3(ly(n)+(ly(_C(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=_C(t,s,s?i[$0]===1?9:8:6);return r===e}function _a(t){return t[0].toUpperCase()+t.substr(1)}function aU(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function z0e(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function lU(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function mI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function Cc(t){return pI(`${t}`,{ALLOWED_TAGS:[]})}function pI(t,e){return Nfe.sanitize(t,e)}const Ra=t=>["tabindex",t],U0e=()=>["role","treegrid"],mc=()=>["role","presentation"],Y0e=()=>["role","gridcell"],G0e=()=>["role","gridcell button"],K0e=()=>["role","rowheader"],cU=()=>["role","rowgroup"],q0e=()=>["role","columnheader"],uU=()=>["role","row"],X0e=()=>["role","menu"],Q0e=()=>["role","menuitem"],J0e=()=>["role","menuitemcheckbox"],Z0e=()=>["role","combobox"],dU=()=>["role","listbox"],eye=()=>["role","option"],tye=()=>["role","checkbox"],rye=()=>["role","dialog"],nye=()=>["role","alertdialog"],iye=()=>["scope","col"],sye=()=>["scope","row"],oye=()=>["type","text"],Us=t=>["aria-label",t],aye=t=>["aria-labelledby",t],lye=t=>["aria-describedby",t],yf=()=>["aria-hidden","true"],D0=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},cye=()=>["aria-multiselectable","true"],hU=t=>["aria-haspopup",t],fU=t=>["aria-rowcount",t],w_=t=>["aria-colcount",t],gU=t=>["aria-rowindex",t],yI=t=>["aria-colindex",t],ko=t=>["aria-expanded",t],uye=t=>["aria-sort",t],V3=()=>["aria-readonly","true"],B3=()=>["aria-invalid","true"],mU=t=>["aria-checked",t],vI=()=>["aria-selected","true"],dye=()=>["aria-autocomplete","list"],hye=t=>["aria-controls",t],fye=t=>["aria-activedescendant",t],gye=t=>["aria-live",t],mye=t=>["aria-relevant",t],pye=t=>["aria-setsize",t],yye=t=>["aria-posinset",t],vye=()=>["aria-modal","true"];var wye=eo,bye=AO.get,xye=function(e){if(!wye(e))return!1;var r=bye(e);return!!r&&r.type==="RawJSON"},wI=un,Sye=to,nb=SyntaxError,Cye=parseInt,_ye=String.fromCharCode,Rye=wI("".charAt),W3=wI("".slice),z3=wI(/./.exec),U3={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},Eye=/^[\da-f]{4}$/i,Nye=/^[\u0000-\u001F]$/,kye=function(t,e){for(var r=!0,n="";e<t.length;){var i=Rye(t,e);if(i==="\\"){var s=W3(t,e,e+2);if(Sye(U3,s))n+=U3[s],e+=2;else if(s==="\\u"){e+=2;var o=W3(t,e,e+4);if(!z3(Eye,o))throw new nb("Bad Unicode escape at: "+e);n+=_ye(Cye(o,16)),e+=4}else throw new nb('Unknown escape sequence: "'+s+'"')}else if(i==='"'){r=!1,e++;break}else{if(z3(Nye,i))throw new nb("Bad control character in string literal at: "+e);n+=i,e++}}if(r)throw new nb("Unterminated string at: "+e);return{value:n,end:e}},Tye=cn,Pye=!Tye(function(){var t="9007199254740993",e=JSON.rawJSON(t);return!JSON.isRawJSON(e)||JSON.stringify(e)!==t}),Mye=Jt,pU=Km,Aye=Fv,yU=wn,vf=un,vU=cn,Y3=b8,RC=Pn,Oye=xye,G3=RO,K3=uf,Iye=a_,jye=UO,Hye=kye,$ye=kO,Dye=_O,BE=Pye,wU=String,qu=pU("JSON","stringify"),ib=vf(/./.exec),rM=vf("".charAt),Lye=vf("".charCodeAt),Fye=vf("".replace),WE=vf("".slice),nM=vf([].push),Vye=vf(1.1.toString),Bye=/[\uD800-\uDFFF]/g,q3=/^[\uD800-\uDBFF]$/,X3=/^[\uDC00-\uDFFF]$/,iM=$ye(),Q3=iM.length,bU=!Dye||vU(function(){var t=pU("Symbol")("stringify detection");return qu([t])!=="[null]"||qu({a:t})!=="{}"||qu(Object(t))!=="{}"}),J3=vU(function(){return qu("\uDF06\uD834")!=='"\\udf06\\ud834"'||qu("\uDEAD")!=='"\\udead"'}),Wye=bU?function(t,e){var r=jye(arguments),n=xU(e);if(!(!RC(n)&&(t===void 0||G3(t))))return r[1]=function(i,s){if(RC(n)&&(s=yU(n,this,wU(i),s)),!G3(s))return s},Aye(qu,null,r)}:qu,zye=function(t,e,r){var n=rM(r,e-1),i=rM(r,e+1);return ib(q3,t)&&!ib(X3,i)||ib(X3,t)&&!ib(q3,n)?"\\u"+Vye(Lye(t,0),16):t},xU=function(t){if(RC(t))return t;if(Y3(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?nM(r,i):(typeof i=="number"||K3(i)==="Number"||K3(i)==="String")&&nM(r,Iye(i))}var s=r.length,o=!0;return function(a,c){if(o)return o=!1,c;if(Y3(this))return c;for(var u=0;u<s;u++)if(r[u]===a)return c}}};qu&&Mye({target:"JSON",stat:!0,arity:3,forced:bU||J3||!BE},{stringify:function(e,r,n){var i=xU(r),s=[],o=Wye(e,function(m,g){var p=RC(i)?yU(i,this,wU(m),g):g;return!BE&&Oye(p)?iM+(nM(s,p.rawJSON)-1):p},n);if(typeof o!="string"||(J3&&(o=Fye(o,Bye,zye)),BE))return o;for(var a="",c=o.length,u=0;u<c;u++){var d=rM(o,u);if(d==='"'){var f=Hye(o,++u).end-1,h=WE(o,u,f);a+=WE(h,0,Q3)===iM?s[WE(h,Q3)]:'"'+h+'"',u=f}else a+=d}return a}});function rv(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},at(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=rv(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[rv(r[0])]:e[n]=[]:e[n]=null)})),e}function Uye(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function vn(t,e,r){const n=Array.isArray(r);return at(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function b_(t,e){at(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),b_(t[n],e[n])):t[n]=e[n]})}function Bi(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function kl(t){const e={};return at(t,(r,n)=>{e[n]=r}),e}function Ht(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return B(r,i=>{t.MIXINS.push(i.MIXIN_NAME),at(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(d,f){const h=`_${d}`,m=g=>{let p=g;return(Array.isArray(p)||Le(p))&&(p=Bi(p)),p};return function(){return this[h]===void 0&&(this[h]=m(f)),this[h]}},c=function(d){const f=`_${d}`;return function(h){this[f]=h}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:c(o),configurable:!0})}})}),t}function x_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Le(t){return Object.prototype.toString.call(t)==="[object Object]"}function Fc(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function at(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function sM(t,e){const r=e.split(".");let n=t;return at(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function zE(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==n.length-1?(Kr(i,s)||(i[s]={}),i=i[s]):i[s]=r)})}function bI(t){if(!Le(t))return 0;const e=function(r){let n=0;return Le(r)?at(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function Ks(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Kr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function gS(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?r[n]=gS(t[n],e[n]):r[n]=Kr(t,n)&&t[n]!==void 0?t[n]:e[n]}),Object.keys(t).forEach(n=>{Kr(r,n)||(r[n]=t[n])}),r}function EC(t){return window.requestAnimationFrame(t)}function NC(t){window.cancelAnimationFrame(t)}function SU(){return"ontouchstart"in window}function Yye(){return typeof window<"u"}let Tf;function Gye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Tf||(typeof Intl=="object"?Tf=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Tf=(r,n)=>`${r}`.localeCompare(n):Tf=(r,n)=>r===n?0:r>n?-1:1,Tf)}const po=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},dd={chrome:po((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:po(t=>/CriOS/.test(t)),edge:po(t=>/Edge/.test(t)),edgeWebKit:po(t=>/EdgiOS/.test(t)),firefox:po(t=>/Firefox/.test(t)),firefoxWebKit:po(t=>/FxiOS/.test(t)),mobile:po(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:po((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Gv={mac:po(t=>/^Mac/.test(t)),win:po(t=>/^Win/.test(t)),linux:po(t=>/^Linux/.test(t)),ios:po(t=>/iPhone|iPad|iPod/i.test(t))};function Kye(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};at(dd,r=>{let{test:n}=r;return void n(t,e)})}function qye(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};at(Gv,e=>{let{test:r}=e;return void r(t)})}Yye()&&(Kye(),qye());function CU(){return dd.chrome.value}function Xye(){return dd.chromeWebKit.value}function UE(){return dd.firefox.value}function Qye(){return dd.firefoxWebKit.value}function S_(){return dd.safari.value}function Jye(){return dd.edge.value}function Sl(){return dd.mobile.value}function _U(){return Gv.ios.value}function xI(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Gv.mac.value}function oM(){return Gv.win.value}function Z3(){return Gv.mac.value}function Zye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function mS(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function eve(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function nd(t){return eve(t)&&t.parent}function qh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;const{host:c}=s;c&&o===i?s=c:s=s.parentNode}return null}function sb(t,e,r){const n=[];let i=t;for(;i&&(i=qh(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function tve(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(s=>e.test(s));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function Dh(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function rve(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function wd(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function RU(t){return!t||!t.length?[]:t.filter(e=>!!e)}function EU(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function Ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ee(t,e){typeof e=="string"&&(e=e.split(" ")),e=RU(e),e.length>0&&t.classList.add(...e)}function Re(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=EU(e,!0);r=RU(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function Ne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function _c(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=EU(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function NU(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)NU(e[r])}}function Mc(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const nve=/(<(.*)>|&(.*);)/;function wf(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;nve.test(e)?t.innerHTML=r?pI(e):e:Xh(t,e)}function Xh(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Mc(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Qh(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Qh(n.host.impl);if(n.host)return Qh(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function ive(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function xi(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function kU(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function SI(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function CI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?kU(e):t.scrollTop}function TU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?SI(e):t.scrollLeft}function kC(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function sve(t){return t.scrollHeight-t.clientHeight}function ove(t){return t.scrollWidth-t.clientWidth}function nv(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),c=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(c))return n;n=n.parentNode}return r}function TC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function sn(t){return t.offsetWidth}function yn(t){return t.getBoundingClientRect().height}function uy(t){return t.clientHeight||t.innerHeight}function PU(t){return t.clientWidth||t.innerWidth}function MU(t){return t.selectionStart?t.selectionStart:0}function ave(t){return t.selectionEnd?t.selectionEnd:0}function e4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function C_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let YE;function lve(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return oM()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function cve(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");S_()&&!Sl()&&!xI()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function on(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return YE===void 0&&(YE=cve(t)),YE}function AU(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function OU(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function _I(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function __(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function pS(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function IU(t){return pS(t)&&t.hasAttribute("data-hot-input")===!1}function jU(t){return!t.parentNode}function uve(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function HU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();Ne(t,"contenteditable",!0),r&&Ne(t,...yf()),e&&ee(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function $U(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Re(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function dve(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HU(t,r),e(),$U(t,r)}function Rc(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Tt(t){return typeof t=="function"}function R_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function DU(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function hve(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const c=n.concat(o);let u;return c.length>=e?u=t.apply(this,c):u=r(c),u}}return r([])}function aM(t,e,r,n,i,s,o,a){return xe(a)?t.call(e,r,n,i,s,o,a):xe(o)?t.call(e,r,n,i,s,o):xe(s)?t.call(e,r,n,i,s):xe(i)?t.call(e,r,n,i):xe(n)?t.call(e,r,n):xe(r)?t.call(e,r):t.call(e)}const De={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:UE()?182:174,AUDIO_MUTE:UE()?181:173,AUDIO_UP:UE()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},fve=[De.ALT,De.ARROW_DOWN,De.ARROW_LEFT,De.ARROW_RIGHT,De.ARROW_UP,De.AUDIO_DOWN,De.AUDIO_MUTE,De.AUDIO_UP,De.BACKSPACE,De.CAPS_LOCK,De.DELETE,De.END,De.ENTER,De.ESCAPE,De.F1,De.F2,De.F3,De.F4,De.F5,De.F6,De.F7,De.F8,De.F9,De.F10,De.F11,De.F12,De.F13,De.F14,De.F15,De.F16,De.F17,De.F18,De.F19,De.HOME,De.INSERT,De.MEDIA_NEXT,De.MEDIA_PLAY_PAUSE,De.MEDIA_PREV,De.MEDIA_STOP,De.NULL,De.NUM_LOCK,De.PAGE_DOWN,De.PAGE_UP,De.PAUSE,De.SCROLL_LOCK,De.SHIFT,De.TAB];function gve(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function LU(t){return fve.includes(t)}function mve(t){return[De.CONTROL,De.COMMAND_LEFT,De.COMMAND_RIGHT,De.COMMAND_FIREFOX].includes(t)}function Am(t,e){const r=e.split("|");let n=!1;return B(r,i=>{if(t===De[i])return n=!0,!1}),n}function Ao(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function dh(t){return t.isImmediatePropagationEnabled===!1}function Jh(t){return t.button===2}function RI(t){return t.button===0}function pve(t){return typeof TouchEvent<"u"&&t instanceof TouchEvent}function yve(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!Rc(e)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}function nt(){xe(console)&&console.warn(...arguments)}function FU(t){xe(console)&&console.warn(`Deprecated: ${t}`)}function EI(){xe(console)&&console.error(...arguments)}const hh=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],GE=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),KE=new Map([[]]);var vve=Qm,wve=function(t,e,r){for(var n=0,i=arguments.length>2?r:vve(e),s=new t(i);i>n;)s[n]=e[n++];return s},bve=ln,xve=function(t,e){var r=bve[t],n=r&&r.prototype;return n&&n[e]},Sve=ka,Cve=F8,_ve=$c.f,lM=Sve("unscopables"),cM=Array.prototype;cM[lM]===void 0&&_ve(cM,lM,{configurable:!0,value:Cve(null)});var E_=function(t){cM[lM][t]=!0},Rve=Jt,Eve=un,Nve=vs,kve=jv,Tve=wve,Pve=xve,Mve=E_,Ave=Array,Ove=Eve(Pve("Array","sort"));Rve({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&Nve(e);var r=kve(this),n=Tve(Ave,r);return Ove(n,e)}});Mve("toSorted");var Ive=Jt,jve=wn,Hve=Jm,$ve=vs,Dve=bn,Lve=Al,Fve=ws,Vve=ud,qE=Vve("find",TypeError);Ive({target:"Iterator",proto:!0,real:!0,forced:qE},{find:function(e){Dve(this);try{$ve(e)}catch(i){Fve(this,"throw",i)}if(qE)return jve(qE,this,e);var r=Lve(this),n=0;return Hve(r,function(i,s){if(e(i,n++))return s(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function Bve(t,e){VU(t,e),e.add(t)}function XE(t,e,r){VU(t,e),e.set(t,r)}function VU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t4(t,e,r){return t.set(PC(t,e),r),r}function Xn(t,e){return t.get(PC(t,e))}function PC(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Wve=100;var Os=new WeakMap,xg=new WeakMap,QE=new WeakMap,JE=new WeakSet;class r4{constructor(){Bve(this,JE),XE(this,Os,new Map),XE(this,xg,new Map),XE(this,QE,new Set),hh.forEach(e=>PC(JE,this,n4).call(this,e))}getHooks(e){var r;return(r=Xn(Os,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Xn(Os,this).has(e)||(PC(JE,this,n4).call(this,e),hh.push(e));const i=Xn(Os,this).get(e),s=i.find(d=>d.callback===r);if(s){s.skip===!0&&(s.skip=!1);return}const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,c=!!n.initialHook;let u=!1;if(c){const d=i.find(f=>f.initialHook);d&&(d.callback=r,u=!0)}if(!u){i.push({callback:r,orderIndex:o,runOnce:a,initialHook:c,skip:!1});let d=Xn(QE,this).has(e);!d&&o!==0&&(d=!0,Xn(QE,this).add(e)),d&&i.length>1&&Xn(Os,this).set(e,i.toSorted((f,h)=>f.orderIndex-h.orderIndex))}}has(e){return Xn(Os,this).has(e)&&Xn(Os,this).get(e).length>0}remove(e,r){if(!Xn(Os,this).has(e))return!1;const n=Xn(Os,this).get(e),i=n.find(s=>s.callback===r);if(i){let s=Xn(xg,this).get(e);return i.skip=!0,s+=1,s>Wve&&(Xn(Os,this).set(e,n.filter(o=>!o.skip)),s=0),Xn(xg,this).set(e,s),!0}return!1}destroy(){Xn(Os,this).clear(),Xn(xg,this).clear(),t4(Os,this,null),t4(xg,this,null)}}function n4(t){Xn(Os,this).set(t,[]),Xn(xg,this).set(t,0)}function zve(t,e,r){return(e=Uve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uve(t){var e=Yve(t,"string");return typeof e=="symbol"?e:e+""}function Yve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gve=Rt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class _e{constructor(){zve(this,"globalBucket",new r4)}static getSingleton(){return qve()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new r4),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?B(r,s=>this.add(e,s,n)):(GE.has(e)&&nt(mI(Gve,{hookName:e,removedInVersion:GE.get(e)})),KE.has(e)&&nt(KE.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?B(r,s=>this.once(e,s,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?B(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,s,o,a,c){{const u=this.getBucket().getHooks(r),d=u?u.length:0;let f=0;if(d)for(;f<d;){if(!u[f]||u[f].skip){f+=1;continue}const h=aM(u[f].callback,e,n,i,s,o,a,c);h!==void 0&&(n=h),u[f]&&u[f].runOnce&&this.remove(r,u[f].callback),f+=1}}{const u=this.getBucket(e).getHooks(r),d=u?u.length:0;let f=0;if(d)for(;f<d;){if(!u[f]||u[f].skip){f+=1;continue}const h=aM(u[f].callback,e,n,i,s,o,a,c);h!==void 0&&(n=h),u[f]&&u[f].runOnce&&this.remove(r,u[f].callback,e),f+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||hh.push(e)}deregister(e){this.isRegistered(e)&&hh.splice(hh.indexOf(e),1)}isDeprecated(e){return KE.has(e)||GE.has(e)}isRegistered(e){return hh.indexOf(e)>=0}getRegistered(){return hh}}const Kve=new _e;function qve(){return Kve}const Ch=new Map;function $o(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ch.has(t)||Ch.set(t,new Map);const e=Ch.get(t);function r(c,u){e.set(c,u)}function n(c){return e.get(c)}function i(c){return e.has(c)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){Ch.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o,clear:a}}function Xve(t,e){var r;return Ch==null||(r=Ch.get(t.guid))===null||r===void 0?void 0:r.get(e)}const uM=new WeakMap,{register:Qve,getItem:BU,hasItem:WU,getNames:BWe,getValues:WWe}=$o("editors");function Jve(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},_e.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function zU(t,e){let r;if(typeof t=="function")uM.get(t)||Hs(null,t),r=uM.get(t);else if(typeof t=="string")r=BU(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function dM(t){if(typeof t=="function")return t;if(!WU(t))throw Error(`No registered editor found under "${t}" name`);return BU(t).getConstructor()}function Hs(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new Jve(e);typeof t=="string"&&Qve(t,r),uM.set(e,r)}function Zve(t,e,r){return(e=ewe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ewe(t){var e=twe(t,"string");return typeof e=="symbol"?e:e+""}function twe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ea{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Zve(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,rwe(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function rwe(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ao(this)},t}function nwe(t,e){iwe(t,e),e.add(t)}function iwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bd(t,e,r){return(e=swe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function swe(t){var e=owe(t,"string");return typeof e=="symbol"?e:e+""}function owe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ob=new WeakSet;class hM{constructor(e,r,n){nwe(this,ob),bd(this,"hot",void 0),bd(this,"tableMeta",void 0),bd(this,"selection",void 0),bd(this,"eventManager",void 0),bd(this,"destroyed",!1),bd(this,"activeEditor",void 0),bd(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Ea(e),this.hot.addHook("afterDocumentKeyDown",i=>ZE(ob,this,i4).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>ZE(ob,this,i4).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>ZE(ob,this,awe).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let o=n,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const c=this.hot.getCell(n,i,!0);if(c){const u=this.hot.getCellEditor(this.cellProperties),d=this.hot.colToProp(a),f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=zU(u,this.hot),this.activeEditor.prepare(n,i,d,c,f,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function i4(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||dh(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!LU(r)&&!mve(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function awe(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const s4=new WeakMap;hM.getInstance=function(t,e,r){let n=s4.get(t);return n||(n=new hM(t,e,r),s4.set(t,n)),n};var lwe=eo,cwe=uf,uwe=ka,dwe=uwe("match"),hwe=function(t){var e;return lwe(t)&&((e=t[dwe])!==void 0?!!e:cwe(t)==="RegExp")},fwe=ln,gwe=cn,o4=fwe.RegExp,mwe=!gwe(function(){var t=!0;try{o4(".","d")}catch{t=!1}var e={},r="",n=t?"dgimsy":"gimsy",i=function(c,u){Object.defineProperty(e,c,{get:function(){return r+=u,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};t&&(s.hasIndices="d");for(var o in s)i(o,s[o]);var a=Object.getOwnPropertyDescriptor(o4.prototype,"flags").get.call(e);return a!==n||r!==n}),pwe={correct:mwe},ywe=bn,vwe=function(){var t=ywe(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},wwe=wn,bwe=to,xwe=Hv,a4=pwe,Swe=vwe,Cwe=RegExp.prototype,_we=a4.correct?function(t){return t.flags}:function(t){return!a4.correct&&xwe(Cwe,t)&&!bwe(t,"flags")?wwe(Swe,t):t.flags},NI=un,Rwe=qm,Ewe=Math.floor,eN=NI("".charAt),Nwe=NI("".replace),tN=NI("".slice),kwe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Twe=/\$([$&'`]|\d{1,2})/g,Pwe=function(t,e,r,n,i,s){var o=r+t.length,a=n.length,c=Twe;return i!==void 0&&(i=Rwe(i),c=kwe),Nwe(s,c,function(u,d){var f;switch(eN(d,0)){case"$":return"$";case"&":return t;case"`":return tN(e,0,r);case"'":return tN(e,o);case"<":f=i[tN(d,1,-1)];break;default:var h=+d;if(h===0)return u;if(h>a){var m=Ewe(h/10);return m===0?u:m<=a?n[m-1]===void 0?eN(d,1):n[m-1]+eN(d,1):u}f=n[h-1]}return f===void 0?"":f})},Mwe=Jt,Awe=wn,kI=un,l4=Iv,Owe=Pn,Iwe=eo,jwe=hwe,Hp=a_,Hwe=$v,$we=_we,Dwe=Pwe,Lwe=ka,Fwe=Lwe("replace"),Vwe=TypeError,rN=kI("".indexOf);kI("".replace);var c4=kI("".slice),Bwe=Math.max;Mwe({target:"String",proto:!0},{replaceAll:function(e,r){var n=l4(this),i,s,o,a,c,u,d,f,h,m,g=0,p="";if(Iwe(e)){if(i=jwe(e),i&&(s=Hp(l4($we(e))),!~rN(s,"g")))throw new Vwe("`.replaceAll` does not allow non-global regexes");if(o=Hwe(e,Fwe),o)return Awe(o,e,n,r)}for(a=Hp(n),c=Hp(e),u=Owe(r),u||(r=Hp(r)),d=c.length,f=Bwe(1,d),h=rN(a,c);h!==-1;)m=u?Hp(r(c,h,a)):Dwe(c,a,h,[],void 0,r),p+=c4(a,g,h)+m,g=h+d,h=h+f>a.length?-1:rN(a,c,h+f);return g<a.length&&(p+=c4(a,g)),p}});const UU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Wwe=new RegExp(Object.keys(UU).map(t=>`(${t})`).join("|"),"gi");function zwe(t){return(t&&t.nodeName||"")==="TABLE"}function u4(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],c=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],d=r?1:0,f=e?1:0;for(let h=0;h<s;h+=1){const m=e&&h===0,g=[];for(let y=0;y<o;y+=1){const w=!m&&r&&y===0;let v="";if(m)v=`<th>${t.getColHeader(y-d)}</th>`;else if(w)v=`<th>${t.getRowHeader(h-f)}</th>`;else{const x=i[h][y],{hidden:S,rowspan:N,colspan:R}=t.getCellMeta(h-f,y-d);if(!S){const E=[];if(N&&E.push(`rowspan="${N}"`),R&&E.push(`colspan="${R}"`),qr(x))v=`<td ${E.join(" ")}></td>`;else{const P=x.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${E.join(" ")}>${P}</td>`}}}g.push(v)}const p=["<tr>",...g,"</tr>"].join("");m?c.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,c.join(""),u.join("")),a.join("")}function d4(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,o=[];n===0&&r.push("<tbody>");for(let a=0;a<s;a+=1){const c=i[a],u=qr(c)?"":c.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,d=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(d.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}r.push("<tr>",...o,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function h4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const x=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,S=>{const N=S.match(/<td\b[^>]*?>/g)[0],R=/<p.*?>/g,E=S.substring(N.length,S.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(R,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${N}${E}</td>`});i.insertAdjacentHTML("afterbegin",`${x}`),s=i.querySelector("table")}if(!s||!zwe(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,c=s.querySelector("tr"),u=c?Array.from(c.cells).reduce((x,S)=>x+S.colSpan,0)-(a?1:0):0,d=s.tFoot&&Array.from(s.tFoot.rows)||[],f=[];let h=!1,m=0,g=0;if(s.tHead){const x=Array.from(s.tHead.rows).filter(S=>{const N=S.querySelector("td")!==null;return N&&f.push(S),!N});m=x.length,h=m>0,m>1?r.nestedHeaders=Array.from(x).reduce((S,N)=>{const R=Array.from(N.cells).reduce((E,P,D)=>{if(a&&D===0)return E;const{colSpan:H,innerHTML:Z}=P,I=H>1?{label:Z,colspan:H}:Z;return E.push(I),E},[]);return S.push(R),S},[]):h&&(r.colHeaders=Array.from(x[0].children).reduce((S,N,R)=>(a&&R===0||S.push(N.innerHTML),S),[]))}f.length&&(r.fixedRowsTop=f.length),d.length&&(r.fixedRowsBottom=d.length);const p=[...f,...Array.from(s.tBodies).reduce((x,S)=>(x.push(...Array.from(S.rows)),x),[]),...d];g=p.length;const y=new Array(g);for(let x=0;x<g;x++)y[x]=new Array(u);const w=[],v=[];for(let x=0;x<g;x++){const S=p[x],N=Array.from(S.cells),R=N.length;for(let E=0;E<R;E++){const P=N[E],{nodeName:D,innerHTML:H,rowSpan:Z,colSpan:I}=P,Y=y[x].findIndex(re=>re===void 0);if(D==="TD"){if(Z>1||I>1){for(let ue=x;ue<x+Z;ue++)if(ue<g)for(let Q=Y;Q<Y+I;Q++)y[ue][Q]=null;const ne=P.getAttribute("style");ne&&ne.includes("mso-ignore:colspan")||w.push({col:Y,row:x,rowspan:Z,colspan:I})}let re="";o&&/excel/gi.test(o.content)?re=H.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):re=H.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[x][Y]=re.replace(Wwe,ne=>UU[ne])}else v.push(H)}}return w.length&&(r.mergeCells=w),v.length&&(r.rowHeaders=v),y.length&&(r.data=y),r}function Di(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Uwe(t){return Di(t,[","])}function Oe(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function f4(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function YU(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ut(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function Ywe(t){const e=t.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function dm(t){return Number.isInteger(t)&&t>=0}const fM="asc",Gwe="desc",g4=new Map([[fM,[-1,1]],[Gwe,[1,-1]]]),Kwe=t=>`The priority '${t}' is already declared in a map.`,qwe=t=>`The priority '${t}' is not a number.`;function Xwe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Tt(t)?t:Kwe,e=Tt(e)?e:qwe;function n(s,o){if(!Di(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fM;const[o,a]=g4.get(s)||g4.get(fM);return[...r].sort((c,u)=>c[0]<u[0]?o:a).map(c=>c[1])}return{addItem:n,getItems:i}}const Qwe=t=>`The id '${t}' is already declared in a map.`;function Kv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Tt(t)?t:Qwe;function r(d,f){if(u(d))throw new Error(t(d));e.set(d,f)}function n(d){return e.delete(d)}function i(){e.clear()}function s(d){const[f]=a().find(h=>{let[m,g]=h;return d===g?m:!1})||[null];return f}function o(d){return e.get(d)}function a(){return[...e]}function c(){return[...e.values()]}function u(d){return e.has(d)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,getValues:c,hasItem:u,removeItem:n}}const Jwe=t=>`'${t}' value is already declared in a unique set.`;function Zwe(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Tt(t)?t:Jwe;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const TI=t=>`There is already registered "${t}" plugin.`,ebe=t=>`There is already registered plugin on priority "${t}".`,tbe=t=>`The priority "${t}" is not a number.`,GU=Xwe({errorPriorityExists:ebe,errorPriorityNaN:tbe}),KU=Zwe({errorItemExists:TI}),gM=Kv({errorIdExists:TI});function qU(){return[...GU.getItems(),...KU.getItems()]}function PI(t){const e=_a(t);return gM.getItem(e)}function rbe(t){return!!PI(t)}function ht(t,e,r){[t,e,r]=ibe(t,e,r),PI(t)===void 0&&nbe(t,e,r)}function nbe(t,e,r){const n=_a(t);if(gM.hasItem(n))throw new Error(TI(n));r===void 0?KU.addItem(n):GU.addItem(r,n),gM.addItem(n,e)}function ibe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:sbe,getItem:obe,hasItem:XU,getNames:zWe,getValues:UWe}=$o("renderers");function mM(t){if(typeof t=="function")return t;if(!XU(t))throw Error(`No registered renderer found under "${t}" name`);return obe(t)}function fo(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),sbe(t,e)}const{register:abe,getItem:lbe,hasItem:QU,getNames:YWe,getValues:GWe}=$o("validators");function cbe(t){if(typeof t=="function")return t;if(!QU(t))throw Error(`No registered validator found under "${t}" name`);return lbe(t)}function Sg(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),abe(t,e)}var ube=Jt,dbe=qm,hbe=Qm,fbe=Dv,gbe=E_;ube({target:"Array",proto:!0},{at:function(e){var r=dbe(this),n=hbe(r),i=fbe(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:r[s]}});gbe("at");var mbe=Jt,pbe=un,ybe=Iv,vbe=Dv,wbe=a_,bbe=cn,xbe=pbe("".charAt),Sbe=bbe(function(){return"".at(-2)!=="\uD842"});mbe({target:"String",proto:!0,forced:Sbe},{at:function(e){var r=wbe(ybe(this)),n=r.length,i=vbe(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:xbe(r,s)}});function $p(t,e,r){return(e=Cbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cbe(t){var e=_be(t,"string");return typeof e=="symbol"?e:e+""}function _be(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rbe{constructor(){$p(this,"count",0),$p(this,"startColumn",null),$p(this,"endColumn",null),$p(this,"startPosition",null),$p(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=r,a=i>0?s+1:s;n>=i&&n+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:c,startPositions:u,columnWidth:d}=e;if(this.endColumn===a-1&&c)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+d-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const f=o>0?i+1:i,h=n+i-f,m=this.startColumn===null?0:e.getColumnWidth(this.startColumn);h<-1*s||n>u.at(-1)||-1*n-i>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Dp(t,e,r){return(e=Ebe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ebe(t){var e=Nbe(t,"string");return typeof e=="symbol"?e:e+""}function Nbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kbe{constructor(){Dp(this,"count",0),Dp(this,"startRow",null),Dp(this,"endRow",null),Dp(this,"startPosition",null),Dp(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=r;n>=i&&n+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:c,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=c[this.endRow]+u-c[this.startRow-1];if(h<=i-s&&(this.startRow-=1),h>=i-s)break}this.startPosition=(r=c[this.startRow])!==null&&r!==void 0?r:null;const d=n+i-s,f=this.startRow===null?0:e.getRowHeight(this.startRow);d<f||n>c.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Lp(t,e,r){return(e=Tbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tbe(t){var e=Pbe(t,"string");return typeof e=="symbol"?e:e+""}function Pbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JU{constructor(){Lp(this,"count",0),Lp(this,"startColumn",null),Lp(this,"endColumn",null),Lp(this,"startPosition",null),Lp(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const o=i>0?s+1:s;n>=i&&n<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:c,startPositions:u,columnWidth:d}=e;if(this.endColumn===a-1&&c)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+d-u[this.startColumn-1];if(this.startColumn-=1,m>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const f=o>0?i+1:i;n+i-f<-1*s||n>u.at(-1)+d||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Fp(t,e,r){return(e=Mbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mbe(t){var e=Abe(t,"string");return typeof e=="symbol"?e:e+""}function Abe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZU{constructor(){Fp(this,"count",0),Fp(this,"startRow",null),Fp(this,"endRow",null),Fp(this,"startPosition",null),Fp(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:c,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const f=c[this.endRow]+u-c[this.startRow-1];if(this.startRow-=1,f>=i-s)break}this.startPosition=(r=c[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>c.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vp(t,e,r){return(e=Obe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Obe(t){var e=Ibe(t,"string");return typeof e=="symbol"?e:e+""}function Ibe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jbe{constructor(){Vp(this,"count",0),Vp(this,"startColumn",0),Vp(this,"endColumn",0),Vp(this,"startPosition",0),Vp(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Bp(t,e,r){return(e=Hbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hbe(t){var e=$be(t,"string");return typeof e=="symbol"?e:e+""}function $be(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dbe{constructor(){Bp(this,"count",0),Bp(this,"startRow",0),Bp(this,"endRow",0),Bp(this,"startPosition",0),Bp(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function m4(t,e,r){return(e=Lbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lbe(t){var e=Fbe(t,"string");return typeof e=="symbol"?e:e+""}function Fbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vbe extends JU{constructor(){super(...arguments),m4(this,"columnStartOffset",0),m4(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof n=="function"){const o=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function p4(t,e,r){return(e=Bbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bbe(t){var e=Wbe(t,"string");return typeof e=="symbol"?e:e+""}function Wbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zbe extends ZU{constructor(){super(...arguments),p4(this,"rowStartOffset",0),p4(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof n=="function"){const o=this.startRow,a=this.endRow;n(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function y4(t,e,r){return(e=Ube(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ube(t){var e=Ybe(t,"string");return typeof e=="symbol"?e:e+""}function Ybe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e9{constructor(e){y4(this,"calculationTypes",[]),y4(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Wo(t,e,r){return(e=Gbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gbe(t){var e=Kbe(t,"string");return typeof e=="symbol"?e:e+""}function Kbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Om=50;class qbe extends e9{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:c}=e;super(r),Wo(this,"viewportWidth",0),Wo(this,"scrollOffset",0),Wo(this,"zeroBasedScrollOffset",0),Wo(this,"totalColumns",0),Wo(this,"columnWidthFn",null),Wo(this,"columnWidth",0),Wo(this,"overrideFn",null),Wo(this,"inlineStartOffset",0),Wo(this,"totalCalculatedWidth",0),Wo(this,"startPositions",[]),Wo(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=c,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Om:r}}function oo(t,e,r){return(e=Xbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xbe(t){var e=Qbe(t,"string");return typeof e=="symbol"?e:e+""}function Qbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jbe extends e9{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:c,horizontalScrollbarHeight:u}=e;super(r),oo(this,"viewportHeight",0),oo(this,"scrollOffset",0),oo(this,"zeroBasedScrollOffset",0),oo(this,"totalRows",0),oo(this,"rowHeightFn",null),oo(this,"rowHeight",0),oo(this,"overrideFn",null),oo(this,"horizontalScrollbarHeight",0),oo(this,"innerViewportHeight",0),oo(this,"totalCalculatedHeight",0),oo(this,"startPositions",[]),oo(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=c,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function Zbe(t,e,r){exe(t,e),e.set(t,r)}function exe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v4(t,e,r){return(e=txe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function txe(t){var e=rxe(t,"string");return typeof e=="symbol"?e:e+""}function rxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pf(t,e){return t.get(t9(t,e))}function w4(t,e,r){return t.set(t9(t,e),r),r}function t9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fl=new WeakMap;class Zh{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;v4(this,"row",null),v4(this,"col",null),Zbe(this,Fl,!1),w4(Fl,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Pf(Fl,this)}isSouthEastOf(e){return this.row>=e.row&&(Pf(Fl,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Pf(Fl,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Pf(Fl,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Pf(Fl,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Zh&&w4(Fl,this,e.isRtl()),this}clone(){return new Zh(this.row,this.col,Pf(Fl,this))}toObject(){return{row:this.row,col:this.col}}}function nxe(t,e,r){ixe(t,e),e.set(t,r)}function ixe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nN(t,e,r){return(e=sxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sxe(t){var e=oxe(t,"string");return typeof e=="symbol"?e:e+""}function oxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ao(t,e){return t.get(r9(t,e))}function axe(t,e,r){return t.set(r9(t,e),r),r}function r9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qi=new WeakMap;class rp{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;nN(this,"highlight",null),nN(this,"from",null),nN(this,"to",null),nxe(this,qi,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),axe(qi,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),c=Math.min(n.row,o.row),u=Math.min(n.col,o.col),d=Math.max(i.row,a.row),f=Math.max(i.col,a.col),h=this._createCellCoords(c,u),m=this._createCellCoords(d,f);return this.from=h,this.to=m,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ao(qi,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ao(qi,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ao(qi,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ao(qi,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ao(qi,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ao(qi,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ao(qi,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ao(qi,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Zh))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(ao(qi,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(ao(qi,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new rp(this.highlight,this.from,this.to,ao(qi,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Zh(e,r,ao(qi,this))}}function Da(t,e,r){lxe(t,e),e.set(t,r)}function lxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(n9(t,e))}function Kc(t,e,r){return t.set(n9(t,e),r),r}function n9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var lo=new WeakMap,iN=new WeakMap,In=new WeakMap,Mf=new WeakMap,ab=new WeakMap,zo=new WeakMap,sN=new WeakMap,Wp=new WeakMap,xd=new WeakMap,La=new WeakMap;let i9=class{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Da(this,lo,void 0),Da(this,iN,void 0),Da(this,In,void 0),Da(this,Mf,void 0),Da(this,ab,void 0),Da(this,zo,void 0),Da(this,sN,void 0),Da(this,Wp,void 0),Da(this,xd,[null,null]),Da(this,La,[null,null]),Kc(lo,this,n),Kc(iN,this,r),Kc(In,this,s),Kc(Mf,this,o),Kc(ab,this,a),Kc(zo,this,i),Kc(sN,this,e),this.registerEvents()}registerEvents(){Ie(zo,this).addEventListener(Ie(In,this).holder,"contextmenu",n=>this.onContextMenu(n)),Ie(zo,this).addEventListener(Ie(In,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Ie(zo,this).addEventListener(Ie(In,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Ie(zo,this).addEventListener(Ie(In,this).holder,"touchstart",n=>this.onTouchStart(n)),Ie(zo,this).addEventListener(Ie(In,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Ie(zo,this).addEventListener(Ie(In,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ie(lo,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ie(lo,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Ie(zo,this).addEventListener(Ie(In,this).holder,"mouseup",n=>this.onMouseUp(n)),Ie(zo,this).addEventListener(Ie(In,this).holder,"mousedown",n=>this.onMouseDown(n))};Sl()?e():(SU()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Ie(Wp,this)&&n){const[i,s]=[n.row,Ie(Wp,this).from.row],[o,a]=[n.col,Ie(Wp,this).from.col];return i===s&&o===a}return!1}parentCell(e){const r={},n=Ie(In,this).TABLE,i=sb(e,["TD","TH"],n);return i?(r.coords=Ie(In,this).getCoords(i),r.TD=i):Ve(e,"wtBorder")&&Ve(e,"current")?(r.coords=Ie(Mf,this).getFocusSelection().cellRange.highlight,r.TD=Ie(In,this).getCell(r.coords)):Ve(e,"wtBorder")&&Ve(e,"area")&&Ie(Mf,this).getAreaSelection().cellRange&&(r.coords=Ie(Mf,this).getAreaSelection().cellRange.to,r.TD=Ie(In,this).getCell(r.coords)),r}onMouseDown(e){const r=Ie(iN,this).rootDocument.activeElement,n=DU(Zye,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);Ve(i,"corner")?Ie(lo,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Ie(lo,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Ie(La,this)[0]=s.TD,clearTimeout(Ie(xd,this)[0]),Ie(xd,this)[0]=setTimeout(()=>{Ie(La,this)[0]=null},1e3))}onContextMenu(e){if(Ie(lo,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Ie(lo,this).has("onCellMouseOver"))return;const r=Ie(In,this).TABLE,n=sb(e.target,["TD","TH"],r),i=Ie(ab,this)||this;n&&n!==i.lastMouseOver&&Dh(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Ie(In,this).getCoords(n),n))}onMouseOut(e){if(!Ie(lo,this).has("onCellMouseOut"))return;const r=Ie(In,this).TABLE,n=sb(e.target,["TD","TH"],r),i=sb(e.relatedTarget,["TD","TH"],r),s=Ie(ab,this)||this;n&&n!==i&&Dh(n,r)&&(this.callListener("onCellMouseOut",e,Ie(In,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&Ie(lo,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Ie(La,this)[0]&&r.TD===Ie(La,this)[1]?(Ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Ie(La,this)[0]=null,Ie(La,this)[1]=null):r.TD===Ie(La,this)[0]&&(Ie(La,this)[1]=r.TD,clearTimeout(Ie(xd,this)[1]),Ie(xd,this)[1]=setTimeout(()=>{Ie(La,this)[1]=null},500)))}onTouchStart(e){Kc(Wp,this,Ie(Mf,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=xe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Ie(lo,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];_U()&&(Xye()||Qye())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=Ie(lo,this).getSettingPure(e);s&&s(r,n,i,Ie(sN,this).call(this))}destroy(){clearTimeout(Ie(xd,this)[0]),clearTimeout(Ie(xd,this)[1]),Ie(zo,this).destroy()}};function oN(t,e,r){return(e=cxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cxe(t){var e=uxe(t,"string");return typeof e=="symbol"?e:e+""}function uxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dxe{constructor(e,r,n){oN(this,"offset",void 0),oN(this,"total",void 0),oN(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function aN(t,e,r){return(e=hxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hxe(t){var e=fxe(t,"string");return typeof e=="symbol"?e:e+""}function fxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gxe{constructor(e,r,n){aN(this,"offset",void 0),aN(this,"total",void 0),aN(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function lb(t,e,r){return(e=mxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mxe(t){var e=pxe(t,"string");return typeof e=="symbol"?e:e+""}function pxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yxe{constructor(){lb(this,"currentSize",0),lb(this,"nextSize",0),lb(this,"currentOffset",0),lb(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const vxe=0,b4=1,pM=2;function lN(t,e,r){return(e=wxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wxe(t){var e=bxe(t,"string");return typeof e=="symbol"?e:e+""}function bxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xxe{constructor(){lN(this,"size",new yxe),lN(this,"workingSpace",vxe),lN(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=b4,e.workingSpace=pM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=pM,e.workingSpace=b4,this.sharedSize=e.getViewSize()}}var x4=o_,Sxe=TypeError,Cxe=function(t,e){if(!delete t[e])throw new Sxe("Cannot delete property "+x4(e)+" of "+x4(t))},_xe=Jt,Rxe=qm,Exe=Qm,Nxe=x8,kxe=Cxe,Txe=S8,Pxe=[].unshift(0)!==1,Mxe=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},Axe=Pxe||!Mxe();_xe({target:"Array",proto:!0,arity:1,forced:Axe},{unshift:function(e){var r=Rxe(this),n=Exe(r),i=arguments.length;if(i){Txe(n+i);for(var s=n;s--;){var o=s+i;s in r?r[o]=r[s]:kxe(r,o)}for(var a=0;a<i;a++)r[a]=arguments[a]}return Nxe(r,n+i)}});function Oxe(t,e,r){return(e=Ixe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ixe(t){var e=jxe(t,"string");return typeof e=="symbol"?e:e+""}function jxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S4{constructor(e,r){Oxe(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Hxe(t,e,r){return(e=$xe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $xe(t){var e=Dxe(t,"string");return typeof e=="symbol"?e:e+""}function Dxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lxe{constructor(e){Hxe(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new S4(s,r),c=new S4(o,n),u=[];for(let d=0;d<i;d++){const f=a.get(d),h=c.get(d);if(h===-1)u.push(["remove",f]);else if(f===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(pM)?u.push(["append",h]):u.push(["prepend",h]);else if(h>f)a.has(h)&&(a.remove(h),n<=a.length&&(i-=1)),u.push(["replace",h,f]);else if(h<f){const m=a.prepend(h);u.push(["insert_before",h,f,m])}else u.push(["none",h])}return u}}function Af(t,e,r){return(e=Fxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fxe(t){var e=Vxe(t,"string");return typeof e=="symbol"?e:e+""}function Vxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s9{constructor(e,r){Af(this,"rootNode",void 0),Af(this,"nodesPool",void 0),Af(this,"sizeSet",new xxe),Af(this,"collectedNodes",[]),Af(this,"viewDiffer",new Lxe(this.sizeSet)),Af(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,s,o]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(s)),r.removeChild(this.nodesPool(o));break;case"replace":r.replaceChild(a,this.nodesPool(s));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class o9 extends s9{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function C4(t,e,r){return(e=Bxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bxe(t){var e=Wxe(t,"string");return typeof e=="symbol"?e:e+""}function Wxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zxe{constructor(e){C4(this,"nodeType",void 0),C4(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,s),s}}function zp(t,e,r){return(e=Uxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uxe(t){var e=Yxe(t,"string");return typeof e=="symbol"?e:e+""}function Yxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qv{constructor(e,r){zp(this,"nodesPool",null),zp(this,"nodeType",void 0),zp(this,"rootNode",void 0),zp(this,"table",null),zp(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new zxe(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function _4(t,e,r){return(e=Gxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gxe(t){var e=Kxe(t,"string");return typeof e=="symbol"?e:e+""}function Kxe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qxe extends qv{constructor(){super("TH"),_4(this,"orderViews",new WeakMap),_4(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new o9(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),c=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(c),d=s.obtainOrderView(c);u.appendView(d).setSize(n).setOffset(0).start();for(let f=n-1;f>=0;f--){u.render();const h=u.getCurrentNode();h.className="",h.removeAttribute("style"),_c(h,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ne(h,[K0e(),sye(),yI(f+1),Ra(-1)]),r[f](a,h,f)}u.end()}}}class Xxe extends qv{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let a=0,c=e;a<c;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Mc(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ne(this.rootNode,[cU()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Ne(o,[uU(),gU(r+1)]);for(let a=-1*s;a<i;a+=1){const c=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),_c(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ne(u,[yI(a+1+this.table.rowHeadersCount),Ra(-1),q0e(),...a>=0?[iye()]:[G0e(),Us("Select whole grid")]]),n[r](c,u,r)}}}}let R4=!1;class Qxe extends qv{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!R4&&e>1e3&&(R4=!0,nt(Rt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&ee(n,"rowHeader")}}function Jxe(t,e,r){return(e=Zxe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zxe(t){var e=eSe(t,"string");return typeof e=="symbol"?e:e+""}function eSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Of={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let E4=!1;class tSe extends qv{constructor(e){super("TR",e),Jxe(this,"orderView",void 0),this.orderView=new s9(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!E4&&e>1e3&&(E4=!0,nt(Rt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ne(this.rootNode,[cU()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Ne(s,[uU(),gU(o+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(o+1)%2===0?Ve(s,Of.rowEven)||(Re(s,Of.rowOdd),ee(s,Of.rowEven)):Ve(s,Of.rowOdd)||(Re(s,Of.rowEven),ee(s,Of.rowOdd))}this.orderView.end()}}function N4(t,e,r){return(e=rSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rSe(t){var e=nSe(t,"string");return typeof e=="symbol"?e:e+""}function nSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iSe extends qv{constructor(){super("TD"),N4(this,"orderViews",new WeakMap),N4(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new o9(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const c=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=c;const d=this.obtainOrderView(u),f=i.obtainOrderView(u);d.prependView(f).setSize(r).setOffset(0).start();for(let h=0;h<r;h++){d.render();const m=this.table.renderedColumnToSource(h),g=d.getCurrentNode();if(Ve(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),_c(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(c,m,g),this.table.isAriaEnabled()){var s,o;Ne(g,[...g.hasAttribute("role")?[]:[Y0e()],Ra(-1),yI(m+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}d.end()}}}function hn(t,e,r){return(e=sSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sSe(t){var e=oSe(t,"string");return typeof e=="symbol"?e:e+""}function oSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aSe{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hn(this,"rootNode",void 0),hn(this,"rootDocument",void 0),hn(this,"rowHeaders",null),hn(this,"columnHeaders",null),hn(this,"colGroup",null),hn(this,"rows",null),hn(this,"cells",null),hn(this,"rowFilter",null),hn(this,"columnFilter",null),hn(this,"rowUtils",null),hn(this,"columnUtils",null),hn(this,"rowsToRender",0),hn(this,"columnsToRender",0),hn(this,"rowHeaderFunctions",[]),hn(this,"rowHeadersCount",0),hn(this,"columnHeaderFunctions",[]),hn(this,"columnHeadersCount",0),hn(this,"cellRenderer",void 0),hn(this,"activeOverlayName",void 0),hn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),s=this.rowUtils;if(i.firstChild){const o=this.renderedRowToSource(n),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class lSe{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new aSe(e,{cellRenderer:a,stylesHandler:c}),this.renderer.setRenderers({rowHeaders:new qxe,columnHeaders:new Xxe(r),colGroup:new Qxe(n),rows:new tSe(i),cells:new iSe}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cN(t,e,r){return(e=cSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cSe(t){var e=uSe(t,"string");return typeof e=="symbol"?e:e+""}function uSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dSe{constructor(e,r){cN(this,"dataAccessObject",void 0),cN(this,"wtSettings",void 0),cN(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let o=Array.isArray(r)?r[s]:r;o=o??i,this.headerWidths.set(s,o)}}}}function k4(t,e,r){return(e=hSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hSe(t){var e=fSe(t,"string");return typeof e=="symbol"?e:e+""}function fSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gSe{constructor(e,r){k4(this,"dataAccessObject",void 0),k4(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Fa(t,e,r){return(e=mSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mSe(t){var e=pSe(t,"string");return typeof e=="symbol"?e:e+""}function pSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class np{constructor(e,r,n,i,s){Fa(this,"wtSettings",null),Fa(this,"domBindings",void 0),Fa(this,"TBODY",null),Fa(this,"THEAD",null),Fa(this,"COLGROUP",null),Fa(this,"hasTableHeight",!0),Fa(this,"hasTableWidth",!0),Fa(this,"isTableVisible",!1),Fa(this,"tableOffset",0),Fa(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,NU(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new gSe(this.dataAccessObject,this.wtSettings),this.columnUtils=new dSe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new lSe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ne(n,[mc()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ne(n,[mc()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Ne(n,[Ra(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ne(n.parentNode,[mc()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ne(n,[mc()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),c=a.length,u=r.getSetting("columnHeaders"),d=u.length;let f=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=xi(this.holder),f=i.createCalculators(f),c&&!r.getSetting("fixedColumnsStart"))){const m=n.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,g!==this.correctHeaderWidth&&(f=!1)}if(f)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=xi(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const m=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new gxe(m,s,d),this.columnFilter=new dxe(g,o,c);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),p=y.skipRender!==!0}p&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(vl)||this.is(Xu))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(vl))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(vl)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let h=!1;return this.isMaster&&(h=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(h=n.bottomOverlay.resetFixedPosition()||h),h=n.inlineStartOverlay.resetFixedPosition()||h,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),h?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,o,a;const c=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=uy(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(c)?c[n]!==null&&c[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=c[n]):isNaN(c)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=c),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(c[n]||c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=c[n]||c))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(vl))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=qh(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let s=rve(n),o=r.cellIndex;wd(rf,r,this.wtRootElement)||wd(ef,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):wd(Xu,r,this.wtRootElement)||wd(vl,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),wd(rf,r,this.wtRootElement)||wd(tf,r,this.wtRootElement)||wd(Xu,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=uy(this.TBODY)-1,s=r.areCellsBorderBox(),o=s?yn:uy,a=s?0:1,c=s?1:0;let u,d,f,h,m;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,f=this.rowFilter.renderedToSource(e),u=this.getRowHeight(f),h=this.getTrForRow(f),m=h.querySelector("th");const g=f===0?c:0;m?d=o(m):d=o(h)-a,(!u&&r.getDefaultRowHeight()<d-g||u<d)&&(s||(d+=1),this.dataAccessObject.wtViewport.oversizedRows[f]=d)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return sn(this.TABLE)}getHeight(){return yn(this.TABLE)}getTotalWidth(){const e=sn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=yn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Qh(this.TABLE)}_modifyRowHeaderWidth(e){let r=Tt(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const ySe="stickyRowsBottom",MI={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Fc(MI,"MIXIN_NAME",ySe,{writable:!1,enumerable:!1});const vSe="stickyColumnsStart",N_={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Fc(N_,"MIXIN_NAME",vSe,{writable:!1,enumerable:!1});class AI extends np{constructor(e,r,n,i){super(e,r,n,i,Xu)}}Ht(AI,MI);Ht(AI,N_);const ef="top",vl="bottom",tf="inline_start",rf="top_inline_start_corner",Xu="bottom_inline_start_corner",a9=[ef,vl,tf,rf,Xu],wSe=new Map([[ef,`ht_clone_${ef}`],[vl,`ht_clone_${vl}`],[tf,`ht_clone_${tf} ht_clone_left`],[rf,`ht_clone_${rf} ht_clone_top_left_corner`],[Xu,`ht_clone_${Xu} ht_clone_bottom_left_corner`]]);function bSe(t,e){xSe(t,e),e.add(t)}function xSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SSe(t,e,r){return(e=CSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CSe(t){var e=_Se(t,"string");return typeof e=="symbol"?e:e+""}function _Se(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cb(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Up=new WeakSet;class RSe{constructor(e){bSe(this,Up),SSe(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,n);return i||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const s=Ks(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,c=r==="auto";if(c&&e<o)return!1;const u=this.getFirstVisibleColumn(),d=this.getLastVisibleColumn();let f=!1;return(c&&(e<u||e>d)||!c)&&(f=a.scrollTo(e,c?e>=this.getLastPartiallyVisibleColumn():r==="end")),f}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const s=Ks(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:c}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-o-1))return!1;const d=this.getFirstVisibleRow(),f=this.getLastVisibleRow();let h=!1;return(u&&(e<d||e>f)||!u)&&(h=c.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),h}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return cb(Up,this,P4).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return cb(Up,this,P4).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return cb(Up,this,T4).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return cb(Up,this,T4).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function T4(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let c=null;if(a){const d=n.TABLE.getBoundingClientRect(),h=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;c=Math.abs(d.right-h)}else c=xi(n.wtRootElement).left;const u=Math.abs(TU(o,o));if(c>u){const d=PU(o);let f=i.getRowHeaderWidth();for(let h=1;h<=s;h++)if(f+=r.sumCellSizes(h-1,h),c+f-u>=d){t=h-2;break}}}return t}function P4(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=xi(r.wtRootElement),a=CI(s,s);if(o.top>a){const c=uy(s);let u=n.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(u+=e.sumCellSizes(d-1,d),o.top+u-a>=c){t=d-2;break}}}return t}function co(t,e,r){return(e=ESe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ESe(t){var e=NSe(t,"string");return typeof e=="symbol"?e:e+""}function NSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OI{get eventManager(){return new Ea(this)}constructor(e,r){co(this,"wtTable",void 0),co(this,"wtScroll",void 0),co(this,"wtViewport",void 0),co(this,"wtOverlays",void 0),co(this,"selectionManager",void 0),co(this,"wtEvent",void 0),co(this,"guid",`wt_${aU()}`),co(this,"drawInterrupted",!1),co(this,"drawn",!1),co(this,"activeOverlayName","master"),co(this,"domBindings",void 0),co(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new RSe(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Xh(n,e[r])}])}}createCellCoords(e,r){return new Zh(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new rp(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||ive(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function M4(t,e,r){return(e=kSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kSe(t){var e=TSe(t,"string");return typeof e=="symbol"?e:e+""}function TSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PSe extends OI{constructor(e,r,n){super(e,r),M4(this,"cloneSource",void 0),M4(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new i9(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function MSe(t,e,r){return(e=ASe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ASe(t){var e=OSe(t,"string");return typeof e=="symbol"?e:e+""}function OSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xv{constructor(e,r,n,i,s){MSe(this,"wtSettings",null),Fc(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:o,hider:a,spreader:c,holder:u,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=c,this.holder=u,this.wtRootElement=d,this.trimmingContainer=nv(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=nv(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=kC(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){nt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(c),top:c.offsetTop},d={start:this.getRelativeStartPosition(e),top:e.offsetTop};let f=null;return i?f=this.getRelativeCellPositionWithinWindow(o,s,d,u):f=this.getRelativeCellPositionWithinHolder(o,a,s,d,u),f}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=i.start;else{let c=s.left;this.isRtl()&&(c=this.domBindings.rootWindow.innerWidth-(s.left+s.width+on())),o=c<=0?-1*c:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,c=0;if(n||(a=o.horizontal-s.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();c=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(c=o.vertical-s.top);return{start:i.start-a,top:i.top-c}}makeClone(){if(a9.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${wSe.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&Ne(s,[mc()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ef||u==="vertical"&&this.type===tf?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=kC(e.TABLE),new PSe(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class ISe extends Xv{constructor(e,r,n,i,s,o){super(e,r,Xu,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new AI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else __(r),this.repositionOverlay();let n=yn(this.clone.wtTable.TABLE);const i=sn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=on(n)),i.style.bottom=`${s}px`}}const jSe="calculatedColumns",k_={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Fc(k_,"MIXIN_NAME",jSe,{writable:!1,enumerable:!1});class II extends np{constructor(e,r,n,i){super(e,r,n,i,vl)}}Ht(II,MI);Ht(II,k_);function HSe(t,e,r){return(e=$Se(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Se(t){var e=DSe(t,"string");return typeof e=="symbol"?e:e+""}function DSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LSe extends Xv{constructor(e,r,n,i){super(e,r,vl,n,i),HSe(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new II(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=on(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(SI(r),top),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<r;){const c=n.getRowHeight(o);a+=c===void 0?s:c,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=on(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let c=yn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(c=0),o.height=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=on(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return CI(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Ve(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ee(o,"innerBorderBottom"),s=!a):(Re(o,"innerBorderBottom"),s=a)}return s}}const FSe="calculatedRows",jI={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Fc(jI,"MIXIN_NAME",FSe,{writable:!1,enumerable:!1});class HI extends np{constructor(e,r,n,i){super(e,r,n,i,tf)}}Ht(HI,jI);Ht(HI,N_);const VSe="localHooks",Mn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let c=0;c<a;c++)aM(this._localHooks[t][c],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};Fc(Mn,"MIXIN_NAME",VSe,{writable:!1,enumerable:!1});let l9=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Ht(l9,Mn);const c9="active-header",$I="header",DI="area",MC="focus",BSe="fill",WSe="row",zSe="column",USe="custom-selection",LI=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var YSe=E_;YSe("flat");function GSe(t,e){u9(t,e),e.add(t)}function A4(t,e,r){u9(t,e),e.set(t,r)}function u9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kr(t,e){return t.get(dy(t,e))}function O4(t,e,r){return t.set(dy(t,e),r),r}function dy(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xo=new WeakMap,mi=new WeakMap,ub=new WeakSet;class KSe{constructor(){GSe(this,ub),A4(this,Xo,void 0),A4(this,mi,void 0)}setActiveOverlay(e){return O4(mi,this,e),this}setActiveSelection(e){return O4(Xo,this,e),this}scan(){const e=kr(Xo,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=kr(Xo,this).getCorners(),{wtTable:o}=kr(mi,this),a=o.getRenderedColumnsCount(),c=o.getColumnHeadersCount();let u=0;for(let d=-o.getRowHeadersCount();d<a;d++){const f=o.columnFilter.renderedToSource(d);if(!(f<n||f>s)){for(let h=-c;h<0;h++){if(h<r||h>i)continue;const m=h+c;let g=o.getColumnHeader(f,m);const p=kr(mi,this).getSetting("onBeforeHighlightingColumnHeader",f,m,{selectionType:kr(Xo,this).settings.selectionType,columnCursor:u,selectionWidth:s-n+1});p!==null&&(p!==f&&(g=o.getColumnHeader(p,m)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=kr(Xo,this).getCorners(),{wtTable:o}=kr(mi,this),a=o.getRenderedRowsCount(),c=o.getRowHeadersCount();let u=0;for(let d=-o.getColumnHeadersCount();d<a;d++){const f=o.rowFilter.renderedToSource(d);if(!(f<r||f>i)){for(let h=-c;h<0;h++){if(h<n||h>s)continue;const m=h+c;let g=o.getRowHeader(f,m);const p=kr(mi,this).getSetting("onBeforeHighlightingRowHeader",f,m,{selectionType:kr(Xo,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});p!==null&&(p!==f&&(g=o.getRowHeader(p,m)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:r}=kr(mi,this);dy(ub,this,qSe).call(this,(n,i)=>{const s=r.getCell(kr(mi,this).createCellCoords(n,i)),o=kr(mi,this).getSetting("onAfterDrawSelection",n,i,kr(Xo,this).settings.layerLevel);typeof o=="string"&&ee(s,o),e(s)})}scanRowsInCellsRange(e){const[r,,n]=kr(Xo,this).getCorners(),{wtTable:i}=kr(mi,this);dy(ub,this,I4).call(this,(s,o)=>{if(s>=r&&s<=n){const a=i.getCell(kr(mi,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=kr(Xo,this).getCorners(),{wtTable:i}=kr(mi,this);dy(ub,this,I4).call(this,(s,o)=>{if(o>=r&&o<=n){const a=i.getCell(kr(mi,this).createCellCoords(s,o));e(a)}})}}function qSe(t){let[e,r,n,i]=kr(Xo,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:s}=kr(mi,this),o=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),o){if(r=Math.max(r,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),i<r||n<e)return}else{const a=s.getCell(kr(mi,this).createCellCoords(e,r));if(!Rc(a))return}for(let a=e;a<=n;a+=1)for(let c=r;c<=i;c+=1)t(a,c)}function I4(t){const{wtTable:e}=kr(mi,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<n;o+=1)t(s,e.columnFilter.renderedToSource(o))}}const j4="ht-border-style-",XSe="-vertical",QSe="-horizontal";class H4{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=LI(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ao(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(c){if(c.clientY<Math.floor(s.top)||c.clientY>Math.ceil(s.top+s.height)||c.clientX<Math.floor(s.left)||c.clientX>Math.ceil(s.left+s.width))return!0}function a(c){o(c)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const c=n[a],u=r.createElement("div"),d=h=>this.settings[c]&&this.settings[c][h]?this.settings[c][h]:e.border[h];u.className=`wtBorder ${this.settings.className||""}`,this.settings[c]&&this.settings[c].hide&&(u.className+=" hidden"),i=u.style;const f=d("style");f?(["start","end"].includes(c)?u.className+=` ${j4}${f}${XSe}`:u.className+=` ${j4}${f}${QSe}`,i.setProperty("--ht-custom-border-size",`${d("width")}px`),i.setProperty("--ht-custom-border-color",d("color"))):i.backgroundColor=d("color"),i.height=`${d("width")}px`,i.width=`${d("width")}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Sl()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),s=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),c=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,d=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const f={position:"absolute",height:`${d}px`,width:`${d}px`,"border-radius":`${parseInt(d/1.5,10)}px`};at(f,(m,g)=>{this.selectionHandles.styles.bottomHitArea[g]=m,this.selectionHandles.styles.topHitArea[g]=m});const h=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${c}`};at(h,(m,g)=>{this.selectionHandles.styles.bottom[g]=m,this.selectionHandles.styles.top[g]=m}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){const c=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:d,bottom:f,bottomHitArea:h}=this.selectionHandles.styles,m=parseInt(u.borderWidth,10),g=parseInt(u.width,10),p=parseInt(d.width,10),y=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();u.top=`${parseInt(n-g-1,10)}px`,u[c]=`${parseInt(i-g-1,10)}px`,d.top=`${parseInt(n-p/4*3,10)}px`,d[c]=`${parseInt(i-p/4*3,10)}px`;const v=Math.min(parseInt(i+s,10),y-g-m*2),x=Math.min(parseInt(i+s-p/4,10),y-p-m*2);f[c]=`${v}px`,h[c]=`${x}px`;const S=Math.min(parseInt(n+o,10),w-g-m*2),N=Math.min(parseInt(n+o-p/4,10),w-p-m*2);f.top=`${S}px`,h.top=`${N}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",d.display="block",this.isPartRange(e,r)?(f.display="none",h.display="none"):(f.display="block",h.display="block")):(u.display="none",f.display="none",d.display="none",h.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",d.zIndex="9999"):(u.zIndex="",d.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,s]=e;if(r<0&&i<0||n<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:c}=this.wot,u=r!==i||n!==s,d=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),f=o.getFirstRenderedRow(),h=o.getLastRenderedRow(),m=o.getFirstRenderedColumn(),g=o.getLastRenderedColumn();if(m<0&&g<0||f<0&&h<0){this.disappear();return}let p;if(u){if(n=Math.max(n,m),s=Math.min(s,g),r=Math.max(r,f),i=Math.min(i,h),s<n||i<r){this.disappear();return}p=o.getCell(this.wot.createCellCoords(r,n))}else if(p=o.getCell(this.wot.createCellCoords(r,n)),!Rc(p)){this.disappear();return}const y=u?o.getCell(this.wot.createCellCoords(i,s)):p,w=xi(p),v=u?xi(y):w,x=xi(o.TABLE),S=w.top,N=w.left,R=this.wot.wtSettings.getSetting("rtlMode");let E=0,P=0;if(R){const Q=sn(o.TABLE),fe=sn(p),ye=c.innerWidth-x.left-Q;P=N+fe-v.left,E=c.innerWidth-N-fe-ye-1}else P=v.left+sn(y)-N,E=N-x.left-1;if(this.isEntireColumnSelected(r,i)){const Q=r,fe=this.getDimensionsFromHeader("columns",n,s,Q,x);let ye=null;fe&&([ye,E,P]=fe),ye&&(p=ye)}let D=S-x.top-1,H=v.top+yn(y)-S;if(this.isEntireRowSelected(n,s)){const Q=n,fe=this.getDimensionsFromHeader("rows",r,i,Q,x);let ye=null;fe&&([ye,D,H]=fe),ye&&(p=ye)}const Z=c.getComputedStyle(p);parseInt(Z.borderTopWidth,10)>0&&(D+=1,H=H>0?H-1:0),parseInt(Z[R?"borderRightWidth":"borderLeftWidth"],10)>0&&(E+=1,P=P>0?P-1:0);const I=R?"right":"left",Y=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${D}px`,this.topStyle[I]=`${E}px`,this.topStyle.width=`${P+Y}px`,this.topStyle.display="block",this.startStyle.top=`${D}px`,this.startStyle[I]=`${E}px`,this.startStyle.height=`${H+Y}px`,this.startStyle.display="block",this.bottomStyle.top=`${D+H-parseInt(this.bottomStyle.height,10)+Y}px`,this.bottomStyle[I]=`${E}px`,this.bottomStyle.width=`${P+Y}px`,this.bottomStyle.display="block",this.endStyle.top=`${D}px`,this.endStyle[I]=`${E+P-parseInt(this.endStyle.width,10)+Y}px`,this.endStyle.height=`${H+Y}px`,this.endStyle.display="block";let re=this.settings.border.cornerVisible;re=typeof re=="function"?re(this.settings.layerLevel):re;const ne=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[ae,ue]=[i,s];if(ne&&Array.isArray(ne)&&([,,ae,ue]=ne),Sl()||!re||this.isPartRange(ae,ue))this.cornerStyle.display="none";else{this.cornerStyle.top=`${D+H+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[I]=`${E+P+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Q=nv(o.TABLE);const fe=Q===c;fe&&(Q=a.documentElement);const ye=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,de=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),se=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const me=fe?y.getBoundingClientRect().left:y.offsetLeft;let te=!1,b=0;if(R?(b=me-parseInt(this.cornerDefaultStyle.width,10)/2,te=b<0):(b=me+sn(y)+parseInt(this.cornerDefaultStyle.width,10)/2,te=b>=PU(Q)),te){const _=Math.floor(E+P+this.cornerCenterPointOffset-de-ye);d?(this.cornerStyle[I]=`${_}px`,this.cornerStyle[R?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[I]=`${_-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(fe?y.getBoundingClientRect().top:y.offsetTop)+yn(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=uy(Q)){const _=Math.floor(D+H+this.cornerCenterPointOffset-se-ye);d?(this.cornerStyle.top=`${_}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${_-1}px`}this.cornerStyle.display="block"}Sl()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,D,E,P,H)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let c=null,u=null,d=null,f=null,h=null,m=null,g=null,p=null;switch(e){case"rows":c=function(){return o.getRowHeader(...arguments)},u=function(){return yn(...arguments)},d="ht__selection--rows",m="top";break;case"columns":c=function(){return o.getColumnHeader(...arguments)},u=function(){return sn(...arguments)},d="ht__selection--columns",m="left";break}if(a.classList.contains(d)){const y=this.wot.getSetting("columnHeaders").length;if(g=c(r,y-i),p=c(n,y-i),!g||!p)return!1;const w=xi(g),v=xi(p);return g&&p&&(f=w[m]-s[m]-1,h=v[m]+u(p)-w[m]),[g,f,h]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?ee(this[e],"hidden"):(Ve(this[e],"hidden")&&Re(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?ee(this[e],"hidden"):Re(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Sl()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function JSe(t,e){d9(t,e),e.add(t)}function If(t,e,r){d9(t,e),e.set(t,r)}function d9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function st(t,e){return t.get(FI(t,e))}function $4(t,e,r){return t.set(FI(t,e),r),r}function FI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pi=new WeakMap,is=new WeakMap,uN=new WeakMap,L0=new WeakMap,dN=new WeakMap,Sd=new WeakMap,D4=new WeakSet;class ZSe{constructor(e){JSe(this,D4),If(this,pi,void 0),If(this,is,void 0),If(this,uN,new KSe),If(this,L0,new WeakMap),If(this,dN,new WeakSet),If(this,Sd,new Map),$4(is,this,e)}setActiveOverlay(e){return $4(pi,this,e),st(uN,this).setActiveOverlay(st(pi,this)),st(L0,this).has(st(pi,this))||st(L0,this).set(st(pi,this),new Set),this}getFocusSelection(){return st(is,this)!==null?st(is,this).getFocus():null}getAreaSelection(){return st(is,this)!==null?st(is,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(st(Sd,this).has(e)){const n=st(Sd,this).get(e);if(n.has(st(pi,this)))return n.get(st(pi,this));const i=new H4(st(pi,this),e.settings);return n.set(st(pi,this),i),i}const r=new H4(st(pi,this),e.settings);return st(Sd,this).set(e,new Map([[st(pi,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=st(Sd,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){st(Sd,this).get(e).forEach(r=>r.destroy()),st(Sd,this).delete(e)}render(e){if(st(is,this)===null)return;e&&FI(D4,this,eCe).call(this);const r=Array.from(st(is,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const o=r[s],{className:a,headerAttributes:c,createLayers:u,selectionType:d}=o.settings;st(dN,this).has(o)||(st(dN,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const f=this.getBorderInstance(o);if(o.isEmpty()){f==null||f.disappear();continue}a&&st(uN,this).setActiveSelection(o).scan().forEach(g=>{if(n.has(g)){const p=n.get(g);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else n.set(g,new Map([[a,1]]));c&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...c))});const h=o.getCorners();st(pi,this).getSetting("onBeforeDrawBorders",h,d),f==null||f.appear(h)}n.forEach((s,o)=>{var a;const c=Array.from(s).map(u=>{let[d,f]=u;return f===1?d:[d,...Array.from({length:f-1},(h,m)=>`${d}-${m+1}`)]}).flat();c.forEach(u=>st(L0,this).get(st(pi,this)).add(u)),ee(o,c),o.nodeName==="TD"&&Array.isArray((a=st(is,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ne(o,st(is,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Ne(s,[...i.get(s)])})}}function eCe(){const t=st(L0,this).get(st(pi,this)),e=st(pi,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=st(pi,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((n=st(is,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=st(is,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=st(is,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...st(is,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,c=s.length;a<c;a++)Re(s[a],r),_c(s[a],o)}),t.clear()}class tCe extends Xv{constructor(e,r,n,i){super(e,r,tf,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new HI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),_I(n,`${s}px`,"0px")):(s=this.getScrollPosition(),__(n));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const s=r.scrollX;r.scrollTo(e,kU(r)),n=s!==r.scrollX}else if(e!==i.scrollLeft){const s=i.scrollLeft;i.scrollLeft=e,n=s!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=on(n)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const c=sn(this.clone.wtTable.TABLE);o.width=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=LI(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,c=s===0&&i.length>0&&!Ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),d=0;if(r){const f=this.wot.wtTable.getColumnWidth(e),h=this.wot.wtViewport.getViewportWidth();f>h&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(d=on(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=c):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=d,ove(this.mainTableScrollableElement)===u-c&&c>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(c),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(TU(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?Re(n,"emptyRows"):ee(n,"emptyRows");let c=!1;if(!a){if(s&&!i.length)ee(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=Ve(n,"innerBorderInlineStart");e?(ee(n,"innerBorderLeft innerBorderInlineStart"),c=!u):(Re(n,"innerBorderLeft innerBorderInlineStart"),c=u)}}return c}}const rCe="stickyRowsTop",VI={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Fc(VI,"MIXIN_NAME",rCe,{writable:!1,enumerable:!1});class BI extends np{constructor(e,r,n,i){super(e,r,n,i,rf)}}Ht(BI,VI);Ht(BI,N_);function L4(t,e,r){return(e=nCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nCe(t){var e=iCe(t,"string");return typeof e=="symbol"?e:e+""}function iCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sCe extends Xv{constructor(e,r,n,i,s,o){super(e,r,rf,n,i),L4(this,"topOverlay",void 0),L4(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new BI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();_I(e,`${i}px`,`${s}px`)}else __(e);let r=yn(this.clone.wtTable.TABLE);const n=sn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class WI extends np{constructor(e,r,n,i){super(e,r,n,i,ef)}}Ht(WI,VI);Ht(WI,k_);function oCe(t,e,r){return(e=aCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aCe(t){var e=lCe(t,"string");return typeof e=="symbol"?e:e+""}function lCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cCe extends Xv{constructor(e,r,n,i){super(e,r,ef,n,i),oCe(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new WI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,c=a.hider.getBoundingClientRect(),u=Math.ceil(c.bottom),d=e.offsetHeight;s=u===d,i=this.getOverlayOffset(),_I(e,"0px",`${i}px`)}else i=this.getScrollPosition(),__(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(SI(r),e),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,s=0;for(;i<r;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=on(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let c=yn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(c=0),o.height=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=LI(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Ve(o.parentNode,"innerBorderTop")?1:0;let d=this.getTableParentOffset(),f=0;if(r){const h=this.wot.wtTable.getRowHeight(e),m=this.wot.wtViewport.getViewportHeight();h>m&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(f=on(this.domBindings.rootDocument)),r){const h=i.getSetting("fixedRowsBottom"),m=i.getSetting("totalRows");d+=this.sumCellSizes(0,e+1),d-=n.wtViewport.getViewportHeight()-this.sumCellSizes(m-h,m),d+=1,d+=u}else d+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return d+=f,sve(this.mainTableScrollableElement)===d-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(d)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return CI(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";s?Re(i,"emptyColumns"):ee(i,"emptyColumns");let a=!1;if(!r&&!o){const c=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==c,d=n.getSetting("columnHeaders");if((u||c===0)&&d.length>0){const f=Ve(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(ee(i,"innerBorderTop"),a=!f):(Re(i,"innerBorderTop"),a=f)}}return a}}function db(t,e,r){uCe(t,e),e.set(t,r)}function uCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vl(t,e,r){return(e=dCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dCe(t){var e=hCe(t,"string");return typeof e=="symbol"?e:e+""}function hCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cd(t,e,r){return t.set(h9(t,e),r),r}function Bl(t,e){return t.get(h9(t,e))}function h9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jf=new WeakMap,hb=new WeakMap,Hf=new WeakMap,fb=new WeakMap;class fCe{constructor(e,r,n,i,s,o){Vl(this,"wot",null),db(this,jf,[]),Vl(this,"topOverlay",null),Vl(this,"bottomOverlay",null),Vl(this,"inlineStartOverlay",null),Vl(this,"topInlineStartCornerOverlay",null),Vl(this,"bottomInlineStartCornerOverlay",null),Vl(this,"browserLineHeight",void 0),Vl(this,"wtSettings",null),db(this,hb,!1),db(this,Hf,0),db(this,fb,null),Vl(this,"resizeObserver",new ResizeObserver(d=>{EC(()=>{!Array.isArray(d)||!d.length||(Cd(Hf,this,Bl(Hf,this)+1),Bl(Hf,this)===300&&(nt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Bl(fb,this)!==null&&clearTimeout(Bl(fb,this)),Cd(fb,this,setTimeout(()=>{Cd(Hf,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:c}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=on(a);const u=c.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:kC(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Bl(jf,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new cCe(...e),this.bottomOverlay=new LSe(...e),this.inlineStartOverlay=new tCe(...e),this.topInlineStartCornerOverlay=new sCe(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new ISe(...e,this.bottomOverlay,this.inlineStartOverlay),Cd(jf,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Cd(hb,this,Bl(jf,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Bl(jf,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Bl(jf,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",f=>this.onKeyDown(f)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",f=>this.onTableScroll(f),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",f=>this.onTableScroll(f),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),c={passive:o};(a||s||!CU())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",f=>this.onCloneWheel(f,a),c),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(f=>{this.eventManager.addEventListener(f.clone.wtTable.holder,"wheel",h=>this.onCloneWheel(h,a),c)});let d;this.eventManager.addEventListener(r,"resize",()=>{EC(()=>{clearTimeout(d),this.wtSettings.getSetting("onWindowResize"),d=setTimeout(()=>{Cd(Hf,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),c=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||c)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Am(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Bl(hb,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Cd(hb,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=kC(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,d=c+this.topOverlay.sumCellSizes(0,o)+u,f=a+this.inlineStartOverlay.sumCellSizes(0,s),m=r.hider.style,g=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,d-r.holder.clientHeight),p=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,f-r.holder.clientWidth),y=g()?1:0,w=p()?1:0;m.width=`${f+w}px`,m.height=`${d+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return B(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];B(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function F4(t,e,r){return(e=gCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gCe(t){var e=mCe(t,"string");return typeof e=="symbol"?e:e+""}function mCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let pCe=class{constructor(e){F4(this,"settings",{}),F4(this,"defaults",Object.freeze(this.getDefaults())),at(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Xh(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?at(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};class zI extends np{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=nv(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=TC(e,"height",r),s=TC(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:c}=e;let u=e.offsetWidth,d=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const h=e.cloneNode(!1);h.style.overflow="auto",h.style.position="absolute",e.nextElementSibling?n.insertBefore(h,e.nextElementSibling):n.appendChild(h);const m=parseInt(r.getComputedStyle(h).height,10);n.removeChild(h),m===0&&(d=0)}d=Math.min(d,c),o.height=i==="auto"?"auto":`${d}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:d>0,this.hasTableWidth=u>0}this.isTableVisible=Qh(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,c=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let d=-1*a;d<c;d++)this.markIfOversizedColumnHeader(d);r.hasOversizedColumnHeadersMarked[n]=!0}}}Ht(zI,jI);Ht(zI,k_);class yCe{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new Dbe:new zbe],["fullyVisible",()=>new kbe],["partiallyVisible",()=>new ZU]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new jbe:new Vbe],["fullyVisible",()=>new Rbe],["partiallyVisible",()=>new JU]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=yn(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?on():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return xi(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=yn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=sn(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const c=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),d=r.getSetting("totalRows");return c&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,c),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(d-u,d),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=on(this.domBindings.rootDocument),new Jbe({calculationTypes:e.map(f=>[f,this.rowsCalculatorTypes.get(f)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:f=>n.getRowHeight(f),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=on(this.domBindings.rootDocument)),new qbe({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible"),o=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s,o)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible"),o=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s,o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;const{startRow:s,endRow:o}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(s)&&!this.wtTable.isRowAfterRenderedRows(o))return!0;n=s,i=o}const{startRow:a,endRow:c,rowStartOffset:u,rowEndOffset:d}=this.rowsRenderCalculator,f=this.wtSettings.getSetting("totalRows")-1,h=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(h)&&h>0?(n=Math.max(0,n-Math.min(u,h)),i=Math.min(f,i+Math.min(d,h))):h==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(f,i+Math.ceil(d/2))),n<a||n===a&&n>0?!1:!(i>c||i===c&&i<f)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;const{startColumn:s,endColumn:o}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(s)&&!this.wtTable.isColumnAfterRenderedColumns(o))return!0;n=s,i=o}const{startColumn:a,endColumn:c,columnStartOffset:u,columnEndOffset:d}=this.columnsRenderCalculator,f=this.wtSettings.getSetting("totalColumns")-1,h=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(h)&&h>0?(n=Math.max(0,n-Math.min(u,h)),i=Math.min(f,i+Math.min(d,h))):h==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(f,i+Math.ceil(d/2))),n<a||n===a&&n>0?!1:!(i>c||i===c&&i<f)}resetHasOversizedColumnHeadersMarked(){at(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class vCe extends OI{constructor(e,r){super(e,new pCe(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new zI(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new yCe(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new ZSe(this.wtSettings.getSetting("selections")),this.wtEvent=new i9(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new fCe(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];at(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),Re(this.wtTable.wtRootElement.parentNode,r),ee(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!a9.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class UI{constructor(e){e instanceof OI?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new UI(r);return()=>n},this._wot=new vCe(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function V4(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const c=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),d=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&c)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||d)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(c.to.row,i.col)):d&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,c.to.col)):(!u&&!d&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(c.from.row,0),i.row,i.col):(!u&&!d&&i.row<0||d&&i.row<0)&&!o.column&&s.selectColumns(Math.max(c.from.col,0),i.col,i.row);else{const f=!s.inInSelection(i),h=r||n&&f;i.row<0&&i.col>=0&&!o.column?h&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?h&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?h&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function wCe(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),c=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(s(u-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,c-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function B4(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),s=i.clone().map(a=>n.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!r.isMultiple(o)){const a=s.findAll(o);a.length===s.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(c=>{let{layer:u}=c;return u})),r.refresh())}}const bCe=new Map([["touchstart",V4],["touchend",B4],["mousedown",V4],["mouseover",wCe],["mouseup",B4]]);function hN(t,e){bCe.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:RI(t)||t.type==="touchstart",isRightClick:Jh(t),...e})}const f9=new WeakMap,YI=Symbol("rootInstance");function xCe(t){f9.set(t,!0)}function SCe(t){return t===YI}function nl(t){return f9.has(t)}function CCe(t,e){g9(t,e),e.add(t)}function qc(t,e,r){g9(t,e),e.set(t,r)}function g9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xc(t,e,r){return(e=_Ce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ce(t){var e=RCe(t,"string");return typeof e=="symbol"?e:e+""}function RCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zr(t,e){return t.get(hm(t,e))}function Xi(t,e,r){return t.set(hm(t,e),r),r}function hm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fN=new WeakMap,gb=new WeakMap,mb=new WeakMap,Wl=new WeakMap,Uo=new WeakMap,gN=new WeakMap,mN=new WeakMap,$f=new WeakMap,F0=new WeakSet;class ECe{constructor(e){CCe(this,F0),Xc(this,"hot",void 0),Xc(this,"eventManager",void 0),Xc(this,"settings",void 0),Xc(this,"THEAD",void 0),Xc(this,"TBODY",void 0),Xc(this,"_wt",void 0),Xc(this,"activeWt",void 0),qc(this,fN,0),qc(this,gb,0),Xc(this,"postponedAdjustElementsSize",!1),qc(this,mb,!1),qc(this,Wl,void 0),qc(this,Uo,void 0),qc(this,gN,0),qc(this,mN,0),qc(this,$f,null),this.hot=e,this.eventManager=new Ea(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),hm(F0,this,kCe).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),ee(e,"handsontable"),Xi(Uo,this,r.createElement("TABLE")),ee(Zr(Uo,this),"htCore"),this.hot.getSettings().tableClassName&&ee(Zr(Uo,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ne(Zr(Uo,this),[mc()]),Ne(e,[U0e(),fU(-1),w_(this.hot.countCols()),cye()])),this.THEAD=r.createElement("THEAD"),Zr(Uo,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Zr(Uo,this).appendChild(this.TBODY),this.hot.table=Zr(Uo,this),this.hot.container.insertBefore(Zr(Uo,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:s}=this.hot,o=n.documentElement;this.eventManager.addEventListener(r,"mousedown",c=>{Xi(mb,this,!0),this.isTextSelectionAllowed(c.target)||(e4(s),c.preventDefault(),s.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Xi(mb,this,!1)}),this.eventManager.addEventListener(r,"mousemove",c=>{Zr(mb,this)&&!this.isTextSelectionAllowed(c.target)&&(this.settings.fragmentSelection&&e4(s),c.preventDefault())}),this.eventManager.addEventListener(o,"keyup",c=>{i.isInProgress()&&!c.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",c=>{i.isInProgress()&&RI(c)&&i.finish(),Xi(Wl,this,!1);const u=IU(n.activeElement);pS(n.activeElement)&&!u||(u||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(c.target)&&!Jh(c))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",c=>{i.isInProgress()&&Jh(c)&&(i.finish(),Xi(Wl,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),Xi(Wl,this,!1)}),this.eventManager.addEventListener(o,"mousedown",c=>{const u=c.target,d=c.x||c.clientX,f=c.y||c.clientY;let h=c.target;if(Zr(Wl,this)||!r||!this.hot.view)return;const{holder:m}=this._wt.wtTable;if(h===m){const p=on(n);if(n.elementFromPoint(d+p,f)!==m||n.elementFromPoint(d,f+p)!==m)return}else for(;h!==o;){if(h===null){if(c.isTargetWebComponent)break;return}if(h===r)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=nd(s);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=nd(a);this.eventManager.addEventListener(Zr(Uo,this),"selectstart",c=>{this.settings.fragmentSelection||pS(c.target)||c.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&ee(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Re(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Zr(Uo,this),isDataViewInstance:()=>nl(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const c=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(c,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Xi(gb,this,s.length),this.hot.getSettings().ariaTags&&hm(F0,this,m9).call(this)===this.hot.countCols()&&hm(F0,this,NCe).call(this,Zr(gb,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const c=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(c,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Xi(fN,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),c=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(c),c,o)},cellRenderer:(s,o,a)=>{const[c,u]=this.translateFromRenderableToVisualIndex(s,o),d=this.hot.runHooks("modifyGetCellCoords",c,u,!1,"meta");let f=c,h=u;Array.isArray(d)&&([f,h]=d);const m=this.hot.getCellMeta(f,h),g=this.hot.colToProp(h);let p=this.hot.getDataAtRowProp(f,g);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,m)),this.hot.runHooks("beforeRenderer",a,c,u,g,p,m),this.hot.getCellRenderer(m)(this.hot,a,c,u,g,p,m),this.hot.runHooks("afterRenderer",a,c,u,g,p,m)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Qh(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,c)=>{const u=this.translateFromRenderableToVisualCoords(o),d={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=c,Xi(Wl,this,!0),Xi($f,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,d),!dh(s)&&(hN(s,{coords:u,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,h)=>this.hot._createCellCoords(f,h)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,c)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=c,Xi(Wl,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!dh(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,c)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=c,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!dh(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,c)=>{const u=this.translateFromRenderableToVisualCoords(o),d={row:!1,column:!1,cell:!1};this.activeWt=c,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,d),!dh(s)&&(Zr(Wl,this)&&(!Zr($f,this)||Zr($f,this).x!==s.clientX||Zr($f,this).y!==s.clientY)&&hN(s,{coords:u,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,h)=>this.hot._createCellCoords(f,h)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt,Xi($f,this,null))},onCellMouseUp:(s,o,a,c)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=c,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(dh(s)||this.hot.isDestroyed)&&(hN(s,{coords:u,selection:this.hot.selection,cellRangeMapper:Xve(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,c=s<0;let u=s;return!c&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,c=s<0;let u=s;return!c&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const c=this.hot.rowIndexMapper,u=s<0;let d=s;u||(d=c.getVisualFromRenderableIndex(s));const f=this.hot.runHooks("beforeHighlightingRowHeader",d,o,a);return u?f:c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const c=this.hot.columnIndexMapper,u=s<0;let d=s;u||(d=c.getVisualFromRenderableIndex(s));const f=this.hot.runHooks("beforeHighlightingColumnHeader",d,o,a);return u?f:c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(s,o,a)=>{let c;const[u,d]=this.translateFromRenderableToVisualIndex(s,o),f=this.hot.selection.getSelectedRange();if(f.size()>0){const m=f.peekByIndex(a??0);c=[m.from.row,m.from.col,m.to.row,m.to.col]}return this.hot.runHooks("afterDrawSelection",u,d,c,a)},onBeforeDrawBorders:(s,o)=>{const[a,c,u,d]=s,f=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.hot.runHooks("beforeDrawBorders",f,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,c)=>{const u=this.hot.rowIndexMapper,d=this.hot.columnIndexMapper,f=o>=0?d.getVisualFromRenderableIndex(o):o,h=s>=0?u.getVisualFromRenderableIndex(s):s,m=this.hot.runHooks("modifyGetCellCoords",h,f,a,c);if(Array.isArray(m)){const[g,p,y,w]=m;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,p>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(p,1)):p,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,w>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(w,-1)):w]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,u=o>=0?c.getVisualFromRenderableIndex(o):o,d=s>=0?a.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCoordsElement",d,u);if(Array.isArray(f)){const[h,m]=f;return[h>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(h,1)):h,m>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,1)):m]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),c=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(c-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const d=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(c-d,0),s.endRow=Math.min(u+d,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),c=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(c-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const d=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(c-d,0),s.endColumn=Math.min(u+d,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new UI(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(pS(e))return!0;const i=Dh(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const s=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&s&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&s)}isMouseDown(){return Zr(Wl,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!Ve(n,"relative")){Mc(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;Ve(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,i),o.className="",ee(o,["relative",...s()])):(Mc(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),c=o.createElement("span"),u=s();a.classList.add("relative",...u),c.className="colHeader",this.settings.ariaTags&&(Ne(a,...mc()),Ne(c,...mc())),this.updateCellHeader(c,e,n,i),a.appendChild(c),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ve(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):Ve(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?wf(e,n(r,i)):(Xh(e,""),ee(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Xi(gN,this,e),Xi(mN,this,r)}getLastSize(){return{width:Zr(gN,this),height:Zr(mN,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Zr(fN,this)}getRowHeadersCount(){return Zr(gb,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function m9(){return parseInt(this.hot.rootElement.getAttribute(w_()[0]),10)}function NCe(t){const e=hm(F0,this,m9).call(this)+t;Ne(this.hot.rootElement,...w_(e))}function kCe(){const t=this.hot.rootElement;this.hasVerticalScroll()?ee(t,"htHasScrollY"):Re(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?ee(t,"htVerticallyScrollableByWindow"):Re(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?ee(t,"htHasScrollX"):Re(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?ee(t,"htHorizontallyScrollableByWindow"):Re(t,"htHorizontallyScrollableByWindow")}var TCe=Jt,PCe=wn,MCe=Jm,ACe=vs,OCe=bn,ICe=Al,jCe=ws,HCe=ud,pN=HCe("every",TypeError);TCe({target:"Iterator",proto:!0,real:!0,forced:pN},{every:function(e){OCe(this);try{ACe(e)}catch(i){jCe(this,"throw",i)}if(pN)return PCe(pN,this,e);var r=ICe(this),n=0;return!MCe(r,function(i,s){if(!e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const $Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZ",W4=$Ce.length;function DCe(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%W4,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/W4,10);return r}function p9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{n.push([s+e,a,o])}):Object.keys(i).forEach(o=>{n.push([s+e,o,i[o]])})}),n}function y9(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Le(t[0])&&(e=bI(t[0]))),e}function LCe(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function FCe(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Yp(t,e,r){return(e=VCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VCe(t){var e=BCe(t,"string");return typeof e=="symbol"?e:e+""}function BCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WCe{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Yp(this,"hot",void 0),Yp(this,"data",void 0),Yp(this,"dataType","array"),Yp(this,"colToProp",()=>{}),Yp(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return B(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,c=null;if(a=this.modifyRowData(e),Array.isArray(a))c=[],s?a.forEach((u,d)=>{c[d]=this.getAtPhysicalCell(e,d,a)}):Oe(r,n,u=>{c[u-r]=this.getAtPhysicalCell(e,u,a)});else if(Le(a)||Tt(a))if(i?c=[]:c={},!s||i){const d=this.countFirstRowKeys()-1;Oe(0,d,f=>{const h=this.colToProp(f);if(f>=(r||0)&&f<=(n||d)&&!Number.isInteger(h)){const m=this.getAtPhysicalCell(e,h,a);i?c.push(m):o?zE(c,h,m):c[h]=m}})}else at(a,(u,d)=>{const f=this.getAtPhysicalCell(e,d,a);o?zE(c,d,f):c[d]=f});return c}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Ks(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:zE(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?sM(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=Ks(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,c=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),c=Math.max(e.col,r.col));const u=[];return Oe(s,a,d=>{u.push(i?this.getAtRow(d,void 0,void 0,n):this.getAtRow(d,o,c,n))}),u}getCopyable(e,r){const n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return y9(this.data)}destroy(){this.data=null,this.hot=null}}var zCe=Jt,UCe=wn,YCe=Jm,GCe=vs,KCe=bn,qCe=Al,XCe=ws,QCe=ud,yN=QCe("some",TypeError);zCe({target:"Iterator",proto:!0,real:!0,forced:yN},{some:function(e){KCe(this);try{GCe(e)}catch(i){XCe(this,"throw",i)}if(yN)return UCe(yN,this,e);var r=qCe(this),n=0;return YCe(r,function(i,s){if(e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function z4(t,e,r){return(e=JCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JCe(t){var e=ZCe(t,"string");return typeof e=="symbol"?e:e+""}function ZCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bf{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;z4(this,"indexedValues",[]),z4(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Tt(this.initValueOrFn)?Oe(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Oe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Ht(bf,Mn);function GI(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>Tt(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function KI(t,e){return Kh(t,(r,n)=>e.includes(n)===!1)}class hd extends bf{insert(e,r){this.indexedValues=GI(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=KI(this.indexedValues,e),super.remove(e)}}class T_ extends hd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return bs(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function qI(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function iv(t,e){return Kh(t,r=>e.includes(r)===!1)}function XI(t,e){return _t(t,r=>r-e.filter(n=>n<r).length)}function QI(t,e){const r=e[0],n=e.length;return _t(t,i=>i>=r?i+n:i)}function e1e(t,e,r){return(e=t1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t1e(t){var e=r1e(t,"string");return typeof e=="symbol"?e:e+""}function r1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P_ extends bf{constructor(){super(...arguments),e1e(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=iv(this.orderOfIndexes,[e]),Tt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=GI(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=QI(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=KI(this.indexedValues,e),this.orderOfIndexes=iv(this.orderOfIndexes,e),this.orderOfIndexes=XI(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Qv extends hd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return bs(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const U4=new Map([["indexesSequence",{getListWithInsertedItems:qI,getListWithRemovedItems:iv}],["physicallyIndexed",{getListWithInsertedItems:GI,getListWithRemovedItems:KI}]]),v9=t=>{if(U4.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return U4.get(t)};class w9 extends bf{constructor(){super(e=>e)}insert(e,r){const n=QI(this.indexedValues,r);this.indexedValues=qI(n,e,r),super.insert(e,r)}remove(e){const r=iv(this.indexedValues,e);this.indexedValues=XI(r,e),super.remove(e)}}const Y4=new Map([["hiding",T_],["index",bf],["linkedPhysicalIndexToValue",P_],["physicalIndexToValue",hd],["trimming",Qv]]);function n1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Y4.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Y4.get(t))(e)}function i1e(t,e,r){return(e=s1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s1e(t){var e=o1e(t,"string");return typeof e=="symbol"?e:e+""}function o1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JI{constructor(){i1e(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);xe(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return fr(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Ht(JI,Mn);function vN(t,e,r){return(e=a1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a1e(t){var e=l1e(t,"string");return typeof e=="symbol"?e:e+""}function l1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G4 extends JI{constructor(e,r){super(),vN(this,"mergedValuesCache",[]),vN(this,"aggregationFunction",void 0),vN(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=_t(this.get(),s=>s.getValues()),n=[],i=xe(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return _t(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return xe(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function c1e(t,e,r){u1e(t,e),e.set(t,r)}function u1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d1e(t,e,r){return t.set(b9(t,e),r),r}function h1e(t,e){return t.get(b9(t,e))}function b9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var wN=new WeakMap;class x9{constructor(){c1e(this,wN,[])}subscribe(e){return this.addLocalHook("change",e),this._write(h1e(wN,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){d1e(wN,this,e)}}Ht(x9,Mn);function K4(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Gp(t,e,r){f1e(t,e),e.set(t,r)}function f1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uo(t,e){return t.get(S9(t,e))}function pb(t,e,r){return t.set(S9(t,e),r),r}function S9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var yb=new WeakMap,Kp=new WeakMap,vb=new WeakMap,wb=new WeakMap,bb=new WeakMap;class g1e{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Gp(this,yb,new Set),Gp(this,Kp,[]),Gp(this,vb,[]),Gp(this,wb,!1),Gp(this,bb,!1),pb(bb,this,e??!1)}createObserver(){const e=new x9;return uo(yb,this).add(e),e.addLocalHook("unsubscribe",()=>{uo(yb,this).delete(e)}),e._writeInitialChanges(K4(uo(Kp,this),uo(vb,this))),e}emit(e){let r=uo(vb,this);(!uo(wb,this)||uo(Kp,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(uo(bb,this)):pb(Kp,this,new Array(e.length).fill(uo(bb,this))),uo(wb,this)||(pb(wb,this,!0),r=uo(Kp,this)));const n=K4(r,e);uo(yb,this).forEach(i=>i._write(n)),pb(vb,this,e)}}function Ei(t,e,r){return(e=m1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m1e(t){var e=p1e(t,"string");return typeof e=="symbol"?e:e+""}function p1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yM{constructor(){Ei(this,"indexesSequence",new w9),Ei(this,"trimmingMapsCollection",new G4(e=>e.some(r=>r===!0),!1)),Ei(this,"hidingMapsCollection",new G4(e=>e.some(r=>r===!0),!1)),Ei(this,"variousMapsCollection",new JI),Ei(this,"hidingChangesObservable",new g1e({initialIndexValue:!1})),Ei(this,"notTrimmedIndexesCache",[]),Ei(this,"notHiddenIndexesCache",[]),Ei(this,"isBatched",!1),Ei(this,"indexesSequenceChanged",!1),Ei(this,"indexesChangeSource",void 0),Ei(this,"trimmedIndexesChanged",!1),Ei(this,"hiddenIndexesChanged",!1),Ei(this,"renderablePhysicalIndexesCache",[]),Ei(this,"fromPhysicalToVisualIndexesCache",new Map),Ei(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,n1e(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof Qv?this.trimmingMapsCollection.register(e,r):r instanceof T_?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return xe(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return xe(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return xe(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return xe(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=_t(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=iv(this.getIndexesSequence(),n),a=o.filter(u=>this.isTrimmed(u)===!1);let c=o.indexOf(a[a.length-1])+1;if(r+s<i){const u=a[r];c=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(qI(o,c,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],s=xe(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=_t(new Array(r).fill(s),(u,d)=>u+d);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const c=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(o,c),this.hidingMapsCollection.insertToEvery(o,c),this.variousMapsCollection.insertToEvery(o,c),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Ht(yM,Mn);function y1e(t,e){return at(e,(r,n)=>{fr(t[n])&&(t[n]=r)}),t}function C9(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function _9(t){xe(t)&&EI(Rt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function v1e(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function R9(t,e){return Array.isArray(t)?t.map(r=>R9(r,e)):mI(t,e)}const{register:w1e,getValues:b1e}=$o("phraseFormatters");function E9(t,e){w1e(t,e)}function x1e(){return b1e()}E9("pluralize",v1e);E9("substitute",R9);const ZI="Common:",AC=`${ZI}ok`,e2=`${ZI}cancel`,N9="ContextMenu:items",qe=N9,t2=`${qe}.noItems`,r2=`${qe}.insertRowAbove`,n2=`${qe}.insertRowBelow`,i2=`${qe}.insertColumnOnTheLeft`,s2=`${qe}.insertColumnOnTheRight`,o2=`${qe}.removeRow`,a2=`${qe}.removeColumn`,l2=`${qe}.undo`,c2=`${qe}.redo`,OC=`${qe}.readOnly`,u2=`${qe}.clearColumn`,d2=`${qe}.copy`,h2=`${qe}.copyWithHeaders`,f2=`${qe}.copyWithGroupHeaders`,g2=`${qe}.copyHeadersOnly`,m2=`${qe}.cut`,p2=`${qe}.freezeColumn`,y2=`${qe}.unfreezeColumn`,v2=`${qe}.mergeCells`,w2=`${qe}.unmergeCells`,b2=`${qe}.addComment`,x2=`${qe}.editComment`,S2=`${qe}.removeComment`,C2=`${qe}.readOnlyComment`,_2=`${qe}.align`,R2=`${qe}.align.left`,E2=`${qe}.align.center`,N2=`${qe}.align.right`,k2=`${qe}.align.justify`,T2=`${qe}.align.top`,P2=`${qe}.align.middle`,M2=`${qe}.align.bottom`,A2=`${qe}.borders`,O2=`${qe}.borders.top`,I2=`${qe}.borders.right`,j2=`${qe}.borders.bottom`,H2=`${qe}.borders.left`,$2=`${qe}.borders.remove`,D2=`${qe}.nestedHeaders.insertChildRow`,L2=`${qe}.nestedHeaders.detachFromParent`,F2=`${qe}.hideColumn`,V2=`${qe}.showColumn`,B2=`${qe}.hideRow`,W2=`${qe}.showRow`,Yi="Filters:",Dr=`${Yi}conditions`,M_=`${Dr}.none`,z2=`${Dr}.isEmpty`,U2=`${Dr}.isNotEmpty`,Y2=`${Dr}.isEqualTo`,G2=`${Dr}.isNotEqualTo`,K2=`${Dr}.beginsWith`,q2=`${Dr}.endsWith`,X2=`${Dr}.contains`,Q2=`${Dr}.doesNotContain`,S1e=`${Dr}.byValue`,J2=`${Dr}.greaterThan`,Z2=`${Dr}.greaterThanOrEqualTo`,ej=`${Dr}.lessThan`,tj=`${Dr}.lessThanOrEqualTo`,rj=`${Dr}.isBetween`,nj=`${Dr}.isNotBetween`,ij=`${Dr}.after`,sj=`${Dr}.before`,oj=`${Dr}.today`,aj=`${Dr}.tomorrow`,lj=`${Dr}.yesterday`,cj=`${Yi}labels.filterByCondition`,uj=`${Yi}labels.filterByValue`,dj=`${Yi}labels.conjunction`,A_=`${Yi}labels.disjunction`,IC=`${Yi}values.blankCells`,hj=`${Yi}buttons.selectAll`,fj=`${Yi}buttons.clear`,gj=`${Yi}buttons.ok`,mj=`${Yi}buttons.cancel`,pj=`${Yi}buttons.placeholder.search`,yj=`${Yi}buttons.placeholder.value`,vj=`${Yi}buttons.placeholder.secondValue`,jl="Pagination:",wj=`${jl}section.pagination`,bj=`${jl}.pageSize.auto`,jC=`${jl}section.pageSize`,xj=`${jl}section.counter`,Sj=`${jl}section.navigation`,Cj=`${jl}firstPage`,_j=`${jl}prevPage`,Rj=`${jl}nextPage`,Ej=`${jl}lastPage`,Nj="CheckboxRenderer:",kj=`${Nj}checked`,Tj=`${Nj}unchecked`,k9="Loading:",Pj=`${k9}title`,ip="EmptyDataState:",Mj=`${ip}title`,Aj=`${ip}description`,Oj=`${ip}title.filters`,Ij=`${ip}description.filters`,jj=`${ip}buttons.filters.reset`,C1e=Object.freeze(Object.defineProperty({__proto__:null,CANCEL:e2,CHECKBOX_CHECKED:kj,CHECKBOX_RENDERER_NAMESPACE:Nj,CHECKBOX_UNCHECKED:Tj,COMMON_NAMESPACE:ZI,CONTEXTMENU_ITEMS_ADD_COMMENT:b2,CONTEXTMENU_ITEMS_ALIGNMENT:_2,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:M2,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:E2,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:k2,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:R2,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:P2,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:N2,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:T2,CONTEXTMENU_ITEMS_BORDERS:A2,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:j2,CONTEXTMENU_ITEMS_BORDERS_LEFT:H2,CONTEXTMENU_ITEMS_BORDERS_RIGHT:I2,CONTEXTMENU_ITEMS_BORDERS_TOP:O2,CONTEXTMENU_ITEMS_CLEAR_COLUMN:u2,CONTEXTMENU_ITEMS_COPY:d2,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:g2,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:f2,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:h2,CONTEXTMENU_ITEMS_CUT:m2,CONTEXTMENU_ITEMS_EDIT_COMMENT:x2,CONTEXTMENU_ITEMS_FREEZE_COLUMN:p2,CONTEXTMENU_ITEMS_HIDE_COLUMN:F2,CONTEXTMENU_ITEMS_HIDE_ROW:B2,CONTEXTMENU_ITEMS_INSERT_LEFT:i2,CONTEXTMENU_ITEMS_INSERT_RIGHT:s2,CONTEXTMENU_ITEMS_MERGE_CELLS:v2,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:L2,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:D2,CONTEXTMENU_ITEMS_NO_ITEMS:t2,CONTEXTMENU_ITEMS_READ_ONLY:OC,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:C2,CONTEXTMENU_ITEMS_REDO:c2,CONTEXTMENU_ITEMS_REMOVE_BORDERS:$2,CONTEXTMENU_ITEMS_REMOVE_COLUMN:a2,CONTEXTMENU_ITEMS_REMOVE_COMMENT:S2,CONTEXTMENU_ITEMS_REMOVE_ROW:o2,CONTEXTMENU_ITEMS_ROW_ABOVE:r2,CONTEXTMENU_ITEMS_ROW_BELOW:n2,CONTEXTMENU_ITEMS_SHOW_COLUMN:V2,CONTEXTMENU_ITEMS_SHOW_ROW:W2,CONTEXTMENU_ITEMS_UNDO:l2,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:y2,CONTEXTMENU_ITEMS_UNMERGE_CELLS:w2,CONTEXT_MENU_ITEMS_NAMESPACE:N9,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:jj,EMPTY_DATA_STATE_DESCRIPTION:Aj,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:Ij,EMPTY_DATA_STATE_NAMESPACE:ip,EMPTY_DATA_STATE_TITLE:Mj,EMPTY_DATA_STATE_TITLE_FILTERS:Oj,FILTERS_BUTTONS_CANCEL:mj,FILTERS_BUTTONS_CLEAR:fj,FILTERS_BUTTONS_OK:gj,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:pj,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:vj,FILTERS_BUTTONS_PLACEHOLDER_VALUE:yj,FILTERS_BUTTONS_SELECT_ALL:hj,FILTERS_CONDITIONS_AFTER:ij,FILTERS_CONDITIONS_BEFORE:sj,FILTERS_CONDITIONS_BEGINS_WITH:K2,FILTERS_CONDITIONS_BETWEEN:rj,FILTERS_CONDITIONS_BY_VALUE:S1e,FILTERS_CONDITIONS_CONTAINS:X2,FILTERS_CONDITIONS_EMPTY:z2,FILTERS_CONDITIONS_ENDS_WITH:q2,FILTERS_CONDITIONS_EQUAL:Y2,FILTERS_CONDITIONS_GREATER_THAN:J2,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Z2,FILTERS_CONDITIONS_LESS_THAN:ej,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:tj,FILTERS_CONDITIONS_NAMESPACE:Dr,FILTERS_CONDITIONS_NONE:M_,FILTERS_CONDITIONS_NOT_BETWEEN:nj,FILTERS_CONDITIONS_NOT_CONTAIN:Q2,FILTERS_CONDITIONS_NOT_EMPTY:U2,FILTERS_CONDITIONS_NOT_EQUAL:G2,FILTERS_CONDITIONS_TODAY:oj,FILTERS_CONDITIONS_TOMORROW:aj,FILTERS_CONDITIONS_YESTERDAY:lj,FILTERS_DIVS_FILTER_BY_CONDITION:cj,FILTERS_DIVS_FILTER_BY_VALUE:uj,FILTERS_LABELS_CONJUNCTION:dj,FILTERS_LABELS_DISJUNCTION:A_,FILTERS_NAMESPACE:Yi,FILTERS_VALUES_BLANK_CELLS:IC,LOADING_NAMESPACE:k9,LOADING_TITLE:Pj,OK:AC,PAGINATION_COUNTER_SECTION:xj,PAGINATION_FIRST_PAGE:Cj,PAGINATION_LAST_PAGE:Ej,PAGINATION_NAMESPACE:jl,PAGINATION_NAV_SECTION:Sj,PAGINATION_NEXT_PAGE:Rj,PAGINATION_PAGE_SIZE_AUTO:bj,PAGINATION_PAGE_SIZE_SECTION:jC,PAGINATION_PREV_PAGE:_j,PAGINATION_SECTION:wj},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const T9={languageCode:"en-US",[AC]:"OK",[e2]:"Cancel",[t2]:"No available options",[r2]:"Insert row above",[n2]:"Insert row below",[i2]:"Insert column left",[s2]:"Insert column right",[o2]:["Remove row","Remove rows"],[a2]:["Remove column","Remove columns"],[l2]:"Undo",[c2]:"Redo",[OC]:"Read only",[u2]:"Clear column",[_2]:"Alignment",[R2]:"Left",[E2]:"Center",[N2]:"Right",[k2]:"Justify",[T2]:"Top",[P2]:"Middle",[M2]:"Bottom",[p2]:"Freeze column",[y2]:"Unfreeze column",[A2]:"Borders",[O2]:"Top",[I2]:"Right",[j2]:"Bottom",[H2]:"Left",[$2]:"Remove border(s)",[b2]:"Add comment",[x2]:"Edit comment",[S2]:"Delete comment",[C2]:"Read-only comment",[v2]:"Merge cells",[w2]:"Unmerge cells",[d2]:"Copy",[h2]:["Copy with header","Copy with headers"],[f2]:["Copy with group header","Copy with group headers"],[g2]:["Copy header only","Copy headers only"],[m2]:"Cut",[D2]:"Insert child row",[L2]:"Detach from parent",[F2]:["Hide column","Hide columns"],[V2]:["Show column","Show columns"],[B2]:["Hide row","Hide rows"],[W2]:["Show row","Show rows"],[M_]:"None",[z2]:"Is empty",[U2]:"Is not empty",[Y2]:"Is equal to",[G2]:"Is not equal to",[K2]:"Begins with",[q2]:"Ends with",[X2]:"Contains",[Q2]:"Does not contain",[J2]:"Greater than",[Z2]:"Greater than or equal to",[ej]:"Less than",[tj]:"Less than or equal to",[rj]:"Is between",[nj]:"Is not between",[ij]:"After",[sj]:"Before",[oj]:"Today",[aj]:"Tomorrow",[lj]:"Yesterday",[IC]:"Blank cells",[cj]:"Filter by condition",[uj]:"Filter by value",[dj]:"And",[A_]:"Or",[hj]:"Select all",[fj]:"Clear",[gj]:"OK",[mj]:"Cancel",[pj]:"Search",[yj]:"Value",[vj]:"Second value",[wj]:"Pagination",[jC]:"Page size",[bj]:"Auto",[xj]:"[start] - [end] of [total]",[Sj]:"Page [currentPage] of [totalPages]",[Cj]:"Go to first page",[_j]:"Go to previous page",[Rj]:"Go to next page",[Ej]:"Go to last page",[kj]:"Checked",[Tj]:"Unchecked",[Pj]:"Loading...",[Mj]:"No data available",[Aj]:"Theres nothing to display yet.",[Oj]:"No results found",[Ij]:"It looks like your current filters are hiding all results.",[jj]:"Reset filters"},_1e=C1e,vM=T9.languageCode,{register:R1e,getItem:P9,hasItem:E1e,getValues:N1e}=$o("languagesDictionaries");M9(T9);function M9(t,e){let r=t,n=e;return Le(t)&&(n=t,r=n.languageCode),k1e(r,n),R1e(r,Bi(n)),Bi(n)}function k1e(t,e){t!==vM&&y1e(e,P9(vM))}function A9(t){return Hj(t)?Bi(P9(t)):null}function Hj(t){return E1e(t)}function T1e(){return N1e()}function O9(t,e,r){const n=A9(t);if(n===null)return null;const i=n[e];if(fr(i))return null;const s=P1e(i,r);return Array.isArray(s)?s[0]:s}function P1e(t,e){return x1e().reduce((r,n)=>n(r,e),t)}function M1e(t){let e=C9(t);return Hj(e)||(e=vM,_9(t)),e}function A1e(t,e,r){return(e=O1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O1e(t){var e=I1e(t,"string");return typeof e=="symbol"?e:e+""}function I1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vc extends l9{constructor(e,r){super(e,null),A1e(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,n,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const c=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(c)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function bN(t){let{activeHeaderClassName:e,...r}=t;return new Vc({className:e,...r,selectionType:c9})}function j1e(t){let{areaCornerVisible:e,...r}=t;return new Vc({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:DI})}function H1e(t){let{...e}=t;return new Vc({className:"highlight",...e,selectionType:DI})}function $1e(t){let{columnClassName:e,...r}=t;return new Vc({className:e,...r,selectionType:zSe})}function D1e(t){let{cellCornerVisible:e,...r}=t;return new Vc({className:"current",headerAttributes:[vI()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:MC})}function L1e(t){let{border:e,visualCellRange:r,...n}=t;return new Vc({...e,...n,selectionType:USe},r)}function F1e(t){let{...e}=t;return new Vc({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:BSe})}function q4(t){let{headerClassName:e,...r}=t;return new Vc({className:e,...r,selectionType:$I})}function V1e(t){let{rowClassName:e,...r}=t;return new Vc({className:e,...r,selectionType:WSe})}function B1e(t,e){W1e(t,e),e.add(t)}function W1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(t,e,r){return(e=z1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z1e(t){var e=U1e(t,"string");return typeof e=="symbol"?e:e+""}function U1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Va=new WeakSet;class Y1e{constructor(e){B1e(this,Va),Qi(this,"options",void 0),Qi(this,"layerLevel",0),Qi(this,"focus",void 0),Qi(this,"fill",void 0),Qi(this,"layeredAreas",new Map),Qi(this,"areas",new Map),Qi(this,"rowHeaders",new Map),Qi(this,"columnHeaders",new Map),Qi(this,"activeRowHeaders",new Map),Qi(this,"activeColumnHeaders",new Map),Qi(this,"activeCornerHeaders",new Map),Qi(this,"rowHighlights",new Map),Qi(this,"columnHighlights",new Map),Qi(this,"customSelections",[]),this.options=e,this.focus=D1e(e),this.fill=F1e(e)}isEnabledFor(e,r){let n=e;e===MC&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return zl(Va,this,Ul).call(this,this.layeredAreas,j1e)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return zl(Va,this,Ul).call(this,this.areas,H1e)}getAreas(){return[...this.areas.values()]}createRowHeader(){return zl(Va,this,Ul).call(this,this.rowHeaders,q4)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return zl(Va,this,Ul).call(this,this.columnHeaders,q4)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return zl(Va,this,Ul).call(this,this.activeRowHeaders,bN)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return zl(Va,this,Ul).call(this,this.activeColumnHeaders,bN)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return zl(Va,this,Ul).call(this,this.activeCornerHeaders,bN)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return zl(Va,this,Ul).call(this,this.rowHighlights,V1e)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return zl(Va,this,Ul).call(this,this.columnHighlights,$1e)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(L1e({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),B(this.areas.values(),e=>void e.clear()),B(this.layeredAreas.values(),e=>void e.clear()),B(this.rowHeaders.values(),e=>void e.clear()),B(this.columnHeaders.values(),e=>void e.clear()),B(this.activeRowHeaders.values(),e=>void e.clear()),B(this.activeColumnHeaders.values(),e=>void e.clear()),B(this.activeCornerHeaders.values(),e=>void e.clear()),B(this.rowHighlights.values(),e=>void e.clear()),B(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ul(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function X4(t,e,r){return(e=G1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G1e(t){var e=K1e(t,"string");return typeof e=="symbol"?e:e+""}function K1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $j{constructor(e){X4(this,"ranges",[]),X4(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new $j(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function q1e(t,e){I9(t,e),e.add(t)}function X1e(t,e,r){return(e=Q1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q1e(t){var e=J1e(t,"string");return typeof e=="symbol"?e:e+""}function J1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xN(t,e,r){I9(t,e),e.set(t,r)}function I9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mn(t,e){return t.get(It(t,e))}function Ug(t,e,r){return t.set(It(t,e),r),r}function It(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var oc=new WeakMap,fh=new WeakMap,Xs=new WeakMap,Lt=new WeakSet;class Dj{constructor(e,r){q1e(this,Lt),xN(this,oc,void 0),xN(this,fh,0),xN(this,Xs,{x:0,y:0}),X1e(this,"tableApi",void 0),Ug(oc,this,e),this.tableApi=r}setActiveLayerIndex(e){Ug(fh,this,e)}getCurrentSelection(){return mn(oc,this).peekByIndex(mn(fh,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Ug(Xs,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,r);let s=this.getCurrentSelection().highlight;const o=this.tableApi.visualToRenderableCoords(s);let a=0,c=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){let{width:u,height:d}=It(Lt,this,wM).call(this);const{row:f,col:h}=It(Lt,this,e6).call(this,s),m=this.tableApi.fixedRowsBottom(),g=this.tableApi.minSpareRows(),p=this.tableApi.minSpareCols(),y=this.tableApi.autoWrapRow(),w=this.tableApi.autoWrapCol(),v=this.tableApi.createCellCoords(f+i.row,h+i.col);if(v.row>=d){const N=Ks(n&&g>0&&m===0),R=v.col+1,E=R>=u,P=this.tableApi.createCellCoords(v.row-d,E?R-u:R);if(this.runLocalHooks("beforeColumnWrap",N,It(Lt,this,Df).call(this,P),E),N.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(w){if(this.shouldSwitchSelectionLayer()&&E&&mn(oc,this).size()>1){It(Lt,this,Q4).call(this);const D=It(Lt,this,xb).call(this,"forward");D!==null&&P.assign(D)}v.assign(P)}}else if(v.row<0){const N=Ks(w),R=v.col-1,E=R<0,P=this.tableApi.createCellCoords(d+v.row,E?u+R:R);if(this.runLocalHooks("beforeColumnWrap",N,It(Lt,this,Df).call(this,P),E),w){if(this.shouldSwitchSelectionLayer()&&E&&mn(oc,this).size()>1){It(Lt,this,J4).call(this);const D=It(Lt,this,xb).call(this,"backward");D!==null&&P.assign(D)}v.assign(P)}}if({width:u,height:d}=It(Lt,this,wM).call(this),v.col>=u){const N=Ks(n&&p>0),R=v.row+1,E=R>=d,P=this.tableApi.createCellCoords(E?R-d:R,v.col-u);if(this.runLocalHooks("beforeRowWrap",N,It(Lt,this,Df).call(this,P),E),N.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(y){if(this.shouldSwitchSelectionLayer()&&E&&mn(oc,this).size()>1){It(Lt,this,Q4).call(this);const D=It(Lt,this,xb).call(this,"forward");D!==null&&P.assign(D)}v.assign(P)}}else if(v.col<0){const N=Ks(y),R=v.row-1,E=R<0,P=this.tableApi.createCellCoords(E?d+R:R,u+v.col);if(this.runLocalHooks("beforeRowWrap",N,It(Lt,this,Df).call(this,P),E),y){if(this.shouldSwitchSelectionLayer()&&E&&mn(oc,this).size()>1){It(Lt,this,J4).call(this);const D=It(Lt,this,xb).call(this,"backward");D!==null&&P.assign(D)}v.assign(P)}}const{rowDir:x,colDir:S}=It(Lt,this,Z4).call(this,v);a=x,c=S,s=It(Lt,this,Df).call(this,v)}return this.runLocalHooks("afterTransformStart",s,a,c),{selectionLayer:mn(fh,this),visualCoords:s}}transformEnd(e,r){Ug(Xs,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),s=this.tableApi.visualToRenderableCoords(i.highlight),o=It(Lt,this,yS).call(this,i.to.row,i.from.row),a=It(Lt,this,vS).call(this,i.to.col,i.from.col),c=i.to.clone();let u=0,d=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:f,col:h}=It(Lt,this,e6).call(this,i.highlight),m=this.tableApi.createCellCoords(o+n.row,a+n.col),g=i.getTopStartCorner(),p=i.getTopEndCorner(),y=i.getBottomEndCorner();if(n.col<0&&a>=h&&m.col<h){const S=m.col-h;m.col=It(Lt,this,vS).call(this,g.col,p.col)+S}else if(n.col>0&&a<=h&&m.col>h){const S=It(Lt,this,vS).call(this,p.col,g.col),N=Math.max(m.col-S,1);m.col=S+N}if(n.row<0&&o>=f&&m.row<f){const S=m.row-f;m.row=It(Lt,this,yS).call(this,g.row,y.row)+S}else if(n.row>0&&o<=f&&m.row>f){const S=It(Lt,this,yS).call(this,y.row,g.row),N=Math.max(m.row-S,1);m.row=S+N}const{rowDir:w,colDir:v}=It(Lt,this,Z4).call(this,m);u=w,d=v;const x=It(Lt,this,Df).call(this,m);n.row===0&&n.col!==0?c.col=x.col:n.row!==0&&n.col===0?c.row=x.row:(c.row=x.row,c.col=x.col)}return this.runLocalHooks("afterTransformEnd",c,u,d),{selectionLayer:mn(fh,this),visualCoords:c}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function Q4(){const t=mn(fh,this)+1;this.setActiveLayerIndex(t>=mn(oc,this).size()?0:t),Ug(Xs,this,this.calculateOffset())}function J4(){const t=mn(fh,this)-1;this.setActiveLayerIndex(t<0?mn(oc,this).size()-1:t),Ug(Xs,this,this.calculateOffset())}function Z4(t){const{width:e,height:r}=It(Lt,this,wM).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function wM(){return{width:mn(Xs,this).x+this.countRenderableColumns(),height:mn(Xs,this).y+this.countRenderableRows()}}function xb(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,s,o]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=It(Lt,this,yS).call(this,n,i),c=It(Lt,this,vS).call(this,s,o);return a===null||c===null?null:this.tableApi.createCellCoords(a,c)}function yS(t,e){const r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:mn(Xs,this).y+r}function vS(t,e){const r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:mn(Xs,this).x+r}function e6(t){const{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(mn(Xs,this).y+e,mn(Xs,this).x+r)}function Df(t){const e=t.clone();return e.col=t.col-mn(Xs,this).x,e.row=t.row-mn(Xs,this).y,this.tableApi.renderableToVisualCoords(e)}Ht(Dj,Mn);class Z1e extends Dj{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class e_e extends Dj{calculateOffset(){const e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),s=this.tableApi.countRenderableRowsInRange(0,r-1),o=e.highlight.isHeader(),a=o?Math.abs(n):0,c=o?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?c:-s}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const O_=0,I_=1,j9=2,Lj=3,t_e=[Lj,j9],r_e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],SN=Symbol("root"),t6=Symbol("child");function Im(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:SN;if(e!==SN&&e!==t6)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===SN;let i=O_;if(r){const s=t[0];t.length===0?i=I_:n&&s instanceof rp?i=Lj:n&&Array.isArray(s)?i=Im(s,t6):t.length>=2&&t.length<=4&&!t.some((a,c)=>!r_e[c].includes(typeof a))&&(i=j9)}return i}function sv(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t_e.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===Lj;let a=o?s.from.row:s[0],c=o?s.from.col:s[1],u=o?s.to.row:s[2],d=o?s.to.col:s[3];if(typeof i=="function"&&(typeof c=="string"&&(c=i(c)),typeof d=="string"&&(d=i(d))),fr(u)&&(u=a),fr(d)&&(d=c),!n){const g=a,p=c,y=u,w=d;a=Math.min(g,y),c=Math.min(p,w),u=Math.max(g,y),d=Math.max(p,w)}const f=o?s.highlight.clone():e(a,c),h=e(a,c),m=e(u,d);return r(f,h,m)}}function n_e(t){const e=Im(t.getSelected());if(e===O_||e===I_)return[];const r=sv(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;B(t.getSelected(),o=>{const{from:a,to:c}=r(o),u=Math.max(a.col,0),d=c.col-u+1;B(Array.from(new Array(d),(f,h)=>u+h),f=>{n.has(f)||n.add(f)})});const i=Array.from(n).sort((o,a)=>o-a);return bs(i,(o,a,c,u)=>(c!==0&&a===u[c-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function i_e(t){const e=Im(t.getSelected());if(e===O_||e===I_)return[];const r=sv(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;B(t.getSelected(),o=>{const{from:a,to:c}=r(o),u=Math.max(a.row,0),d=c.row-u+1;B(Array.from(new Array(d),(f,h)=>u+h),f=>{n.has(f)||n.add(f)})});const i=Array.from(n).sort((o,a)=>o-a);return bs(i,(o,a,c,u)=>(c!==0&&a===u[c-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function _d(t,e,r){s_e(t,e),e.set(t,r)}function s_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rd(t,e,r){return(e=o_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o_e(t){var e=a_e(t,"string");return typeof e=="symbol"?e:e+""}function a_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vr(t,e){return t.get(H9(t,e))}function Ns(t,e,r){return t.set(H9(t,e),r),r}function H9(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ks=new WeakMap,Lf=new WeakMap,Sb=new WeakMap,Qc=new WeakMap,Cb=new WeakMap,qp=new WeakMap,_b=new WeakMap;class $9{constructor(e,r){var n=this;Rd(this,"settings",void 0),Rd(this,"tableProps",void 0),Rd(this,"inProgress",!1),Rd(this,"selectedRange",new $j((i,s,o)=>this.tableProps.createCellRange(i,s,o))),Rd(this,"highlight",void 0),_d(this,ks,void 0),_d(this,Lf,void 0),Rd(this,"selectedByRowHeader",new Set),Rd(this,"selectedByColumnHeader",new Set),_d(this,Sb,!1),_d(this,Qc,!1),_d(this,Cb,"unknown"),_d(this,qp,-1),_d(this,_b,0),this.settings=e,this.tableProps=r,this.highlight=new Y1e({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[vI()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),Ns(ks,this,new Z1e(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ns(Lf,this,new e_e(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),vr(ks,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),vr(ks,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),vr(ks,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),vr(ks,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),vr(ks,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),vr(ks,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)}),vr(ks,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...s)}),vr(ks,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...s)}),vr(Lf,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),vr(Lf,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(vr(_b,this))}getActiveSelectionLayerIndex(){return vr(_b,this)}setActiveSelectionLayerIndex(e){Ns(_b,this,e)}markSource(e){Ns(Cb,this,e)}markEndSource(){Ns(Cb,this,"unknown")}getSelectionSource(){return vr(Cb,this)}setExpectedLayers(e){Ns(qp,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ns(qp,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=fr(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();Ns(Qc,this,!1),Ns(Sb,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!s||s&&!o&&fr(r))&&(this.selectedRange.clear(),B(this.highlight.getAreas(),c=>void c.clear()),B(this.highlight.getLayeredAreas(),c=>void c.clear()),B(this.highlight.getRowHeaders(),c=>void c.clear()),B(this.highlight.getColumnHeaders(),c=>void c.clear()),B(this.highlight.getActiveRowHeaders(),c=>void c.clear()),B(this.highlight.getActiveColumnHeaders(),c=>void c.clear()),B(this.highlight.getActiveCornerHeaders(),c=>void c.clear()),B(this.highlight.getRowHighlights(),c=>void c.clear()),B(this.highlight.getColumnHighlights(),c=>void c.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);const n=e.clone(),i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||s>0)&&(i===0&&n.col<0&&!o||s===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),d=a.getVerticalDirection(),f=this.isMultiple();a.setTo(n),f&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),f&&(d!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);const c=vr(qp,this)===-1||this.selectedRange.size()===vr(qp,this);this.runLocalHooks("afterSetRangeEnd",e,c)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),c=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),h=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),c.clear(),u.clear(),d.clear(),f.clear(),h.clear(),m.clear(),this.highlight.isEnabledFor(DI,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const g=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor($I,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),w=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),x=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),c.add(v).commit(),h.add(y).commit(),m.add(v).commit()):(a.add(y).add(w).commit(),c.add(v).add(x).commit(),h.add(y).add(w).commit(),m.add(v).add(x).commit())}const g=!vr(Qc,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!vr(Qc,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&d.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&p&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),vr(ks,this).setActiveLayerIndex(r),vr(Lf,this).setActiveLayerIndex(r);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(MC,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(Ns(Sb,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=vr(ks,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){const{visualCoords:n,selectionLayer:i}=vr(ks,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){const{selectionLayer:n,visualCoords:i}=vr(Lf,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countRows(),c=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),d=u?-1:0,f=u?0:r;this.getSelectedRange().pop();const h=this.tableProps.createCellCoords(ut(i.row+f,d,a-1),i.col),m=this.tableProps.createCellCoords(ut(s.row+r,d,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(h,!0,this.tableProps.createCellCoords(ut(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(h,!0),c&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countCols(),c=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),d=c?-1:0,f=c?0:r;this.getSelectedRange().pop();const h=this.tableProps.createCellCoords(i.row,ut(i.col+f,d,a-1)),m=this.tableProps.createCellCoords(s.row,ut(s.col+r,d,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(h,!0,this.tableProps.createCellCoords(o.row,ut(o.col+r,0,a-1))):this.setRangeStartOnly(h,!0),c&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const r=Ks(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&vr(Sb,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),c=this.tableProps.countColHeaders(),u=n?-c:0,d=r?-a:0;if(u===0&&d===0&&(s===0||o===0))return;let f=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:h,disableHeadersHighlight:m}=i;h&&Number.isInteger(h==null?void 0:h.row)&&Number.isInteger(h==null?void 0:h.col)&&(f=this.tableProps.createCellCoords(ut(h.row,u,s-1),ut(h.col,d,o-1)));const g=this.tableProps.createCellCoords(u,d),p=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.runLocalHooks("beforeSelectAll",g,p,f),this.setRangeStartOnly(g,void 0,f),Ns(Qc,this,m),d<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectAll",g,p,f),this.finish()}selectCells(e){var r=this;const n=Im(e);if(n===I_)return!1;if(n===O_)throw new Error(Rt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=sv(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:c=>this.tableProps.propToCol(c),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(c=>{const u=i(c),d=u.isValid(o);return!(d&&!u.containsHeaders()||d&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),B(e,c=>{const{from:u,to:d}=i(c);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(d.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),c=this.tableProps.countColHeaders(),u=c===0?0:-c,d=this.tableProps.createCellCoords(u,i),f=this.tableProps.createCellCoords(o-1,s),h=this.tableProps.createCellRange(d,d,f).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:c});if(h){let m=0,g=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(m=ut(n.row,u,o-1),g=ut(n.col,Math.min(i,s),Math.max(i,s))):(m=ut(n,u,o-1),g=i);const p=this.tableProps.createCellCoords(m,g),y=c===0?0:ut(p.row,u,-1),w=o-1,v=this.tableProps.createCellCoords(y,i),x=this.tableProps.createCellCoords(w,s);this.runLocalHooks("beforeSelectColumns",v,x,p),this.setRangeStartOnly(v,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.runLocalHooks("afterSelectColumns",v,x,p),this.finish()}return h}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,c=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,s-1),d=this.tableProps.createCellRange(c,c,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(d){let f=0,h=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(f=ut(n.row,Math.min(e,r),Math.max(e,r)),h=ut(n.col,a,s-1)):(f=e,h=ut(n,a,s-1));const m=this.tableProps.createCellCoords(f,h),g=o===0?0:ut(m.col,a,-1),p=s-1,y=this.tableProps.createCellCoords(e,g),w=this.tableProps.createCellCoords(r,p);this.runLocalHooks("beforeSelectRows",y,w,m),this.setRangeStartOnly(y,void 0,m),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",y,w,m),this.finish()}return d}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:s,selectedByColumnHeader:o,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,Ns(Qc,this,a),this.selectedByRowHeader=new Set(s),this.selectedByColumnHeader=new Set(o),this.setActiveSelectionLayerIndex(0),r.forEach((c,u)=>{this.selectedRange.push(c),this.applyAndCommit(c,u)}),this.setRangeFocus(n.highlight,i),Ns(Qc,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:vr(Qc,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(o=>{const{from:a,to:c,highlight:u}=o,d=e-1,f=r-1;u.assign({row:ut(u.row,this.settings.navigableHeaders?-1/0:0,d),col:ut(u.col,this.settings.navigableHeaders?-1/0:0,f)}),a.assign({row:ut(a.row,-1/0,d),col:ut(a.col,-1/0,f)}),c.assign({row:ut(c.row,-1/0,d),col:ut(c.col,-1/0,f)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(c)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(MC,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),c=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),h=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),c.commit(),u.commit(),d.commit(),f.commit(),h.commit(),m.commit()}this.highlight.useLayerLevel(r)}}Ht($9,Mn);const r6=/^(\r\n|\n\r|\r|\n)/,l_e=/^[^\t\r\n]+/,n6=/^\t/;function c_e(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(n6))t=t.replace(n6,""),r+=1,e[n][r]="";else if(t.match(r6))t=t.replace(r6,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const c=t.slice(0,1);c==='"'&&(o+=1),s+=c,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,c=>new Array(Math.floor(c.length/2)).fill('"').join(""))}else{const o=t.match(l_e);s=o?o[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function HC(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function CN(t,e){const{instance:r,visualRow:n,visualCol:i,valueSetter:s}=e;return Tt(s)?s.call(r,t,n,i,e):t}function u_e(t,e){const{instance:r,visualRow:n,visualCol:i,valueGetter:s}=e;return Tt(s)?s.call(r,t,n,i,e):t}function Ed(t,e,r){return(e=d_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d_e(t){var e=h_e(t,"string");return typeof e=="symbol"?e:e+""}function h_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yg{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Ed(this,"hot",void 0),Ed(this,"metaManager",void 0),Ed(this,"tableMeta",void 0),Ed(this,"dataSource",void 0),Ed(this,"duckSchema",void 0),Ed(this,"colToPropCache",void 0),Ed(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){const a=bI(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=o?r(n):r[n];if(Le(a)){if(typeof a.data<"u"){const c=o?s:n;this.colToPropCache[c]=a.data,this.propToColCache.set(a.data,c)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return y9(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&at(e,(a,c)=>{a===null?(o=s+c,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${c}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&xe(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(xe(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?rv(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,c=e;if((typeof c!="number"||c>=s)&&(c=s),c<this.hot.countRows()&&(o=this.hot.toPhysicalRow(c)),this.hot.runHooks("beforeCreateRow",c,r,n)===!1||o===null)return{delta:0};const d=this.tableMeta.maxRows,f=this.getSchema().length,h=[];for(;a<r&&s+a<d;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Bi(this.getSchema()):(g=[],Oe(f-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(c+a):(g={},b_(g,this.getSchema())),h.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(c,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,h);const m=this.hot.toVisualRow(o);return this.hot.countSourceRows()===h.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",m,a,n),{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),c=this.hot.countCols(),u=this.hot.countSourceRows(),d=typeof e=="number"&&e<=a?e:c;if(this.hot.runHooks("beforeCreateCol",d,r,n)===!1)return{delta:0};const f=d<c?this.hot.toPhysicalColumn(d):a,h=i==="end"?Math.min(f+1,a):f;let m=0;for(let g=h;m<r&&c+m<o;g++){if(typeof d!="number"||d>=c+m)if(u>0)for(let p=0;p<u;p+=1)typeof s[p]>"u"&&(s[p]=[]),s[p].push(null);else s.push([null]);else for(let p=0;p<u;p++)s[p].splice(g,0,null);m+=1}return m>0&&(e==null?this.metaManager.createColumn(null,m):n!=="auto"&&this.metaManager.createColumn(h,r)),this.hot.columnIndexMapper.insertIndexes(d,m,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(h),m,n),this.refreshDuckSchema(),{delta:m,startPhysicalIndex:h}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const c=s.length;if(this.filterData(i,c,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const d=xe(this.tableMeta.columns)||xe(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!d&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((d,f)=>f-d).forEach(d=>{this.metaManager.removeRow(d,1)}),this.hot.runHooks("afterRemoveRow",i,c,s,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((f,h)=>h-f);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let c=!0;const u=o.length,d=this.dataSource;for(let f=0;f<u;f++)c&&s[0]!==s[f]-f&&(c=!1);if(c)for(let f=0,h=this.hot.countSourceRows();f<h;f++)d[f].splice(s[0],r),f===0&&this.metaManager.removeColumn(s[0],r);else for(let f=0,h=this.hot.countSourceRows();f<h;f++)for(let m=0;m<u;m++)d[f].splice(o[m],1),f===0&&this.metaManager.removeColumn(o[m],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,c=new Array(a>3?a-3:0),u=3;u<a;u++)c[u-3]=arguments[u];I3(c,o);let d=0;for(;d<n;)c.push(null),d+=1;return $0e(c),this.hot.populateFromArray(r,e,c,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,c=new Array(a>3?a-3:0),u=3;u<a;u++)c[u-3]=arguments[u];I3(c,o);let d=0;for(;d<n;)c.push(null),d+=1;return this.hot.populateFromArray(e,r,[c],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Kr(i,r))a=i[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let d=i;if(!d)return null;const f=r.split(".");for(let h=0,m=f.length;h<m;h++)if(d=d[f[h]],typeof d>"u")return null;a=d}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));const c=this.propToCol(r),u=this.hot.toPhysicalColumn(c);if(dm(n)&&dm(u)&&(a=u_e(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:c,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const d=Ks(a);this.hot.runHooks("modifyData",e,c,d,"get"),d.isTouched()&&(a=d.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=Ks(s);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:c}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Kr(o,r))o[r]=s;else if(c&&typeof r=="string"&&r.indexOf(".")>-1){let u=o,d=0,f;const h=r.split(".");for(d=0,f=h.length-1;d<f;d++){if(h[d]==="__proto__"||h[d]==="constructor"||h[d]==="prototype")return;typeof u[h[d]]>"u"&&(u[h[d]]={}),u=u[h[d]]}u[h[d]]=s}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],s);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;o[r]=s}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,o=r;for(;s<n&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Yg.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,o,a;const c=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(c===0||u===0)return[];const d=n===Yg.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(c-1,0),Math.max(e.row,r.row)),h=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=f;s++){a=[];const m=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=h&&m!==null;o++)a.push(d.call(this,s,this.colToProp(o)));m!==null&&i.push(a)}return i}getText(e,r){return HC(this.getRange(e,r,Yg.DESTINATION_RENDERER))}getCopyableText(e,r){return HC(this.getRange(e,r,Yg.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:f_e,getItem:g_e,hasItem:D9,getNames:QWe,getValues:JWe}=$o("cellTypes");function m_e(t){if(!D9(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return g_e(t)}function Qo(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&Hs(t,r),n&&fo(t,n),i&&Sg(t,i),f_e(t,e)}function p_e(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Kr(e,t)}function j_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?m_e(e.type):e.type;if(t._automaticallyAssignedMetaProps&&at(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!Le(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};at(n,(s,o)=>{if(p_e(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),vn(t,i)}function y_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Uye(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function wS(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function V0(t){return t==null}const L9=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),qr(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),qr(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),x_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function i6(t,e,r){return(e=v_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v_e(t){var e=w_e(t,"string");return typeof e=="symbol"?e:e+""}function w_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b_e(){return class{}}class x_e{constructor(e){i6(this,"metaCtor",b_e()),i6(this,"meta",void 0),this.meta=this.metaCtor.prototype,vn(this.meta,L9()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;vn(this.meta,e),j_(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function S_e(t,e,r){return(e=C_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C_e(t){var e=__e(t,"string");return typeof e=="symbol"?e:e+""}function __e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R_e{constructor(e){S_e(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){vn(this.meta,e),j_(this.meta,e,e)}}function Rb(t,e,r){return(e=E_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E_e(t){var e=N_e(t,"string");return typeof e=="symbol"?e:e+""}function N_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $C{constructor(e){Rb(this,"valueFactory",void 0),Rb(this,"data",[]),Rb(this,"index",[]),Rb(this,"holes",new Set),this.valueFactory=e}obtain(e){wS(()=>dm(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;wS(()=>dm(e)||V0(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);const s=V0(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;wS(()=>dm(e)||V0(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(V0(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function s6(t,e,r){return(e=k_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k_e(t){var e=T_e(t,"string");return typeof e=="symbol"?e:e+""}function T_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const P_e=["data","width"];class M_e{constructor(e){s6(this,"globalMeta",void 0),s6(this,"metas",new $C(()=>this._createMeta())),this.globalMeta=e,this.metas=new $C(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);vn(n,r),j_(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return y_e(this.globalMeta.getMetaConstructor(),P_e).prototype}}function o6(t,e,r){return(e=A_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A_e(t){var e=O_e(t,"string");return typeof e=="symbol"?e:e+""}function O_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I_e{constructor(e){o6(this,"columnMeta",void 0),o6(this,"metas",new $C(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);vn(i,n),j_(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)xe(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){wS(()=>dm(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new $C(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class F9{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new x_e(e),this.tableMeta=new R_e(this.globalMeta),this.columnMeta=new M_e(this.globalMeta),this.cellMeta=new I_e(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ht(F9,Mn);function a6(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:c,metaManager:u,firstRun:d}=n,f=_a(a),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":Tt(h.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${f}`,t,d,c);const m=new Yg(i,t,u);if(e(m),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=m.getSchema();t=[];let p,y=0,w=0;for(y=0,w=h.startRows;y<w;y++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)p=Bi(g),t.push(p);else if(i.dataType==="array")p=Bi(g[0]),t.push(p);else{p=[];for(let v=0,x=h.startCols;v<x;v++)p.push(null);t.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),h.data=t,m.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=m.colToProp.bind(m),o.propToCol=m.propToCol.bind(m),o.countCachedColumns=m.countCachedColumns.bind(m),r(m),i.runHooks(`after${f}`,t,d,c),d||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Ne(i.rootElement,[fU(-1),w_(i.countCols()+(i.view?i.countRowHeaders():0))])}function l6(t,e,r){return(e=j_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j_e(t){var e=H_e(t,"string");return typeof e=="symbol"?e:e+""}function H_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_e{constructor(e){var r=this;l6(this,"metaManager",void 0),l6(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),_e.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,c=a.colToProp(o);e.prop=c,a.runHooks("beforeGetCellMeta",s,o,e);const u=Kr(e,"type")?e.type:null;let d=Tt(e.cells)?e.cells(n,i,c):null;if(u)if(d){var f;d.type=(f=d.type)!==null&&f!==void 0?f:u}else d={type:u};d&&this.metaManager.updateCellMeta(n,i,d),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function D_e(t,e,r){L_e(t,e),e.set(t,r)}function L_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _N(t,e,r){return(e=F_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F_e(t){var e=V_e(t,"string");return typeof e=="symbol"?e:e+""}function V_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B_e(t,e){return t.get(W_e(t,e))}function W_e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var c6=new WeakMap;class z_e{constructor(e){_N(this,"metaManager",void 0),_N(this,"usageTracker",new Set),_N(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),D_e(this,c6,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:r,c=`_${a}`;this.metaManager.globalMeta.meta[c]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,c,s),o&&this.installPropWatcher(i,c,s)):n&&(this.installPropWatcher(r,c,B_e(c6,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}function U_e(t,e){V9(t,e),e.add(t)}function u6(t,e,r){V9(t,e),e.set(t,r)}function V9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d6(t,e){return t.get(jm(t,e))}function h6(t,e,r){return t.set(jm(t,e),r),r}function jm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bM=new WeakMap,xM=new WeakMap,hy=new WeakSet;class Y_e{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;U_e(this,hy),u6(this,bM,void 0),u6(this,xM,void 0),h6(bM,this,r),h6(xM,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=jm(hy,this,f6).call(this,e.from,r,n);if(i===null)return null;const s=jm(hy,this,f6).call(this,e.to,-r,-n);if(s===null)return null;const o=e.clone();return o.from=i,o.to=s,o.includes(e.highlight)||(o.highlight=i),o}}function f6(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=jm(hy,this,g6).call(this,d6(bM,this),t.row,e);if(n===null)return null;const i=jm(hy,this,g6).call(this,d6(xM,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function g6(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}function sp(t){Rc(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function H_(t){const{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),s=r.getFirstFullyVisibleColumn(),o=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,c=n.getBottomEndCorner().col,u=a<=s,d=c>=o,f=r.getFirstFullyVisibleRow(),h=r.getLastFullyVisibleRow(),m=n.getTopStartCorner().row,g=n.getBottomEndCorner().row,p=m<=f,y=g>=h;return{getComputedColumnTarget(w){return i==="mouse"||i==="keyboard"?w.col:u&&d?n.highlight.col:u?a:d?c:w.col},getComputedRowTarget(w){return i==="mouse"||i==="keyboard"?w.row:p&&y?n.highlight.row:p?m:y?g:w.row}}}function G_e(t){return e=>{const r=H_(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;sp(t.getCell(n?-1:0,r,!0))})}}function K_e(){return()=>{}}function q_e(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const r=t.getSelectedRangeActive();if(!r)return;const{row:n,col:i}=r.highlight;sp(t.getCell(n,i,!0))})}}function X_e(t){return e=>{const r=H_(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;sp(t.getCell(i,s,!0))})}}function Q_e(t){return e=>{const r=H_(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;sp(t.getCell(i,s,!0))})}}function J_e(t){return e=>{const r=H_(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;sp(t.getCell(r,n?-1:0,!0))})}}function Z_e(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,s=()=>{sp(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},s);else if(i<0&&n>=0)t.scrollViewportTo({row:n},s);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},s)}}}function eRe(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let o;e.isFocusSelectionChanged()?o=q_e(t):e.isSelectedByCorner()?o=K_e():e.isSelectedByRowHeader()?o=J_e(t):e.isSelectedByColumnHeader()?o=G_e(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=X_e(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=Z_e(t):e.getSelectedRange().size()>1&&(o=Q_e(t)),(s=o)===null||s===void 0||s(i)}}}const tRe=Object.freeze({INLINE:"inline",MODAL:"modal"}),_h=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),rRe="grid";function nRe(t,e){const r=m6(t,_h.TAB_FROM_ABOVE),n=m6(t,_h.TAB_FROM_BELOW);return e.prepend(r),e.append(n),{activate(){r.tabIndex=0,n.tabIndex=0},deactivate(){r.tabIndex=-1,n.tabIndex=-1},destroy(){r.remove(),n.remove()}}}function m6(t,e){const n=t.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),n.dataset.htFocusSource=e,t.getSettings().ariaTags&&Ne(n,[Us("Focus catcher")]),n}function iRe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n={shortcutsContextName:rRe,type:tRe.INLINE,contains:m=>m===e||e.contains(m),runOnlyIf:()=>!0,...r},i=nRe(t,e);return{getType:()=>n.type,hasContainerDetached:()=>!t.rootWrapperElement.contains(e),getShortcutsContextName:()=>n.shortcutsContextName,runOnlyIf:()=>n.runOnlyIf(),contains:m=>n.contains(m),activate:function(){var m;let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_h.UNKNOWN;(m=n.onActivate)===null||m===void 0||m.call(n,g)},deactivate:()=>{var m;(m=n.onDeactivate)===null||m===void 0||m.call(n)},activateFocusCatchers:()=>{i==null||i.activate()},deactivateFocusCatchers:()=>{i==null||i.deactivate()},enable:()=>{e.removeAttribute("inert")},disable:()=>{e.setAttribute("inert","true")},destroy:()=>{i==null||i.destroy()}}}function sRe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=!1;function n(d){if(!r){var f;(f=e.onFocus)===null||f===void 0||f.call(e,d)}}function i(d){var f;(f=e.onClick)===null||f===void 0||f.call(e,d)}function s(d){if(d.key==="Tab"){var f;(f=e.onTabKeyDown)===null||f===void 0||f.call(e,d)}}function o(){r=!0}function a(){r=!1}return{mount:()=>{let d=t;for(;d;){const{documentElement:f}=d.document;f.addEventListener("focusin",n),f.addEventListener("click",i),f.addEventListener("keydown",s),f.addEventListener("mousedown",o),f.addEventListener("mouseup",a),d=nd(d)}},unmount:()=>{let d=t;for(;d;){const{documentElement:f}=d.document;f.removeEventListener("focusin",n),f.removeEventListener("click",i),f.removeEventListener("keydown",s),f.removeEventListener("mousedown",o),f.removeEventListener("mouseup",a),d=nd(d)}}}}function oRe(t){const e=Kv({errorIdExists:g=>`The "${g}" focus scope is already registered.`}),r=t.getShortcutManager();let n=null;function i(){return n?e.getId(n):null}function s(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.hasItem(g))throw new Error(`Scope with id "${g}" already registered`);const w=iRe(t,p,y);e.addItem(g,w),r.getOrCreateContext(w.getShortcutsContextName())}function o(g){if(!e.hasItem(g))throw new Error(`Scope with id "${g}" not found`);e.getItem(g).destroy(),e.removeItem(g)}function a(g){if(!e.hasItem(g))throw new Error(`Scope with id "${g}" not found`);u(e.getItem(g))}function c(g){if(!e.hasItem(g))throw new Error(`Scope with id "${g}" not found`);d(e.getItem(g))}function u(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_h.UNKNOWN;n!==g&&(n!==null&&d(n),n=g,n.activate(p),r.setActiveContextName(g.getShortcutsContextName()))}function d(g){f(),n===g&&(n=null,g.deactivate())}function f(){const g=e.getValues(),p=g.filter(y=>y.runOnlyIf()&&y.getType()==="modal");g.forEach(y=>{p.length>0&&p.includes(y)||p.length===0||y.hasContainerDetached()?y.enable():y.disable(),y===n?y.contains(t.rootDocument.activeElement)?y.deactivateFocusCatchers():y.activateFocusCatchers():y.runOnlyIf()?y.activateFocusCatchers():y.deactivateFocusCatchers()})}function h(g,p){if(!g.isConnected||!Qh(g))return;const y=e.getValues().filter(v=>v.runOnlyIf());let w=!1;y.forEach(v=>{!w&&v.contains(g)&&(w=!0,p!==_h.UNKNOWN&&t.listen(),u(v,p))}),!w&&n&&(d(n),t.unlisten())}const m=sRe(t.rootWindow,{onFocus:g=>{var p;h(g.target,(p=g.target.dataset.htFocusSource)!==null&&p!==void 0?p:_h.UNKNOWN)},onClick:g=>{h(g.target,_h.CLICK)},onTabKeyDown:()=>{f()}});return m.mount(),{getActiveScopeId:i,registerScope:s,unregisterScope:o,activateScope:g=>a(g),deactivateScope:g=>c(g),destroy:()=>m.unmount()}}function aRe(t,e){B9(t,e),e.add(t)}function Ff(t,e,r){B9(t,e),e.set(t,r)}function B9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e){return t.get(fa(t,e))}function gh(t,e,r){return t.set(fa(t,e),r),r}function fa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const fm=Object.freeze({CELL:"cell",MIXED:"mixed"});var Wr=new WeakMap,Eb=new WeakMap,Nb=new WeakMap,kb=new WeakMap,Tb=new WeakMap,DC=new WeakMap,hl=new WeakSet;class lRe{constructor(e){aRe(this,hl),Ff(this,Wr,void 0),Ff(this,Eb,void 0),Ff(this,Nb,1),Ff(this,kb,null),Ff(this,Tb,new Map),Ff(this,DC,!1),gh(Wr,this,e)}init(){var e=this;const r=zt(Wr,this).getSettings();gh(Eb,this,r.imeFastEdit?fm.MIXED:fm.CELL),zt(Wr,this).addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fa(hl,e,hRe).call(e,...i)}),zt(Wr,this).addHook("afterSelection",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fa(hl,e,p6).call(e,...i)}),zt(Wr,this).addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fa(hl,e,p6).call(e,...i)}),zt(Wr,this).addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fa(hl,e,uRe).call(e,...i)}),zt(Wr,this).addHook("afterRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fa(hl,e,dRe).call(e,...i)})}getFocusMode(){return zt(Eb,this)}setFocusMode(e){Object.values(fm).includes(e)?gh(Eb,this,e):nt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return zt(Nb,this)}setRefocusDelay(e){gh(Nb,this,e)}setRefocusElementGetter(e){gh(kb,this,e)}getRefocusElement(){var e;return typeof zt(kb,this)=="function"?zt(kb,this).call(this):(e=zt(Wr,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const o=(i=zt(Wr,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=zt(Wr,this).runHooks("modifyFocusedElement",o.row,o.col,n);Rc(a)||(a=n),a&&!((s=zt(Wr,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):fa(hl,this,Fj).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zt(Nb,this);if(zt(Wr,this).getSettings().imeFastEdit&&!((e=zt(Wr,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=zt(Wr,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),zt(Tb,this).has(r)||zt(Tb,this).set(r,R_(()=>{if(!zt(Wr,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},r)),zt(Tb,this).get(r)()}}}function Fj(t){var e;const r=(e=zt(Wr,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!zt(Wr,this).selection.isCellVisible(r)){t(null);return}const n=zt(Wr,this).getCell(r.row,r.col,!0);n===null?zt(Wr,this).addHookOnce("afterScroll",()=>{t(zt(Wr,this).getCell(r.row,r.col,!0))}):t(n)}function cRe(){fa(hl,this,Fj).call(this,t=>{const{activeElement:e}=zt(Wr,this).rootDocument;e&&IU(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function uRe(){fa(hl,this,Fj).call(this,t=>{this.getFocusMode()===fm.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function p6(){gh(DC,this,!0)}function dRe(){zt(DC,this)&&(gh(DC,this,!1),fa(hl,this,cRe).call(this))}function hRe(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?fm.MIXED:fm.CELL)}function fRe(t){return e=>{if(!e)return null;const{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;const i=SM(t),s=CM(t);return i===null||s===null?null:(e.row=ut(e.row,i.row,s.row),e.col=ut(e.col,i.col,s.col),e)}}function SM(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function CM(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}const fy="gridDefault",Vj="grid",LC="grid.tabNavigation",fd="editorManager.handlingEditor",gRe="editor",mRe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},pRe="hooksRefRegisterer",W9={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){B(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){at(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Fc(W9,"MIXIN_NAME",pRe,{writable:!1,enumerable:!1});function Yo(t,e,r){return(e=yRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yRe(t){var e=vRe(t,"string");return typeof e=="symbol"?e:e+""}function vRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wRe="base",zr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class op{static get EDITOR_TYPE(){return wRe}constructor(e){Yo(this,"hot",void 0),Yo(this,"state",zr.VIRGIN),Yo(this,"_opened",!1),Yo(this,"_fullEditMode",!1),Yo(this,"_closeCallback",null),Yo(this,"TD",null),Yo(this,"row",null),Yo(this,"col",null),Yo(this,"prop",null),Yo(this,"originalValue",null),Yo(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:zr.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){const c=this.hot.getSelectedRangeActive(),u=c.getTopStartCorner(),d=c.getBottomEndCorner();n=u.row,i=u.col,s=d.row,o=d.col}else[n,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==zr.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=zr.EDITING,this.isInFullEditMode()){const c=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:sr(c);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),n.view.scrollViewport(n._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===zr.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===zr.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=zr.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=zr.FINISHED,this.discardEditor(o)}):(this.state=zr.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=zr.FINISHED,this.discardEditor()}discardEditor(e){this.state===zr.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=zr.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=zr.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===zr.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=xi(r),a=sn(r),c=xi(this.hot.rootElement),u=sn(this.hot.rootElement),d=n.topOverlay.holder,f=n.inlineStartOverlay.holder,h=d!==s?d.scrollTop:0,m=f!==s?f.scrollLeft:0,g=s.innerWidth-c.left-u,{wtTable:p}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,y=p.name,w=["master","inline_start"].includes(y)?h:0,v=["master","top","bottom"].includes(y)?m:0,x=o.top===c.top?0:1;let S=o.top-c.top-x-w,N=0;this.hot.isRtl()?N=s.innerWidth-o.left-a-g-1+v:N=o.left-c.left-1-v,["top","top_inline_start_corner"].includes(y)&&(S+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(N+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const R=this.hot.hasColHeaders(),E=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),P=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),H=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(R&&E<=0||E===H)&&(S+=1),P<=0&&(N+=1);const Z=i.rowsRenderCalculator.startPosition,I=i.columnsRenderCalculator.startPosition,Y=Math.abs(n.inlineStartOverlay.getScrollPosition()),re=n.topOverlay.getScrollPosition(),ne=on(this.hot.rootDocument);let ae=r.offsetTop;if(["inline_start","master"].includes(y)&&(ae+=Z-re),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:F,wtTable:K}=n.bottomOverlay.clone;ae+=F.getWorkspaceHeight()-K.getHeight()-ne}let ue=r.offsetLeft;this.hot.isRtl()?(ue>=0?ue=p.getWidth()-r.offsetLeft:ue=Math.abs(ue),ue+=I-Y-a):["top","master","bottom"].includes(y)&&(ue+=I-Y);const Q=s.getComputedStyle(this.TD),fe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ye=parseInt(Q[fe],10)>0?0:1,de=parseInt(Q.borderTopWidth,10)>0?0:1,se=sn(r)+ye,me=yn(r)+de,te=AU(d)?ne:0,b=OU(f)?ne:0,_=this.hot.view.maximumVisibleElementWidth(ue)-te+ye,T=Math.max(this.hot.view.maximumVisibleElementHeight(ae)-b+de,this.hot.stylesHandler.getDefaultRowHeight());return{top:S,start:N,height:me,maxHeight:T,width:se,maxWidth:_}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Ht(op,W9);const bRe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===zr.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},xRe={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},SRe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},CRe={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},_Re={name:"editorOpen",callback(t,e,r){const{selection:n}=t,i=t._getEditorManager(),s=t.getSelectedRange(),o=t.getSelectedRangeActive(),{highlight:a}=o;if((s.some(c=>n.isMultiple(c))||s.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const c=t.getSettings(),u=typeof c.enterMoves=="function"?c.enterMoves(e):c.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Ao(e))}};function RRe(){return[mRe,bRe,xRe,SRe,CRe,_Re]}const ERe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},NRe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),s=r.getNearestNotHiddenIndex(i,-1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),c=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:c,verticalSnap:"top",horizontalSnap:"start"})}}},kRe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},TRe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},PRe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},MRe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),c=i.clone();c.row=n.row,e.markSource("keyboard"),e.setRangeStart(c,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},ARe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},ORe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),c=i.clone();c.col=n.col,e.markSource("keyboard"),e.setRangeStart(c,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},IRe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),c=i.clone();c.col=n.col,e.markSource("keyboard"),e.setRangeStart(c,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},jRe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),c=i.clone();c.col=n.col,e.markSource("keyboard"),e.setRangeStart(c,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},HRe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(0,1),c=i.clone();c.row=n.row,e.markSource("keyboard"),e.setRangeStart(c,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},$Re={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},DRe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},LRe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),s=r.getNearestNotHiddenIndex(i,1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),c=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:c,verticalSnap:"top",horizontalSnap:"start"})}}};function FRe(){return[ERe,NRe,kRe,TRe,PRe,MRe,ARe,ORe,IRe,jRe,HRe,$Re,DRe,LRe]}const VRe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},BRe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let s=t.countVisibleRows()+n;s=s===0?1:s,i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},WRe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),s=t.getSelectedRangeActive(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-o.row,-o.col):r.transformStart(-o.row,-o.col),r.markEndSource()}},zRe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),s=t.getSelectedRangeActive(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(o.row,o.col):r.transformStart(o.row,o.col),r.markEndSource()}},URe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},YRe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},GRe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},KRe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}},qRe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},XRe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,s)),e.markEndSource()}},QRe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},JRe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},ZRe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},eEe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},tEe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},rEe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let s=t.countVisibleRows()+n;s=s===0?-1:-s,i===-n?s=-1:i+s<n&&(s=-(i+n)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function nEe(){return[VRe,BRe,WRe,zRe,URe,YRe,GRe,KRe,qRe,XRe,QRe,JRe,ZRe,eEe,tEe,rEe]}const iEe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},sEe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,n),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const d=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-d,0)}if(e.row>=0){const d=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-d,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},oEe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},aEe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},lEe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,c)=>{if(a>=0&&c>=0&&(a!==r||c!==n)){const{readOnly:u}=t.getCellMeta(a,c);u||s.set(`${a}x${c}`,[a,c,i])}});t.setDataAtCell(Array.from(s.values()))}},cEe={name:"tabNavigation",callback(t){const e={wrapped:!1,flipped:!1};let r=!1,n=!1;return t.addHook("afterSelection",(i,s,o,a,c)=>{r&&(e.wrapped&&e.flipped||n)&&(n=!1,c.value=!0)}),t.addHook("beforeRowWrap",(i,s,o)=>{e.wrapped=!0,e.flipped=o}),{before(){const{tabNavigation:i}=t.getSettings();r=!0,i||(n=!0)},after(i){const{tabNavigation:s,autoWrapRow:o}=t.getSettings();if(r=!1,!s||!t.selection.isSelected()||o&&e.wrapped&&e.flipped||!o&&e.wrapped)return e.wrapped=!1,e.flipped=!1,t.deselectCell(),!1;i.preventDefault()}}}},uEe=[...RRe(),...FRe(),...nEe(),iEe,sEe,oEe,aEe,lEe,cEe];function z9(t){const e={};return uEe.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function dEe(t){const e=t.getShortcutManager().addContext(gRe),r=z9(t),n={group:fd};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext(Vj),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function hEe(t){const e=t.getShortcutManager().addContext(Vj),r=z9(t),n={runOnlyIf:()=>{const{navigableHeaders:s}=t.getSettings();return xe(t.getSelected())&&(s||!s&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:fy};e.addShortcuts([{keys:[["F2"]],callback:s=>r.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>r.editorOpen(s,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:fd,runOnlyIf:()=>xe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var s;return!((s=t.getSelectedRangeActive())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=t.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var s,o;return!((s=t.getSelectedRangeActive())!==null&&s!==void 0&&s.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n);const i=r.tabNavigation();e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:fy,group:LC,position:"before",callback:s=>i.before(s)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:fy,group:LC,callback:s=>i.after(s),position:"after"}])}function fEe(t){[hEe,dEe].forEach(e=>e(t))}function gEe(t){var e;const r=fRe(t),n={wrapped:!1,flipped:!1};let i,s=!0,o=!1;t.addHook("afterSelection",()=>{if(s){var u;i=(u=t.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight}}),t.addHook("beforeRowWrap",(u,d,f)=>{n.wrapped=!0,n.flipped=f}),t.addHook("beforeEmptyDataStateShow",()=>{o=!0}),t.addHook("beforeEmptyDataStateHide",()=>{o=!1}),t.getShortcutManager().getContext(Vj).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:fy,group:LC,position:"before",callback(){const{tabNavigation:u}=t.getSettings();t.getSelectedRangeActive()&&!u&&(s=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:fy,group:LC,callback(u){const{tabNavigation:d,autoWrapRow:f}=t.getSettings();s=!0,(!d||!t.selection.isSelected()||f&&n.wrapped&&n.flipped||!f&&n.wrapped)&&(f&&n.wrapped&&n.flipped&&(i=u.shiftKey?SM(t):CM(t)),n.wrapped=!1,n.flipped=!1)},position:"after"}]);const c=(e=t.rootGridElement)!==null&&e!==void 0?e:t.rootElement;t.getFocusScopeManager().registerScope("grid",c,{contains:u=>c===u||c.contains(u)?!0:u.closest(".htMenu")!==null?!1:t.rootPortalElement.contains(u),runOnlyIf:()=>{const{navigableHeaders:u}=t.getSettings();return(o||!u)&&t.countRenderedRows()===0&&t.countRenderedCols()===0&&t.countRowHeaders()>0&&t.countColHeaders()>0?!1:!u&&t.countRenderedRows()>0&&t.countRenderedCols()>0||u&&(t.countRowHeaders()>0||t.countColHeaders()>0)},onActivate:u=>{if(u==="tab_from_above"){var d;const h=(d=r(i))!==null&&d!==void 0?d:SM(t);h&&t.runHooks("modifyFocusOnTabNavigation","from_above",h)!==!1&&t.selectCell(h.row,h.col)}else if(u==="tab_from_below"){var f;const h=(f=r(i))!==null&&f!==void 0?f:CM(t);h&&t.runHooks("modifyFocusOnTabNavigation","from_below",h)!==!1&&t.selectCell(h.row,h.col)}}})}function mEe(t){[gEe].forEach(e=>e(t))}const y6=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Pb=t=>t.map(e=>{const r=e.toLowerCase();return y6.has(r)?y6.get(r):r}).sort().join("+"),pEe=t=>t.split("+"),v6=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),RN=t=>{let{which:e,key:r}=t;if(v6.has(e))return v6.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},U9=Symbol("shortcut-context");function _M(t){return Le(t)&&t.__kindOf===U9}const yEe=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const r=Kv({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:d,group:f,runOnlyIf:h=()=>!0,captureCtrl:m=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:y,position:w,forwardToContext:v}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(fr(f))throw new Error("You need to define the shortcut's group.");if(Tt(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(Rt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const x={callback:d,group:f,runOnlyIf:h,captureCtrl:m,preventDefault:g,stopPropagation:p};xe(y)&&(x.relativeToGroup=y,x.position=w),_M(v)&&(x.forwardToContext=v),u.forEach(S=>{const N=Pb(S);if(r.hasItem(N)){const E=r.getItem(N);let P=E.findIndex(D=>D.group===y);P!==-1?w==="before"?P-=1:P+=1:P=E.length,E.splice(P,0,x)}else r.addItem(N,[x])})},i=function(u){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(f=>{at(d,(h,m)=>{Object.prototype.hasOwnProperty.call(f,m)===!1&&(f[m]=d[m])}),n(f)})},s=u=>{const d=Pb(u);r.removeItem(d)};return{__kindOf:U9,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{const d=Pb(u),f=r.getItem(d);return xe(f)?f.slice():[]},hasShortcut:u=>{const d=Pb(u);return r.hasItem(d)},removeShortcutsByKeys:s,removeShortcutsByGroup:u=>{r.getItems().forEach(f=>{let[h,m]=f;const g=m.filter(p=>p.group!==u);g.length===0?s(pEe(h)):(m.length=0,m.push(...g))})}}};function vEe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const wEe=["meta","alt","shift","control"],Xp=vEe(),Qp=[];let Mb=0;function bEe(t,e,r,n,i){const s=m=>wEe.includes(m),o=function(m){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return m.altKey&&p.push("alt"),g&&(m.ctrlKey||m.metaKey)?p.push("control/meta"):(m.ctrlKey&&p.push("control"),m.metaKey&&p.push("meta")),m.shiftKey&&p.push("shift"),p},a=m=>{if(e(m)===!1||r(m)===!1||m.keyCode===229||typeof m.key!="string"||dh(m))return;const p=RN(m);let y=[];s(p)||(y=o(m));const w=[p].concat(y);!i(m,w)&&(Z3()&&y.includes("meta")||!Z3()&&y.includes("control"))&&i(m,[p].concat(o(m,!0))),n(m)},c=m=>{if(typeof m.key=="string"){const g=RN(m);s(g)&&Xp.press(g)}},u=m=>{if(typeof m.key=="string"){const g=RN(m);s(g)&&Xp.release(g)}},d=()=>{Xp.releaseAll()};return{mount:()=>{let m=t;for(Mb+=1;m;)Mb===1&&(m.document.documentElement.addEventListener("keydown",c),Qp.push({event:"keydown",listener:c}),m.document.documentElement.addEventListener("keyup",u),Qp.push({event:"keyup",listener:u})),m.document.documentElement.addEventListener("keydown",a),m.document.documentElement.addEventListener("blur",d),m=nd(m)},unmount:()=>{let m=t;for(Mb-=1;m;){if(Mb===0){for(let g=0;g<Qp.length;g++){const{event:p,listener:y}=Qp[g];m.document.documentElement.removeEventListener(p,y)}Qp.length=0}m.document.documentElement.removeEventListener("keydown",a),m.document.documentElement.removeEventListener("blur",d),m=nd(m)}},isPressed:m=>Xp.isPressed(m),releasePressedKeys:()=>Xp.releaseAll()}}const xEe=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=Kv({errorIdExists:y=>`The "${y}" context name is already registered.`});let o="grid";const a=function(y){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const v=yEe(y,w);return s.addItem(y,v),v},c=()=>o,u=y=>s.getItem(y),d=function(y){var w;let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(w=u(y))!==null&&w!==void 0?w:a(y,v)},f=y=>{if(!s.hasItem(y))throw new Error(Rt`You've tried to activate the "${y}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=y};let h=!1;const m=function(y,w){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c();const x=_M(v)?v:u(v);let S=!1;if(!x.hasShortcut(w))return S;const N=x.getShortcuts(w);for(let R=0;R<N.length;R++){const{callback:E,runOnlyIf:P,preventDefault:D,stopPropagation:H,captureCtrl:Z,forwardToContext:I}=N[R];if(P(y)===!0){if(h=Z,S=E(y,w)===!1,h=!1,D&&y.preventDefault(),H&&(Ao(y),y.stopPropagation()),S)break;I&&m(y,w,I)}}return S},p=bEe(e,y=>{const w=c(),v=_M(w)?w:u(w);return r(y,v.scope)},n,i,m);return p.mount(),{addContext:a,getActiveContextName:c,getContext:u,getOrCreateContext:d,setActiveContextName:f,isCtrlPressed:()=>!h&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};function w6(t){const{classNames:e}=tve(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function SEe(t,e){Y9(t,e),e.add(t)}function Yl(t,e,r){Y9(t,e),e.set(t,r)}function Y9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tr(t,e){return t.get(ca(t,e))}function ss(t,e,r){return t.set(ca(t,e),r),r}function ca(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const b6=23;var EN=new WeakMap,Ba=new WeakMap,FC=new WeakMap,Bj=new WeakMap,RM=new WeakMap,pu=new WeakMap,B0=new WeakMap,ov=new WeakMap,Jp=new WeakMap,al=new WeakSet;class CEe{constructor(e){let{hot:r,rootElement:n,rootDocument:i,onThemeChange:s=()=>{}}=e;SEe(this,al),Yl(this,EN,void 0),Yl(this,Ba,void 0),Yl(this,FC,void 0),Yl(this,Bj,void 0),Yl(this,RM,void 0),Yl(this,pu,!0),Yl(this,B0,{}),Yl(this,ov,{}),Yl(this,Jp,void 0),ss(EN,this,r),ss(FC,this,n),ss(RM,this,i),ss(Jp,this,s)}isClassicTheme(){return Tr(pu,this)}getCSSVariableValue(e){var r;if(Tr(pu,this))return null;if(Tr(B0,this)[`--ht-${e}`])return Tr(B0,this)[`--ht-${e}`];const n=(r=ca(al,this,EEe).call(this,`--ht-${e}`))!==null&&r!==void 0?r:ca(al,this,G9).call(this,`--ht-${e}`);if(n!==null)return Tr(B0,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Tr(ov,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(e){if(Tr(pu,this))return b6;const r=ca(al,this,_Ee).call(this);return r?e!==void 0&&e===Tr(EN,this).view.getFirstRenderedVisibleRow()?r+1:r:b6}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){ss(Ba,this,void 0),ss(pu,this,!0),Tr(Jp,this).call(this,Tr(Ba,this)),ca(al,this,NN).call(this);return}if(e&&e!==Tr(Ba,this)){if(!/ht-theme-.*/.test(e)){nt(`Invalid theme name: ${e}. Please provide a valid theme name.`),ss(Ba,this,void 0),ss(pu,this,!1),Tr(Jp,this).call(this,Tr(Ba,this)),ca(al,this,NN).call(this);return}Tr(Ba,this)&&ca(al,this,NEe).call(this),ss(Ba,this,e),ss(pu,this,!1),Tr(Jp,this).call(this,Tr(Ba,this)),ca(al,this,NN).call(this)}}getThemeName(){return Tr(Ba,this)}}function _Ee(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function NN(){this.isClassicTheme()||ss(Bj,this,getComputedStyle(Tr(FC,this)));const t=ca(al,this,REe).call(this,["box-sizing","border-bottom-width"]);Tr(ov,this).td={...Tr(ov,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function REe(t){const e=Tr(RM,this),r=Tr(FC,this),n=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),n.appendChild(i),r.appendChild(n);const c=getComputedStyle(a),u={};return t.forEach(d=>{u[d]=c.getPropertyValue(d)}),r.removeChild(n),u}function EEe(t){const e=Math.ceil(parseFloat(ca(al,this,G9).call(this,t)));return Number.isNaN(e)?null:e}function G9(t){const e=Tr(Bj,this).getPropertyValue(t);return e===""?null:e}function NEe(){ss(ov,this,{}),ss(B0,this,{}),ss(pu,this,!0)}let zs=null,bS=0;function kEe(t){const e=t.ownerDocument;if(!zs){zs=e.createElement("div"),zs.setAttribute("role","status"),zs.setAttribute("aria-live","assertive"),zs.setAttribute("aria-atomic","true");const r=zs.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild(zs)}bS+=1}function TEe(){bS!==0&&(bS===1&&(zs.remove(),zs=null),bS-=1)}function PEe(t){zs&&(zs.textContent="",setTimeout(()=>{zs&&(zs.textContent=t)},100))}let kN=null;const Ab=new WeakSet,TN=new Map;function K9(t,e){var r,n,i=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const a=new Ea(o);let c,u,d,f,h,m,g=!0;const p={...e.initialState,...e};SCe(s)&&xCe(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=nl(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,nl(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),ee(this.rootElement,["ht-wrapper","handsontable"]),ee(this.rootWrapperElement,"ht-root-wrapper"),ee(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),ee(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const y=(r=p==null?void 0:p.layoutDirection)!==null&&r!==void 0?r:"inherit",w=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new CEe({hot:o,rootElement:o.rootElement,rootDocument:o.rootDocument,onThemeChange:b=>{nl(this)&&(Re(this.rootWrapperElement,/ht-theme-.*/g),Re(this.rootPortalElement,/ht-theme-.*/g),b&&(ee(this.rootWrapperElement,b),ee(this.rootPortalElement,b),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||nt(`The "${b}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),p.language=M1e(p.language);const v=Object.fromEntries(Object.entries(p).filter(b=>{let[_]=b;return!(_e.getSingleton().isRegistered(_)||_e.getSingleton().isDeprecated(_))})),x=new F9(o,v,[$_e,z_e]),S=x.getTableMeta(),N=x.getGlobalMeta(),R=Kv();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${aU()}`,TN.set(this.guid,this),this.columnIndexMapper=new yM,this.rowIndexMapper=new yM,this.columnIndexMapper.addLocalHook("indexesSequenceChange",b=>{o.runHooks("afterColumnSequenceChange",b)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",b=>{o.runHooks("afterRowSequenceChange",b)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",b=>{o.runHooks("beforeCompositionStart",b)}),u=new WCe(o);const E=$o(this.guid);E.register("cellRangeMapper",new Y_e({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=b=>{const{row:_,col:T}=b;return o._createCellCoords(_>=0?o.rowIndexMapper.getRenderableFromVisualIndex(_):_,T>=0?o.columnIndexMapper.getRenderableFromVisualIndex(T):T)},D=b=>{const{row:_,col:T}=b;return o._createCellCoords(_>=0?o.rowIndexMapper.getVisualFromRenderableIndex(_):_,T>=0?o.columnIndexMapper.getVisualFromRenderableIndex(T):T)},H=(b,_)=>{const T=_>b?1:-1,F=Math.min(b,_),K=Math.max(b,_),C=o.rowIndexMapper.getNearestNotHiddenIndex(b,T);return C===null||T===1&&C>K||T===-1&&C<F?null:C>=0?o.rowIndexMapper.getRenderableFromVisualIndex(C):C},Z=(b,_)=>{const T=_>b?1:-1,F=Math.min(b,_),K=Math.max(b,_),C=o.columnIndexMapper.getNearestNotHiddenIndex(b,T);return C===null||T===1&&C>K||T===-1&&C<F?null:C>=0?o.columnIndexMapper.getRenderableFromVisualIndex(C):C};let I=new $9(S,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:b=>c.propToCol(b),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(b,_)=>o._createCellCoords(b,_),createCellRange:(b,_,T)=>o._createCellRange(b,_,T),visualToRenderableCoords:P,renderableToVisualCoords:D,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:Z,isDisabledCellSelection:(b,_)=>b<0||_<0?o.getSettings().disableVisualSelection:o.getCellMeta(b,_).disableVisualSelection});this.selection=I;const Y=b=>{let{hiddenIndexesChanged:_}=b;this.forceFullRender=!0,_&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",b=>{Y(b),this.runHooks("afterColumnSequenceCacheUpdate",b)}),this.rowIndexMapper.addLocalHook("cacheUpdated",b=>{Y(b),this.runHooks("afterRowSequenceCacheUpdate",b)}),this.selection.addLocalHook("afterSetRangeEnd",(b,_)=>{const T=Ks(!1),F=this.selection.getSelectedRange(),{from:K,to:C}=F.current(),k=F.size()-1;this.runHooks("afterSelection",K.row,K.col,C.row,C.col,T,k),this.runHooks("afterSelectionByProp",K.row,o.colToProp(K.col),C.row,o.colToProp(C.col),T,k),_&&(!T.isTouched()||T.isTouched()&&!T.value)&&m.scrollTo(b);const M=I.isSelectedByRowHeader(),V=I.isSelectedByColumnHeader();M&&V?ee(this.rootElement,["ht__selection--rows","ht__selection--columns"]):M?(Re(this.rootElement,"ht__selection--columns"),ee(this.rootElement,"ht__selection--rows")):V?(Re(this.rootElement,"ht__selection--rows"),ee(this.rootElement,"ht__selection--columns")):Re(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(I.getSelectionSource())||f.closeEditor(null),I.getSelectionSource()!=="refresh"&&(o.view.render(),f.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",b=>{this.runHooks("beforeSelectionFocusSet",b.row,b.col)}),this.selection.addLocalHook("afterSetFocus",b=>{const _=Ks(!1);this.runHooks("afterSelectionFocusSet",b.row,b.col,_),(!_.isTouched()||_.isTouched()&&!_.value)&&m.scrollTo(b),f.closeEditor(),o.view.render(),f.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",b=>{const _=b.length-1,{from:T,to:F}=b[_];this.runHooks("afterSelectionEnd",T.row,T.col,F.row,F.col,_),this.runHooks("afterSelectionEndByProp",T.row,o.colToProp(T.col),F.row,o.colToProp(F.col),_),I.getSelectionSource()==="refresh"&&(o.view.render(),f.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",b=>{const _=this.runHooks("afterIsMultipleSelection",b.value);b.value&&(b.value=_)}),this.selection.addLocalHook("afterDeselect",()=>{f.closeEditor(),o.view.render(),Re(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeSetRangeStart",..._)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeSetRangeStartOnly",..._)}).addLocalHook("beforeSetRangeEnd",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeSetRangeEnd",..._)}).addLocalHook("beforeSelectColumns",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeSelectColumns",..._)}).addLocalHook("afterSelectColumns",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("afterSelectColumns",..._)}).addLocalHook("beforeSelectRows",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeSelectRows",..._)}).addLocalHook("afterSelectRows",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("afterSelectRows",..._)}).addLocalHook("beforeSelectAll",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeSelectAll",..._)}).addLocalHook("afterSelectAll",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("afterSelectAll",..._)}).addLocalHook("beforeModifyTransformStart",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("modifyTransformStart",..._)}).addLocalHook("afterModifyTransformStart",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("afterModifyTransformStart",..._)}).addLocalHook("beforeModifyTransformFocus",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("modifyTransformFocus",..._)}).addLocalHook("afterModifyTransformFocus",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("afterModifyTransformFocus",..._)}).addLocalHook("beforeModifyTransformEnd",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("modifyTransformEnd",..._)}).addLocalHook("afterModifyTransformEnd",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("afterModifyTransformEnd",..._)}).addLocalHook("beforeRowWrap",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeRowWrap",..._)}).addLocalHook("beforeColumnWrap",function(){for(var b=arguments.length,_=new Array(b),T=0;T<b;T++)_[T]=arguments[T];return i.runHooks("beforeColumnWrap",..._)}).addLocalHook("insertRowRequire",b=>this.alter("insert_row_above",b,1,"auto")).addLocalHook("insertColRequire",b=>this.alter("insert_col_start",b,1,"auto")),d={alter(b,_){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0;const C=k=>{if(k.length===0)return[];const M=[...k];return M.sort((j,A)=>{let[U]=j,[L]=A;return U===L?0:U>L?1:-1}),bs(M,(j,A)=>{let[U,L]=A;const W=j[j.length-1],[X,q]=W,ie=X+q;if(U<=ie){const we=Math.max(L-(ie-U),0);W[1]+=we}else j.push([U,L]);return j},[M[0]])};switch(b){case"insert_row_below":case"insert_row_above":const k=o.countSourceRows();if(S.maxRows===k)return;const M=b==="insert_row_below"?"below":"above";_=_??(M==="below"?k:0);const{delta:V,startPhysicalIndex:j}=c.createRow(_,T,{source:F,mode:M});I.shiftRows(o.toVisualRow(j),V);break;case"insert_col_start":case"insert_col_end":const A=b==="insert_col_end"?"end":"start";_=_??(A==="end"?o.countSourceCols():0);const{delta:U,startPhysicalIndex:L}=c.createCol(_,T,{source:F,mode:A});if(U){if(Array.isArray(S.colHeaders)){const q=[o.toVisualColumn(L),0];q.length+=U,Array.prototype.splice.apply(S.colHeaders,q)}I.shiftColumns(o.toVisualColumn(L),U)}break;case"remove_row":const W=q=>{let ie=0;B(q,we=>{let[ve,je]=we;const oe=qr(ve)?o.countRows()-1:Math.max(ve-ie,0);if(Number.isInteger(ve)&&(ve=Math.max(ve-ie,0)),!c.removeRow(ve,je,F))return;if(I.isSelected()){const{row:Ge}=o.getSelectedRangeActive().highlight;Ge>=ve&&Ge<=ve+je-1&&f.closeEditor(!0)}const Se=o.countRows(),He=S.fixedRowsTop;He>=oe+1&&(S.fixedRowsTop-=Math.min(je,He-oe));const ze=S.fixedRowsBottom;if(ze&&oe>=Se-ze&&(S.fixedRowsBottom-=Math.min(je,ze)),Se===0)I.deselect();else if(F==="ContextMenu.removeRow"){const Ge=I.getSelectedRange(),Zt=Ge.pop();Ge.clear().set(Zt.from).current().setTo(Zt.to),I.refresh()}else I.shiftRows(ve,-je);ie+=je})};Array.isArray(_)?W(C(_)):W([[_,T]]);break;case"remove_col":const X=q=>{let ie=0;B(q,we=>{let[ve,je]=we;const oe=qr(ve)?o.countCols()-1:Math.max(ve-ie,0);let Ee=o.toPhysicalColumn(oe);if(Number.isInteger(ve)&&(ve=Math.max(ve-ie,0)),!c.removeCol(ve,je,F))return;if(I.isSelected()){const{col:Ge}=o.getSelectedRangeActive().highlight;Ge>=ve&&Ge<=ve+je-1&&f.closeEditor(!0)}if(o.countCols()===0)I.deselect();else if(F==="ContextMenu.removeColumn"){const Ge=I.getSelectedRange(),Zt=Ge.pop();Ge.clear().set(Zt.from).current().setTo(Zt.to),I.refresh()}else I.shiftColumns(ve,-je);const ze=S.fixedColumnsStart;ze>=oe+1&&(S.fixedColumnsStart-=Math.min(je,ze-oe)),Array.isArray(S.colHeaders)&&(typeof Ee>"u"&&(Ee=-1),S.colHeaders.splice(Ee,je)),ie+=je})};Array.isArray(_)?X(C(_)):X([[_,T]]);break;default:throw new Error(`There is no such action "${b}"`)}K||d.adjustRowsAndCols(),o.view.adjustElementsSize(),o.view.render()},adjustRowsAndCols(){const b=S.minRows,_=S.minSpareRows,T=S.minCols,F=S.minSpareCols;if(b){const K=o.countRows();K<b&&c.createRow(K,b-K,{source:"auto"})}if(_){const K=o.countEmptyRows(!0);if(K<_){const C=_-K,k=Math.min(C,S.maxRows-o.countSourceRows());c.createRow(o.countRows(),k,{source:"auto"})}}{let K;(T||F)&&(K=o.countEmptyCols(!0));let C=o.countCols();if(T&&!S.columns&&C<T){const k=T-C;K+=k,c.createCol(C,k,{source:"auto"})}if(F&&!S.columns&&o.dataType==="array"&&K<F){C=o.countCols();const k=F-K,M=Math.min(k,S.maxCols-C);c.createCol(C,M,{source:"auto"})}}},populateFromArray(b,_,T,F,K){let C,k,M,V;const j=[],A={},U=[],L=b.row,W=b.col;if(k=_.length,k===0)return!1;let X=0,q=0;switch(Le(T)&&(X=T.col-W+1,q=T.row-L+1),K){case"shift_down":const we=fS(_),ve=we.length,je=Math.max(ve,X),oe=o.getData().slice(L),Ee=fS(oe).slice(W,W+je);for(M=0;M<je;M+=1)if(M<ve){for(C=0,k=we[M].length;C<q-k;C+=1)we[M].push(we[M][C%k]);M<Ee.length?U.push(we[M].concat(Ee[M])):U.push(we[M].concat(new Array(oe.length).fill(null)))}else U.push(we[M%ve].concat(Ee[M]));o.populateFromArray(L,W,fS(U));break;case"shift_right":const Se=_.length,He=Math.max(Se,q),ze=o.getData().slice(L).map(Be=>Be.slice(W));for(C=0;C<He;C+=1)if(C<Se){for(M=0,V=_[C].length;M<X-V;M+=1)_[C].push(_[C][M%V]);if(C<ze.length)for(let Be=0;Be<ze[C].length;Be+=1)_[C].push(ze[C][Be]);else _[C].push(...new Array(ze[0].length).fill(null))}else _.push(_[C%k].slice(0,He).concat(ze[C]));o.populateFromArray(L,W,_);break;case"overwrite":default:A.row=b.row,A.col=b.col;let Ge=0,Zt=0,Qr=!0,$t;const Gt=function(yr){let Kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Gn=_[yr%_.length];return Kt!==null?Gn[Kt%Gn.length]:Gn},Ue=_.length,ct=T?T.row-b.row+1:0;for(T?k=ct:k=Math.max(Ue,ct),C=0;C<k&&!(T&&A.row>T.row&&ct>Ue||!S.allowInsertRow&&A.row>o.countRows()-1||A.row>=S.maxRows);C++){const Be=C-Ge,yr=Gt(Be).length,Kt=T?T.col-b.col+1:0;if(T?V=Kt:V=Math.max(yr,Kt),A.col=b.col,$t=o.getCellMeta(A.row,A.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&$t.skipRowOnPaste){Ge+=1,A.row+=1,k+=1;continue}for(Zt=0,M=0;M<V;M++){var ie;if(T&&A.col>T.col&&Kt>yr||!S.allowInsertColumn&&A.col>o.countCols()-1||A.col>=S.maxCols)break;if($t=o.getCellMeta(A.row,A.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&$t.skipColumnOnPaste){Zt+=1,A.col+=1,V+=1;continue}if($t.readOnly&&F!=="UndoRedo.undo"){A.col+=1;continue}const Gn=M-Zt,Pa=!!$t.valueSetter;let Gi=Gt(Be,Gn),Jr=(ie=o.getSourceDataAtCell(A.row,A.col))!==null&&ie!==void 0?ie:null;if(Gi!==null&&typeof Gi=="object"){if(Array.isArray(Gi)&&Jr===null&&(Jr=[]),!Pa&&(typeof Jr!="object"||Jr===null))Qr=!1;else if(Jr!==null){const Ma=rv(Array.isArray(Jr)?Jr:Jr[0]||Jr),Wc=rv(Array.isArray(Gi)?Gi:Gi[0]||Gi);Pa||x_(Ma,Wc)||Array.isArray(Ma)&&Array.isArray(Wc)?Gi=Bi(Gi):Qr=!1}}else!Pa&&Jr!==null&&typeof Jr=="object"&&(Qr=!1);Qr&&j.push([A.row,A.col,Gi]),Qr=!0,A.col+=1}A.row+=1}o.setDataAtCell(j,null,null,F||"populateFromArray");break}}};function re(b){const _=C9(b);Hj(_)?(o.runHooks("beforeLanguageChange",_),N.language=_,o.runHooks("afterLanguageChange",_)):_9(b)}function ne(b,_){const T=b==="className"?o.rootElement:o.table;if(g)ee(T,_);else{let F=[],K=[];N[b]&&(F=Array.isArray(N[b])?N[b]:H3(N[b])),_&&(K=Array.isArray(_)?_:H3(_));const C=j3(F,K),k=j3(K,F);C.length&&Re(T,C),k.length&&ee(T,k)}N[b]=_}this.init=function(){u.setData(S.data),o.runHooks("beforeInit"),(Sl()||xI())&&ee(o.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new ECe(this),f=hM.getInstance(o,S,I),m=eRe(o),h.init(),nl(this)&&(kEe(o.rootPortalElement),B0e(p.licenseKey,this.rootWrapperElement)),o.runHooks("init"),this.render(),g&&o.rootElement.offsetParent===null&&uve(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.view.adjustElementsSize(),o.render()}),typeof g=="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function ae(){let b=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,b=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&b===!1&&(b=!0,this.onQueueEmpty(this.valid))}}}function ue(b,_,T){if(!b.length){T();return}const F=o.getActiveEditor(),K=new ae;let C=!0;K.onQueueEmpty=()=>{F&&C&&F.cancelChanges(),T()};for(let k=b.length-1;k>=0;k--){const[M,V,,j]=b[k],A=c.propToCol(V);let U;Number.isInteger(A)?U=o.getCellMeta(M,A):U={...Object.getPrototypeOf(S),...S},o.getCellValidator(U)&&(K.addValidatorToQueue(),o.validateCell(j,U,function(L,W){return function(X){if(typeof X!="boolean")throw new Error("Validation error: result is not boolean");X===!1&&W.allowInvalid===!1&&(C=!1,b.splice(L,1),W.valid=!0),K.removeValidatorFormQueue()}}(k,U),_))}K.checkIfQueueIsEmpty()}function Q(b,_){for(let F=b.length-1;F>=0;F--){let K=!1;if(b[F]===null){b.splice(F,1);continue}if(!((b[F][2]===null||b[F][2]===void 0)&&(b[F][3]===null||b[F][3]===void 0))){if(S.allowInsertRow)for(;b[F][0]>o.countRows()-1;){const{delta:C}=c.createRow(void 0,void 0,{source:"auto"});if(C===0){K=!0;break}}if(o.dataType==="array"&&(!S.columns||S.columns.length===0)&&S.allowInsertColumn)for(;c.propToCol(b[F][1])>o.countCols()-1;){const{delta:C}=c.createCol(void 0,void 0,{source:"auto"});if(C===0){K=!0;break}}K||c.set(b[F][0],b[F][1],b[F][3])}}if(b.length>0){d.adjustRowsAndCols(),o.runHooks("beforeChangeRender",b,_),f.closeEditor(),o.view.adjustElementsSize(),o.render(),f.prepareEditor(),o.runHooks("afterChange",b,_||"edit");const F=o.getActiveEditor();F&&xe(F.refreshValue)&&F.refreshValue()}else o.render()}this._createCellCoords=function(b,_){return o.view._wt.createCellCoords(b,_)},this._createCellRange=function(b,_,T){return o.view._wt.createCellRange(b,_,T)},this.validateCell=function(b,_,T,F){let K=o.getCellValidator(_);function C(k){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||_.hidden===!0){T(k);return}const V=_.visualCol,j=_.visualRow,A=o.getCell(j,V,!0);if(A&&A.nodeName!=="TH"){const U=o.rowIndexMapper.getRenderableFromVisualIndex(j),L=o.columnIndexMapper.getRenderableFromVisualIndex(V);o.view._wt.getSetting("cellRenderer",U,L,A)}T(k)}L0e(K)&&(K=function(k){return function(M,V){V(k.test(M))}}(K)),Tt(K)?(b=o.runHooks("beforeValidate",b,_.visualRow,_.prop,F),o._registerImmediate(()=>{K.call(_,b,k=>{o&&(k=o.runHooks("afterValidate",k,b,_.visualRow,_.prop,F),_.valid=k,C(k),o.runHooks("postAfterValidate",k,b,_.visualRow,_.prop,F))})})):o._registerImmediate(()=>{_.valid=!0,C(_.valid,!1)})};function fe(b,_,T){return Array.isArray(b)?b:[[b,_,T]]}function ye(b,_){const T=o.runHooks("beforeChange",b,_||"edit"),F=b.filter(C=>C!==null);if(T===!1||F.length===0){var K;return(K=o.getActiveEditor())===null||K===void 0||K.cancelChanges(),[]}for(let C=F.length-1;C>=0;C--){const[k,M,,V]=F[C],j=c.propToCol(M);let A;Number.isInteger(j)?A=o.getCellMeta(k,j):A={...Object.getPrototypeOf(S),...S},F[C][3]=CN(V,A)}return F}this.setDataAtCell=function(b,_,T,F){const K=fe(b,_,T),C=[];let k=F,M,V,j;for(M=0,V=K.length;M<V;M++){const[U,L,W]=K[M];if(typeof K[M]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof L!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");L>=this.countCols()?j=L:j=c.colToProp(L),C.push([U,j,u.getAtCell(this.toPhysicalRow(U),L),W])}!k&&typeof b=="object"&&(k=_);const A=ye(C,k);o.runHooks("afterSetDataAtCell",A,k),ue(A,k,()=>{Q(A,k)})},this.setDataAtRowProp=function(b,_,T,F){const K=fe(b,_,T),C=[];let k=F,M,V;for(M=0,V=K.length;M<V;M++){const[A,U,L]=K[M];C.push([A,U,u.getAtCell(this.toPhysicalRow(A),U),L])}!k&&typeof b=="object"&&(k=_);const j=ye(C,F);o.runHooks("afterSetDataAtRowProp",j,k),ue(j,k,()=>{Q(j,k)})},this.listen=function(){o&&!o.isListening()&&(TN.forEach(b=>{o!==b&&b.unlisten()}),kN=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(kN=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return kN===o.guid},this.destroyEditor=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.closeEditor(b),o.view.render(),_&&I.isSelected()&&f.prepareEditor()},this.populateFromArray=function(b,_,T,F,K,C,k){if(!(typeof T=="object"&&typeof T[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const M=typeof F=="number"?o._createCellCoords(F,K):null;return d.populateFromArray(o._createCellCoords(b,_),T,M,C,k)},this.spliceCol=function(b,_,T){for(var F=arguments.length,K=new Array(F>3?F-3:0),C=3;C<F;C++)K[C-3]=arguments[C];return c.spliceCol(b,_,T,...K)},this.spliceRow=function(b,_,T){for(var F=arguments.length,K=new Array(F>3?F-3:0),C=3;C<F;C++)K[C-3]=arguments[C];return c.spliceRow(b,_,T,...K)},this.getSelected=function(){if(I.isSelected())return _t(I.getSelectedRange(),b=>{let{from:_,to:T}=b;return[_.row,_.col,T.row,T.col]})},this.getSelectedLast=function(){const b=this.getSelected();let _;return b&&b.length>0&&(_=b[b.length-1]),_},this.getSelectedActive=function(){const b=this.getSelectedRangeActive();if(!b)return;const{from:_,to:T}=b;return[_.row,_.col,T.row,T.col]},this.getSelectedRange=function(){if(I.isSelected())return Array.from(I.getSelectedRange())},this.getSelectedRangeLast=function(){const b=this.getSelectedRange();let _;return b&&b.length>0&&(_=b[b.length-1]),_},this.getSelectedRangeActive=function(){return I.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return I.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(b){if(!I.isSelected()||this.countRows()===0||this.countCols()===0)return;const _=[];B(I.getSelectedRange(),T=>{if(T.isSingleHeader())return;const F=T.getTopStartCorner(),K=T.getBottomEndCorner();Oe(F.row,K.row,C=>{Oe(F.col,K.col,k=>{this.getCellMeta(C,k).readOnly||_.push([C,k,null])})})}),_.length>0&&this.setDataAtCell(_,b)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const b=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(b,0),!this.isRenderSuspended()&&b===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(b){this.suspendRender();const _=b();return this.resumeRender(),_},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const _=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(_,0),(!this.isExecutionSuspended()&&_===this.executionSuspendedCounter||b)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(b){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const T=b();return this.resumeExecution(_),T},this.batch=function(b){this.suspendRender(),this.suspendExecution();const _=b();return this.resumeExecution(),this.resumeRender(),_},this.refreshDimensions=function(){if(!o.view)return;const b=o.view,{width:_,height:T}=b.getLastSize(),{width:F,height:K}=o.rootElement.getBoundingClientRect(),C=F!==_||K!==T;o.runHooks("beforeRefreshDimensions",{width:_,height:T},{width:F,height:K},C)!==!1&&((C||b._wt.wtOverlays.scrollableElement===o.rootWindow)&&(b.setLastSize(F,K),b.adjustElementsSize(),o.render()),o.runHooks("afterRefreshDimensions",{width:_,height:T},{width:F,height:K},C))},this.updateData=function(b,_){a6(b,T=>{c=T},T=>{c=T,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),I.refresh()},{hotInstance:o,dataMap:c,dataSource:u,internalSource:"updateData",source:_,metaManager:x,firstRun:g})},this.loadData=function(b,_){a6(b,T=>{c=T},()=>{x.clearCellsCache(),o.initIndexMappers(),d.adjustRowsAndCols(),I.refresh(),g&&(g=[null,"loadData"])},{hotInstance:o,dataMap:c,dataSource:u,internalSource:"loadData",source:_,metaManager:x,firstRun:g})},this.getInitialColumnCount=function(){const b=S.columns;let _=0;if(Array.isArray(b))_=b.length;else if(Tt(b))if(o.dataType==="array"){const T=this.countSourceCols();for(let F=0;F<T;F+=1)b(F)&&(_+=1)}else(o.dataType==="object"||o.dataType==="function")&&(_=c.colToPropCache.length);else if(xe(S.dataSchema)){const T=c.getSchema();_=Array.isArray(T)?T.length:bI(T)}else _=this.countSourceCols();return _},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(b,_,T,F){return fr(b)?c.getAll():c.getRange(o._createCellCoords(b,_),o._createCellCoords(T,F),c.DESTINATION_RENDERER)},this.getCopyableText=function(b,_,T,F){return c.getCopyableText(o._createCellCoords(b,_),o._createCellCoords(T,F))},this.getCopyableData=function(b,_){return c.getCopyable(b,c.colToProp(_))},this.getCopyableSourceData=function(b,_){return u.getCopyable(b,c.colToProp(_))},this.getSchema=function(){return c.getSchema()},this.updateSettings=function(b){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const T=(g?o.loadData:o.updateData).bind(this);let F=!1,K,C;if(xe(b.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(xe(b.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(xe(b.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');xe(b.rowHeights)&&xe(b.minRowHeights)&&nt("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(K in b)if(!(K==="data"||K==="language"))if(K==="className")ne("className",b.className);else if(K==="tableClassName"&&o.table)ne("tableClassName",b.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(_e.getSingleton().isRegistered(K)||_e.getSingleton().isDeprecated(K)){const A=b[K];Tt(A)?(_e.getSingleton().addAsFixed(K,A,o),S[K]=A):Array.isArray(A)&&(_e.getSingleton().add(K,A,o),S[K]=A)}else!_&&Kr(b,K)&&(N[K]=b[K]);if(_)o.useTheme(S.themeName||w6(o.rootContainer));else{const A=o.getCurrentThemeName();Kr(b,"themeName")&&A!==b.themeName&&o.useTheme(b.themeName)}Ab.has(o)&&o.stylesHandler.getThemeName()!==void 0&&Ab.delete(o),nl(o)&&!Ab.has(o)&&o.stylesHandler.isClassicTheme()&&(FU("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),Ab.add(o)),b.data===void 0&&S.data===void 0?T(null,"updateSettings"):b.data!==void 0?T(b.data,"updateSettings"):b.columns!==void 0&&(c.createMap(),o.initIndexMappers()),!g&&b.language&&re(b.language);const k=o.countCols(),M=S.columns;if(M&&Tt(M)&&(F=!0),(b.cell!==void 0||b.cells!==void 0||b.columns!==void 0)&&x.clearCache(),k>0)for(K=0,C=0;K<k;K++){if(M){const A=F?M(K):M[C];A&&x.updateColumnMeta(C,A)}C+=1}xe(b.cell)&&at(b.cell,A=>{o.setCellMetaObject(A.row,A.col,A)}),o.runHooks("afterCellMetaReset");let V=o.rootElement.style.height;V!==""&&(V=parseInt(o.rootElement.style.height,10)),_&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"));let j=b.height;if(typeof b.height<"u")if(Tt(j)&&(j=j()),j=o.runHooks("beforeHeightChange",j),j===null){const A=o.rootElement.getAttribute("data-initialstyle");A&&(A.indexOf("height")>-1||A.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",A):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else j!==void 0&&(o.rootElement.style.height=isNaN(j)?`${j}`:`${j}px`,o.rootElement.style.overflow="hidden");if(typeof b.width<"u"){let A=b.width;Tt(A)&&(A=A()),A=o.runHooks("beforeWidthChange",A),o.rootElement.style.width=isNaN(A)?`${A}`:`${A}px`}_||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",b)),d.adjustRowsAndCols(),o.view&&!g&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!_&&o.view&&(V===""||j===""||j===void 0)&&V!==j&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const b=o.getSelectedRangeActive();if(S.getValue){if(Tt(S.getValue))return S.getValue.call(o);if(b)return o.getData()[b.highlight.row][S.getValue]}else if(b)return o.getDataAtCell(b.highlight.row,b.highlight.col);return null},this.getSettings=function(){return S},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(b,_,T,F,K){d.alter(b,_,T,F,K)},this.getCell=function(b,_){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,F=_,K=b;if(_>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(_)))return null;F=this.columnIndexMapper.getRenderableFromVisualIndex(_)}if(b>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(b)))return null;K=this.rowIndexMapper.getRenderableFromVisualIndex(b)}return K===null||F===null||K===void 0||F===void 0?null:o.view.getCellAtCoords(o._createCellCoords(K,F),T)},this.getCoords=function(b){const _=this.view._wt.wtTable.getCoords(b);if(_===null)return null;const{row:T,col:F}=_;let K=T,C=F;return T>=0&&(K=this.rowIndexMapper.getVisualFromRenderableIndex(T)),F>=0&&(C=this.columnIndexMapper.getVisualFromRenderableIndex(F)),o._createCellCoords(K,C)},this.colToProp=function(b){return c.colToProp(b)},this.propToCol=function(b){return c.propToCol(b)},this.toVisualRow=b=>this.rowIndexMapper.getVisualFromPhysicalIndex(b),this.toVisualColumn=b=>this.columnIndexMapper.getVisualFromPhysicalIndex(b),this.toPhysicalRow=b=>this.rowIndexMapper.getPhysicalFromVisualIndex(b),this.toPhysicalColumn=b=>this.columnIndexMapper.getPhysicalFromVisualIndex(b),this.getDataAtCell=function(b,_){return c.get(b,c.colToProp(_))},this.getDataAtRowProp=function(b,_){return c.get(b,_)},this.getDataAtCol=function(b){const _=[],T=c.getRange(o._createCellCoords(0,b),o._createCellCoords(S.data.length-1,b),c.DESTINATION_RENDERER);for(let F=0;F<T.length;F+=1)for(let K=0;K<T[F].length;K+=1)_.push(T[F][K]);return _},this.getDataAtProp=function(b){const _=[],T=c.getRange(o._createCellCoords(0,c.propToCol(b)),o._createCellCoords(S.data.length-1,c.propToCol(b)),c.DESTINATION_RENDERER);for(let F=0;F<T.length;F+=1)for(let K=0;K<T[F].length;K+=1)_.push(T[F][K]);return _},this.getSourceData=function(b,_,T,F){let K;return b===void 0?K=u.getData():K=u.getByRange(o._createCellCoords(b,_),o._createCellCoords(T,F)),K},this.getSourceDataArray=function(b,_,T,F){let K;return b===void 0?K=u.getData(!0):K=u.getByRange(o._createCellCoords(b,_),o._createCellCoords(T,F),!0),K},this.getSourceDataAtCol=function(b){return u.getAtColumn(b)},this.setSourceDataAtCell=function(b,_,T,F){const K=fe(b,_,T),C=this.hasHook("afterSetSourceDataAtCell"),k=[],M=(j,A)=>{const U=this.toVisualRow(j),L=this.toVisualColumn(A);return Number.isInteger(L)?this.getCellMeta(U,L):{...Object.getPrototypeOf(S),...S}};C&&B(K,j=>{let[A,U,L]=j;const W=CN(L,M(A,U));k.push([A,U,u.getAtCell(A,U),W])}),B(K,j=>{let[A,U,L]=j;const W=CN(L,M(A,U));u.setAtCell(A,U,W)}),C&&this.runHooks("afterSetSourceDataAtCell",k,F),this.render();const V=o.getActiveEditor();V&&xe(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(b){return u.getAtRow(b)},this.getSourceDataAtCell=function(b,_){return u.getAtCell(b,_)},this.getDataAtRow=function(b){return c.getRange(o._createCellCoords(b,0),o._createCellCoords(b,this.countCols()-1),c.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(b,_,T,F){const K=b===void 0?[0,0,this.countRows(),this.countCols()]:[b,_,T,F],[C,k]=K;let[,,M,V]=K,j=null,A=null;M===void 0&&(M=C),V===void 0&&(V=k);let U="mixed";return Oe(Math.max(Math.min(C,M),0),Math.max(C,M),L=>{let W=!0;return Oe(Math.max(Math.min(k,V),0),Math.max(k,V),X=>(A=this.getCellMeta(L,X).type,j?W=j===A:j=A,W)),U=W?A:"mixed",W}),U},this.removeCellMeta=function(b,_,T){const[F,K]=[this.toPhysicalRow(b),this.toPhysicalColumn(_)];let C=x.getCellMetaKeyValue(F,K,T);o.runHooks("beforeRemoveCellMeta",b,_,T,C)!==!1&&(x.removeCellMeta(F,K,T),o.runHooks("afterRemoveCellMeta",b,_,T,C)),C=null},this.spliceCellsMeta=function(b){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var T=arguments.length,F=new Array(T>2?T-2:0),K=2;K<T;K++)F[K-2]=arguments[K];if(F.length>0&&!Array.isArray(F[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");_>0&&x.removeRow(this.toPhysicalRow(b),_),F.length>0&&B(F.reverse(),C=>{x.createRow(this.toPhysicalRow(b)),B(C,(k,M)=>this.setCellMetaObject(b,M,k))}),o.render()},this.setCellMetaObject=function(b,_,T){typeof T=="object"&&at(T,(F,K)=>{this.setCellMeta(b,_,K,F)})},this.setCellMeta=function(b,_,T,F){if(o.runHooks("beforeSetCellMeta",b,_,T,F)===!1)return;let C=b,k=_;b<this.countRows()&&(C=this.toPhysicalRow(b)),_<this.countCols()&&(k=this.toPhysicalColumn(_)),x.setCellMeta(C,k,T,F),o.runHooks("afterSetCellMeta",b,_,T,F)},this.getCellsMeta=function(){return x.getCellsMeta()},this.getCellMeta=function(b,_){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},F=this.toPhysicalRow(b),K=this.toPhysicalColumn(_);return F===null&&(F=b),K===null&&(K=_),x.getCellMeta(F,K,{visualRow:b,visualColumn:_,...T})},this.getColumnMeta=function(b){return x.getColumnMeta(this.toPhysicalColumn(b))},this.getCellMetaAtRow=function(b){return x.getCellsMetaAtRow(b)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||S.columns)},this.getCellRenderer=function(b,_){const T=typeof b=="number"?o.getCellMeta(b,_).renderer:b.renderer;return typeof T=="string"?mM(T):fr(T)?mM("text"):T},this.getCellEditor=function(b,_){const T=typeof b=="number"?o.getCellMeta(b,_).editor:b.editor;return typeof T=="string"?dM(T):fr(T)?dM("text"):T},this.getCellValidator=function(b,_){const T=typeof b=="number"?o.getCellMeta(b,_).validator:b.validator;return typeof T=="string"?cbe(T):T},this.validateCells=function(b){this._validateCells(b)},this.validateRows=function(b,_){if(!Array.isArray(b))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(_,b)},this.validateColumns=function(b,_){if(!Array.isArray(b))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(_,void 0,b)},this._validateCells=function(b,_,T){const F=new ae;b&&(F.onQueueEmpty=b);let K=o.countRows()-1;for(;K>=0;){if(_!==void 0&&_.indexOf(K)===-1){K-=1;continue}let C=o.countCols()-1;for(;C>=0;){if(T!==void 0&&T.indexOf(C)===-1){C-=1;continue}F.addValidatorToQueue(),o.validateCell(o.getDataAtCell(K,C),o.getCellMeta(K,C),k=>{if(typeof k!="boolean")throw new Error("Validation error: result is not boolean");k===!1&&(F.valid=!1),F.removeValidatorFormQueue()},"validateCells"),C-=1}K-=1}F.checkIfQueueIsEmpty()},this.getRowHeader=function(b){let _=S.rowHeaders,T=b;return T!==void 0&&(T=o.runHooks("modifyRowHeader",T)),T===void 0?(_=[],Oe(o.countRows()-1,F=>{_.push(o.getRowHeader(F))})):Array.isArray(_)&&_[T]!==void 0?_=_[T]:Tt(_)?_=_(T):_&&typeof _!="string"&&typeof _!="number"&&(_=T+1),_},this.hasRowHeaders=function(){return!!S.rowHeaders},this.hasColHeaders=function(){if(S.colHeaders!==void 0&&S.colHeaders!==null)return!!S.colHeaders;for(let b=0,_=o.countCols();b<_;b++)if(o.getColHeader(b))return!0;return!1},this.getColHeader=function(b){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const T=o.runHooks("modifyColHeader",b);if(T===void 0){const M=[],V=o.countCols();for(let j=0;j<V;j++)M.push(o.getColHeader(j));return M}let F=S.colHeaders;const K=function(M){const V=[],j=o.countCols();let A=0;for(;A<j;A++)Tt(S.columns)&&S.columns(A)&&V.push(A);return V[M]},C=o.toPhysicalColumn(T),k=K(C);return S.colHeaders===!1?F=null:S.columns&&Tt(S.columns)&&S.columns(k)&&S.columns(k).title?F=S.columns(k).title:S.columns&&S.columns[C]&&S.columns[C].title?F=S.columns[C].title:Array.isArray(S.colHeaders)&&S.colHeaders[C]!==void 0?F=S.colHeaders[C]:Tt(S.colHeaders)?F=S.colHeaders(C):S.colHeaders&&typeof S.colHeaders!="string"&&typeof S.colHeaders!="number"&&(F=DCe(T)),F=o.runHooks("modifyColumnHeaderValue",F,b,_),F},this._getColWidthFromSettings=function(b){let _;if(b>=0&&(_=o.getCellMeta(0,b).width),(_===void 0||_===S.width)&&(_=S.colWidths),_!=null){switch(typeof _){case"object":_=_[b];break;case"function":_=_(b);break}typeof _=="string"&&(_=Number.parseInt(_,10))}return _},this.getColWidth=function(b,_){let T=o._getColWidthFromSettings(b);return T=o.runHooks("modifyColWidth",T,b,_),T===void 0&&(T=Om),T},this._getRowHeightFromSettings=function(b){var _;const T=o.stylesHandler.getDefaultRowHeight(b);let F=(_=S.rowHeights)!==null&&_!==void 0?_:S.minRowHeights;if(F!=null){switch(typeof F){case"object":F=F[b];break;case"function":F=F(b);break}typeof F=="string"&&(F=Number.parseInt(F,10))}return F!=null&&F<T?T:F},this.getRowHeight=function(b,_){let T=o._getRowHeightFromSettings(b);return T=o.runHooks("modifyRowHeight",T,b,_),T},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return c.getLength()},this.countCols=function(){const b=S.maxCols,_=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(b,_)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=0;return f4(o.countRows()-1,T=>{if(o.isEmptyRow(T))_+=1;else if(b===!0)return!1}),_},this.countEmptyCols=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=0;return f4(o.countCols()-1,T=>{if(o.isEmptyCol(T))_+=1;else if(b===!0)return!1}),_},this.isEmptyRow=function(b){return S.isEmptyRow.call(o,b)},this.isEmptyCol=function(b){return S.isEmptyCol.call(o,b)},this.selectCell=function(b,_,T,F){let K=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,C=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return fr(b)||fr(_)?!1:this.selectCells([[b,_,T,F]],K,C)},this.selectCells=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_===!1&&m.suspend();const F=I.selectCells(b);return F&&T&&o.listen(),m.resume(),F},this.selectColumns=function(b){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:b,T=arguments.length>2?arguments[2]:void 0;return I.selectColumns(b,_,T)},this.selectRows=function(b){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:b,T=arguments.length>2?arguments[2]:void 0;return I.selectRows(b,_,T)},this.deselectCell=function(){I.deselect()},this.selectAll=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:b,T=arguments.length>2?arguments[2]:void 0;m.skipNextScrollCycle(),I.selectAll(b,_,T)};const de=(b,_)=>b.getNearestNotHiddenIndex(_,1,!0);this.scrollViewportTo=function(b,_){if(typeof b=="number"){var T;b={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(T=arguments[4])!==null&&T!==void 0?T:!0}}const{row:F,col:K,considerHiddenIndexes:C}=b??{};let k=F,M=K;if(Tt(_)&&this.addHookOnce("afterScroll",_),C===void 0||C){const U=Number.isInteger(F)&&F>=0,L=Number.isInteger(K)&&K>=0,W=U?de(this.rowIndexMapper,F):void 0,X=L?de(this.columnIndexMapper,K):void 0;if(W===null||X===null)return!1;k=U?o.rowIndexMapper.getRenderableFromVisualIndex(W):F,M=L?o.columnIndexMapper.getRenderableFromVisualIndex(X):K}const V=Number.isInteger(k),j=Number.isInteger(M);let A=!1;return V&&k>=0&&j&&M>=0?A=o.view.scrollViewport(o._createCellCoords(k,M),b.horizontalSnap,b.verticalSnap):V&&k>=0&&(j&&M<0||!j)?A=o.view.scrollViewportVertically(k,b.verticalSnap):j&&M>=0&&(V&&k<0||!V)&&(A=o.view.scrollViewportHorizontally(M,b.horizontalSnap)),Tt(_)&&(A?this.view.render():(this.removeHook("afterScroll",_),this._registerMicrotask(()=>_()))),A},this.scrollToFocusedCell=function(b){if(!this.selection.isSelected())return!1;Tt(b)&&this.addHookOnce("afterScroll",b);const{highlight:_}=this.getSelectedRangeActive(),T=this.scrollViewportTo(_.toObject());return T?this.view.render():Tt(b)&&(this.removeHook("afterScroll",b),this._registerMicrotask(()=>b())),T},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,nl(this)&&(TEe(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),E.clear(),x.clearCache(),TN.delete(this.guid),a.destroy(),f&&f.destroy(),o.rootContainer&&Mc(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),R.getItems().forEach(b=>{let[,_]=b;_.destroy()}),R.clear(),o.runHooks("afterDestroy")},!0),_e.getSingleton().destroy(o),at(o,(b,_,T)=>{Tt(b)?T[_]=se(_):_!=="guid"&&(T[_]=null)}),o.isDestroyed=!0,c&&c.destroy(),c=null,d=null,I=null,f=null,o=null};function se(b){return()=>{throw new Error(`The "${b}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(b){return R.getItem(_a(b))},this.getPluginName=function(b){return b===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:R.getId(b)},this.getInstance=function(){return o},this.addHook=function(b,_,T){_e.getSingleton().add(b,_,o,T)},this.hasHook=function(b){return _e.getSingleton().has(b,o)||_e.getSingleton().has(b)},this.addHookOnce=function(b,_,T){_e.getSingleton().once(b,_,o,T)},this.removeHook=function(b,_){_e.getSingleton().remove(b,_,o)},this.runHooks=function(b,_,T,F,K,C,k){return _e.getSingleton().run(o,b,_,T,F,K,C,k)},this.getTranslatedPhrase=function(b,_){return O9(S.language,b,_)},this.toHTML=()=>u4(this),this.toTableElement=()=>{const b=this.rootDocument.createElement("div");return b.insertAdjacentHTML("afterbegin",u4(this)),b.firstElementChild},this.timeouts=[],this.useTheme=b=>{const _=!!g;this.stylesHandler.useTheme(b);const T=this.stylesHandler.getThemeName();_||(o.render(),o.scrollViewportTo(0,0),w6(this.rootContainer)&&(Re(this.rootContainer,/ht-theme-.*/g),T&&ee(this.rootContainer,T))),this.runHooks("afterSetTheme",T,_)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(b){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=b;typeof T=="function"&&(T=setTimeout(T,_)),this.timeouts.push(T)},this._clearTimeouts=function(){B(this.timeouts,b=>{clearTimeout(b)})},this.immediates=[],this._registerImmediate=function(b){this.immediates.push(setImmediate(b))},this._clearImmediates=function(){B(this.immediates,b=>{clearImmediate(b)})},this._registerMicrotask=function(b){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||b()})},this._getEditorManager=function(){return f};const me=xEe({handleEvent(){return o.isListening()},beforeKeyDown:b=>this.runHooks("beforeKeyDown",b),afterKeyDown:b=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",b)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",b=>{b.ctrlKey===!1&&b.metaKey===!1&&me.releasePressedKeys()}),this.getShortcutManager=function(){return me},h=new lRe(o);const te=nl(this)?oRe(o):null;this.getFocusManager=function(){return h},this.getFocusScopeManager=function(){if(!nl(o))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return te},qU().forEach(b=>{const _=PI(b);R.addItem(b,new _(this))}),fEe(o),nl(this)&&mEe(o),me.setActiveContextName("grid"),_e.getSingleton().run(o,"construct")}function x6(t,e,r){t.addEventListener(e,r,!1)}function S6(t,e,r){t.removeEventListener(e,r,!1)}function Ob(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function q9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:f=>f.value,...e},n=t.body,i=t.createTextNode(""),s=t.createElement("span");let o;function a(){var f,h;i.textContent=r.textContent(o),s.style.position="absolute",s.style.fontSize=Ob(o).fontSize,s.style.fontFamily=Ob(o).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);const m=parseInt(((f=Ob(o))===null||f===void 0?void 0:f.paddingInlineStart)||0,10),g=parseInt(((h=Ob(o))===null||h===void 0?void 0:h.paddingInlineEnd)||0,10),p=s.clientWidth+m+g+1;n.removeChild(s);const y=o.style;y.height=`${r.minHeight}px`,r.minWidth>p?y.width=`${r.minWidth}px`:p>r.maxWidth?y.width=`${r.maxWidth}px`:y.width=`${p}px`;const w=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>w?y.height=`${r.minHeight}px`:r.maxHeight<w?(y.height=`${r.maxHeight}px`,y.overflowY="visible"):y.height=`${w}px`}function c(){t.defaultView.setTimeout(a,0)}function u(f){if(f&&f.minHeight)if(f.minHeight==="inherit")r.minHeight=o.clientHeight;else{const h=parseInt(f.minHeight,10);isNaN(h)||(r.minHeight=h)}if(f&&f.maxHeight)if(f.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{const h=parseInt(f.maxHeight,10);isNaN(h)||(r.maxHeight=h)}if(f&&f.minWidth)if(f.minWidth==="inherit")r.minWidth=o.clientWidth;else{const h=parseInt(f.minWidth,10);isNaN(h)||(r.minWidth=h)}if(f&&f.maxWidth)if(f.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{const h=parseInt(f.maxWidth,10);isNaN(h)||(r.maxWidth=h)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function d(f,h){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=f,u(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),m&&(x6(o,"input",a),x6(o,"keydown",c)),a()}return{init:d,resize:a,unObserve(){S6(o,"input",a),S6(o,"keydown",c)}}}function C6(t,e){const r=MU(e),n=e.value.split(`
`);let i=r,s=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(s+=n[o-1].length+1);const c=s+a.length;if(t==="home"?i=s:t==="end"&&(i=c),r<=c)break}C_(e,i)}function Nd(t,e,r){return(e=MEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MEe(t){var e=AEe(t,"string");return typeof e=="symbol"?e:e+""}function AEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const OEe="ht_editor_visible",Ib="ht_editor_hidden",_6="textEditor",IEe="text";class xf extends op{static get EDITOR_TYPE(){return IEe}constructor(e){super(e),Nd(this,"eventManager",new Ea(this)),Nd(this,"autoResize",q9(this.hot.rootDocument)),Nd(this,"TEXTAREA",void 0),Nd(this,"textareaStyle",void 0),Nd(this,"TEXTAREA_PARENT",void 0),Nd(this,"textareaParentStyle",void 0),Nd(this,"layerClass",void 0),this.eventManager=new Ea(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),mS(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,o){const a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:c}=o;c&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==zr.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===zr.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),C_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ne(this.TEXTAREA,[["data-hot-input",""],Ra(-1)]),ee(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ee(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ve(this.TEXTAREA_PARENT,this.layerClass)&&Re(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,Ib),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Jye()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Re(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,Ib)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Oe(e.length-1,n=>{const i=e[n];if(Ve(i,"handsontableEditor"))return r=!0,!1}),Ve(this.TEXTAREA_PARENT,Ib)&&Re(this.TEXTAREA_PARENT,Ib),r?(this.layerClass=OEe,ee(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ee(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==zr.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const c=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=c.fontSize,this.TEXTAREA.style.fontFamily=c.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){_U()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===zr.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===zr.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>xe(this.hot.getSelected()),group:_6},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;C6(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;C6(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_6)}}const jEe="base",HEe="htTextEllipsis";function Jv(t,e,r,n,i,s,o){const a=o.ariaTags,c=[],u=[],d=[],f=[];o.className&&ee(e,o.className),o.readOnly?(c.push(o.readOnlyCellClassName),a&&f.push(V3())):a&&d.push(V3()[0]),o.valid===!1&&o.invalidCellClassName?(c.push(o.invalidCellClassName),a&&f.push(B3())):(u.push(o.invalidCellClassName),a&&d.push(B3()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&c.push(o.noWordWrapClassName),!s&&o.placeholder&&c.push(o.placeholderCellClassName),o.textEllipsis&&c.push(HEe),Re(e,u),ee(e,c),_c(e,d),Ne(e,f)}Jv.RENDERER_TYPE=jEe;const $Ee="text";function Bc(t,e,r,n,i,s,o){Jv.apply(this,[t,e,r,n,i,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=sr(a),o.trimWhitespace&&(a=a.trim()),Xh(e,a)}Bc.RENDERER_TYPE=$Ee;const DEe="text",X9={CELL_TYPE:DEe,editor:xf,renderer:Bc};Qo(X9);gt.editors={BaseEditor:op};function gt(t,e){const r=new K9(t,e||{},YI);return r.init(),r}gt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new K9(t,e,YI)};gt.DefaultSettings=L9();gt.hooks=_e.getSingleton();gt.CellCoords=Zh;gt.CellRange=rp;gt.packageName="handsontable";gt.buildDate="20/11/2025 13:26:54";gt.version="16.2.0";gt.languages={dictionaryKeys:_1e,getLanguageDictionary:A9,getLanguagesDictionaries:T1e,registerLanguageDictionary:M9,getTranslatedPhrase:O9};function EM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function LEe(t){if(Array.isArray(t))return EM(t)}function FEe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function av(t,e,r){return e=VC(e),GEe(t,Q9()?Reflect.construct(e,r||[],VC(t).constructor):e.apply(t,r))}function Hm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R6(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J9(n.key),n)}}function $m(t,e,r){return e&&R6(t.prototype,e),r&&R6(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function VEe(t,e,r){return(e=J9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VC(t){return VC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},VC(t)}function lv(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NM(t,e)}function Q9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q9=function(){return!!t})()}function BEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function WEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E6(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zEe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?E6(Object(r),!0).forEach(function(n){VEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E6(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UEe(t,e){if(t==null)return{};var r,n,i=YEe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function YEe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function GEe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FEe(t)}function NM(t,e){return NM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},NM(t,e)}function KEe(t){return LEe(t)||BEe(t)||XEe(t)||WEe()}function qEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function J9(t){var e=qEe(t,"string");return typeof e=="symbol"?e:e+""}function XEe(t,e){if(t){if(typeof t=="string")return EM(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?EM(t,e):void 0}}var PN=null,QEe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",JEe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",BC="global",ZEe="hot-wrapper-editor-container";function eNe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function kM(t,e){var r=Pt.Children.toArray(t),n=Pt.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(s){return s.props[e]!==void 0})),i||null}function Z9(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function eY(t,e){if(typeof t>"u"||e===null)return null;var r=rY(e.props,!1);return r.className="".concat(ZEe," ").concat(r.className),Bz.createPortal(Pt.createElement("div",Object.assign({},r),e),t.body)}function tY(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:BC,n=kM(t,"hot-editor"),i=Z9(n);return n?Pt.cloneElement(n,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var c=e.get(i);c.set(a??BC,o)},editorColumnScope:r,isEditor:!0}):null}function tNe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;r||(r=document),PN||(PN=r.createDocumentFragment());var s=i??r.createElement("DIV");PN.appendChild(s);var o=Pt.cloneElement(t,zEe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:Bz.createPortal(o,s,n),portalContainer:s}}function rY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function rNe(){return typeof window<"u"}var nY=function(){function t(){Hm(this,t)}return $m(t,null,[{key:"getSettings",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.prevProps,s=i===void 0?{}:i,o=n.isInit,a=o===void 0?!1:o,c=n.initOnlySettingKeys,u=c===void 0?[]:c,d=function(y){return!a&&u.includes(y)?s[y]===r[y]:!1},f={};if(r.settings){var h=r.settings;for(var m in h)h.hasOwnProperty(m)&&!d(m)&&(f[m]=h[m])}for(var g in r)g!=="settings"&&g!=="children"&&!d(g)&&r.hasOwnProperty(g)&&(f[g]=r[g]);return f}}])}(),nNe=function(t){function e(){return Hm(this,e),av(this,e,arguments)}return lv(e,t),$m(e,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!n.internalProps.includes(i)}).reduce(function(i,s){return i[s]=n.props[s],i},{})}},{key:"getLocalEditorElement",value:function(){return tY(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=nY.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),i=eY(n,this.getLocalEditorElement());return Pt.createElement(Pt.Fragment,null,i)}}])}(Pt.Component),iNe=function(t){function e(){var r;return Hm(this,e),r=av(this,e,arguments),r.state={portals:[]},r}return lv(e,t),$m(e,[{key:"render",value:function(){return Pt.createElement(Pt.Fragment,null,this.state.portals)}}])}(Pt.Component),sNe="16.2.0";function oNe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var iY={exports:{}},MN,N6;function aNe(){if(N6)return MN;N6=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return MN=t,MN}var AN,k6;function lNe(){if(k6)return AN;k6=1;var t=aNe();function e(){}function r(){}return r.resetWarningCache=e,AN=function(){function i(a,c,u,d,f,h){if(h!==t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}i.isRequired=i;function s(){return i}var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},AN}iY.exports=lNe()();var cNe=iY.exports,ON=oNe(cNe),Wj=function(t){function e(){var r;return Hm(this,e),r=av(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return lv(e,t),$m(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(JEe),null)},set:function(n){this.__hotInstance=n}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return rNe()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var i=this;return function(o,a,c,u,d,f,h){var m=i.getRenderedCellCache(),g=i.getPortalContainerCache(),p="".concat(c,"-").concat(u),y=o.guid,w="".concat(y,"-").concat(p),v="".concat(p,"-").concat(y);if(m.has(p)&&(a.innerHTML=m.get(p).innerHTML),a&&!a.getAttribute("ghost-table")){for(var x=i.portalCache.get(v),S=g.get(w);a.firstChild;)a.removeChild(a.firstChild);if(x&&S)a.appendChild(S);else{var N=tNe(n,{TD:a,row:c,col:u,prop:d,value:f,cellProperties:h,isRenderer:!0},a.ownerDocument,v,S),R=N.portal,E=N.portalContainer;g.set(w,E),a.appendChild(E),i.portalCache.set(v,R)}}return m.set(p,a),a}}},{key:"getEditorClass",value:function(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:BC,o=Z9(n),a=(i=this.getEditorCache().get(o))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(n){var i=function(s){function o(a){var c;return Hm(this,o),c=av(this,o,[a]),n.hotCustomEditorInstance=c,c.editorComponent=n,c}return lv(o,s),$m(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(gt.editors.BaseEditor);return Object.getOwnPropertyNames(gt.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var o,a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return(o=n[s]).call.apply(o,[n].concat(c))})}),i}},{key:"getGlobalRendererElement",value:function(){return kM(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return tY(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((n=this.hotInstance)===null||n===void 0||(n=n.getSettings())===null||n===void 0?void 0:n._initOnlySettings)||[],a=nY.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:o}),c=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(this.columnSettings.length&&(a.columns=this.columnSettings),u)a.editor=this.getEditorClass(u,BC);else{var d;this.props.editor||(d=this.props.settings)!==null&&d!==void 0&&d.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=dM("text")}if(c)a.renderer=this.getRendererWrapper(c),this.componentRendererColumns.set("global",!0);else{var f;this.props.renderer||(f=this.props.settings)!==null&&f!==void 0&&f.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=mM("text")}return a}},{key:"displayAutoSizeWarning",value:function(n){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&eNe(QEe)}},{key:"setHotColumnSettings",value:function(n,i){this.columnSettings[i]=n}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:KEe(this.portalCache.values())})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new gt.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(n){this.clearCache();var i=this.createNewGlobalSettings(!1,n);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,i=function(d){return d.type===nNe},s=Pt.Children.toArray(this.props.children),o=s.filter(function(u){return i(u)}).map(function(u,d){return Pt.cloneElement(u,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:d,_getChildElementByType:kM.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:u.props.children})}),a=rY(this.props),c=eY(this.getOwnerDocument(),this.getGlobalEditorElement());return Pt.createElement(Pt.Fragment,null,Pt.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),o),Pt.createElement(iNe,{ref:this.setRenderersPortalManagerRef.bind(this)}),c)}}],[{key:"version",get:function(){return sNe}}])}(Pt.Component);Wj.propTypes={style:ON.object,id:ON.string,className:ON.string};var uNe=["children"],xt=Pt.forwardRef(function(t,e){var r,n=t.children,i=UEe(t,uNe),s=typeof Pt.useId=="function"?Pt.useId():void 0,o=(r=i.id)!==null&&r!==void 0?r:s;return Pt.createElement(Wj,Object.assign({id:o},i,{ref:e}),n)});xt.version=Wj.version;Pt.Component;function T6(t,e,r){return(e=dNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dNe(t){var e=hNe(t,"string");return typeof e=="symbol"?e:e+""}function hNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const P6="handsontableEditor",fNe="handsontable";class zj extends xf{constructor(){super(...arguments),T6(this,"isFlippedVertically",!1),T6(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return fNe}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),C_(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,d){const f=this.getSourceData(d.row,d.col);f!==void 0&&a.setValue(f),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&vn(c,o.handsontable),this.htOptions=c}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+a,0)}const i=this.getDropdownHeight(),s=e.getWorkspaceHeight()-n-r.height,o=i>s&&n>s+r.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:n,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.start+r.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;n=Math.max(n+a,0)}const i=this.getDropdownWidth(),s=e.getWorkspaceWidth()-n+r.width,o=i>s&&n>s;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:n,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:r}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-r)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:P6,relativeToGroup:fd,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),Ao(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,c;return!o.getSelectedActive()&&this.isFlippedVertically?a=o.countRows()-1:o.getSelectedActive()&&(this.isFlippedVertically?(c=o.getSelectedActive()[0],a=Math.max(0,c-1)):(c=o.getSelectedActive()[0],a=c-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,c;if(!o.getSelectedActive()&&!this.isFlippedVertically)a=0;else if(o.getSelectedActive()){if(this.isFlippedVertically)a=o.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const u=o.countRows()-1;c=o.getSelectedActive()[0],a=Math.min(u,c+1)}}return i(a,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(P6)}}function gNe(t,e){sY(t,e),e.add(t)}function M6(t,e,r){sY(t,e),e.set(t,r)}function sY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IN(t,e,r){return(e=mNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mNe(t){var e=pNe(t,"string");return typeof e=="symbol"?e:e+""}function pNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jN(t,e){return t.get(yu(t,e))}function yu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const yNe="autocomplete";var HN=new WeakMap,A6=new WeakMap,Jc=new WeakSet;class Uj extends zj{constructor(){super(...arguments),gNe(this,Jc),IN(this,"query",null),IN(this,"strippedChoices",[]),IN(this,"rawChoices",[]),M6(this,HN,this.hot.guid.slice(0,9)),M6(this,A6,R_(()=>{this.focus()},100))}static get EDITOR_TYPE(){return yNe}getValue(){const e=this.rawChoices.find(r=>{const n=this.stripValueIfNeeded(r);return(yu(Jc,this,Zp).call(this,n)?n.value:n)===this.TEXTAREA.value});return xe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ee(this.htContainer,"autocompleteEditor"),ee(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[oye(),Z0e(),hU("listbox"),dye()])}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[ko("false"),hye(`${jN(HN,this)}-listbox-${e}-${r}`)]),this.htOptions={...this.htOptions,valueGetter:a=>yu(Jc,this,Zp).call(this,a)?a.value:a}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=n==null?void 0:n.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",jN(A6,this)),this.htEditor.updateSettings({colWidths:e?[sn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,c,u,d,f,h,m)=>{Bc(a,c,u,d,f,h,m);const{filteringCaseSensitive:g,allowHtml:p,locale:y}=this.cellProperties,w=this.query;let v=sr(h),x,S;v&&!p&&(x=g===!0?v.indexOf(w):v.toLocaleLowerCase(y).indexOf(w.toLocaleLowerCase(y)),x!==-1&&(S=v.substr(x,w.length),v=v.replace(S,`<strong>${S}</strong>`))),r&&Ne(c,[eye(),...n?[pye(i)]:[],...n?[yye(n.indexOf(h)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${d}`]]),c.innerHTML=v},afterSelectionEnd:(a,c)=>{if(r){const u=f=>{Ne(f,[vI()]),Ne(this.TEXTAREA,...fye(f.id))},d=this.htEditor.getCell(a,c,!0);d!==null?u(d):this.htEditor.addHookOnce("afterScrollVertically",()=>{const f=this.htEditor.getCell(a,c,!0);u(f)})}}}),r&&(Ne(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...mc()),Ne(this.htEditor.rootElement,[dU(),gye("polite"),mye("text"),["id",`${jN(HN,this)}-listbox-${s}-${o}`]]),Ne(this.TEXTAREA,...ko("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[ko("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}finishEditing(e,r,n){if(this.isOpened()){const i=this.hot.getSelectedRangeActive();(fr(i)||xe(i)&&!i.includes(this.hot._createCellCoords(this.row,this.col)))&&(e=!0)}super.finishEditing(e,r,n)}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=MU(this.TEXTAREA),n=ave(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,o=this.stripValueIfNeeded(this.getValue()),a=yu(Jc,this,Zp).call(this,o)?o.value:o;let c=null,u=e;i||(u=u.toSorted());const d=[],f=this.cellProperties.locale,h=this.cellProperties.filteringCaseSensitive,m=h?a:a.toLocaleLowerCase(f);for(let g=0;g<u.length;g++){const p=yu(Jc,this,Zp).call(this,u[g])?Cc(sr(u[g].value)):Cc(sr(u[g]));if((h?p:p.toLocaleLowerCase(f)).indexOf(m)!==-1&&(d.push(g),s===!1))break}s===!1?o.length>0&&(c=d[0]):(u=d.map(g=>u[g]),c=u.indexOf(m)>-1?u.indexOf(m):0),this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(fS([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c)),this.hot.listen(),C_(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:r,spaceAbove:n,spaceBelow:i}=e;return this.limitDropdownIfNeeded(r?n:i),e}limitDropdownIfNeeded(e){const r=this.getDropdownHeight();if(r>e){let n=0,i=0,s=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),n+=i;while(n<e);s=n-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-s}px`),this.setDropdownHeight(n-i)}}updateDropdownDimensions(){const e=lve(),r=this.getTargetEditorWidth()+e,n=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:r,height:n}),yu(Jc,this,O6).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),yu(Jc,this,O6).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(i,s)=>s).reduce((i,s)=>{const o=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return i+o},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderInlineStartWidth,10)+parseInt(r.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=i=>sr(r?i:Cc(i));return e.every(i=>yu(Jc,this,Zp).call(this,i))?e.map(i=>({key:n(i.key),value:n(i.value)})):e.map(i=>n(i))}onBeforeKeyDown(e){if(gve(e.keyCode)||e.keyCode===De.BACKSPACE||e.keyCode===De.DELETE||e.keyCode===De.INSERT){let r=10;if(e.keyCode===De.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}function O6(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+on(this.hot.rootDocument)})}function Zp(t){return Le(t)&&xe(t.key)&&xe(t.value)}const vNe="checkbox";class oY extends op{static get EDITOR_TYPE(){return vNe}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');Ve(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ju=()=>window,bo=()=>window.document,TM=(t,e)=>window.setTimeout(t,e),il=function(t,e,r,n){t.addEventListener(e,r,!!n)},Gl=function(t,e,r,n){t.removeEventListener(e,r,!!n)},wNe=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Is=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},$N=function(t,e){Is(t,e)||(t.className=t.className===""?e:t.className+" "+e)},DN=function(t,e){t.className=wNe((" "+t.className+" ").replace(" "+e+" "," "))},Yj=function(t){return/Array/.test(Object.prototype.toString.call(t))},Ds=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},bNe=function(t){let e=t.getDay();return e===0||e===6},xNe=function(t){return t%4===0&&t%100!==0||t%400===0},I6=function(t,e){return[31,xNe(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},jb=function(t){Ds(t)&&t.setHours(0,0,0,0)},Hb=function(t,e){return t.getTime()===e.getTime()},WC=function(t,e,r){let n,i;for(n in e)i=t[n]!==void 0,i&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?Ds(e[n])?r&&(t[n]=new Date(e[n].getTime())):Yj(e[n])?r&&(t[n]=e[n].slice(0)):t[n]=WC({},e[n],r):(r||!i)&&(t[n]=e[n]);return t},j6=function(t,e,r){let n=bo().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=WC(n,r),t.dispatchEvent(n)},H6=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Wa={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},$6=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},SNe=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},CNe=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),n=t.getDay(),i=e,s=i-1,o=7,a=function(h){return(h+o-1)%o};t.setDate(r+s-a(n));let c=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,d=(t.getTime()-c.getTime())/u;return 1+Math.round((d-s+a(c.getDay()))/o)},_Ne=function(t,e,r,n,i){let s=new Date(n,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():CNe(s,i))+"</td>"},RNe=function(t,e,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},ENe=function(t){return"<tbody>"+t.join("")+"</tbody>"},NNe=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+$6(t,e)+'">'+$6(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},kNe=function(t,e,r,n,i,s){let o,a,c,u=t._o,d=r===u.minYear,f=r===u.maxYear,h='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',m,g,p=!0,y=!0;for(c=[],o=0;o<12;o++)c.push('<option value="'+(r===i?o-e:12+o-e)+'"'+(o===n?' selected="selected"':"")+(d&&o<u.minMonth||f&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(m='<div class="pika-label">'+u.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+c.join("")+"</select></div>",Yj(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=r-u.yearRange,a=1+r+u.yearRange),c=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&c.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+r+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+c.join("")+"</select></div>",u.showMonthAfterYear?h+=g+m:h+=m+g,d&&(n===0||u.minMonth>=n)&&(p=!1),f&&(n===11||u.maxMonth<=n)&&(y=!1),e===0&&(h+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(h+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),h+="</div>"},TNe=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+NNe(t)+ENe(e)+"</table>"};function PM(t){let e=this,r=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||ju().event;let s=i.target||i.srcElement;if(s)if(Is(s,"is-disabled")||(Is(s,"pika-button")&&!Is(s,"is-empty")&&!Is(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&TM(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):Is(s,"pika-prev")?e.prevMonth():Is(s,"pika-next")&&e.nextMonth()),Is(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||ju().event;let s=i.target||i.srcElement;s&&(Is(s,"pika-select-month")?e.gotoMonth(s.value):Is(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||ju().event,e.isVisible())switch(i.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let i=this.moment(r.field.value,r.format,r.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),Ds(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=bo().activeElement;do if(Is(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=TM(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||ju().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&Is(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),il(s,"change",e._onChange)));do if(Is(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&s!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=bo().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),il(e.el,"mousedown",e._onMouseDown,!0),il(e.el,"touchend",e._onMouseDown,!0),il(e.el,"change",e._onChange),r.keyboardInput&&il(bo(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?bo().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),il(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;Ds(n)?r.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",il(r.trigger,"click",e._onInputClick),il(r.trigger,"focus",e._onInputFocus),il(r.trigger,"blur",e._onInputBlur)):this.show()}PM.prototype={config:function(t){this._o||(this._o=WC({},Wa,!0));let e=WC(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,Ds(e.minDate)||(e.minDate=!1),Ds(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),Yj(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Wa.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Ds(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Ds(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",j6(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Ds(t))return;let r=this._o.minDate,n=this._o.maxDate;Ds(r)&&t<r?t=r:Ds(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),jb(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),j6(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Ds(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<r.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(r.valueOf()+n):t==="subtract"&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=H6(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=H6({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(jb(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Wa.minDate,this._o.minYear=Wa.minYear,this._o.minMonth=Wa.minMonth,this._o.startRange=Wa.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(jb(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Wa.maxDate,this._o.maxYear=Wa.maxYear,this._o.maxMonth=Wa.maxMonth,this._o.endRange=Wa.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,n=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=r&&(this._y=r,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s));for(let c=0;c<e.numberOfMonths;c++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+kNe(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year,a)+this.render(this.calendars[c].year,this.calendars[c].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&TM(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,n,i,s,o,a,c,u,d;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,n=ju().innerWidth||bo().documentElement.clientWidth,i=ju().innerHeight||bo().documentElement.clientHeight,s=bo().body.scrollTop||bo().documentElement.scrollTop,u=!0,d=!0,c=t.getBoundingClientRect(),o=c.left+ju().pageXOffset,a=c.bottom+ju().pageYOffset,(this._o.reposition&&o+e>n||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,u=!1),(this._o.reposition&&a+r>i+s||this._o.position.indexOf("top")>-1&&a-r-t.offsetHeight>0)&&(a=a-r-t.offsetHeight,d=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",$N(this.el,u?"left-aligned":"right-aligned"),$N(this.el,d?"bottom-aligned":"top-aligned"),DN(this.el,u?"right-aligned":"left-aligned"),DN(this.el,d?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let n=this._o,i=new Date,s=I6(t,e),o=new Date(t,e,1).getDay(),a=[],c=[];jb(i),n.firstDay>0&&(o-=n.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,d=e===11?0:e+1,f=e===0?t-1:t,h=e===11?t+1:t,m=I6(f,u),g=s+o,p=g;for(;p>7;)p-=7;g+=7-p;let y=!1;for(let w=0,v=0;w<g;w++){let x=new Date(t,e,1+(w-o)),S=Ds(this._d)?Hb(x,this._d):!1,N=Hb(x,i),R=n.events.indexOf(x.toDateString())!==-1,E=w<o||w>=s+o,P=1+(w-o),D=e,H=t,Z=n.startRange&&Hb(n.startRange,x),I=n.endRange&&Hb(n.endRange,x),Y=n.startRange&&n.endRange&&n.startRange<x&&x<n.endRange,re=n.minDate&&x<n.minDate||n.maxDate&&x>n.maxDate||n.disableWeekends&&bNe(x)||n.disableDayFn&&n.disableDayFn(x);E&&(w<o?(P=m+P,D=u,H=f):(P=P-s,D=d,H=h));let ne={day:P,month:D,year:H,hasEvent:R,isSelected:S,isToday:N,isDisabled:re,isEmpty:E,isStartRange:Z,isEndRange:I,isInRange:Y,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&S&&(y=!0),c.push(SNe(ne)),++v===7&&(n.showWeekNumber&&c.unshift(_Ne(this,w-o,e,t,n.firstWeekOfYearMinDays)),a.push(RNe(c,n.isRTL,n.pickWholeWeek,y)),c=[],v=0,y=!1)}return TNe(n,a,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),DN(this.el,"is-hidden"),this._o.bound&&(il(bo(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Gl(bo(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),$N(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Gl(this.el,"mousedown",this._onMouseDown,!0),Gl(this.el,"touchend",this._onMouseDown,!0),Gl(this.el,"change",this._onChange),t.keyboardInput&&Gl(bo(),"keydown",this._onKeyChange),t.field&&(Gl(t.field,"change",this._onInputChange),t.bound&&(Gl(t.trigger,"click",this._onInputClick),Gl(t.trigger,"focus",this._onInputFocus),Gl(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function PNe(t,e){MNe(t,e),e.add(t)}function MNe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D6(t,e,r){return(e=ANe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ANe(t){var e=ONe(t,"string");return typeof e=="symbol"?e:e+""}function ONe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const aY="date",L6="dateEditor",INe="DD/MM/YYYY";var $b=new WeakSet;class lY extends xf{constructor(){super(...arguments),PNe(this,$b),D6(this,"parentDestroyed",!1),D6(this,"$datePicker",null)}static get EDITOR_TYPE(){return aY}init(){if(typeof ce!="function")throw new Error("You need to include moment.js to your project.");if(typeof PM!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ee(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ve(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:L6})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(L6),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=LN($b,this,FN).call(this),n=this.hot.view.isMouseDown(),i=e?LU(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new PM(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(ce),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,ce(s,r,!0).isValid()&&this.$datePicker.setMoment(ce(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!n&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,ce(s,r,!0).isValid()&&this.$datePicker.setMoment(ce(s,r),!0),!i&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const r=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&b_(n,this.cellProperties.datePickerConfig);const i=n.onSelect,s=n.onClose;return n.field=r,n.trigger=r,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=(e=n.format)!==null&&e!==void 0?e:LN($b,this,FN).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=ce(a).format(LN($b,this,FN).call(this))),this.setValue(a),i&&i(),Sl()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},n}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==zr.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,a=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),c=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),d=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=c&&this.col>=u&&this.col<=d){const f=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+f.top+yn(this.TD)}px`;let h=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?h+=f.right-sn(this.datePicker):h+=f.left,this.datePickerStyle.left=`${h}px`}else this.hideDatepicker()}}function FN(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:INe}const jNe="dropdown";class cY extends Uj{static get EDITOR_TYPE(){return jNe}prepare(e,r,n,i,s,o){o.filter=!1,o.strict=!0,super.prepare(e,r,n,i,s,o)}}const HNe="numeric";class uY extends xf{static get EDITOR_TYPE(){return HNe}}function $Ne(t,e,r){return(e=DNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DNe(t){var e=LNe(t,"string");return typeof e=="symbol"?e:e+""}function LNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const FNe="password";class dY extends xf{constructor(){super(...arguments),$Ne(this,"autoResize",q9(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return FNe}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Mc(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Ra(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const VN="ht_editor_visible",F6="selectEditor",VNe="select";class hY extends op{static get EDITOR_TYPE(){return VNe}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...yf()),e.appendChild(this.hot.rootDocument.createTextNode("")),ee(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ve(this.selectWrapper,VN)&&Re(this.selectWrapper,VN),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this.cellProperties.selectOptions;let c;typeof a=="function"?c=this.prepareOptions(a(this.row,this.col,this.prop)):c=this.prepareOptions(a),Mc(this.select),at(c,(u,d)=>{const f=this.hot.rootDocument.createElement("OPTION");f.value=d,wf(f,u),this.select.appendChild(f)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==zr.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",ee(this.selectWrapper,VN)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:F6};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(F6)}}const BNe="time";class fY extends xf{static get EDITOR_TYPE(){return BNe}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.TEXTAREA.dir="ltr"}}function WNe(){Hs(op),Hs(Uj),Hs(oY),Hs(lY),Hs(cY),Hs(zj),Hs(uY),Hs(dY),Hs(hY),Hs(xf),Hs(fY)}const zNe="html";function Gj(t,e,r,n,i,s,o){Jv.apply(this,[t,e,r,n,i,s,o]),wf(e,s??"",!1)}Gj.RENDERER_TYPE=zNe;const UNe="autocomplete";function ap(t,e,r,n,i,s,o){const{rootDocument:a}=t,c=o.allowHtml?Gj:Bc,u=a.createElement("DIV"),d=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",d&&u.setAttribute(...yf()),u.appendChild(a.createTextNode("")),c.apply(this,[t,e,r,n,i,s,o]),e.firstChild||e.appendChild(a.createTextNode("")),e.insertBefore(u,e.firstChild),ee(e,"htAutocomplete"),!t.acArrowListener){const f=new Ea(t);t.acArrowListener=function(h){Ve(h.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},f.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{f.destroy()})}}ap.RENDERER_TYPE=UNe;const YNe="dropdown";function Kj(t,e,r,n,i,s,o){ap.apply(this,[t,e,r,n,i,s,o])}Kj.RENDERER_TYPE=YNe;const V6=new WeakMap,B6=new WeakMap,GNe="htBadValue",Dm="data-row",Lm="data-col",KNe="checkboxRenderer",gY="checkbox";_e.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:o,prop:a}=e;if(i!==gY||!n)return;const{value:c,property:u}=n;let d=r;if(c)d=typeof c=="function"?c(s,o,a,r):c;else if(u){const f=this.getDataAtRowProp(s,u);d=f!==null?f:r}return`${sr(d).length}`});function qj(t,e,r,n,i,s,o){const{rootDocument:a}=t,c=t.getSettings().ariaTags;Jv.apply(this,[t,e,r,n,i,s,o]),qNe(t);let u=XNe(a);const d=o.label;let f=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Mc(e),s===o.checkedTemplate||sr(s).toLocaleLowerCase(o.locale)===sr(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||sr(s).toLocaleLowerCase(o.locale)===sr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:qr(s)?ee(u,"noValue"):(u.style.display="none",ee(u,GNe),f=!0),Ne(u,[[Dm,r],[Lm,n]]),c&&Ne(u,[Us(u.checked?t.getTranslatedPhrase(kj):t.getTranslatedPhrase(Tj)),mU(u.checked),tye()]),!f&&d){let p="";if(d.value)p=typeof d.value=="function"?d.value.call(this,r,n,i,s):d.value;else if(d.property){const w=t.getDataAtRowProp(r,d.property);p=w!==null?w:""}const y=QNe(a,p,d.separated!==!0);d.position==="before"?d.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!d.position||d.position==="after")&&(d.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!d||d&&!d.separated)&&e.appendChild(u),f&&e.appendChild(a.createTextNode("#bad-value#")),V6.has(t)||(V6.set(t,!0),h());function h(){const y=t.getShortcutManager().getContext("grid"),w={group:KNe,relativeToGroup:fd,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(m(),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeActive())===null||v===void 0?void 0:v.highlight.isCell()}},{keys:[["enter"]],callback:()=>(m(),!g()),runOnlyIf:()=>{const v=t.getSelectedRangeActive();return t.getSettings().enterBeginsEditing&&(v==null?void 0:v.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(m(!0),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeActive())===null||v===void 0?void 0:v.highlight.isCell()}}],w)}function m(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),w=[],v=new Map;let x=[],S=0;if(y){for(let N=0;N<y.length;N++){const{row:R,col:E}=y[N].getTopStartCorner(),{row:P,col:D}=y[N].getBottomEndCorner();for(let H=R;H<=P;H+=1)for(let Z=E;Z<=D;Z+=1){const I=t.getCellMeta(H,Z);if(I.hidden)continue;const Y={checkedTemplate:I.checkedTemplate,uncheckedTemplate:I.uncheckedTemplate};if(I.type!=="checkbox"){p===!0&&!I.readOnly&&(v.has(w.length)?v.set(w.length,[...v.get(w.length),[H,Z,null]]):v.set(w.length,[[H,Z,null]]));continue}if(I.readOnly===!0)continue;typeof I.checkedTemplate>"u"&&(I.checkedTemplate=!0),typeof I.uncheckedTemplate>"u"&&(I.uncheckedTemplate=!1);const re=t.getDataAtCell(H,Z);p===!1?[I.checkedTemplate,I.checkedTemplate.toString()].includes(re)?x.push([H,Z,I.uncheckedTemplate,Y]):[I.uncheckedTemplate,I.uncheckedTemplate.toString(),null,void 0].includes(re)&&x.push([H,Z,I.checkedTemplate,Y]):x.push([H,Z,I.uncheckedTemplate,Y]),S+=1}w.push(S),S=0}x.every(N=>{let[,,R]=N;return R===x[0][2]})?x=x.map(N=>{let[R,E,P]=N;return[R,E,P]}):x=x.map(N=>{let[R,E,,P]=N;return[R,E,P.checkedTemplate]}),x.length>0&&w.forEach((N,R)=>{let E=x.splice(0,N);v.size&&v.has(R)&&(E=[...E,...v.get(R)]),t.setDataAtCell(E)})}}function g(){const p=t.getSelectedRange();if(p){for(let y=0;y<p.length;y++){const w=p[y].getTopStartCorner(),v=p[y].getBottomEndCorner();for(let x=w.row;x<=v.row;x++)for(let S=w.col;S<=v.col;S++){if(t.getCellMeta(x,S).readOnly)continue;const R=t.getCell(x,S);if(Rc(R)&&R.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}qj.RENDERER_TYPE=gY;function qNe(t){let e=B6.get(t);if(!e){const{rootElement:r}=t;e=new Ea(t),e.addEventListener(r,"click",n=>ZNe(n,t)),e.addEventListener(r,"mouseup",n=>JNe(n,t)),e.addEventListener(r,"change",n=>eke(n,t)),B6.set(t,e)}return e}function XNe(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function QNe(t,e,r){const n=t.createElement("label");n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`;const i=t.createTextNode(e);if(r){const s=t.createElement("span");s.appendChild(i),n.appendChild(s)}else n.appendChild(i);return n.cloneNode(!0)}function JNe(t,e){const{target:r}=t;Xj(r)&&(!r.hasAttribute(Dm)||!r.hasAttribute(Lm)||setTimeout(e.listen,10))}function ZNe(t,e){const{target:r}=t;if(!Xj(r)||!r.hasAttribute(Dm)||!r.hasAttribute(Lm))return;const n=parseInt(r.getAttribute(Dm),10),i=parseInt(r.getAttribute(Lm),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function eke(t,e){const{target:r}=t;if(!Xj(r)||!r.hasAttribute(Dm)||!r.hasAttribute(Lm))return;const n=parseInt(r.getAttribute(Dm),10),i=parseInt(r.getAttribute(Lm),10),s=e.getCellMeta(n,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function Xj(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const tke="handsontable";function Qj(t,e,r,n,i,s,o){ap.apply(this,[t,e,r,n,i,s,o])}Qj.RENDERER_TYPE=tke;var rke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nke(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var BN,W6;function ike(){return W6||(W6=1,BN={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),BN}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var WN,z6;function mY(){if(z6)return WN;z6=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(c){return c.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(c,u,d,f,h,m,g){if(!isNaN(+c))return+c;let p="",y=c.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==c)return-1*r(y,u,d,f,h,m);for(let R=0;R<t.length;R++){let E=t[R];if(p=c.replace(RegExp(`([0-9 ])(${E.key})$`),"$1"),p!==c)return r(p,u,d,f,h,m)*E.factor}if(p=c.replace("%",""),p!==c)return r(p,u,d,f,h,m)/100;let w=parseFloat(c);if(isNaN(w))return;let v=f(w);if(v&&v!=="."&&(p=c.replace(new RegExp(`${e(v)}$`),""),p!==c))return r(p,u,d,f,h,m);let x={};Object.keys(m).forEach(R=>{x[m[R]]=R});let S=Object.keys(x).sort().reverse(),N=S.length;for(let R=0;R<N;R++){let E=S[R],P=x[E];if(p=c.replace(E,""),p!==c){let D;switch(P){case"thousand":D=Math.pow(10,3);break;case"million":D=Math.pow(10,6);break;case"billion":D=Math.pow(10,9);break;case"trillion":D=Math.pow(10,12);break}return r(p,u,d,f,h,m)*D}}}function n(c,u,d){let f=c.replace(d,"");return f=f.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),f=f.replace(u.decimal,"."),f}function i(c,u,d="",f,h,m,g){if(c==="")return;if(c===h)return 0;let p=n(c,u,d);return r(p,u,d,f,h,m)}function s(c,u){if(!(c.indexOf(":")&&u.thousands!==":"))return!1;let f=c.split(":");if(f.length!==3)return!1;let h=+f[0],m=+f[1],g=+f[2];return!isNaN(h)&&!isNaN(m)&&!isNaN(g)}function o(c){let u=c.split(":"),d=+u[0],f=+u[1];return+u[2]+60*f+3600*d}function a(c,u){const d=eH();let f=d.currentDelimiters(),h=d.currentCurrency().symbol,m=d.currentOrdinal(),g=d.getZeroFormat(),p=d.currentAbbreviations(),y;if(typeof c=="string")s(c,f)?y=o(c):y=i(c,f,h,m,g,p);else if(typeof c=="number")y=c;else return;if(y!==void 0)return y}return WN={unformat:a},WN}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var zN,U6;function Jj(){if(U6)return zN;U6=1;let t=mY();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],n=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,w)=>w.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:n},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,w)=>w.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,w)=>!w.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,w)=>w.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},d={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(y,w){let v=h(y),x=g(w);return v&&x}function h(y){return t.unformat(y)!==void 0}function m(y,w,v,x=!1){let S=Object.keys(y).map(N=>{if(!w[N])return console.error(`${v} Invalid key: ${N}`),!1;let R=y[N],E=w[N];if(typeof E=="string"&&(E={type:E}),E.type==="format"){if(!m(R,u,`[Validate ${N}]`,!0))return!1}else if(typeof R!==E.type)return console.error(`${v} ${N} type mismatched: "${E.type}" expected, "${typeof R}" provided`),!1;if(E.restrictions&&E.restrictions.length){let P=E.restrictions.length;for(let D=0;D<P;D++){let{restriction:H,message:Z}=E.restrictions[D];if(!H(R,y))return console.error(`${v} ${N} invalid value: ${Z}`),!1}}return E.restriction&&!E.restriction(R,y)?(console.error(`${v} ${N} invalid value: ${E.message}`),!1):E.validValues&&E.validValues.indexOf(R)===-1?(console.error(`${v} ${N} invalid value: must be among ${JSON.stringify(E.validValues)}, "${R}" provided`),!1):!(E.children&&!m(R,E.children,`[Validate ${N}]`))});return x||S.push(...Object.keys(w).map(N=>{let R=w[N];if(typeof R=="string"&&(R={type:R}),R.mandatory){let E=R.mandatory;if(typeof E=="function"&&(E=E(y)),E&&y[N]===void 0)return console.error(`${v} Missing mandatory key "${N}"`),!1}return!0})),S.reduce((N,R)=>N&&R,!0)}function g(y){return m(y,u,"[Validate format]")}function p(y){return m(y,d,"[Validate language]")}return zN={validate:f,validateFormat:g,validateInput:h,validateLanguage:p},zN}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function ske(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function oke(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function ake(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function lke(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function cke(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function uke(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function dke(t,e){let n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}function hke(t,e){let r=t.split(".")[1];if(r){let n=r.match(/0+/);n&&(e.mantissa=n[0].length)}}function fke(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function gke(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function mke(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function pke(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function yke(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function vke(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function wke(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function bke(t,e={}){return typeof t!="string"?t:(t=ske(t,e),t=oke(t,e),ake(t,e),uke(t,e),dke(t,e),yke(t,e),gke(t,e),mke(t,e),hke(t,e),pke(t,e),fke(t,e),lke(t,e),cke(t,e),vke(t,e),wke(t,e),e)}var Zj={parseFormat:bke};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var UN,Y6;function eH(){if(Y6)return UN;Y6=1;const t=ike(),e=Jj(),r=Zj;let n={},i,s={},o=null,a={};function c(d){i=d}function u(){return s[i]}return n.languages=()=>Object.assign({},s),n.currentLanguage=()=>i,n.currentBytes=()=>u().bytes||{},n.currentCurrency=()=>u().currency,n.currentAbbreviations=()=>u().abbreviations,n.currentDelimiters=()=>u().delimiters,n.currentOrdinal=()=>u().ordinal,n.currentDefaults=()=>Object.assign({},u().defaults,a),n.currentOrdinalDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().ordinalFormat),n.currentByteDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().byteFormat),n.currentPercentageDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().percentageFormat),n.currentCurrencyDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().currencyFormat),n.currentTimeDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().timeFormat),n.setDefaults=d=>{d=r.parseFormat(d),e.validateFormat(d)&&(a=d)},n.getZeroFormat=()=>o,n.setZeroFormat=d=>o=typeof d=="string"?d:null,n.hasZeroFormat=()=>o!==null,n.languageData=d=>{if(d){if(s[d])return s[d];throw new Error(`Unknown tag "${d}"`)}return u()},n.registerLanguage=(d,f=!1)=>{if(!e.validateLanguage(d))throw new Error("Invalid language data");s[d.languageTag]=d,f&&c(d.languageTag)},n.setLanguage=(d,f=t.languageTag)=>{if(!s[d]){let h=d.split("-")[0],m=Object.keys(s).find(g=>g.split("-")[0]===h);if(!s[m]){c(f);return}c(m);return}c(d)},n.registerLanguage(t),i=t.languageTag,UN=n,UN}function xke(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Ske(t,e){t.forEach(r=>{let n;try{n=xke(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}n&&e.registerLanguage(n)})}var Cke=t=>({loadLanguagesInNode:e=>Ske(e,t)}),pY={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,d=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,m=1e9;function g(R){var E,P,D,H=te.prototype={constructor:te,toString:null,valueOf:null},Z=new te(1),I=20,Y=4,re=-7,ne=21,ae=-1e7,ue=1e7,Q=!1,fe=1,ye=0,de={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},se="0123456789abcdefghijklmnopqrstuvwxyz",me=!0;function te(C,k){var M,V,j,A,U,L,W,X,q=this;if(!(q instanceof te))return new te(C,k);if(k==null){if(C&&C._isBigNumber===!0){q.s=C.s,!C.c||C.e>ue?q.c=q.e=null:C.e<ae?q.c=[q.e=0]:(q.e=C.e,q.c=C.c.slice());return}if((L=typeof C=="number")&&C*0==0){if(q.s=1/C<0?(C=-C,-1):1,C===~~C){for(A=0,U=C;U>=10;U/=10,A++);A>ue?q.c=q.e=null:(q.e=A,q.c=[C]);return}X=String(C)}else{if(!n.test(X=String(C)))return D(q,X,L);q.s=X.charCodeAt(0)==45?(X=X.slice(1),-1):1}(A=X.indexOf("."))>-1&&(X=X.replace(".","")),(U=X.search(/e/i))>0?(A<0&&(A=U),A+=+X.slice(U+1),X=X.substring(0,U)):A<0&&(A=X.length)}else{if(v(k,2,se.length,"Base"),k==10&&me)return q=new te(C),F(q,I+q.e+1,Y);if(X=String(C),L=typeof C=="number"){if(C*0!=0)return D(q,X,L,k);if(q.s=1/C<0?(X=X.slice(1),-1):1,te.DEBUG&&X.replace(/^0\.0*|\./,"").length>15)throw Error(a+C)}else q.s=X.charCodeAt(0)===45?(X=X.slice(1),-1):1;for(M=se.slice(0,k),A=U=0,W=X.length;U<W;U++)if(M.indexOf(V=X.charAt(U))<0){if(V=="."){if(U>A){A=W;continue}}else if(!j&&(X==X.toUpperCase()&&(X=X.toLowerCase())||X==X.toLowerCase()&&(X=X.toUpperCase()))){j=!0,U=-1,A=0;continue}return D(q,String(C),L,k)}L=!1,X=P(X,k,10,q.s),(A=X.indexOf("."))>-1?X=X.replace(".",""):A=X.length}for(U=0;X.charCodeAt(U)===48;U++);for(W=X.length;X.charCodeAt(--W)===48;);if(X=X.slice(U,++W)){if(W-=U,L&&te.DEBUG&&W>15&&(C>d||C!==s(C)))throw Error(a+q.s*C);if((A=A-U-1)>ue)q.c=q.e=null;else if(A<ae)q.c=[q.e=0];else{if(q.e=A,q.c=[],U=(A+1)%u,A<0&&(U+=u),U<W){for(U&&q.c.push(+X.slice(0,U)),W-=u;U<W;)q.c.push(+X.slice(U,U+=u));U=u-(X=X.slice(U)).length}else U-=W;for(;U--;X+="0");q.c.push(+X)}}else q.c=[q.e=0]}te.clone=g,te.ROUND_UP=0,te.ROUND_DOWN=1,te.ROUND_CEIL=2,te.ROUND_FLOOR=3,te.ROUND_HALF_UP=4,te.ROUND_HALF_DOWN=5,te.ROUND_HALF_EVEN=6,te.ROUND_HALF_CEIL=7,te.ROUND_HALF_FLOOR=8,te.EUCLID=9,te.config=te.set=function(C){var k,M;if(C!=null)if(typeof C=="object"){if(C.hasOwnProperty(k="DECIMAL_PLACES")&&(M=C[k],v(M,0,m,k),I=M),C.hasOwnProperty(k="ROUNDING_MODE")&&(M=C[k],v(M,0,8,k),Y=M),C.hasOwnProperty(k="EXPONENTIAL_AT")&&(M=C[k],M&&M.pop?(v(M[0],-m,0,k),v(M[1],0,m,k),re=M[0],ne=M[1]):(v(M,-m,m,k),re=-(ne=M<0?-M:M))),C.hasOwnProperty(k="RANGE"))if(M=C[k],M&&M.pop)v(M[0],-m,-1,k),v(M[1],1,m,k),ae=M[0],ue=M[1];else if(v(M,-m,m,k),M)ae=-(ue=M<0?-M:M);else throw Error(o+k+" cannot be zero: "+M);if(C.hasOwnProperty(k="CRYPTO"))if(M=C[k],M===!!M)if(M)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Q=M;else throw Q=!M,Error(o+"crypto unavailable");else Q=M;else throw Error(o+k+" not true or false: "+M);if(C.hasOwnProperty(k="MODULO_MODE")&&(M=C[k],v(M,0,9,k),fe=M),C.hasOwnProperty(k="POW_PRECISION")&&(M=C[k],v(M,0,m,k),ye=M),C.hasOwnProperty(k="FORMAT"))if(M=C[k],typeof M=="object")de=M;else throw Error(o+k+" not an object: "+M);if(C.hasOwnProperty(k="ALPHABET"))if(M=C[k],typeof M=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(M))me=M.slice(0,10)=="0123456789",se=M;else throw Error(o+k+" invalid: "+M)}else throw Error(o+"Object expected: "+C);return{DECIMAL_PLACES:I,ROUNDING_MODE:Y,EXPONENTIAL_AT:[re,ne],RANGE:[ae,ue],CRYPTO:Q,MODULO_MODE:fe,POW_PRECISION:ye,FORMAT:de,ALPHABET:se}},te.isBigNumber=function(C){if(!C||C._isBigNumber!==!0)return!1;if(!te.DEBUG)return!0;var k,M,V=C.c,j=C.e,A=C.s;e:if({}.toString.call(V)=="[object Array]"){if((A===1||A===-1)&&j>=-m&&j<=m&&j===s(j)){if(V[0]===0){if(j===0&&V.length===1)return!0;break e}if(k=(j+1)%u,k<1&&(k+=u),String(V[0]).length==k){for(k=0;k<V.length;k++)if(M=V[k],M<0||M>=c||M!==s(M))break e;if(M!==0)return!0}}}else if(V===null&&j===null&&(A===null||A===1||A===-1))return!0;throw Error(o+"Invalid BigNumber: "+C)},te.maximum=te.max=function(){return _(arguments,-1)},te.minimum=te.min=function(){return _(arguments,1)},te.random=function(){var C=9007199254740992,k=Math.random()*C&2097151?function(){return s(Math.random()*C)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(M){var V,j,A,U,L,W=0,X=[],q=new te(Z);if(M==null?M=I:v(M,0,m),U=i(M/u),Q)if(crypto.getRandomValues){for(V=crypto.getRandomValues(new Uint32Array(U*=2));W<U;)L=V[W]*131072+(V[W+1]>>>11),L>=9e15?(j=crypto.getRandomValues(new Uint32Array(2)),V[W]=j[0],V[W+1]=j[1]):(X.push(L%1e14),W+=2);W=U/2}else if(crypto.randomBytes){for(V=crypto.randomBytes(U*=7);W<U;)L=(V[W]&31)*281474976710656+V[W+1]*1099511627776+V[W+2]*4294967296+V[W+3]*16777216+(V[W+4]<<16)+(V[W+5]<<8)+V[W+6],L>=9e15?crypto.randomBytes(7).copy(V,W):(X.push(L%1e14),W+=7);W=U/7}else throw Q=!1,Error(o+"crypto unavailable");if(!Q)for(;W<U;)L=k(),L<9e15&&(X[W++]=L%1e14);for(U=X[--W],M%=u,U&&M&&(L=f[u-M],X[W]=s(U/L)*L);X[W]===0;X.pop(),W--);if(W<0)X=[A=0];else{for(A=-1;X[0]===0;X.splice(0,1),A-=u);for(W=1,L=X[0];L>=10;L/=10,W++);W<u&&(A-=u-W)}return q.e=A,q.c=X,q}}(),te.sum=function(){for(var C=1,k=arguments,M=new te(k[0]);C<k.length;)M=M.plus(k[C++]);return M},P=function(){var C="0123456789";function k(M,V,j,A){for(var U,L=[0],W,X=0,q=M.length;X<q;){for(W=L.length;W--;L[W]*=V);for(L[0]+=A.indexOf(M.charAt(X++)),U=0;U<L.length;U++)L[U]>j-1&&(L[U+1]==null&&(L[U+1]=0),L[U+1]+=L[U]/j|0,L[U]%=j)}return L.reverse()}return function(M,V,j,A,U){var L,W,X,q,ie,we,ve,je,oe=M.indexOf("."),Ee=I,Se=Y;for(oe>=0&&(q=ye,ye=0,M=M.replace(".",""),je=new te(V),we=je.pow(M.length-oe),ye=q,je.c=k(N(y(we.c),we.e,"0"),10,j,C),je.e=je.c.length),ve=k(M,V,j,U?(L=se,C):(L=C,se)),X=q=ve.length;ve[--q]==0;ve.pop());if(!ve[0])return L.charAt(0);if(oe<0?--X:(we.c=ve,we.e=X,we.s=A,we=E(we,je,Ee,Se,j),ve=we.c,ie=we.r,X=we.e),W=X+Ee+1,oe=ve[W],q=j/2,ie=ie||W<0||ve[W+1]!=null,ie=Se<4?(oe!=null||ie)&&(Se==0||Se==(we.s<0?3:2)):oe>q||oe==q&&(Se==4||ie||Se==6&&ve[W-1]&1||Se==(we.s<0?8:7)),W<1||!ve[0])M=ie?N(L.charAt(1),-Ee,L.charAt(0)):L.charAt(0);else{if(ve.length=W,ie)for(--j;++ve[--W]>j;)ve[W]=0,W||(++X,ve=[1].concat(ve));for(q=ve.length;!ve[--q];);for(oe=0,M="";oe<=q;M+=L.charAt(ve[oe++]));M=N(M,X,L.charAt(0))}return M}}(),E=function(){function C(V,j,A){var U,L,W,X,q=0,ie=V.length,we=j%h,ve=j/h|0;for(V=V.slice();ie--;)W=V[ie]%h,X=V[ie]/h|0,U=ve*W+X*we,L=we*W+U%h*h+q,q=(L/A|0)+(U/h|0)+ve*X,V[ie]=L%A;return q&&(V=[q].concat(V)),V}function k(V,j,A,U){var L,W;if(A!=U)W=A>U?1:-1;else for(L=W=0;L<A;L++)if(V[L]!=j[L]){W=V[L]>j[L]?1:-1;break}return W}function M(V,j,A,U){for(var L=0;A--;)V[A]-=L,L=V[A]<j[A]?1:0,V[A]=L*U+V[A]-j[A];for(;!V[0]&&V.length>1;V.splice(0,1));}return function(V,j,A,U,L){var W,X,q,ie,we,ve,je,oe,Ee,Se,He,ze,Ge,Zt,Qr,$t,Gt,Ue=V.s==j.s?1:-1,ct=V.c,Be=j.c;if(!ct||!ct[0]||!Be||!Be[0])return new te(!V.s||!j.s||(ct?Be&&ct[0]==Be[0]:!Be)?NaN:ct&&ct[0]==0||!Be?Ue*0:Ue/0);for(oe=new te(Ue),Ee=oe.c=[],X=V.e-j.e,Ue=A+X+1,L||(L=c,X=p(V.e/u)-p(j.e/u),Ue=Ue/u|0),q=0;Be[q]==(ct[q]||0);q++);if(Be[q]>(ct[q]||0)&&X--,Ue<0)Ee.push(1),ie=!0;else{for(Zt=ct.length,$t=Be.length,q=0,Ue+=2,we=s(L/(Be[0]+1)),we>1&&(Be=C(Be,we,L),ct=C(ct,we,L),$t=Be.length,Zt=ct.length),Ge=$t,Se=ct.slice(0,$t),He=Se.length;He<$t;Se[He++]=0);Gt=Be.slice(),Gt=[0].concat(Gt),Qr=Be[0],Be[1]>=L/2&&Qr++;do{if(we=0,W=k(Be,Se,$t,He),W<0){if(ze=Se[0],$t!=He&&(ze=ze*L+(Se[1]||0)),we=s(ze/Qr),we>1)for(we>=L&&(we=L-1),ve=C(Be,we,L),je=ve.length,He=Se.length;k(ve,Se,je,He)==1;)we--,M(ve,$t<je?Gt:Be,je,L),je=ve.length,W=1;else we==0&&(W=we=1),ve=Be.slice(),je=ve.length;if(je<He&&(ve=[0].concat(ve)),M(Se,ve,He,L),He=Se.length,W==-1)for(;k(Be,Se,$t,He)<1;)we++,M(Se,$t<He?Gt:Be,He,L),He=Se.length}else W===0&&(we++,Se=[0]);Ee[q++]=we,Se[0]?Se[He++]=ct[Ge]||0:(Se=[ct[Ge]],He=1)}while((Ge++<Zt||Se[0]!=null)&&Ue--);ie=Se[0]!=null,Ee[0]||Ee.splice(0,1)}if(L==c){for(q=1,Ue=Ee[0];Ue>=10;Ue/=10,q++);F(oe,A+(oe.e=q+X*u-1)+1,U,ie)}else oe.e=X,oe.r=+ie;return oe}}();function b(C,k,M,V){var j,A,U,L,W;if(M==null?M=Y:v(M,0,8),!C.c)return C.toString();if(j=C.c[0],U=C.e,k==null)W=y(C.c),W=V==1||V==2&&(U<=re||U>=ne)?S(W,U):N(W,U,"0");else if(C=F(new te(C),k,M),A=C.e,W=y(C.c),L=W.length,V==1||V==2&&(k<=A||A<=re)){for(;L<k;W+="0",L++);W=S(W,A)}else if(k-=U,W=N(W,A,"0"),A+1>L){if(--k>0)for(W+=".";k--;W+="0");}else if(k+=A-L,k>0)for(A+1==L&&(W+=".");k--;W+="0");return C.s<0&&j?"-"+W:W}function _(C,k){for(var M,V,j=1,A=new te(C[0]);j<C.length;j++)V=new te(C[j]),(!V.s||(M=w(A,V))===k||M===0&&A.s===k)&&(A=V);return A}function T(C,k,M){for(var V=1,j=k.length;!k[--j];k.pop());for(j=k[0];j>=10;j/=10,V++);return(M=V+M*u-1)>ue?C.c=C.e=null:M<ae?C.c=[C.e=0]:(C.e=M,C.c=k),C}D=function(){var C=/^(-?)0([xbo])(?=\w[\w.]*$)/i,k=/^([^.]+)\.$/,M=/^\.([^.]+)$/,V=/^-?(Infinity|NaN)$/,j=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(A,U,L,W){var X,q=L?U:U.replace(j,"");if(V.test(q))A.s=isNaN(q)?null:q<0?-1:1;else{if(!L&&(q=q.replace(C,function(ie,we,ve){return X=(ve=ve.toLowerCase())=="x"?16:ve=="b"?2:8,!W||W==X?we:ie}),W&&(X=W,q=q.replace(k,"$1").replace(M,"0.$1")),U!=q))return new te(q,X);if(te.DEBUG)throw Error(o+"Not a"+(W?" base "+W:"")+" number: "+U);A.s=null}A.c=A.e=null}}();function F(C,k,M,V){var j,A,U,L,W,X,q,ie=C.c,we=f;if(ie){e:{for(j=1,L=ie[0];L>=10;L/=10,j++);if(A=k-j,A<0)A+=u,U=k,W=ie[X=0],q=s(W/we[j-U-1]%10);else if(X=i((A+1)/u),X>=ie.length)if(V){for(;ie.length<=X;ie.push(0));W=q=0,j=1,A%=u,U=A-u+1}else break e;else{for(W=L=ie[X],j=1;L>=10;L/=10,j++);A%=u,U=A-u+j,q=U<0?0:s(W/we[j-U-1]%10)}if(V=V||k<0||ie[X+1]!=null||(U<0?W:W%we[j-U-1]),V=M<4?(q||V)&&(M==0||M==(C.s<0?3:2)):q>5||q==5&&(M==4||V||M==6&&(A>0?U>0?W/we[j-U]:0:ie[X-1])%10&1||M==(C.s<0?8:7)),k<1||!ie[0])return ie.length=0,V?(k-=C.e+1,ie[0]=we[(u-k%u)%u],C.e=-k||0):ie[0]=C.e=0,C;if(A==0?(ie.length=X,L=1,X--):(ie.length=X+1,L=we[u-A],ie[X]=U>0?s(W/we[j-U]%we[U])*L:0),V)for(;;)if(X==0){for(A=1,U=ie[0];U>=10;U/=10,A++);for(U=ie[0]+=L,L=1;U>=10;U/=10,L++);A!=L&&(C.e++,ie[0]==c&&(ie[0]=1));break}else{if(ie[X]+=L,ie[X]!=c)break;ie[X--]=0,L=1}for(A=ie.length;ie[--A]===0;ie.pop());}C.e>ue?C.c=C.e=null:C.e<ae&&(C.c=[C.e=0])}return C}function K(C){var k,M=C.e;return M===null?C.toString():(k=y(C.c),k=M<=re||M>=ne?S(k,M):N(k,M,"0"),C.s<0?"-"+k:k)}return H.absoluteValue=H.abs=function(){var C=new te(this);return C.s<0&&(C.s=1),C},H.comparedTo=function(C,k){return w(this,new te(C,k))},H.decimalPlaces=H.dp=function(C,k){var M,V,j,A=this;if(C!=null)return v(C,0,m),k==null?k=Y:v(k,0,8),F(new te(A),C+A.e+1,k);if(!(M=A.c))return null;if(V=((j=M.length-1)-p(this.e/u))*u,j=M[j])for(;j%10==0;j/=10,V--);return V<0&&(V=0),V},H.dividedBy=H.div=function(C,k){return E(this,new te(C,k),I,Y)},H.dividedToIntegerBy=H.idiv=function(C,k){return E(this,new te(C,k),0,1)},H.exponentiatedBy=H.pow=function(C,k){var M,V,j,A,U,L,W,X,q,ie=this;if(C=new te(C),C.c&&!C.isInteger())throw Error(o+"Exponent not an integer: "+K(C));if(k!=null&&(k=new te(k)),L=C.e>14,!ie.c||!ie.c[0]||ie.c[0]==1&&!ie.e&&ie.c.length==1||!C.c||!C.c[0])return q=new te(Math.pow(+K(ie),L?C.s*(2-x(C)):+K(C))),k?q.mod(k):q;if(W=C.s<0,k){if(k.c?!k.c[0]:!k.s)return new te(NaN);V=!W&&ie.isInteger()&&k.isInteger(),V&&(ie=ie.mod(k))}else{if(C.e>9&&(ie.e>0||ie.e<-1||(ie.e==0?ie.c[0]>1||L&&ie.c[1]>=24e7:ie.c[0]<8e13||L&&ie.c[0]<=9999975e7)))return A=ie.s<0&&x(C)?-0:0,ie.e>-1&&(A=1/A),new te(W?1/A:A);ye&&(A=i(ye/u+2))}for(L?(M=new te(.5),W&&(C.s=1),X=x(C)):(j=Math.abs(+K(C)),X=j%2),q=new te(Z);;){if(X){if(q=q.times(ie),!q.c)break;A?q.c.length>A&&(q.c.length=A):V&&(q=q.mod(k))}if(j){if(j=s(j/2),j===0)break;X=j%2}else if(C=C.times(M),F(C,C.e+1,1),C.e>14)X=x(C);else{if(j=+K(C),j===0)break;X=j%2}ie=ie.times(ie),A?ie.c&&ie.c.length>A&&(ie.c.length=A):V&&(ie=ie.mod(k))}return V?q:(W&&(q=Z.div(q)),k?q.mod(k):A?F(q,ye,Y,U):q)},H.integerValue=function(C){var k=new te(this);return C==null?C=Y:v(C,0,8),F(k,k.e+1,C)},H.isEqualTo=H.eq=function(C,k){return w(this,new te(C,k))===0},H.isFinite=function(){return!!this.c},H.isGreaterThan=H.gt=function(C,k){return w(this,new te(C,k))>0},H.isGreaterThanOrEqualTo=H.gte=function(C,k){return(k=w(this,new te(C,k)))===1||k===0},H.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},H.isLessThan=H.lt=function(C,k){return w(this,new te(C,k))<0},H.isLessThanOrEqualTo=H.lte=function(C,k){return(k=w(this,new te(C,k)))===-1||k===0},H.isNaN=function(){return!this.s},H.isNegative=function(){return this.s<0},H.isPositive=function(){return this.s>0},H.isZero=function(){return!!this.c&&this.c[0]==0},H.minus=function(C,k){var M,V,j,A,U=this,L=U.s;if(C=new te(C,k),k=C.s,!L||!k)return new te(NaN);if(L!=k)return C.s=-k,U.plus(C);var W=U.e/u,X=C.e/u,q=U.c,ie=C.c;if(!W||!X){if(!q||!ie)return q?(C.s=-k,C):new te(ie?U:NaN);if(!q[0]||!ie[0])return ie[0]?(C.s=-k,C):new te(q[0]?U:Y==3?-0:0)}if(W=p(W),X=p(X),q=q.slice(),L=W-X){for((A=L<0)?(L=-L,j=q):(X=W,j=ie),j.reverse(),k=L;k--;j.push(0));j.reverse()}else for(V=(A=(L=q.length)<(k=ie.length))?L:k,L=k=0;k<V;k++)if(q[k]!=ie[k]){A=q[k]<ie[k];break}if(A&&(j=q,q=ie,ie=j,C.s=-C.s),k=(V=ie.length)-(M=q.length),k>0)for(;k--;q[M++]=0);for(k=c-1;V>L;){if(q[--V]<ie[V]){for(M=V;M&&!q[--M];q[M]=k);--q[M],q[V]+=c}q[V]-=ie[V]}for(;q[0]==0;q.splice(0,1),--X);return q[0]?T(C,q,X):(C.s=Y==3?-1:1,C.c=[C.e=0],C)},H.modulo=H.mod=function(C,k){var M,V,j=this;return C=new te(C,k),!j.c||!C.s||C.c&&!C.c[0]?new te(NaN):!C.c||j.c&&!j.c[0]?new te(j):(fe==9?(V=C.s,C.s=1,M=E(j,C,0,3),C.s=V,M.s*=V):M=E(j,C,0,fe),C=j.minus(M.times(C)),!C.c[0]&&fe==1&&(C.s=j.s),C)},H.multipliedBy=H.times=function(C,k){var M,V,j,A,U,L,W,X,q,ie,we,ve,je,oe,Ee,Se=this,He=Se.c,ze=(C=new te(C,k)).c;if(!He||!ze||!He[0]||!ze[0])return!Se.s||!C.s||He&&!He[0]&&!ze||ze&&!ze[0]&&!He?C.c=C.e=C.s=null:(C.s*=Se.s,!He||!ze?C.c=C.e=null:(C.c=[0],C.e=0)),C;for(V=p(Se.e/u)+p(C.e/u),C.s*=Se.s,W=He.length,ie=ze.length,W<ie&&(je=He,He=ze,ze=je,j=W,W=ie,ie=j),j=W+ie,je=[];j--;je.push(0));for(oe=c,Ee=h,j=ie;--j>=0;){for(M=0,we=ze[j]%Ee,ve=ze[j]/Ee|0,U=W,A=j+U;A>j;)X=He[--U]%Ee,q=He[U]/Ee|0,L=ve*X+q*we,X=we*X+L%Ee*Ee+je[A]+M,M=(X/oe|0)+(L/Ee|0)+ve*q,je[A--]=X%oe;je[A]=M}return M?++V:je.splice(0,1),T(C,je,V)},H.negated=function(){var C=new te(this);return C.s=-C.s||null,C},H.plus=function(C,k){var M,V=this,j=V.s;if(C=new te(C,k),k=C.s,!j||!k)return new te(NaN);if(j!=k)return C.s=-k,V.minus(C);var A=V.e/u,U=C.e/u,L=V.c,W=C.c;if(!A||!U){if(!L||!W)return new te(j/0);if(!L[0]||!W[0])return W[0]?C:new te(L[0]?V:j*0)}if(A=p(A),U=p(U),L=L.slice(),j=A-U){for(j>0?(U=A,M=W):(j=-j,M=L),M.reverse();j--;M.push(0));M.reverse()}for(j=L.length,k=W.length,j-k<0&&(M=W,W=L,L=M,k=j),j=0;k;)j=(L[--k]=L[k]+W[k]+j)/c|0,L[k]=c===L[k]?0:L[k]%c;return j&&(L=[j].concat(L),++U),T(C,L,U)},H.precision=H.sd=function(C,k){var M,V,j,A=this;if(C!=null&&C!==!!C)return v(C,1,m),k==null?k=Y:v(k,0,8),F(new te(A),C,k);if(!(M=A.c))return null;if(j=M.length-1,V=j*u+1,j=M[j]){for(;j%10==0;j/=10,V--);for(j=M[0];j>=10;j/=10,V++);}return C&&A.e+1>V&&(V=A.e+1),V},H.shiftedBy=function(C){return v(C,-d,d),this.times("1e"+C)},H.squareRoot=H.sqrt=function(){var C,k,M,V,j,A=this,U=A.c,L=A.s,W=A.e,X=I+4,q=new te("0.5");if(L!==1||!U||!U[0])return new te(!L||L<0&&(!U||U[0])?NaN:U?A:1/0);if(L=Math.sqrt(+K(A)),L==0||L==1/0?(k=y(U),(k.length+W)%2==0&&(k+="0"),L=Math.sqrt(+k),W=p((W+1)/2)-(W<0||W%2),L==1/0?k="5e"+W:(k=L.toExponential(),k=k.slice(0,k.indexOf("e")+1)+W),M=new te(k)):M=new te(L+""),M.c[0]){for(W=M.e,L=W+X,L<3&&(L=0);;)if(j=M,M=q.times(j.plus(E(A,j,X,1))),y(j.c).slice(0,L)===(k=y(M.c)).slice(0,L))if(M.e<W&&--L,k=k.slice(L-3,L+1),k=="9999"||!V&&k=="4999"){if(!V&&(F(j,j.e+I+2,0),j.times(j).eq(A))){M=j;break}X+=4,L+=4,V=1}else{(!+k||!+k.slice(1)&&k.charAt(0)=="5")&&(F(M,M.e+I+2,1),C=!M.times(M).eq(A));break}}return F(M,M.e+I+1,Y,C)},H.toExponential=function(C,k){return C!=null&&(v(C,0,m),C++),b(this,C,k,1)},H.toFixed=function(C,k){return C!=null&&(v(C,0,m),C=C+this.e+1),b(this,C,k)},H.toFormat=function(C,k,M){var V,j=this;if(M==null)C!=null&&k&&typeof k=="object"?(M=k,k=null):C&&typeof C=="object"?(M=C,C=k=null):M=de;else if(typeof M!="object")throw Error(o+"Argument not an object: "+M);if(V=j.toFixed(C,k),j.c){var A,U=V.split("."),L=+M.groupSize,W=+M.secondaryGroupSize,X=M.groupSeparator||"",q=U[0],ie=U[1],we=j.s<0,ve=we?q.slice(1):q,je=ve.length;if(W&&(A=L,L=W,W=A,je-=A),L>0&&je>0){for(A=je%L||L,q=ve.substr(0,A);A<je;A+=L)q+=X+ve.substr(A,L);W>0&&(q+=X+ve.slice(A)),we&&(q="-"+q)}V=ie?q+(M.decimalSeparator||"")+((W=+M.fractionGroupSize)?ie.replace(new RegExp("\\d{"+W+"}\\B","g"),"$&"+(M.fractionGroupSeparator||"")):ie):q}return(M.prefix||"")+V+(M.suffix||"")},H.toFraction=function(C){var k,M,V,j,A,U,L,W,X,q,ie,we,ve=this,je=ve.c;if(C!=null&&(L=new te(C),!L.isInteger()&&(L.c||L.s!==1)||L.lt(Z)))throw Error(o+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+K(L));if(!je)return new te(ve);for(k=new te(Z),X=M=new te(Z),V=W=new te(Z),we=y(je),A=k.e=we.length-ve.e-1,k.c[0]=f[(U=A%u)<0?u+U:U],C=!C||L.comparedTo(k)>0?A>0?k:X:L,U=ue,ue=1/0,L=new te(we),W.c[0]=0;q=E(L,k,0,1),j=M.plus(q.times(V)),j.comparedTo(C)!=1;)M=V,V=j,X=W.plus(q.times(j=X)),W=j,k=L.minus(q.times(j=k)),L=j;return j=E(C.minus(M),V,0,1),W=W.plus(j.times(X)),M=M.plus(j.times(V)),W.s=X.s=ve.s,A=A*2,ie=E(X,V,A,Y).minus(ve).abs().comparedTo(E(W,M,A,Y).minus(ve).abs())<1?[X,V]:[W,M],ue=U,ie},H.toNumber=function(){return+K(this)},H.toPrecision=function(C,k){return C!=null&&v(C,1,m),b(this,C,k,2)},H.toString=function(C){var k,M=this,V=M.s,j=M.e;return j===null?V?(k="Infinity",V<0&&(k="-"+k)):k="NaN":(C==null?k=j<=re||j>=ne?S(y(M.c),j):N(y(M.c),j,"0"):C===10&&me?(M=F(new te(M),I+j+1,Y),k=N(y(M.c),M.e,"0")):(v(C,2,se.length,"Base"),k=P(N(y(M.c),j,"0"),10,C,V,!0)),V<0&&M.c[0]&&(k="-"+k)),k},H.valueOf=H.toJSON=function(){return K(this)},H._isBigNumber=!0,R!=null&&te.set(R),te}function p(R){var E=R|0;return R>0||R===E?E:E-1}function y(R){for(var E,P,D=1,H=R.length,Z=R[0]+"";D<H;){for(E=R[D++]+"",P=u-E.length;P--;E="0"+E);Z+=E}for(H=Z.length;Z.charCodeAt(--H)===48;);return Z.slice(0,H+1||1)}function w(R,E){var P,D,H=R.c,Z=E.c,I=R.s,Y=E.s,re=R.e,ne=E.e;if(!I||!Y)return null;if(P=H&&!H[0],D=Z&&!Z[0],P||D)return P?D?0:-Y:I;if(I!=Y)return I;if(P=I<0,D=re==ne,!H||!Z)return D?0:!H^P?1:-1;if(!D)return re>ne^P?1:-1;for(Y=(re=H.length)<(ne=Z.length)?re:ne,I=0;I<Y;I++)if(H[I]!=Z[I])return H[I]>Z[I]^P?1:-1;return re==ne?0:re>ne^P?1:-1}function v(R,E,P,D){if(R<E||R>P||R!==s(R))throw Error(o+(D||"Argument")+(typeof R=="number"?R<E||R>P?" out of range: ":" not an integer: ":" not a primitive number: ")+String(R))}function x(R){var E=R.c.length-1;return p(R.e/u)==E&&R.c[E]%2!=0}function S(R,E){return(R.length>1?R.charAt(0)+"."+R.slice(1):R)+(E<0?"e":"e+")+E}function N(R,E,P){var D,H;if(E<0){for(H=P+".";++E;H+=P);R=H+R}else if(D=R.length,++E>D){for(H=P,E-=D;--E;H+=P);R+=H}else E<D&&(R=R.slice(0,E)+"."+R.slice(E));return R}r=g(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(rke)})(pY);var yY=pY.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ta=eH(),_ke=Jj(),Rke=Zj,Eke=yY,qn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Zv={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:vY,decimalSuffixes:zC}=ta.currentBytes(),tH={general:{scale:1024,suffixes:zC},binary:{scale:1024,suffixes:vY},decimal:{scale:1e3,suffixes:zC}};function Nke(t,e={},r){if(typeof e=="string"&&(e=Rke.parseFormat(e)),!_ke.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",o=kke(t,e,r);return o=Gke(o,i),o=Kke(o,s),o}function kke(t,e,r){switch(e.output){case"currency":return e=Cg(e,ta.currentCurrencyDefaultFormat()),Hke(t,e,ta);case"percent":return e=Cg(e,ta.currentPercentageDefaultFormat()),jke(t,e,ta,r);case"byte":return e=Cg(e,ta.currentByteDefaultFormat()),Ake(t,e,ta,r);case"time":return e=Cg(e,ta.currentTimeDefaultFormat()),Ike(t);case"ordinal":return e=Cg(e,ta.currentOrdinalDefaultFormat()),Oke(t,e,ta);case"number":default:return ew({instance:t,providedFormat:e})}}function Tke(t){let e=tH.decimal;return $_(t._value,e.suffixes,e.scale).suffix}function Pke(t){let e=tH.binary;return $_(t._value,e.suffixes,e.scale).suffix}function Mke(t){let e=tH.general;return $_(t._value,e.suffixes,e.scale).suffix}function $_(t,e,r){let n=e[0],i=Math.abs(t);if(i>=r){for(let s=1;s<e.length;++s){let o=Math.pow(r,s),a=Math.pow(r,s+1);if(i>=o&&i<a){n=e[s],t=t/o;break}}n===e[0]&&(t=t/Math.pow(r,e.length-1),n=e[e.length-1])}return{value:t,suffix:n}}function Ake(t,e,r,n){let i=e.base||"binary",s=Object.assign({},Zv,e);const{binarySuffixes:o,decimalSuffixes:a}=r.currentBytes();let u={general:{scale:1024,suffixes:a||zC,marker:"bd"},binary:{scale:1024,suffixes:o||vY,marker:"b"},decimal:{scale:1e3,suffixes:a||zC,marker:"d"}}[i],{value:d,suffix:f}=$_(t._value,u.suffixes,u.scale);return`${ew({instance:n(d),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${f}`}function Oke(t,e,r){let n=r.currentOrdinal(),i=Object.assign({},Zv,e),s=ew({instance:t,providedFormat:e,state:r}),o=n(t._value);return`${s}${i.spaceSeparated?" ":""}${o}`}function Ike(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),n=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${n<10?"0":""}${n}`}function jke(t,e,r,n){let i=e.prefixSymbol,s=ew({instance:n(t._value*100),providedFormat:e,state:r}),o=Object.assign({},Zv,e);return i?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function Hke(t,e,r){const n=r.currentCurrency();let i=Object.assign({},e),s=Object.assign({},Zv,i),o,a="",c=!!s.totalLength||!!s.forceAverage||s.average,u=i.currencyPosition||n.position,d=i.currencySymbol||n.symbol;const f=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),f&&(a=" "),u==="infix"&&(o=a+d+a);let h=ew({instance:t,providedFormat:i,state:r,decimalSeparator:o});return u==="prefix"&&(t._value<0&&s.negative==="sign"?h=`-${a}${d}${h.slice(1)}`:t._value>0&&s.forceSign?h=`+${a}${d}${h.slice(1)}`:h=d+a+h),(!u||u==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&c?"":a,h=h+a+d),h}function $ke({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:n,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",c=Math.abs(t),u=-1;if(e&&n[e]&&qn[e]?(a=n[e],t=t/qn[e]):c>=qn.trillion||r&&o(c/qn.trillion)===1?(a=n.trillion,t=t/qn.trillion):c<qn.trillion&&c>=qn.billion||r&&o(c/qn.billion)===1?(a=n.billion,t=t/qn.billion):c<qn.billion&&c>=qn.million||r&&o(c/qn.million)===1?(a=n.million,t=t/qn.million):(c<qn.million&&c>=qn.thousand||r&&o(c/qn.thousand)===1)&&(a=n.thousand,t=t/qn.thousand),a&&(a=(i?" ":"")+a),s){let f=t<0,h=t.toString().split(".")[0],m=f?h.length-1:h.length;u=Math.max(s-m,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function Dke({value:t,characteristicPrecision:e}){let[r,n]=t.toExponential().split("e"),i=+r;if(!e)return{value:i,abbreviation:`e${n}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),n=+n-(e-s),n=n>=0?`+${n}`:n),{value:i,abbreviation:`e${n}`}}function Db(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function Lke(t,e){let r=t.toString(),[n,i]=r.split("e"),[s,o=""]=n.split(".");if(+i>0)r=s+o+Db(i-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let c=(Db(-i-1)+Math.abs(s)+o).substr(0,e);c.length<e&&(c+=Db(e-c.length)),r=a+c}return+i>0&&e>0&&(r+=`.${Db(e)}`),r}function Fke(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?Lke(t,e):new Eke(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Vke(t,e,r,n,i,s){if(n===-1)return t;let o=Fke(e,n,s),[a,c=""]=o.toString().split(".");if(c.match(/^0+$/)&&(r||i))return a;let u=c.match(/0+$/);return i&&u?`${a}.${c.toString().slice(0,u.index)}`:o.toString()}function Bke(t,e,r,n){let i=t,[s,o]=i.toString().split(".");if(s.match(/^-?0$/)&&r)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),i=i.slice(1)),s.length<n){let c=n-s.length;for(let u=0;u<c;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function Wke(t,e){let r=[],n=0;for(let i=t;i>0;i--)n===e&&(r.unshift(i),n=0),n++;return r}function zke(t,e,r,n,i){let s=n.currentDelimiters(),o=s.thousands;i=i||s.decimal;let a=s.thousandsSize||3,c=t.toString(),u=c.split(".")[0],d=c.split(".")[1];const f=e<0&&u.indexOf("-")===0;return r&&(f&&(u=u.slice(1)),Wke(u.length,a).forEach((m,g)=>{u=u.slice(0,m+g)+o+u.slice(m+g)}),f&&(u=`-${u}`)),d?c=u+i+d:c=u,c}function Uke(t,e){return t+e}function Yke(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function Gke(t,e){return e+t}function Kke(t,e){return t+e}function ew({instance:t,providedFormat:e,state:r=ta,decimalSeparator:n,defaults:i=r.currentDefaults()}){let s=t._value;if(s===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},Zv,i,e),a=o.totalLength,c=a?0:o.characteristic,u=o.optionalCharacteristic,d=o.forceAverage,f=o.lowPrecision,h=!!a||!!d||o.average,m=a?-1:h&&e.mantissa===void 0?0:o.mantissa,g=a?!1:e.optionalMantissa===void 0?m===-1:o.optionalMantissa,p=o.trimMantissa,y=o.thousandSeparated,w=o.spaceSeparated,v=o.negative,x=o.forceSign,S=o.exponential,N=o.roundingFunction,R="";if(h){let P=$ke({value:s,forceAverage:d,lowPrecision:f,abbreviations:r.currentAbbreviations(),spaceSeparated:w,roundingFunction:N,totalLength:a});s=P.value,R+=P.abbreviation,a&&(m=P.mantissaPrecision)}if(S){let P=Dke({value:s,characteristicPrecision:c});s=P.value,R=P.abbreviation+R}let E=Vke(s.toString(),s,g,m,p,N);return E=Bke(E,s,u,c),E=zke(E,s,y,r,n),(h||S)&&(E=Uke(E,R)),(x||s<0)&&(E=Yke(E,s,v)),E}function Cg(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var qke=t=>({format:(...e)=>Nke(...e,t),getByteUnit:(...e)=>Mke(...e,t),getBinaryByteUnit:(...e)=>Pke(...e,t),getDecimalByteUnit:(...e)=>Tke(...e,t),formatOrDefault:Cg});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ac=yY;function Xke(t,e,r){let n=new Ac(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Ac(i),t._value=n.plus(i).toNumber(),t}function wY(t,e,r){let n=new Ac(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Ac(i),t._value=n.minus(i).toNumber(),t}function Qke(t,e,r){let n=new Ac(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Ac(i),t._value=n.times(i).toNumber(),t}function Jke(t,e,r){let n=new Ac(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Ac(i),t._value=n.dividedBy(i).toNumber(),t}function Zke(t,e,r){let n=e;return r.isNumbro(e)&&(n=e._value),t._value=n,t}function eTe(t,e,r){let n=r(t._value);return wY(n,e,r),Math.abs(n._value)}var tTe=t=>({add:(e,r)=>Xke(e,r,t),subtract:(e,r)=>wY(e,r,t),multiply:(e,r)=>Qke(e,r,t),divide:(e,r)=>Jke(e,r,t),set:(e,r)=>Zke(e,r,t),difference:(e,r)=>eTe(e,r,t),BigNumber:Ac});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const rTe="2.5.0",Hl=eH(),nTe=Jj(),iTe=Cke(Xr),sTe=mY();let kd=qke(Xr),oh=tTe(Xr);const oTe=Zj;class bY{constructor(e){this._value=e}clone(){return Xr(this._value)}format(e={}){return kd.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=oTe.parseFormat(e)),e=kd.formatOrDefault(e,Hl.currentCurrencyDefaultFormat()),e.output="currency",kd.format(this,e)}formatTime(e={}){return e.output="time",kd.format(this,e)}binaryByteUnits(){return kd.getBinaryByteUnit(this)}decimalByteUnits(){return kd.getDecimalByteUnit(this)}byteUnits(){return kd.getByteUnit(this)}difference(e){return oh.difference(this,e)}add(e){return oh.add(this,e)}subtract(e){return oh.subtract(this,e)}multiply(e){return oh.multiply(this,e)}divide(e){return oh.divide(this,e)}set(e){return oh.set(this,xY(e))}value(){return this._value}valueOf(){return this._value}}function xY(t){let e=t;return Xr.isNumbro(t)?e=t._value:typeof t=="string"?e=Xr.unformat(t):isNaN(t)&&(e=NaN),e}function Xr(t){return new bY(xY(t))}Xr.version=rTe;Xr.isNumbro=function(t){return t instanceof bY};Xr.language=Hl.currentLanguage;Xr.registerLanguage=Hl.registerLanguage;Xr.setLanguage=Hl.setLanguage;Xr.languages=Hl.languages;Xr.languageData=Hl.languageData;Xr.zeroFormat=Hl.setZeroFormat;Xr.defaultFormat=Hl.currentDefaults;Xr.setDefaults=Hl.setDefaults;Xr.defaultCurrencyFormat=Hl.currentCurrencyDefaultFormat;Xr.validate=nTe.validate;Xr.loadLanguagesInNode=iTe.loadLanguagesInNode;Xr.unformat=sTe.unformat;Xr.BigNumber=oh.BigNumber;var aTe=Xr,Td=nke(aTe);const lTe="numeric";function SY(t,e){if(Di(t)){const r=e.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if(typeof n<"u"&&!Td.languages()[n]){const s=n.replace("-",""),o=Td.allLanguages?Td.allLanguages[n]:Td[s];o&&Td.registerLanguage(o)}Td.setLanguage(n),t=Td(t).format(i||"0")}return t}function rH(t,e,r,n,i,s,o){let a=s;if(Di(a)){let u=[];if(Array.isArray(o.className))u=o.className;else{var c;const d=(c=o.className)!==null&&c!==void 0?c:"";d.length&&(u=d.split(" "))}a=SY(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}Bc(t,e,r,n,i,a,o)}rH.RENDERER_TYPE=lTe;const cTe="password";function nH(t,e,r,n,i,s,o){Bc.apply(this,[t,e,r,n,i,s,o]);const a=o.hashLength||e.innerHTML.length,c=o.hashSymbol||"*";let u="";Oe(a-1,()=>{u+=c}),wf(e,u)}nH.RENDERER_TYPE=cTe;const uTe="select";function iH(t,e,r,n,i,s,o){Bc.apply(this,[t,e,r,n,i,s,o])}iH.RENDERER_TYPE=uTe;const dTe="time";function sH(t,e,r,n,i,s,o){Bc.apply(this,[t,e,r,n,i,s,o]),e.dir="ltr"}sH.RENDERER_TYPE=dTe;function hTe(){fo(ap),fo(Jv),fo(qj),fo(Kj),fo(Qj),fo(Gj),fo(rH),fo(nH),fo(iH),fo(Bc),fo(sH)}const fTe="autocomplete";function D_(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,G6(r,e)):G6(r,e)(this.source):e(!0)}D_.VALIDATOR_TYPE=fTe;function G6(t,e){const r=t;return function(n){let i=!1;for(let s=0,o=n.length;s<o;s++)if(x_(r,n[s])){i=!0;break}e(i)}}function gTe(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const mTe="date";function oH(t,e){const r=zU(aY,this.instance);let n=t,i=!0;n==null&&(n="");let s=ce(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=ce(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=pTe(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}oH.VALIDATOR_TYPE=mTe;function pTe(t,e){const r=ce(gTe(t)),n=ce(t,e),i=t.search(/[A-Za-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const yTe="dropdown";function aH(t,e){D_.apply(this,[t,e])}aH.VALIDATOR_TYPE=yTe;const vTe="numeric";function lH(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Di(t))}lH.VALIDATOR_TYPE=vTe;const wTe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],bTe="time";function cH(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=ce(i,wTe,!0).isValid()?ce(i):ce(i,r);let a=o.isValid(),c=ce(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,c=!0),a||(n=!1),!a&&c&&(n=!0),a&&!c)if(this.correctFormat===!0){const u=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),n=!0}else n=!1;e(n)}cH.VALIDATOR_TYPE=bTe;function xTe(){Sg(D_),Sg(aH),Sg(oH),Sg(lH),Sg(cH)}function CY(t){return Le(t)&&t.value!==void 0?t.value:t}function _Y(t,e,r){const n=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(r)),i=s=>Le(s)&&xe(s.key)&&xe(s.value);return i(n)?i(t)?t:{key:t,value:t}:t}const STe="autocomplete",CTe={CELL_TYPE:STe,editor:Uj,renderer:ap,validator:D_,valueGetter:CY,valueSetter:_Y};function _Te(t,e,r){const{checkedTemplate:n,uncheckedTemplate:i}=this.getCellMeta(e,r),s=sr(t),o=s===sr(n),a=s===sr(i);return o||a?o?n:i:t}const RTe="checkbox",ETe={CELL_TYPE:RTe,editor:oY,renderer:qj,valueSetter:_Te},NTe="date";function RY(t,e,r,n,i,s,o){ap.apply(this,[t,e,r,n,i,s,o])}RY.RENDERER_TYPE=NTe;const kTe="date",TTe={CELL_TYPE:kTe,editor:lY,renderer:RY,validator:oH};function PTe(t){return CY.call(this,t)}function MTe(t,e,r,n){return _Y.call(this,t,e,r,n)}const ATe="dropdown",OTe={CELL_TYPE:ATe,editor:cY,renderer:Kj,validator:aH,filter:!1,strict:!0,valueGetter:PTe,valueSetter:MTe},ITe="handsontable",jTe={CELL_TYPE:ITe,editor:zj,renderer:Qj};function HTe(t){if(typeof t=="string"&&Uwe(t)){const e=Ywe(t);return V0(e)?t:e}return t}const $Te="numeric",DTe={CELL_TYPE:$Te,editor:uY,renderer:rH,validator:lH,dataType:"number",valueSetter:HTe},LTe="password",FTe={CELL_TYPE:LTe,editor:dY,renderer:nH,copyable:!1},VTe="select",BTe={CELL_TYPE:VTe,editor:hY,renderer:iH},WTe="time",zTe={CELL_TYPE:WTe,editor:fY,renderer:sH,validator:cH};function UTe(){Qo(CTe),Qo(ETe),Qo(TTe),Qo(OTe),Qo(jTe),Qo(DTe),Qo(FTe),Qo(BTe),Qo(X9),Qo(zTe)}function YTe(t,e){EY(t,e),e.add(t)}function Vf(t,e,r){return(e=GTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GTe(t){var e=KTe(t,"string");return typeof e=="symbol"?e:e+""}function KTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function K6(t,e,r){EY(t,e),e.set(t,r)}function EY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lb(t,e,r){return t.set(uH(t,e),r),r}function Vr(t,e){return t.get(uH(t,e))}function uH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const q6=new Map([["plugin",rbe],["cell-type",D9],["editor",WU],["renderer",XU],["validator",QU]]),NY=Symbol("mainSetting"),qTe="base",Fb=[];let Pd=null;var en=new WeakMap,Md=new WeakMap,X6=new WeakSet;class wt{static get PLUGIN_KEY(){return qTe}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){YTe(this,X6),K6(this,en,null),Vf(this,"eventManager",new Ea(this)),Vf(this,"pluginName",null),Vf(this,"pluginsInitializedCallbacks",[]),Vf(this,"isPluginsReady",!1),Vf(this,"enabled",!1),Vf(this,"initialized",!1),K6(this,Md,{}),Fc(this,"hot",e,{writable:!1}),Pd=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[o,a]=s.split(":");if(!q6.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);q6.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Fb.push(s)}}if(Pd||(Pd=qU()),Pd.indexOf(this.pluginName)>=0&&Pd.splice(Pd.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Pd.length===0){if(Fb.length>0){const i=[`${Fb.join(`
`)}
`,"You have to import and register them manually."].join("");throw Fb.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var r=this;const n=this.constructor.DEFAULT_SETTINGS,i=this.constructor.SETTINGS_VALIDATORS;if(e===void 0)return Le(Vr(en,this))?gS(Vr(en,this),n):Vr(en,this);let s;if((Array.isArray(Vr(en,this))||Le(Vr(en,this)))&&n[NY]===e)if(Array.isArray(Vr(en,this)))s=Vr(en,this);else{var o;s=(o=Vr(en,this)[e])!==null&&o!==void 0?o:n[e]}else if(e.includes(".")){const a=sM(Vr(en,this),e),c=sM(n,e);Le(a)?s=gS(a,c):s=a!==void 0?a:c}else Le(Vr(en,this))?s=gS(Vr(en,this),n)[e]:s=n[e];if(typeof s=="function"&&i&&typeof i=="object"){const a=i[e];if(a&&typeof a=="function")return function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];const f=s(...u);if(a(f)===!1){const m=u.map(p=>typeof p=="string"?`"${p}"`:"").join(", "),g=u.length>0?m:"";nt(`${r.pluginName} Plugin: "${e}" function (${g}) result                is not valid and will be ignored.`);return}return f}}return s}updatePluginSettings(e){const r=this.constructor.SETTINGS_VALIDATORS;if(r&&typeof r=="function"&&typeof e!="object"){if(r(e)===!1){nt(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return Lb(en,this,e),Vr(en,this)}return r&&typeof r=="object"&&typeof e=="object"?((Vr(en,this)===null||typeof Vr(en,this)!="object")&&Lb(en,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(r).forEach(n=>{if(!(n in e))return;const i=r[n];if((i?i(e[n]):!0)===!1){nt(`${this.pluginName} Plugin: "${n}" option is not valid and it will be ignored.`);return}Vr(en,this)[n]=e[n]}),Vr(en,this)):(Lb(en,this,e),e)}addHook(e,r,n){Vr(Md,this)[e]=Vr(Md,this)[e]||[];const i=Vr(Md,this)[e];this.hot.addHook(e,r,n),i.push(r),Vr(Md,this)[e]=i}removeHooks(e){B(Vr(Md,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Vr(Md,this);at(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){B(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=uH(X6,this,XTe).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;Lb(en,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),at(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function XTe(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Ad(t,e,r){return(e=QTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QTe(t){var e=JTe(t,"string");return typeof e=="symbol"?e:e+""}function JTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let kY=class{constructor(e){Ad(this,"hot",null),Ad(this,"container",null),Ad(this,"injected",!1),Ad(this,"rows",[]),Ad(this,"columns",[]),Ad(this,"samples",null),Ad(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),B(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),B(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{B(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{B(s.strings,o=>{const a=o.col,c=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(c),d=r.createElement("td");d.setAttribute("ghost-table",1),u(this.hot,d,e,a,this.hot.colToProp(a),o.value,c),n.appendChild(d)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{B(i.strings,s=>{const o=s.col,a=e.createElement("th");n.push([o,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),B(n,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{B(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),c=this.hot.getCellRenderer(a),u=r.createElement("td"),d=r.createElement("tr");u.setAttribute("ghost-table",1),c(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),d.appendChild(u),n.appendChild(d)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return n.style.width=`${s}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),o=r.createElement("tbody"),a=r.createElement("colgroup"),c=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(c.appendChild(u),s.appendChild(c),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(c),i.appendChild(o),ee(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:o,colGroup:a,tr:c,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return ee(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function e0(t,e,r){return(e=ZTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZTe(t){var e=ePe(t,"string");return typeof e=="symbol"?e:e+""}function ePe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L_{static get SAMPLE_COUNT(){return 3}constructor(e){e0(this,"samples",null),e0(this,"dataFactory",null),e0(this,"customSampleCount",null),e0(this,"allowDuplicates",!1),e0(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:L_.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:o}=typeof n=="number"?{from:n,to:n}:n;return Oe(s,o,a=>{const c=this.generateSample(e,r,a);i.set(a,c)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return Oe(r.from,r.to,a=>{const c=e==="row"?this.dataFactory(n,a,this):this.dataFactory(a,n,this);if(c===!1)return;const{value:u,bundleSeed:d}=c,f=typeof d=="string"&&d.length>0;let h;f?h=d:Le(u)?h=`${Object.keys(u).length}`:Array.isArray(u)?h=`${u.length}`:h=`${sr(u).length}`,i.has(h)||i.set(h,{needed:this.getSampleCount(),strings:[]});const m=i.get(h);m.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||f)&&(m.strings.push({value:u,[s]:a}),o.push(u),m.needed-=1)}),i}}function tPe(t,e){TY(t,e),e.add(t)}function YN(t,e,r){TY(t,e),e.set(t,r)}function TY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t0(t,e,r){return(e=rPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rPe(t){var e=nPe(t,"string");return typeof e=="symbol"?e:e+""}function nPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hu(t,e){return t.get(as(t,e))}function UC(t,e,r){return t.set(as(t,e),r),r}function as(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("modifyAutoColumnSizeSeed");const GN="autoColumnSize",iPe=10,sPe="autoColumnSize";var dH=new WeakMap,_g=new WeakMap,Fm=new WeakMap,$s=new WeakSet;class gy extends wt{static get PLUGIN_KEY(){return GN}static get PLUGIN_PRIORITY(){return iPe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),tPe(this,$s),t0(this,"ghostTable",new kY(this.hot)),t0(this,"samplesGenerator",new L_((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(r,n);let a="";o.spanned||(a=this.hot.getDataAtCell(r,n));let c="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(c=this.hot.runHooks("modifyAutoColumnSizeSeed",c,o,a)),{value:a,bundleSeed:c}})),t0(this,"inProgress",!1),t0(this,"measuredColumns",0),t0(this,"columnWidthsMap",new hd),YN(this,dH,!1),YN(this,_g,[]),YN(this,Fm,[]),this.hot.columnIndexMapper.registerMap(sPe,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>as($s,this,Q6).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[GN]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return as($s,e,lPe).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return as($s,e,cPe).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return as($s,e,dPe).call(e,...i)}),this.addHook("beforeRender",()=>as($s,this,aPe).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>as($s,this,uPe).call(this)),super.enablePlugin()}updatePlugin(){UC(Fm,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>as($s,this,Q6).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;Oe(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&as($s,this,PY).call(this,o,s)}),this.ghostTable.columns.length&&(as($s,this,MY).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){NC(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+gy.CALCULATION_STEP,i)},e,r),n=n+gy.CALCULATION_STEP+1,n<i?s=EC(o):(NC(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[GN];let r=gy.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Le(e)&&(r=e.syncLimit,lU(r)?r=YU(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Om))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,s)=>{const o=Hu(_g,this).length;return(o-1<s||Hu(_g,this)[s]!==i)&&n.push(this.hot.toVisualColumn(s)),o-1<s?Hu(_g,this).push(i):Hu(_g,this)[s]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function oPe(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||as($s,this,PY).call(this,r,e))}),this.ghostTable.columns.length&&(as($s,this,MY).call(this),this.ghostTable.clean())}function PY(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function MY(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function aPe(){this.calculateVisibleColumnsWidth(),this.inProgress||(as($s,this,oPe).call(this,Hu(Fm,this)),UC(Fm,this,[]))}function lPe(t,e){e||this.recalculateAllColumnsWidth()}function cPe(t){const e=t.reduce((r,n)=>{let[,i]=n;const s=this.hot.propToCol(i);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);Hu(Fm,this).push(...e)}function Q6(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function uPe(){UC(_g,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),UC(dH,this,!0)}function dPe(t){if(!Hu(dH,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);Hu(Fm,this).push(...e)}const Rh={horizontal:"horizontal",vertical:"vertical"};function hPe(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function fPe(t){const e={};return t===!0?(e.directions=Object.keys(Rh),e.autoInsertRow=!0):Le(t)?(xe(t.autoInsertRow)?t.direction===Rh.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,xe(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Rh)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function gPe(t,e){mPe(t,e),e.add(t)}function mPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bf(t,e,r){return(e=pPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pPe(t){var e=yPe(t,"string");return typeof e=="symbol"?e:e+""}function yPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("modifyAutofillRange");_e.getSingleton().register("beforeAutofill");_e.getSingleton().register("afterAutofill");const J6="autofill",vPe=20,wPe=["fillHandle"],bPe="insert_row_below",xPe=200;var Od=new WeakSet;class SPe extends wt{constructor(){super(...arguments),gPe(this,Od),Bf(this,"addingStarted",!1),Bf(this,"mouseDownOnCellCorner",!1),Bf(this,"mouseDragOutside",!1),Bf(this,"handleDraggedCells",0),Bf(this,"directions",[]),Bf(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return J6}static get PLUGIN_PRIORITY(){return vPe}static get SETTING_KEYS(){return[J6,...wPe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Wf(Od,this,RPe).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Wf(Od,this,_Pe).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>Wf(Od,this,EPe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.hot.getSelectedRangeLast(),{row:n,col:i}=r.getTopStartCorner(),{row:s,col:o}=r.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:s,endCol:o}]),c=[],u=[],d=[];return B(a,f=>{for(let h=f.startRow;h<=f.endRow;h+=1)c.indexOf(h)===-1&&c.push(h);for(let h=f.startCol;h<=f.endCol;h+=1)u.indexOf(h)===-1&&u.push(h)}),B(c,f=>{const h=[];B(u,m=>{const g=e?this.hot.getSourceDataAtCell(f,m):null;e&&Le(g)?h.push(this.hot.getCopyableSourceData(f,m)):h.push(this.hot.getCopyableData(f,m))}),d.push(h)}),d}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const c=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(a.row,n),Math.max(a.col,i)],c),{directionOfDrag:d,startOfDragCoords:f,endOfDragCoords:h}=hPe(c,u,(m,g)=>this.hot._createCellCoords(m,g));if(f&&f.row>-1&&f.col>-1){const m=this.getSelectionData(),g=this.getSelectionData(!0),p=s.clone(),y=this.hot._createCellRange(f,f,h),w=this.hot.runHooks("beforeAutofill",m,p,y,d);if(w===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let v=w;const x=w;if(["up","left"].indexOf(d)>-1&&!(x.length===1&&x[0].length===0))if(v=[],d==="up"){const S=h.row-f.row+1,N=S%x.length;for(let R=0;R<S;R++)v.push(x[(R+(x.length-N))%x.length])}else{const S=h.col-f.col+1,N=S%x[0].length;for(let R=0;R<x.length;R++){v.push([]);for(let E=0;E<S;E++)v[R].push(x[R][(E+(x[R].length-N))%x[R].length])}}if(g.some(S=>S.some(N=>Le(N)))){const S=Wf(Od,this,CPe).call(this,v,g,f,h,d);S.length&&(v=S)}this.hot.populateFromArray(f.row,f.col,v,h.row,h.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",v,p,y,d),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(Rh.vertical)&&this.directions.includes(Rh.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(Rh.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(Rh.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(bPe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},xPe)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let c=e[1];c<=e[3];c++){const u=r[s][c];if(!qr(u))return-1}const o=r[s][e[1]-1],a=r[s][e[3]+1];(!qr(o)||!qr(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(..._t(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=xi(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+yn(this.hot.table),i=xi(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+sn(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Wf(Od,this,NPe).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>Wf(Od,this,kPe).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=fPe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function CPe(t,e,r,n){const i=[];for(let s=Math.min(r.row,n.row);s<=Math.max(r.row,n.row);s+=1){i.push([]);for(let o=Math.min(r.col,n.col);o<=Math.max(r.col,n.col);o+=1){const a=this.hot.getSourceDataAtCell(s,o),c=s-Math.min(r.row,n.row),u=o-Math.min(r.col,n.col),d=c%e.length,f=u%e[0].length;Le(a)?i[c][u]=e[d][f]:i[c][u]=t[d][f]}}return i}function _Pe(){this.selectAdjacent()&&this.fillIn()}function RPe(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function EPe(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function NPe(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function kPe(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function TPe(t,e){AY(t,e),e.add(t)}function Z6(t,e,r){AY(t,e),e.set(t,r)}function AY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zf(t,e,r){return(e=PPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PPe(t){var e=MPe(t,"string");return typeof e=="symbol"?e:e+""}function MPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OY(t,e,r){return t.set(Ls(t,e),r),r}function YC(t,e){return t.get(Ls(t,e))}function Ls(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const KN="autoRowSize",APe=40,OPe="autoRowSize",eF="htFirstDatasetColumnNotRendered",tF="htAutoRowSize";var cv=new WeakMap,hH=new WeakMap,go=new WeakSet;class my extends wt{static get PLUGIN_KEY(){return KN}static get PLUGIN_PRIORITY(){return APe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),TPe(this,go),zf(this,"headerHeight",null),zf(this,"ghostTable",new kY(this.hot)),zf(this,"samplesGenerator",new L_((r,n)=>{const i=this.hot.toPhysicalColumn(n);if(this.hot.columnIndexMapper.isHidden(i)||r>=0&&n>=0&&this.hot.getCellMeta(r,n).hidden)return!1;let s;return r>=0?s=this.hot.getDataAtCell(r,n):r===-1&&(s=this.hot.getColHeader(n)),{value:s}})),zf(this,"inProgress",!1),zf(this,"measuredRows",0),zf(this,"rowHeightsMap",new hd),Z6(this,cv,[]),Z6(this,hH,!1),this.hot.rowIndexMapper.registerMap(OPe,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>Ls(go,this,rF).call(this,r,n,i))}isEnabled(){const e=this.hot.getSettings()[KN];return e===!0||Le(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ls(go,e,$Pe).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ls(go,e,DPe).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ls(go,e,FPe).call(e,...i)}),this.addHook("beforeViewRender",()=>Ls(go,this,jPe).call(this)),this.addHook("beforeRender",()=>Ls(go,this,HPe).call(this)),this.addHook("modifyRowHeight",(n,i)=>this.getRowHeight(i,n)),this.addHook("init",()=>Ls(go,this,LPe).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),ee(this.hot.rootElement,tF),super.enablePlugin()}disablePlugin(){this.headerHeight=null,Re(this.hot.rootElement,tF),super.disablePlugin(),Ls(go,this,IY).call(this,!1),this.addHook("beforeRowResize",(e,r,n)=>Ls(go,this,rF).call(this,e,r,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:r},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}Oe(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(n||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,d)=>this.ghostTable.addRow(d,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){NC(s),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+my.CALCULATION_STEP,i)},e,r),n=n+my.CALCULATION_STEP+1,n<i?s=EC(o):(NC(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,r),n=a+1),n<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[KN];let r=my.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return Le(e)&&(r=e.syncLimit,lU(r)?r=YU(n,r):r>>=0),Math.min(r,n)}getRowHeight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight(e);if(e<0){var n;return(n=this.headerHeight)!==null&&n!==void 0?n:r}const i=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(i))return r;const s=this.rowHeightsMap.getValueAtIndex(i);let o=r;return s!==null&&s>r&&(o=s,!this.hot.stylesHandler.isClassicTheme()&&e===this.hot.view.getFirstRenderedVisibleRow()&&(o+=1)),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Oe(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function IPe(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{const i=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function IY(t){const e=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);t===!1||r===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?Re(this.hot.rootElement,eF):ee(this.hot.rootElement,eF)}function jPe(){Ls(go,this,IY).call(this)}function HPe(){this.calculateVisibleRowsHeight(),this.inProgress||(Ls(go,this,IPe).call(this,YC(cv,this)),OY(cv,this,[]))}function rF(t,e,r){let n=t;return r&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function $Pe(t,e){e||this.recalculateAllRowsHeight()}function DPe(t){const e=t.reduce((r,n)=>{let[i]=n;return r.indexOf(i)===-1&&r.push(i),r},[]);YC(cv,this).push(...e)}function LPe(){this.recalculateAllRowsHeight(),OY(hH,this,!0)}function FPe(t){if(!YC(hH,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);YC(cv,this).push(...e)}const{getListWithInsertedItems:VPe,getListWithRemovedItems:BPe}=v9("physicallyIndexed");class WPe extends bf{constructor(){super(e=>e)}insert(e,r){const n=QI(this.indexedValues,r);this.indexedValues=VPe(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=BPe(this.indexedValues,e);this.indexedValues=XI(r,e),super.remove(e)}}const{getListWithInsertedItems:zPe,getListWithRemovedItems:UPe}=v9("physicallyIndexed");class YPe extends bf{constructor(){super(e=>e)}insert(e,r){this.indexedValues=zPe(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=UPe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function GPe(t,e){KPe(t,e),e.add(t)}function KPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qPe(t,e,r){return(e=XPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XPe(t){var e=QPe(t,"string");return typeof e=="symbol"?e:e+""}function QPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JPe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const nF="bindRowsWithHeaders",ZPe=210,eMe="loose",iF=new Map([["loose",WPe],["strict",YPe]]);var sF=new WeakSet;class tMe extends wt{constructor(){super(...arguments),GPe(this,sF),qPe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return nF}static get PLUGIN_PRIORITY(){return ZPe}isEnabled(){return!!this.hot.getSettings()[nF]}enablePlugin(){var e;if(this.enabled)return;const r=(e=iF.get(this.getSetting()))!==null&&e!==void 0?e:iF.get(eMe);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>JPe(sF,this,rMe).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function rMe(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function nMe(t,e){jY(t,e),e.add(t)}function iMe(t,e,r){jY(t,e),e.set(t,r)}function jY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oF(t,e,r){return(e=sMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sMe(t){var e=oMe(t,"string");return typeof e=="symbol"?e:e+""}function oMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aF(t,e){return t.get(Gg(t,e))}function qN(t,e,r){return t.set(Gg(t,e),r),r}function Gg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const xS="collapsibleColumns",aMe=290,lMe=["nestedHeaders"],gm="collapsibleIndicator",lF=xS,cF=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Uf=new WeakMap,r0=new WeakSet;class cMe extends wt{constructor(){super(...arguments),nMe(this,r0),oF(this,"nestedHeadersPlugin",null),oF(this,"headerStateManager",null),iMe(this,Uf,null)}static get PLUGIN_KEY(){return xS}static get PLUGIN_PRIORITY(){return aMe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[xS,...lMe]}isEnabled(){return!!this.hot.getSettings()[xS]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||nt("You need to configure the Nested Headers plugin in order to use collapsible headers."),qN(Uf,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Gg(r0,this,hMe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Gg(r0,e,fMe).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Gg(r0,e,uMe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>Gg(r0,this,dMe).call(this,n,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),qN(Uf,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:n}=this.hot.getSelectedRangeActive().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,n))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight.isHeader())},group:lF,relativeToGroup:fd,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lF)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};Oe(0,e-1,o=>{const a=r.childNodes[o],c=n.childNodes[o],u=i?i.childNodes[o]:null;Oe(0,a.childNodes.length-1,d=>{let f=a.childNodes[d].querySelector(`.${gm}`);s(f),c&&c.childNodes[d]&&(f=c.childNodes[d].querySelector(`.${gm}`),s(f)),i&&u&&u.childNodes[d]&&(f=u.childNodes[d].querySelector(`.${gm}`),s(f))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:c}=n;if(i===!0&&s>1&&(c&&e==="expand"||!c&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!cF.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=Kh(e,m=>{let{row:g}=m;return g<0});let i=n.length>0;B(n,m=>{var g;let{row:p,col:y}=m;const{collapsible:w,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(p,y))!==null&&g!==void 0?g:{};if(!w||v&&r==="collapse"||!v&&r==="expand")return i=!1,!1});const s=[],o=[];i&&B(n,m=>{let{row:g,col:p}=m;const{colspanCompensation:y,affectedColumns:w,rollbackModification:v}=this.headerStateManager.triggerNodeModification(r,g,p);y>0&&(o.push(...w),s.push(v))});const a=this.getCollapsedColumns();let c=[];r==="collapse"?c=D0e([...a,...o]):r==="expand"&&(c=Kh(a,m=>!o.includes(m)));const u=cF.get(r);if(this.hot.runHooks(u.beforeHook,a,c,i)===!1){B(s,m=>{m()});return}this.hot.batchExecution(()=>{B(o,m=>{aF(Uf,this).setValueAtIndex(this.hot.toPhysicalColumn(m),u.hideColumn)})},!0);const f=this.getCollapsedColumns().length!==a.length,h=this.hot.getSelectedRangeActive();if(r==="collapse"&&f&&h){const{row:m,col:g}=h.highlight;if((this.hot.rowIndexMapper.isHidden(m)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const y=m>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(m,1,!0):m,w=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&w!==null&&this.hot.selectCell(y,w)}}this.hot.runHooks(u.afterHook,a,c,i,f),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return aF(Uf,this).getHiddenIndexes()}destroy(){qN(Uf,this,null),super.destroy()}}function uMe(t,e,r){var n;const{collapsible:i,origColspan:s,isCollapsed:o}=(n=this.headerStateManager.getHeaderSettings(r,t))!==null&&n!==void 0?n:{},a=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,c=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${gm}`);if(_c(e,[ko("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ee(u,gm),e.querySelector("div:first-child").appendChild(u)),Re(u,["collapsed","expanded"]),o?(ee(u,"collapsed"),Xh(u,"+"),c&&Ne(e,...ko(!1))):(ee(u,"expanded"),Xh(u,"-"),c&&Ne(e,...ko(!0))),c&&Ne(u,...yf());else{var d;(d=u)===null||d===void 0||d.remove()}}function dMe(t,e){Ve(t.target,gm)&&(Ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ao(t))}function hMe(){this.updatePlugin()}function fMe(t,e){e||this.updatePlugin()}function Id(t,e,r){return(e=gMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gMe(t){var e=mMe(t,"string");return typeof e=="symbol"?e:e+""}function mMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pMe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],yMe=!1,vMe=!0,wMe=!0;class bMe{constructor(e,r){Id(this,"hot",void 0),Id(this,"sortingStates",new P_),Id(this,"sortEmptyCells",yMe),Id(this,"indicator",vMe),Id(this,"headerAction",wMe),Id(this,"compareFunctionFactory",void 0),Id(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){Le(e)&&at(e,(r,n)=>{pMe.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Le(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(xe(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function HY(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:o}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?El:qr(i)?qr(s)?El:o&&t==="asc"?Ar:Or:qr(s)?o&&t==="asc"?Or:Ar:isNaN(i)&&!isNaN(s)?t==="asc"?Or:Ar:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?Ar:Or:i>s?t==="asc"?Or:Ar:El}}const $Y="default";function xMe(t,e,r){return function(n,i){const s=parseFloat(n),o=parseFloat(i),{sortEmptyCells:a}=r;if(s===o||isNaN(s)&&isNaN(o))return El;if(a){if(qr(n))return t==="asc"?Ar:Or;if(qr(i))return t==="asc"?Or:Ar}return isNaN(s)?Or:isNaN(o)?Ar:s<o?t==="asc"?Ar:Or:s>o?t==="asc"?Or:Ar:El}}const SMe="numeric";function CMe(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(o,a){const c=qr(o),u=qr(a),d=c?i:o,f=u?i:a,h=d===i||d===n,m=f===i||f===n;if(s===!1){if(c&&u===!1)return Or;if(c===!1&&u)return Ar}return h===!1&&m?t==="asc"?Ar:Or:h&&m===!1?t==="asc"?Or:Ar:h===!1&&m===!1?HY(t,e,r)(o,a):d===i&&f===n?t==="asc"?Ar:Or:d===n&&f===i?t==="asc"?Or:Ar:El}}const _Me="checkbox";function RMe(t,e,r){return WY(t,e.dateFormat,r)}const EMe="date";function NMe(t,e,r){return WY(t,e.timeFormat,r)}const kMe="time",{register:tw,getItem:uF,hasItem:TMe}=$o("sorting.compareFunctionFactory"),{register:DY,getItem:PMe}=$o("sorting.mainSortComparator");function LY(t){return TMe(t)?uF(t):uF($Y)}tw(_Me,CMe);tw(EMe,RMe);tw($Y,HY);tw(SMe,xMe);tw(kMe,NMe);const El=0,Ar=-1,Or=1;function MMe(t,e){const r=PMe(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}const GC="asc",KC="desc",FY="colHeader";function AMe(t){if(Le(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[GC,KC].includes(r)}function OMe(t){if(t.some(r=>AMe(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function dF(t){if(t!==KC)return t===GC?KC:GC}function VY(t){return t.querySelector(`.${FY}`)}function BY(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function fH(t,e,r){return t===-1&&e>=0&&Jh(r)===!1}function WY(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return El;if(qr(n))return qr(i)?El:s&&t==="asc"?Ar:Or;if(qr(i))return s&&t==="asc"?Or:Ar;const o=ce(n,e),a=ce(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?Ar:Or:a.isBefore(o)?t==="asc"?Or:Ar:El:Ar:Or}}function IMe(t,e){nt(Rt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const jMe="ascending",HMe="descending",zY="indicatorDisabled",UY="columnSorting",YY="sortAction",GY=new Map([[GC,jMe],[KC,HMe]]);function $Me(t,e,r,n){const i=[UY];if(n&&i.push(YY),r===!1)return i.push(zY),i;const s=t.getSortOrderOfColumn(e);return xe(s)&&i.push(GY.get(s)),i}function DMe(){return Array.from(GY.values()).concat(YY,zY,UY)}function LMe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(a){const c=t[a],u=e[a],d=i[a],f=s[a],h=u.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:LY(u.type))(c,u,h)(d,f)}(0)}}function FMe(t,e){VMe(t,e),e.add(t)}function VMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vb(t,e,r){return(e=BMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BMe(t){var e=WMe(t,"string");return typeof e=="symbol"?e:e+""}function WMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const qC="columnSorting",zMe=50,XC="append",UMe="replace",hF=qC;DY(qC,LMe);_e.getSingleton().register("beforeColumnSort");_e.getSingleton().register("afterColumnSort");const n0=new WeakMap;var ah=new WeakSet;class KY extends wt{constructor(){super(...arguments),FMe(this,ah),Vb(this,"columnStatesManager",null),Vb(this,"columnMetaCache",null),Vb(this,"pluginKey",qC),Vb(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return qC}static get PLUGIN_PRIORITY(){return zMe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(n0.has(this.hot)&&n0.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),IMe(n0.get(this.hot),this.pluginKey);return}this.enabled||(n0.set(this.hot,this.pluginKey),this.columnStatesManager=new bMe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new hd(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>Rg(ah,this,YMe).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Rg(ah,e,KMe).call(e,...n)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>Rg(ah,this,MM).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Rg(ah,e,GMe).call(e,...n)}),this.hot.view&&Rg(ah,this,MM).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=VY(n);BY(r,n)===!1||i===null||this.updateHeaderClasses(i)};n0.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:fd,position:"before",group:hF})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hF)}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new w9),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return xe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return OMe(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};r.initialConfig=_t(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return xe(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=_t(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(xe(r)){const i=dF(r);return xe(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:dF()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XC;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(fr(o))return[...s.slice(0,n),...s.slice(n+1)];if(r===XC)return[...s.slice(0,n),...s.slice(n+1),o];if(r===UMe)return[...s.slice(0,n),o,...s.slice(n+1)]}return xe(o)?s.concat(o):s}getPluginColumnConfig(e){if(Le(e)){const r=e[this.pluginKey];if(Le(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):Tt(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],n=this.hot.countRows(),i=u=>_t(e,d=>this.hot.getDataAtCell(u,d.column));for(let u=0;u<this.getNumberOfRowsToSort(n);u+=1)r.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=_t(r,u=>u[0]);MMe(r,this.pluginKey,_t(e,u=>u.sortOrder),_t(e,u=>this.getFirstCellSettings(u.column)));for(let u=r.length;u<n;u+=1)r.push([u].concat(i(u)));const o=_t(r,u=>u[0]),a=new Map(_t(s,(u,d)=>[u,o[d]])),c=_t(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(c)}sortBySettings(e){if(Le(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||Le(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(Re(e,DMe()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];ee(e,$Me(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),xe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&Ve(e.target,FY)}onAfterOnCellMouseDown(e,r){if(fH(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const n=this.hot.getActiveEditor(),i=this.getColumnNextConfig(r.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function MM(){const t=this.getAllSavedSortSettings();if(Le(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function YMe(t,e){const r=VY(e);if(BY(t,e)===!1||r===null)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);Ne(e,...uye(o?`${o}ending`:"none"))}}function GMe(t){t===!0&&this.hot.view&&Rg(ah,this,MM).call(this)}function KMe(t,e,r,n){fH(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function XN(t){return t==null||isNaN(t)}function qMe(t,e){if(typeof t!="number")return t;const r=n=>n.toString();switch(typeof e){case"number":return r(t.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?r(Math.round(t)):t;case"string":if(e==="auto"){const n=Math.round(t).toString().length;return r(t.toFixed(8-n))}return t;default:return t}}function jd(t,e,r){return(e=XMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XMe(t){var e=QMe(t,"string");return typeof e=="symbol"?e:e+""}function QMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JMe{constructor(e,r){jd(this,"plugin",void 0),jd(this,"hot",void 0),jd(this,"endpoints",[]),jd(this,"settings",void 0),jd(this,"settingsType","array"),jd(this,"currentEndpoint",null),jd(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),B(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();B(s,o=>{i==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=n:e==="remove_row"&&(o.alterRowOffset=-1*n)),i==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=n:e==="remove_col"&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(s==="auto")return;if(this.settingsType==="function"){const h=()=>(this.hot.removeHook("beforeViewRender",h),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",h);return}const a=e.indexOf("row")>-1?"row":"col",c=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),d=e.indexOf("move_row")===0,f=r;B(u,h=>{a==="row"&&h.destinationRow>=f&&(h.alterRowOffset=c*n),a==="col"&&h.destinationColumn>=f&&(h.alterColumnOffset=c*n)}),this.resetAllEndpoints(u,!d),d?B(u,h=>{this.extendEndpointRanges(h,f,i[0],i.length),this.recreatePhysicalRanges(h),this.clearOffsetInformation(h)}):B(u,h=>{this.shiftEndpointCoordinates(h,f)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){B(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];B(r,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),B(i,s=>{let o=[];B(s,(a,c)=>{c===0?o.push(a):s[c]!==s[c-1]+1&&(o.push(s[c-1]),n.push(o),o=[],o.push(a)),c===s.length-1&&(o.push(a),n.push(o))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,B(e.ranges,n=>{B(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],B(e,i=>{this.resetEndpointValue(i,r)}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],B(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],B(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&B(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&r.indexOf(a)===-1&&r.push(a)})}),B(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const n=this.hot.getCellMeta(r,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}e.result=qMe(e.result,e.roundFloat),n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){nt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function ZMe(t,e){eAe(t,e),e.add(t)}function eAe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tAe(t,e,r){return(e=rAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rAe(t){var e=nAe(t,"string");return typeof e=="symbol"?e:e+""}function nAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const QN="columnSummary",iAe=220;var Hd=new WeakSet;class sAe extends wt{constructor(){super(...arguments),ZMe(this,Hd),tAe(this,"endpoints",null)}static get PLUGIN_KEY(){return QN}static get PLUGIN_PRIORITY(){return iAe}isEnabled(){return!!this.hot.getSettings()[QN]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[QN],this.endpoints=new JMe(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yf(Hd,e,oAe).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yf(Hd,e,lAe).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yf(Hd,e,aAe).call(e,...n)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yf(Hd,e,cAe).call(e,...n)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yf(Hd,e,uAe).call(e,...n)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yf(Hd,e,dAe).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return at(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,r),s=XN(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,r){let n=null;return at(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,r),o=XN(o)?null:o,i===null)i=o;else if(o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=XN(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return at(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);r+=s,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),o="";if(n!==null&&i!==null&&(o=this.hot.getCellMeta(n,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Rt`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function oAe(){this.endpoints.initEndpoints()}function aAe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function lAe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function cAe(t,e){e||this.endpoints.refreshAllEndpoints()}function uAe(t,e){e||this.endpoints.refreshAllEndpoints()}function dAe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function hAe(t,e){qY(t,e),e.add(t)}function JN(t,e,r){qY(t,e),e.set(t,r)}function qY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eg(t,e){return t.get(gH(t,e))}function AM(t,e,r){return t.set(gH(t,e),r),r}function gH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var QC=new WeakMap,Bb=new WeakMap,Wb=new WeakMap,fF=new WeakSet;class XY{constructor(){hAe(this,fF),JN(this,QC,!0),JN(this,Bb,null),JN(this,Wb,new ResizeObserver(e=>gH(fF,this,fAe).call(this,e)))}setObservedElement(e){AM(Bb,this,e)}unobserve(){Eg(Wb,this).unobserve(Eg(Bb,this))}observe(){AM(QC,this,!0),Eg(Wb,this).observe(Eg(Bb,this))}destroy(){Eg(Wb,this).disconnect()}}function fAe(t){if(Eg(QC,this)||!Array.isArray(t)||!t.length){AM(QC,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:n,blockSize:i}=r[0];this.runLocalHooks("resize",n,i)})}Ht(XY,Mn);function Zc(t,e,r){gAe(t,e),e.set(t,r)}function gAe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(QY(t,e))}function za(t,e,r){return t.set(QY(t,e),r),r}function QY(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Gf=new WeakMap,ZN=new WeakMap,ek=new WeakMap,Kl=new WeakMap,eu=new WeakMap,tu=new WeakMap,zb=new WeakMap,Kf=new WeakMap;class Eh{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r,n){var i=this;Zc(this,Gf,void 0),Zc(this,ZN,void 0),Zc(this,ek,!1),Zc(this,Kl,null),Zc(this,eu,void 0),Zc(this,tu,void 0),Zc(this,zb,!0),Zc(this,Kf,new XY),za(Gf,this,e),za(ZN,this,n),za(ek,this,r),za(eu,this,this.createEditor()),za(tu,this,Vt(eu,this).style),Vt(Kf,this).setObservedElement(this.getInputElement()),Vt(Kf,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,r){Vt(tu,this).left=`${e}px`,Vt(tu,this).top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:sn(this.getInputElement()),height:yn(this.getInputElement())}}observeSize(){Vt(Kf,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){Vt(tu,this).display="block",za(zb,this,!1)}hide(){Vt(Kf,this).unobserve(),Vt(zb,this)||(Vt(tu,this).display="none"),za(zb,this,!0)}isVisible(){return Vt(tu,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return Vt(Gf,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Vt(Gf,this).createElement("div"),r=Vt(Gf,this).createElement("textarea");return e.style.display="none",za(Kl,this,Vt(Gf,this).createElement("div")),Vt(Kl,this).setAttribute("dir",Vt(ek,this)?"rtl":"ltr"),ee(Vt(Kl,this),Eh.CLASS_EDITOR_CONTAINER),Vt(ZN,this).appendChild(Vt(Kl,this)),ee(e,Eh.CLASS_EDITOR),ee(r,Eh.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),Vt(Kl,this).appendChild(e),e}getInputElement(){return Vt(eu,this).querySelector(`.${Eh.CLASS_INPUT}`)}getEditorElement(){return Vt(eu,this)}destroy(){const e=Vt(Kl,this)?Vt(Kl,this).parentNode:null;Vt(eu,this).parentNode.removeChild(Vt(eu,this)),za(eu,this,null),za(tu,this,null),Vt(Kf,this).destroy(),e&&e.removeChild(Vt(Kl,this))}}Ht(Eh,Mn);function tk(t,e,r){return(e=mAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mAe(t){var e=pAe(t,"string");return typeof e=="symbol"?e:e+""}function pAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yAe=250,vAe=250;class JY{constructor(e){tk(this,"wasLastActionShow",!0),tk(this,"showDebounced",null),tk(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},vAe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yAe;this.showDebounced=R_(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}Ht(JY,Mn);function wAe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function bAe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function $d(t,e){const r={};return B(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function vu(t,e,r,n,i){B(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&xAe(o,a,e,r,n,i)})})}function xAe(t,e,r,n,i,s){const o=i(t,e);let a=n;o.className&&(r==="vertical"?a=wAe(o.className,n):a=bAe(o.className,n)),s(t,e,"className",a)}function ZY(t){return`<span class="selected"></span>${t}`}function SS(t,e){let r=!1;return Array.isArray(t)&&B(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function F_(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:s}=n.getBoundingClientRect();r.top=i,r.left=s}return r}const ot="---------";function SAe(){return{name:ot}}const yo="alignment";function CAe(){return{key:yo,name(){return this.getTranslatedPhrase(_2)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${yo}:left`,name(){return this.getTranslatedPhrase(R2)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),vu(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${yo}:center`,name(){return this.getTranslatedPhrase(E2)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),vu(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${yo}:right`,name(){return this.getTranslatedPhrase(N2)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),vu(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${yo}:justify`,name(){return this.getTranslatedPhrase(k2)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),vu(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:ot},{key:`${yo}:top`,name(){return this.getTranslatedPhrase(T2)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),vu(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${yo}:middle`,name(){return this.getTranslatedPhrase(P2)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),vu(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${yo}:bottom`,name(){return this.getTranslatedPhrase(M2)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),vu(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const V_="clear_column";function _Ae(){return{key:V_,name(){return this.getTranslatedPhrase(u2)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const rw="col_left";function RAe(){return{key:rw,name(){return this.getTranslatedPhrase(i2)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const nw="col_right";function EAe(){return{key:nw,name(){return this.getTranslatedPhrase(s2)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const iw="make_read_only";function NAe(){return{key:iw,checkable:!0,ariaChecked(){return SS(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(OC)},name(){let t=this.getTranslatedPhrase(OC);return SS(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=ZY(t)),t},callback(){const t=this.getSelectedRange(),e=SS(t,(r,n)=>this.getCellMeta(r,n).readOnly);B(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const B_="redo";function kAe(){return{key:B_,name(){return this.getTranslatedPhrase(c2)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const sw="remove_col";function TAe(){return{key:sw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(a2,e)},callback(){this.alter("remove_col",n_e(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const W_="remove_row";function PAe(){return{key:W_,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(o2,e)},callback(){this.alter("remove_row",i_e(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const z_="row_above";function MAe(){return{key:z_,name(){return this.getTranslatedPhrase(r2)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const U_="row_below";function AAe(){return{key:U_,name(){return this.getTranslatedPhrase(n2)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const uv="no_items";function OAe(){return{key:uv,name(){return this.getTranslatedPhrase(t2)},disabled:!0,isCommand:!1}}const Y_="undo";function IAe(){return{key:Y_,name(){return this.getTranslatedPhrase(l2)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const jAe=[z_,U_,rw,nw,V_,W_,sw,Y_,B_,iw,yo,ot,uv],HAe={[ot]:SAe,[uv]:OAe,[z_]:MAe,[U_]:AAe,[rw]:RAe,[nw]:EAe,[V_]:_Ae,[W_]:PAe,[sw]:TAe,[Y_]:IAe,[B_]:kAe,[iw]:NAe,[yo]:CAe};function eG(){const t={};return at(HAe,(e,r)=>{t[r]=e()}),t}function $Ae(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(x2):this.getTranslatedPhrase(b2)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function DAe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(S2)},callback(){this.getSelectedRangeActive().forAll((r,n)=>{r>=0&&n>=0&&t.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function LAe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(C2);return SS(this.getSelectedRange(),(n,i)=>t.getCommentMeta(n,i,CS))?ZY(e):e},callback(){this.getSelectedRangeActive().forAll((r,n)=>{if(r>=0&&n>=0){const i=!!t.getCommentMeta(r,n,CS);t.updateCommentMeta(r,n,{[CS]:!i})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function FAe(t,e){tG(t,e),e.add(t)}function Dd(t,e,r){tG(t,e),e.set(t,r)}function tG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VAe(t,e,r){return(e=BAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BAe(t){var e=WAe(t,"string");return typeof e=="symbol"?e:e+""}function WAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wl(t,e,r){return t.set(Rn(t,e),r),r}function tt(t,e){return t.get(Rn(t,e))}function Rn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const JC="comments",zAe=60,ac="comment",W0="value",rG="style",CS="readOnly",i0=JC,OM=`plugin:${JC}`;var Wt=new WeakMap,ll=new WeakMap,G_=new WeakMap,_S=new WeakMap,ZC=new WeakMap,IM=new WeakMap,e1=new WeakMap,Dn=new WeakSet;class UAe extends wt{constructor(){super(...arguments),FAe(this,Dn),VAe(this,"range",{}),Dd(this,Wt,null),Dd(this,ll,null),Dd(this,G_,!1),Dd(this,_S,!1),Dd(this,ZC,!1),Dd(this,IM,null),Dd(this,e1,"")}static get PLUGIN_KEY(){return JC}static get PLUGIN_PRIORITY(){return zAe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[JC]}enablePlugin(){var e=this;this.enabled||(tt(Wt,this)||(wl(Wt,this,new Eh(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),tt(Wt,this).addLocalHook("resize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Rn(Dn,e,ZAe).call(e,...n)}),this.hot.addHook("afterSetTheme",(r,n)=>{n||this.hide()})),tt(ll,this)||wl(ll,this,new JY(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,i,s,o,a)=>Rn(Dn,this,XAe).call(this,r,a)),this.addHook("afterScroll",()=>Rn(Dn,this,eOe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>Rn(Dn,this,gF).call(this,r)),this.addHook("beforeCompositionStart",r=>Rn(Dn,this,gF).call(this,r)),tt(ll,this).addLocalHook("hide",()=>this.hide()),tt(ll,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){tt(ll,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),n=e.addContext(OM);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeActive();wl(_S,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(OM),this.hot._registerTimeout(()=>{wl(_S,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isCell()},group:i0}),n.addShortcut({keys:[["Escape"]],callback:()=>{tt(Wt,this).setValue(tt(e1,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>tt(Wt,this).isVisible()&&tt(Wt,this).isFocused(),group:i0}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>tt(Wt,this).isVisible()&&tt(Wt,this).isFocused(),group:i0}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{wl(ZC,this,!0),tt(Wt,this).setValue(tt(Wt,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:i0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(i0)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>Rn(Dn,this,KAe).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>Rn(Dn,this,YAe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Rn(Dn,this,qAe).call(this)),this.eventManager.addEventListener(r,"focus",()=>Rn(Dn,this,JAe).call(this)),this.eventManager.addEventListener(r,"blur",()=>Rn(Dn,this,QAe).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",n=>Rn(Dn,this,GAe).call(this,n))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=qh(e.target,"TD","TBODY");return!!(r&&Ve(r,"htCommentCell")&&qh(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=tt(Wt,this).getValue();let n="";e!=null?n=e:r!=null&&(n=r);const{row:i,col:s}=Rn(Dn,this,Ng).call(this);this.updateCommentMeta(i,s,{[W0]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:r,col:n}=Rn(Dn,this,Ng).call(this);this.hot.setCellMeta(r,n,ac),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const{row:e,col:r}=Rn(Dn,this,Ng).call(this);return this.getCommentMeta(e,r,W0)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,W0)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:r,col:n}=Rn(Dn,this,Ng).call(this);if(r<0||r>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(r,n);return tt(ll,this).cancelHiding(),tt(Wt,this).setValue((e=i[ac]?i[ac][W0]:null)!==null&&e!==void 0?e:""),tt(Wt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){tt(Wt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!tt(Wt,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:n}=this.hot,{row:i,col:s}=Rn(Dn,this,Ng).call(this);let o=r.getRenderableFromVisualIndex(i),a=n.getRenderableFromVisualIndex(s);const c=o===null;tt(Wt,this).setPosition(0,0),o===null&&(o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1))),a===null&&(a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,-1)));const u=o===null,d=a===null;o=o??0,a=a??0;const{rootWindow:f,view:{_wt:h}}=this.hot,{wtTable:m}=h,g=h.getCell({row:o,col:a},!0),p=this.getCommentMeta(i,s,rG);p?tt(Wt,this).setSize(p.width,p.height):tt(Wt,this).resetSize();const y=d?0:m.getColumnWidth(a),w=c&&!u?yn(g):0,{left:v,top:x,width:S,height:N}=g.getBoundingClientRect(),{width:R,height:E}=tt(Wt,this).getSize(),{innerWidth:P,innerHeight:D}=this.hot.rootWindow,H=this.hot.rootDocument.documentElement,Z=on(this.hot.rootDocument),I=AU(this.hot.rootWindow)?Z:0,Y=OU(this.hot.rootWindow)?Z:0;let re=v+f.scrollX+y,ne=x+f.scrollY+w;this.hot.isRtl()&&(re-=R+y),this.hot.isLtr()&&v+S+R>P-I?re=v+f.scrollX-R-1:this.hot.isRtl()&&re<-(H.scrollWidth-H.clientWidth)&&(re=v+f.scrollX+y+1),x+E>D-Y&&(ne-=E-N+1),tt(Wt,this).setPosition(re,ne),tt(Wt,this).setReadOnlyState(this.getCommentMeta(i,s,CS)),tt(Wt,this).observeSize()}focusEditor(){tt(Wt,this).focus()}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[ac];let s;i?(s=Bi(i),b_(s,n)):s=n,this.hot.setCellMeta(e,r,ac,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[ac])return i[ac][n]}addToContextMenu(e){e.items.push({name:ot},$Ae(this),DAe(this),LAe(this))}getEditorInputElement(){return tt(Wt,this).getInputElement()}destroy(){var e,r;(e=tt(Wt,this))===null||e===void 0||e.destroy(),(r=tt(ll,this))===null||r===void 0||r.destroy(),super.destroy()}}function YAe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!tt(G_,this)&&!this.targetIsCommentTextArea(t)){const e=qh(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function GAe(t){t.stopPropagation()}function KAe(t){const{rootDocument:e}=this.hot;if(!(tt(G_,this)||tt(Wt,this).isFocused()||Ve(t.target,"wtBorder")||tt(IM,this)===t.target||!tt(Wt,this)))if(wl(IM,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));tt(ll,this).show(r)}else Dh(t.target,e)&&!this.targetIsCommentTextArea(t)&&tt(ll,this).hide()}function qAe(){wl(G_,this,!1)}function XAe(t,e){e[ac]&&e[ac][W0]&&ee(t,e.commentedCellClassName)}function QAe(){if(tt(ZC,this)){wl(ZC,this,!1);return}wl(e1,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function JAe(){wl(e1,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(OM)}function ZAe(t,e){const{row:r,col:n}=Rn(Dn,this,Ng).call(this);this.updateCommentMeta(r,n,{[rG]:{width:t,height:e}})}function gF(t){tt(Wt,this).isFocused()&&Ao(t)}function eOe(){tt(_S,this)||this.hide()}function Ng(){return this.range instanceof rp?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function rk(t,e,r){return(e=tOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tOe(t){var e=rOe(t,"string");return typeof e=="symbol"?e:e+""}function rOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nG{constructor(e){rk(this,"hot",void 0),rk(this,"commands",{}),rk(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let c=this.commands[o];if(!c)throw new Error(`Menu command '${o}' not exists.`);if(a&&c.submenu&&(c=nOe(a,c.submenu.items)),c.disabled===!0||typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0||Kr(c,"submenu"))return;const u=[];typeof c.callback=="function"&&u.push(c.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(s.join(":")),B(u,d=>d.apply(this.hot,n))}}function nOe(t,e){let r;return B(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function nk(t,e,r){return(e=iOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iOe(t){var e=sOe(t,"string");return typeof e=="symbol"?e:e+""}function sOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iG{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;nk(this,"hot",void 0),nk(this,"predefinedItems",eG()),nk(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,at(e,(n,i)=>{let s="";n.name===ot?(r[ot]=n,s=ot):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return oOe(e,this.defaultOrderPattern,this.predefinedItems)}}function oOe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Le(i)?at(i,(s,o)=>{let a=r[typeof s=="string"?s:o];a||(a=s),Le(s)?vn(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),n.push(a)}):B(i,(s,o)=>{let a=r[s];!a&&jAe.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),Le(s)&&vn(a,s),a.key===void 0&&(a.key=o),n.push(a))}),n}function ru(t,e,r){return(e=aOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aOe(t){var e=lOe(t,"string");return typeof e=="symbol"?e:e+""}function lOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cOe{constructor(e,r){ru(this,"top",void 0),ru(this,"topRelative",void 0),ru(this,"left",void 0),ru(this,"leftRelative",void 0),ru(this,"scrollTop",void 0),ru(this,"scrollLeft",void 0),ru(this,"cellHeight",void 0),ru(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let s,o,a,c,u,d;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,d=e.width||0,o=s,c=a,s+=n,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,d=e.target.clientWidth,o=s-n,c=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=c,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=d}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function s0(t,e,r){uOe(t,e),e.set(t,r)}function uOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xe(t,e){return t.get(sG(t,e))}function Ub(t,e,r){return t.set(sG(t,e),r),r}function sG(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ni=new WeakMap,Ji=new WeakMap,Zi=new WeakMap,ik=new WeakMap,qf=new WeakMap;class dOe{constructor(e){s0(this,Ni,void 0),s0(this,Ji,void 0),s0(this,Zi,void 0),s0(this,ik,!1),s0(this,qf,{above:0,below:0,left:0,right:0}),Ub(ik,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Xe(qf,this)[e]=r,this}setElement(e){return Ub(Ni,this,e),this}setParentElement(e){return Ub(Ji,this,e),this}updatePosition(e){Ub(Zi,this,new cOe(e,Xe(Ni,this).ownerDocument.defaultView)),Xe(ik,this)?(Xe(Zi,this).fitsBelow(Xe(Ni,this))?this.setPositionBelowCursor():Xe(Zi,this).fitsAbove(Xe(Ni,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Xe(Ni,this).dir==="rtl"?Xe(Zi,this).fitsOnLeft(Xe(Ni,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Xe(Zi,this).fitsOnRight(Xe(Ni,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Xe(qf,this).above+Xe(Zi,this).top-Xe(Ni,this).offsetHeight;if(Xe(Ji,this)){const n=Xe(Ji,this).ownerDocument.defaultView.getComputedStyle(Xe(Ji,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=Xe(Zi,this).top+Xe(Zi,this).cellHeight-Xe(Ni,this).scrollHeight+i+s}Xe(Ni,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Xe(qf,this).below+Xe(Zi,this).top+1;if(Xe(Ji,this)){const n=Xe(Ji,this).ownerDocument.defaultView.getComputedStyle(Xe(Ji,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=Xe(Zi,this).top-i-s}Xe(Ni,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Xe(Zi,this).left;if(Xe(Ji,this)){const r=Xe(Ji,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(Xe(Ji,this).querySelector(".htCore")).borderRightWidth,10);e+=Xe(Zi,this).cellWidth+n}else e+=Xe(qf,this).right;Xe(Ni,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Xe(qf,this).left+Xe(Zi,this).left-Xe(Ni,this).offsetWidth;if(Xe(Ji,this)){const r=Xe(Ji,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(Xe(Ji,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}Xe(Ni,this).style.left=`${e}px`}}function oG(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const s=new Set;let o=ut(e,-1,p()-1);function a(w,v){const x=p()-1;return w<0&&(w=x),w>x&&(w=0),s.has(w)?-1:(s.add(w),n(w,!1)===!1&&(w=a(v===1?++w:--w,v)),w)}function c(w){w>-1&&w<p()&&n(w,!0)!==!1&&(o=w)}function u(w){w>-1&&w<p()&&(o=w)}function d(){return o}function f(){p()>0&&(s.clear(),o=a(0,1))}function h(){p()>0&&(s.clear(),o=a(p()-1,-1))}function m(){p()>0&&(s.clear(),o=a(++o,1))}function g(){p()>0&&(s.clear(),o=a(--o,-1))}function p(){return Math.max(r(),0)}function y(){s.clear(),o=e,i()}return{setCurrentPage:c,setPageCursorAt:u,getCurrentPage:d,toFirstItem:f,toLastItem:h,toNextItem:m,toPreviousItem:g,getSize:p,clear:y}}function hOe(t){return _t(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function jM(t){return Kr(t,"submenu")}function HM(t){return new RegExp(ot,"i").test(t.name)}function RS(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function mF(t){return Kr(t,"disableSelection")}function fOe(t){return Ve(t,"htSeparator")}function gOe(t){return Ve(t,"htSubmenu")}function mOe(t){return Ve(t,"htDisabled")}function pOe(t){return Ve(t,"htSelectionDisabled")}function yOe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function aG(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function vOe(t,e){let r=t.slice(0);return r.reverse(),r=aG(r,e),r.reverse(),r}function wOe(t){const e=[];return B(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function bOe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ot,r=t.slice(0);return r=aG(r,e),r=vOe(r,e),r=wOe(r),r}function xOe(t){return t.checkable===!0}function SOe(t){return oG({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||fOe(n)||mOe(n)||pOe(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function COe(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(n):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedActive();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedActive();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const lG="menu",pF=lG;function _Oe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(COe(t)),e.forEach(u=>{let{shortcuts:d,contextName:f}=u;i(d,f)});function n(u,d){a(d).addShortcuts(u,{group:lG})}function i(u,d){const f=a(d);u.forEach(h=>{let{keys:m}=h;m.forEach(g=>f.removeShortcutsByKeys(g))}),r.push({shortcuts:u,contextName:d}),n(u,d)}function s(){return[...r]}function o(u){return u?`${pF}:${u}`:pF}function a(u){var d;const f=t.hotMenu.getShortcutManager(),h=o(u);return(d=f.getContext(h))!==null&&d!==void 0?d:f.addContext(h)}function c(u){t.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:c}}function ROe(t){return(e,r,n,i,s,o)=>{const a=e.getSourceDataAtRow(n),c=t.rootDocument.createElement("div"),u=typeof o=="function"?o.call(t):o,d=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,f=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Mc(r),ee(c,"htItemWrapper"),t.getSettings().ariaTags){const h=!RS(a,t)&&!mF(a)&&!HM(a);Ne(r,[...xOe(a)?[J0e(),Us(d),mU(f)]:[Q0e(),Us(u)],...h?[Ra(-1)]:[],...RS(a,t)?[D0()]:[],...jM(a)?[ko(!1)]:[]])}r.className="",r.appendChild(c),HM(a)?ee(r,"htSeparator"):typeof a.renderer=="function"?(ee(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,c,n,i,s,u))):wf(c,u),RS(a,t)?ee(r,"htDisabled"):mF(a)?ee(r,"htSelectionDisabled"):jM(a)&&ee(r,"htSubmenu")}}function sk(t,e,r){EOe(t,e),e.set(t,r)}function EOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ua(t,e,r){return(e=NOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NOe(t){var e=kOe(t,"string");return typeof e=="symbol"?e:e+""}function kOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ok(t,e,r){return t.set(cG(t,e),r),r}function nu(t,e){return t.get(cG(t,e))}function cG(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const yF=215;var Xf=new WeakMap,Yb=new WeakMap,Gb=new WeakMap;class lp{get tableBorderWidth(){return nu(Gb,this)===void 0&&this.hotMenu&&ok(Gb,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),nu(Gb,this)}constructor(e,r){var n=this;Ua(this,"hot",void 0),Ua(this,"options",void 0),Ua(this,"eventManager",new Ea(this)),Ua(this,"container",void 0),Ua(this,"positioner",void 0),Ua(this,"hotMenu",null),Ua(this,"hotSubMenus",{}),Ua(this,"parentMenu",void 0),Ua(this,"menuItems",null),Ua(this,"origOutsideClickDeselects",null),sk(this,Xf,void 0),sk(this,Yb,void 0),sk(this,Gb,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:yF,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new dOe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{this.options.container!==this.hot.rootPortalElement&&(Re(this.options.container,/ht-theme-.*/g),ee(this.options.container,i)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=nd(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return nu(Xf,this)}getKeyboardShortcutsCtrl(){return nu(Yb,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=R_(a=>this.openSubMenu(a),300),r=this.options.minWidth||yF;let n=!1,i=Kh(this.menuItems,a=>(a.key===uv&&(n=!0),yOe(a,this.hot)));if(i.length<1&&!n)i.push(eG()[uv]);else if(i.length===0)return;i=bOe(i,ot);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return xe(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:ROe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,c)=>{this.hotMenu.stylesHandler.isClassicTheme()?nu(Xf,this).setCurrentPage(c.row):nu(Xf,this).setPageCursorAt(c.row)},afterOnCellMouseOver:(a,c)=>{this.isAllSubMenusClosed()?e(c.row):this.openSubMenu(c.row)},afterOnCellContextMenu:a=>{a.preventDefault(),oM()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,c,u,d,f)=>{this.hotMenu.view.isMouseDown()&&(f.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!oM()||!Jh(a))&&s&&this.hasSelectedItem()&&(Sl()||xI()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),ok(Xf,this,SOe(this.hotMenu)),ok(Yb,this,_Oe(this)),nu(Yb,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(nu(Xf,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedActive();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Ne(n,[ko(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!gOe(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new lp(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Ne(r,[ko(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ne(i,[ko(!1)])}}closeAllSubMenus(){B(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?hOe(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||HM(e)||RS(e,this.hot)||jM(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),o=bs(r,(a,c,u)=>{const f=this.hotMenu.getCell(u,0)?yn(this.hotMenu.getCell(u,0)):0;return a+(c.name===ot?1:f)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${s+3}px`,i.height=`${o+3}px`):(i.width=`${s}px`,i.height=`${o}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Tt(n)&&(n=n.call(this.hot),n===null||fr(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),ee(i,`htMenu handsontable ${this.options.className}`),n&&ee(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ne(this.hotMenu.rootElement,[X0e(),Ra(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Dh(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Dh(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ve(e.target,"htCore")&&Dh(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Ht(lp,Mn);function TOe(t,e){POe(t,e),e.add(t)}function POe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ak(t,e,r){return(e=MOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MOe(t){var e=AOe(t,"string");return typeof e=="symbol"?e:e+""}function AOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kb(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const z0="contextMenu",OOe=70,vF=z0;_e.getSingleton().register("afterContextMenuDefaultOptions");_e.getSingleton().register("beforeContextMenuShow");_e.getSingleton().register("afterContextMenuShow");_e.getSingleton().register("afterContextMenuHide");_e.getSingleton().register("afterContextMenuExecute");var o0=new WeakSet;class K_ extends wt{constructor(){super(...arguments),TOe(this,o0),ak(this,"commandExecutor",new nG(this.hot)),ak(this,"itemsFactory",null),ak(this,"menu",null)}static get PLUGIN_KEY(){return z0}static get PLUGIN_PRIORITY(){return OOe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[z_,U_,ot,rw,nw,ot,W_,sw,ot,Y_,B_,ot,iw,ot,yo]}isEnabled(){return!!this.hot.getSettings()[z0]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[z0];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new lp(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Kb(o0,this,jOe).call(this)),this.menu.addLocalHook("afterOpen",()=>Kb(o0,this,HOe).call(this)),this.menu.addLocalHook("afterClose",()=>Kb(o0,this,$Oe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Kb(o0,this,IOe).call(this,n)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=F_(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:vF})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vF)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.prepareMenuItems(),this.menu.open(),at(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new iG(this.hot,K_.DEFAULT_ITEMS);const e=this.hot.getSettings()[z0],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),B(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function IOe(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),Ve(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(s)&&!(Ve(s,"current")&&Ve(s,"wtBorder"))))return;const o=F_(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function jOe(){this.hot.runHooks("beforeContextMenuShow",this)}function HOe(){this.hot.runHooks("afterContextMenuShow",this)}function $Oe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}K_.SEPARATOR={name:ot};function DOe(t){return{key:"copy",name(){return this.getTranslatedPhrase(d2)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function LOe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),r=e?ut(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(g2,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function FOe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),r=e?ut(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(f2,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function VOe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),r=e?ut(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(h2,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function BOe(t){return{key:"cut",name(){return this.getTranslatedPhrase(m2)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class WOe{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class zOe{constructor(){this.clipboardData=new WOe}preventDefault(){}composedPath(){return[]}}function UOe(t,e){uG(t,e),e.add(t)}function Qf(t,e,r){uG(t,e),e.set(t,r)}function uG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pi(t,e){return t.get(Kg(t,e))}function Jf(t,e,r){return t.set(Kg(t,e),r),r}function Kg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var iu=new WeakMap,lk=new WeakMap,a0=new WeakMap,$M=new WeakMap,DM=new WeakMap,l0=new WeakMap,c0=new WeakSet;class YOe{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;UOe(this,c0),Qf(this,iu,void 0),Qf(this,lk,void 0),Qf(this,a0,void 0),Qf(this,$M,void 0),Qf(this,DM,void 0),Qf(this,l0,void 0),Jf(lk,this,r),Jf(a0,this,n),Jf($M,this,i),Jf(DM,this,s),Jf(l0,this,o)}setSelectedRange(e){Jf(iu,this,e)}getCellsRange(){if(Pi(lk,this).call(this)===0||Pi(a0,this).call(this)===0)return null;const{row:e,col:r}=Pi(iu,this).getTopStartCorner(),{row:n,col:i}=Pi(iu,this).getBottomEndCorner(),s=Kg(c0,this,GOe).call(this,e,n),o=Kg(c0,this,ck).call(this,r,i);return{isRangeTrimmed:n!==s||i!==o,startRow:e,startCol:r,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Pi(a0,this).call(this)===0||Pi(l0,this).call(this)===0)return null;const{col:e}=Pi(iu,this).getTopStartCorner(),{col:r}=Pi(iu,this).getBottomEndCorner(),n=Kg(c0,this,ck).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Pi(a0,this).call(this)===0||Pi(l0,this).call(this)===0)return null;const{col:e}=Pi(iu,this).getTopStartCorner(),{col:r}=Pi(iu,this).getBottomEndCorner(),n=Kg(c0,this,ck).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Pi(l0,this).call(this),startCol:e,endRow:-1,endCol:n}}}function ck(t,e){return Math.min(e,Math.max(t+Pi(DM,this).call(this)-1,t))}function GOe(t,e){return Math.min(e,Math.max(t+Pi($M,this).call(this)-1,t))}function dG(t){const e=[],r=[];return B(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);Oe(i,s,c=>{e.indexOf(c)===-1&&e.push(c)});const o=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Oe(o,a,c=>{r.indexOf(c)===-1&&r.push(c)})}),{rows:e,columns:r}}function KOe(t,e){hG(t,e),e.add(t)}function su(t,e,r){hG(t,e),e.set(t,r)}function hG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u0(t,e,r){return(e=qOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qOe(t){var e=XOe(t,"string");return typeof e=="symbol"?e:e+""}function XOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function os(t,e){return t.get(yi(t,e))}function Jo(t,e,r){return t.set(yi(t,e),r),r}function yi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("afterCopyLimit");_e.getSingleton().register("modifyCopyableRange");_e.getSingleton().register("beforeCut");_e.getSingleton().register("afterCut");_e.getSingleton().register("beforePaste");_e.getSingleton().register("afterPaste");_e.getSingleton().register("beforeCopy");_e.getSingleton().register("afterCopy");const uk="copyPaste",QOe=80,JOe=["fragmentSelection"],fG="application/ht-source-data-json-html",wF=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var LM=new WeakMap,FM=new WeakMap,VM=new WeakMap,Zf=new WeakMap,qb=new WeakMap,Xb=new WeakMap,eg=new WeakMap,t1=new WeakMap,Mi=new WeakSet;class ZOe extends wt{constructor(){super(...arguments),KOe(this,Mi),u0(this,"columnsLimit",1/0),u0(this,"rowsLimit",1/0),u0(this,"pasteMode","overwrite"),u0(this,"uiContainer",this.hot.rootDocument.body),su(this,LM,!1),su(this,FM,!1),su(this,VM,!1),su(this,Zf,"cells-only"),su(this,qb,!1),su(this,Xb,!1),su(this,eg,new YOe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),su(this,t1,!1),u0(this,"copyableRanges",[])}static get PLUGIN_KEY(){return uk}static get SETTING_KEYS(){return[uk,...JOe]}static get PLUGIN_PRIORITY(){return QOe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[uk]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Jo(LM,this,this.getSetting("copyColumnHeaders")),Jo(FM,this,this.getSetting("copyColumnGroupHeaders")),Jo(VM,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>yi(Mi,this,rIe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return yi(Mi,n,nIe).call(n,...s)}),this.addHook("afterSelectionEnd",()=>yi(Mi,this,iIe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),S_()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return yi(Mi,n,sIe).call(n,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return yi(Mi,n,oIe).call(n,...s)}),this.addHook("afterSelection",()=>yi(Mi,this,aIe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Jo(Zf,this,e),Jo(qb,this,!0),yi(Mi,this,bF).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Jo(Xb,this,!0),yi(Mi,this,bF).call(this,"cut")}getRangedCopyableData(e){return HC(this.getRangedData(e))}getRangedData(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=[],{rows:i,columns:s}=dG(e);return B(i,o=>{const a=[];B(s,c=>{if(o<0)a.push(this.hot.getColHeader(c,o));else{let u=r?this.hot.getCopyableSourceData(o,c):this.hot.getCopyableData(o,c);r&&Le(u)&&(u=JSON.stringify(u)),a.push(u)}}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new zOe;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}os(eg,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);os(Zf,this)==="column-headers-only"?r.set("headers",os(eg,this).getMostBottomColumnHeadersRange()):(os(Zf,this)==="with-column-headers"?r.set("headers",os(eg,this).getMostBottomColumnHeadersRange()):os(Zf,this)==="with-column-group-headers"&&r.set("headers",os(eg,this).getAllColumnHeadersRange()),r.set("cells",os(eg,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:c}=i;return{startRow:s,startCol:o,endRow:a,endCol:c}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=n;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,s=e[0].length,o=[],{row:a,col:c}=n.getTopStartCorner(),{row:u,col:d}=n.getBottomEndCorner();let f=a,h=c,m=a,g=c;for(;o.length<i||f<=u;){const{skipRowOnPaste:y,visualRow:w}=this.hot.getCellMeta(f,c);if(f=w+1,y===!0)continue;m=w,h=c;const v=[],x=o.length%i;for(;v.length<s||h<=d;){var p;const{skipColumnOnPaste:S,visualCol:N}=this.hot.getCellMeta(w,h),R=this.hot.getSourceDataAtCell(w,h),E=v.length%s;if(h=N+1,S===!0)continue;g=N;const P=r==null||(p=r[x])===null||p===void 0?void 0:p[E];let D=e[x][E];if(r&&z0e(P)){const H=JSON.parse(P);(Le(R)||R===null)&&(D=H)}v.push(D)}o.push(v)}return Jo(t1,this,!0),this.hot.populateFromArray(a,c,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,c,m,g]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!os(qb,this)||this.isEditorOpened()||Rc(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!mS(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Jo(qb,this,!1);const s=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0),a=yi(Mi,this,eIe).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,a)&&(yi(Mi,this,xF).call(this,e,s,o),this.hot.runHooks("afterCopy",s,this.copyableRanges,a)),Jo(Zf,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!os(Xb,this)||this.isEditorOpened()||Rc(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!mS(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Jo(Xb,this,!1);const s=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",s,this.copyableRanges)&&(yi(Mi,this,xF).call(this,e,s,o),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges))}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Rc(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!mS(r,this.hot.rootElement)))return;e.preventDefault();let s,o;if(e&&typeof e.clipboardData<"u"){const f=e.clipboardData.getData(fG);f&&(o=h4(f,this.hot.rootDocument).data);const h=pI(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});h&&/(<table)|(<TABLE)/g.test(h)?s=h4(h,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=c_e(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[a,c,u,d]=this.populateValues(s,o);a!==null&&c!==null&&this.hot.selectCell(a,c,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function bF(t){if(S_()){const e=this.hot.getSelectedRangeActive();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&dve(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function eIe(t){const{rows:e}=dG(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function tIe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&HU(n)}}}function gG(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&$U(n)}}}function xF(t,e,r){const n=HC(e);if(t&&t.clipboardData){const i=d4(e),s=d4(r);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[wF,i].join("")),t.clipboardData.setData(fG,[wF,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n)}function rIe(t){t.items.push({name:"---------"},DOe(this)),os(LM,this)&&t.items.push(VOe(this)),os(FM,this)&&t.items.push(FOe(this)),os(VM,this)&&t.items.push(LOe(this)),t.items.push(BOe(this))}function nIe(t,e,r,n,i){os(t1,this)&&(i.value=!0),Jo(t1,this,!1)}function iIe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function sIe(){yi(Mi,this,gG).call(this)}function oIe(){yi(Mi,this,tIe).call(this)}function aIe(){yi(Mi,this,gG).call(this)}function mG(t,e){return`border_row${t}col${e}`}function U0(){return{width:1,color:"#000"}}function pc(){return{hide:!0}}function lIe(){return{width:1,color:"#000",cornerVisible:!1}}function dk(t){if(xe(t.start)||xe(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(xe(t.end)||xe(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function d0(t){return xe(t.start)&&(t.left=t.start),xe(t.end)&&(t.right=t.end),t}function hk(t,e){return{id:mG(t,e),border:lIe(),row:t,col:e,top:pc(),bottom:pc(),start:pc(),end:pc()}}function cIe(t,e){return Kr(e,"border")&&e.border&&(t.border=e.border),Kr(e,"top")&&xe(e.top)&&(e.top?(Le(e.top)||(e.top=U0()),t.top=e.top):(e.top=pc(),t.top=e.top)),Kr(e,"bottom")&&xe(e.bottom)&&(e.bottom?(Le(e.bottom)||(e.bottom=U0()),t.bottom=e.bottom):(e.bottom=pc(),t.bottom=e.bottom)),Kr(e,"start")&&xe(e.start)&&(e.start?(Le(e.start)||(e.start=U0()),t.start=e.start):(e.start=pc(),t.start=e.start)),Kr(e,"end")&&xe(e.end)&&(e.end?(Le(e.end)||(e.end=U0()),t.end=e.end):(e.end=pc(),t.end=e.end)),t}function Oc(t,e){let r=!1;return B(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!Kr(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function q_(t){return`<span class="selected"></span>${t}`}function uIe(t){return t.some(e=>xe(e.left)||xe(e.right))}function dIe(t){return t.some(e=>xe(e.start)||xe(e.end))}const hIe=new Map([["left","start"],["right","end"]]);function fIe(t){var e;return(e=hIe.get(t))!==null&&e!==void 0?e:t}function gIe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(j2);return Oc(this,"bottom")&&(e=q_(e)),e},callback(e,r){const n=Oc(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function mIe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(H2);return Oc(this,e)&&(r=q_(r)),r},callback(r,n){const i=Oc(this,e);t.prepareBorder(n,e,i)}}}function pIe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase($2)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!Oc(this)}}}function yIe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(I2);return Oc(this,e)&&(r=q_(r)),r},callback(r,n){const i=Oc(this,e);t.prepareBorder(n,e,i)}}}function vIe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(O2);return Oc(this,"top")&&(e=q_(e)),e},callback(e,r){const n=Oc(this,"top");t.prepareBorder(r,"top",n)}}}function wIe(t,e){bIe(t,e),e.add(t)}function bIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xIe(t,e,r){return(e=SIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SIe(t){var e=CIe(t,"string");return typeof e=="symbol"?e:e+""}function CIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ES="customBorders",_Ie=90,SF=["dashed","dotted","solid"];var Qb=new WeakSet;class RIe extends wt{constructor(){super(...arguments),wIe(this,Qb),xIe(this,"savedBorders",[])}static get PLUGIN_KEY(){return ES}static get PLUGIN_PRIORITY(){return _Ie}isEnabled(){return!!this.hot.getSettings()[ES]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>fk(Qb,this,NIe).call(this,e)),this.addHook("init",()=>fk(Qb,this,kIe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=dk(r));const s=Im(e),o=sv(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});B(e,a=>{o(a).forAll((c,u)=>{B(n,d=>{this.prepareBorderFromCustomAdded(c,u,i,fIe(d))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=Im(e),n=sv(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return B(e,s=>{n(s).forAll((o,a)=>{B(this.savedBorders,c=>{c.row===o&&c.col===a&&i.push(d0(c))})})}),i}clearBorders(e){e?this.setBorders(e):(B(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||r>=o)return;let a=hk(e,r);n&&(a=cIe(a,n),B(this.hot.selection.highlight.customSelections,c=>{if(a.id===c.settings.id)return Object.assign(c.settings,n),a.id=c.settings.id,a.top=c.settings.top,a.bottom=c.settings.bottom,a.start=c.settings.start,a.end=c.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",d0(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Oe(e.from.row,n,s=>{Oe(e.from.col,i,o=>{const a=hk(s,o);let c=0;s===e.from.row&&Kr(r,"top")&&(c+=1,a.top=r.top),s===e.to.row&&Kr(r,"bottom")&&(c+=1,a.bottom=r.bottom),o===e.from.col&&Kr(r,"start")&&(c+=1,a.start=r.start),o===e.to.col&&Kr(r,"end")&&(c+=1,a.end=r.end),c>0&&(this.hot.setCellMeta(s,o,"borders",d0(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,r){const n=mG(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=hk(e,r):s=dk(s),i?(s[n]=pc(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",d0(s)))):(s[n]=U0(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",d0(s)))}prepareBorder(e,r,n){B(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":Oe(s.col,o.col,a=>{Oe(s.row,o.row,c=>{this.removeAllBorders(c,a)})});break;case"top":Oe(s.col,o.col,a=>{this.setBorder(s.row,a,r,n)});break;case"bottom":Oe(s.col,o.col,a=>{this.setBorder(o.row,a,r,n)});break;case"start":Oe(s.row,o.row,a=>{this.setBorder(a,s.col,r,n)});break;case"end":Oe(s.row,o.row,a=>{this.setBorder(a,o.col,r,n)});break}})}createCustomBorders(e){B(e,r=>{const n=dk(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return bs([r,n,i,s],(a,c)=>{let u=a;return c&&c.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const r=_t(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){B(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){B(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=_t(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):B(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return B(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return B(o,a=>{a.toggleHiddenClass(r,n)}),i=!0,!1}}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):B(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),n){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);B(a,c=>{c.changeBorderStyle(n,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[ES];if(Array.isArray(e)){const r=Bi(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=uIe(e),n=dIe(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".');fk(Qb,this,EIe).call(this,e)}destroy(){super.destroy()}}function EIe(t){t.forEach(e=>{Object.keys(e).forEach(r=>{const n=e[r].style;xe(n)&&!SF.includes(n)?(nt(`The "${n}" border style is not supported. Please use one of the following styles: ${SF.join(", ")}.
The border style will be ignored.`),delete e[r].style):xe(n)&&n==="solid"&&delete e[r].style})})}function NIe(t){this.hot.getSettings()[ES]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(A2)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[vIe(this),yIe(this),gIe(this),mIe(this),pIe(this)]}})}function kIe(){this.changeBorderSettings()}function TIe(t,e){PIe(t,e),e.add(t)}function PIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gk(t,e,r){return(e=MIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MIe(t){var e=AIe(t,"string");return typeof e=="symbol"?e:e+""}function AIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CF(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _F="dragToScroll",OIe=100;var mk=new WeakSet;class IIe extends wt{constructor(){super(...arguments),TIe(this,mk),gk(this,"boundaries",null),gk(this,"callback",null),gk(this,"listening",!1)}static get PLUGIN_KEY(){return _F}static get PLUGIN_PRIORITY(){return OIe}isEnabled(){return!!this.hot.getSettings()[_F]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>CF(mk,this,RF).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>CF(mk,this,RF).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=nd(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function RF(t){if(Jh(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,n)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(r)*50,a+Math.sign(n)*20)}),this.listen()}function jIe(t,e){pG(t,e),e.add(t)}function HIe(t,e,r){pG(t,e),e.set(t,r)}function pG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pk(t,e,r){return(e=$Ie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Ie(t){var e=DIe(t,"string");return typeof e=="symbol"?e:e+""}function DIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LIe(t,e){return t.get(vo(t,e))}function yG(t,e,r){return t.set(vo(t,e),r),r}function vo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("afterDropdownMenuDefaultOptions");_e.getSingleton().register("beforeDropdownMenuShow");_e.getSingleton().register("afterDropdownMenuShow");_e.getSingleton().register("afterDropdownMenuHide");_e.getSingleton().register("afterDropdownMenuExecute");const NS="dropdownMenu",FIe=230,dv="changeType",yk=NS;var X_=new WeakMap,ra=new WeakSet;class Q_ extends wt{static get PLUGIN_KEY(){return NS}static get PLUGIN_PRIORITY(){return FIe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[rw,nw,ot,sw,ot,V_,ot,iw,ot,yo]}constructor(e){super(e),jIe(this,ra),pk(this,"commandExecutor",new nG(this.hot)),pk(this,"itemsFactory",null),pk(this,"menu",null),HIe(this,X_,!1),this.hot.addHook("afterGetColHeader",(r,n)=>vo(ra,this,BIe).call(this,r,n))}isEnabled(){return this.hot.getSettings()[NS]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new iG(this.hot,Q_.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return vo(ra,e,KIe).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return vo(ra,e,GIe).call(e,...s)}),this.addHook("beforeDialogShow",()=>this.close());const r=this.hot.getSettings()[NS],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new lp(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>vo(ra,this,WIe).call(this)),this.menu.addLocalHook("afterOpen",()=>vo(ra,this,zIe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>vo(ra,this,UIe).call(this,s)),this.menu.addLocalHook("afterClose",()=>vo(ra,this,YIe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),B(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:n}=this.hot.getSelectedRangeActive();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:i}=this.hot.getSelectedRangeActive(),s=F_(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${dv}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:yk},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:yk}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yk)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>vo(ra,this,VIe).call(this,e))}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),at(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function vG(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function VIe(t){if(Ve(t.target,dv)){const e=F_(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),yG(X_,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function BIe(t,e){const r=e.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${dv}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=dv,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ne(o,[yf(),Us(" ")]),Ne(e,[hU("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function WIe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function zIe(){this.hot.runHooks("afterDropdownMenuShow",this),vo(ra,this,vG).call(this,this.menu)}function UIe(t){vo(ra,this,vG).call(this,t)}function YIe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function GIe(t){return LIe(X_,this)?null:t}function KIe(t){Ve(t.target,dv)&&yG(X_,this,!0)}Q_.SEPARATOR={name:ot};function EF(t,e,r){return(e=qIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qIe(t){var e=XIe(t,"string");return typeof e=="symbol"?e:e+""}function XIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QIe{constructor(e){EF(this,"hot",void 0),EF(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,o=[];return Oe(e,n,a=>{const c=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(Oe(r,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||c.push(this.hot.getDataAtCell(a,u))}),o.push(c))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();Oe(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();Oe(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,o=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),o=Math.min(o,e),{startRow:n,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function NF(t,e,r){return(e=JIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JIe(t){var e=ZIe(t,"string");return typeof e=="symbol"?e:e+""}function ZIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mH{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){NF(this,"dataProvider",void 0),NF(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=kl(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=vn(kl(mH.DEFAULT_OPTIONS),r),r=vn(r,e),r.filename=mI(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}function e2e(t,e){t2e(t,e),e.add(t)}function t2e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kF(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wG="\r",r2e='"',n2e=`
`,i2e="=",s2e="+",o2e="-",a2e="@",l2e="	";var vk=new WeakSet;class c2e extends mH{constructor(){super(...arguments),e2e(this,vk)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(n=_t(n,c=>this._escapeCell(c,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),B(r,(c,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const d=c.map(f=>this._escapeCell(f,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=d}),a}_escapeCell(e){let{force:r=!1,sanitizeValue:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=sr(e);return i===""||(n&&(r=!0),n instanceof RegExp?i=kF(vk,this,d2e).call(this,i,n):typeof n=="function"?i=n(i):n&&(i=kF(vk,this,u2e).call(this,i)),(r||i.indexOf(wG)>=0||i.indexOf(r2e)>=0||i.indexOf(n2e)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function u2e(t){return t.startsWith(i2e)||t.startsWith(s2e)||t.startsWith(o2e)||t.startsWith(a2e)||t.startsWith(l2e)||t.startsWith(wG)?`'${t}`:t}function d2e(t,e){return e.test(t)?`'${t}`:t}const h2e="csv",BM={[h2e]:c2e};function f2e(t,e,r){return typeof BM[t]=="function"?new BM[t](e,r):null}const g2e="exportFile",m2e=240;class p2e extends wt{static get PLUGIN_KEY(){return g2e}static get PLUGIN_PRIORITY(){return m2e}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),o=this._createBlob(s),a=i.URL||i.webkitURL,c=n.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(c.download!==void 0){const d=a.createObjectURL(o);c.style.display="none",c.setAttribute("href",d),c.setAttribute("download",u),n.body.appendChild(c),c.dispatchEvent(new MouseEvent("click")),n.body.removeChild(c),setTimeout(()=>{a.revokeObjectURL(d)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!BM[e])throw new Error(`Export format type "${e}" is not supported.`);return f2e(e,new QIe(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function tg(t,e,r){return(e=y2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y2e(t){var e=v2e(t,"string");return typeof e=="symbol"?e:e+""}function v2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ow{constructor(e,r){let{id:n,stateless:i=!0}=r;tg(this,"hot",void 0),tg(this,"id",void 0),tg(this,"elements",[]),tg(this,"hidden",!1),tg(this,"stateId",""),tg(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new P_)}getElements(){return this.elements}reset(){B(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),B(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Ht(ow,Mn);const hv={};function id(t,e){if(!hv[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=hv[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function Nh(t){if(!hv[t])throw Error(`Filter condition "${t}" does not exist.`);return hv[t].descriptor}function dn(t,e,r){r.key=t,hv[t]={condition:e,descriptor:r}}const Un="none";function w2e(){return!0}dn(Un,w2e,{name:M_,inputsCount:0,showOperators:!1});const py="empty";function b2e(t){return qr(t.value)}dn(py,b2e,{name:z2,inputsCount:0,showOperators:!0});const kS="not_empty";function x2e(t,e){return!id(py,e)(t)}dn(kS,x2e,{name:U2,inputsCount:0,showOperators:!0});const yy="eq";function S2e(t,e){let[r]=e;return sr(t.value).toLocaleLowerCase(t.meta.locale)===sr(r)}dn(yy,S2e,{name:Y2,inputsCount:1,showOperators:!0});const TS="neq";function C2e(t,e){return!id(yy,e)(t)}dn(TS,C2e,{name:G2,inputsCount:1,showOperators:!0});const bG="gt";function _2e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}dn(bG,_2e,{name:J2,inputsCount:1,showOperators:!0});const xG="gte";function R2e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}dn(xG,R2e,{name:Z2,inputsCount:1,showOperators:!0});const SG="lt";function E2e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}dn(SG,E2e,{name:ej,inputsCount:1,showOperators:!0});const CG="lte";function N2e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}dn(CG,N2e,{name:tj,inputsCount:1,showOperators:!0});const pH="date_after";function k2e(t,e){let[r]=e;const n=ce(t.value,t.meta.dateFormat),i=ce(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}dn(pH,k2e,{name:ij,inputsCount:1,showOperators:!0});const yH="date_before";function T2e(t,e){let[r]=e;const n=ce(t.value,t.meta.dateFormat),i=ce(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}dn(yH,T2e,{name:sj,inputsCount:1,showOperators:!0});const r1="between";function P2e(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=id(yH,[s]),a=id(pH,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}dn(r1,P2e,{name:rj,inputsCount:2,showOperators:!0});const _G="not_between";function M2e(t,e){return!id(r1,e)(t)}dn(_G,M2e,{name:nj,inputsCount:2,showOperators:!0});const RG="begins_with";function A2e(t,e){let[r]=e;return sr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(sr(r))}dn(RG,A2e,{name:K2,inputsCount:1,showOperators:!0});const EG="ends_with";function O2e(t,e){let[r]=e;return sr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(sr(r))}dn(EG,O2e,{name:q2,inputsCount:1,showOperators:!0});const vH="contains";function I2e(t,e){let[r]=e;return sr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(sr(r))>=0}dn(vH,I2e,{name:X2,inputsCount:1,showOperators:!0});const NG="not_contains";function j2e(t,e){return!id(vH,e)(t)}dn(NG,j2e,{name:Q2,inputsCount:1,showOperators:!0});const kG="date_tomorrow";function H2e(t){const e=ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ce().subtract(-1,"days").startOf("day"),"d"):!1}dn(kG,H2e,{name:aj,inputsCount:0});const TG="date_today";function $2e(t){const e=ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ce().startOf("day"),"d"):!1}dn(TG,$2e,{name:oj,inputsCount:0});const PG="date_yesterday";function D2e(t){const e=ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ce().subtract(1,"days").startOf("day"),"d"):!1}dn(PG,D2e,{name:lj,inputsCount:0});Gye();function L2e(t,e){let r=t;return r===""&&(r=`(${e})`),r}function aw(t){const e=new Set(t);return function(r){return e.has(r)}}function wH(t){return t??""}function WM(t){return Array.from(new Set(t)).map(e=>wH(e)).sort((e,r)=>typeof e=="number"&&typeof r=="number"?e-r:e===r?0:e>r?1:-1)}function TF(t,e,r,n){const i=[],s=t===e;let o;return s||(o=aw(e)),t.forEach(a=>{let c=!1;(s||o(a))&&(c=!0);const u={checked:c,value:a,visualValue:L2e(a,r)};n&&n(u),i.push(u)}),i}const kh="by_value";function F2e(t,e){let[r]=e;return r(t.value)}dn(kh,F2e,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[aw(e)]},showOperators:!1});const fv={};function V2e(t){if(!fv[t])throw Error(`Operation with id "${t}" does not exist.`);const e=fv[t].func;return function(r,n){return e(r,n)}}function B2e(t){return fv[t].name}function bH(t,e,r){fv[t]={name:e,func:r}}const Qu="conjunction",W2e=dj;function z2e(t,e){return t.every(r=>r.func(e))}bH(Qu,W2e,z2e);const n1="disjunction",U2e=A_;function Y2e(t,e){return t.some(r=>r.func(e))}bH(n1,U2e,Y2e);const xH="disjunctionWithExtraCondition",G2e=A_;function K2e(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}bH(xH,G2e,K2e);const q2e="numeric",MG="text",X2e="date",PF={[q2e]:[Un,ot,py,kS,ot,yy,TS,ot,bG,xG,SG,CG,r1,_G],[MG]:[Un,ot,py,kS,ot,yy,TS,ot,RG,EG,ot,vH,NG],[X2e]:[Un,ot,py,kS,ot,yy,TS,ot,yH,pH,r1,ot,kG,TG,PG]};function Q2e(t){const e=[];let r=t;return PF[r]||(r=MG),B(PF[r],n=>{let i;n===ot?i={name:ot}:i=kl(Nh(n)),e.push(i)}),e}function h0(t,e,r){return(e=J2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J2e(t){var e=Z2e(t,"string");return typeof e=="symbol"?e:e+""}function Z2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wk="built",bk="building",MF=["click","input","keydown","keypress","keyup","focus","blur","change"];let wa=class AG{static get DEFAULTS(){return kl({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){h0(this,"hot",void 0),h0(this,"eventManager",new Ea(this)),h0(this,"options",void 0),h0(this,"_element",void 0),h0(this,"buildState",void 0),this.hot=e,this.options=vn(AG.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===bk?this._element:this.buildState===wk?(this.update(),this._element):(this.buildState=bk,this.build(),this.buildState=wk,this._element)}isBuilt(){return this.buildState===wk}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Yi)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=bk),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ee(this._element,this.options.className),this.options.children.length)B(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),at(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),B(MF,n=>e(r,n))}else B(MF,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Ht(wa,Mn);function eje(t,e){OG(t,e),e.add(t)}function tje(t,e,r){OG(t,e),e.set(t,r)}function OG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jb(t,e){return t.get(SH(t,e))}function rje(t,e,r){return t.set(SH(t,e),r),r}function SH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rg=new WeakMap,AF=new WeakSet;class Ju extends wa{static get DEFAULTS(){return kl({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,vn(Ju.DEFAULTS,r)),eje(this,AF),tje(this,rg,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>SH(AF,this,nje).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");rje(rg,this,this._element.firstChild),ee(this._element,"htUIInput"),ee(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Jb(rg,this).type=this.options.type,Jb(rg,this).placeholder=this.translateIfPossible(this.options.placeholder),Jb(rg,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Jb(rg,this).focus()}}function nje(t){this.options.value=t.target.value}function ije(t,e){IG(t,e),e.add(t)}function f0(t,e,r){IG(t,e),e.set(t,r)}function IG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ng(t,e,r){return t.set(vy(t,e),r),r}function Er(t,e){return t.get(vy(t,e))}function vy(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xn=new WeakMap,Zb=new WeakMap,ex=new WeakMap,xk=new WeakMap,tx=new WeakMap,rx=new WeakSet;class gv extends wa{static get DEFAULTS(){return kl({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,vn(gv.DEFAULTS,r)),ije(this,rx),f0(this,xn,null),f0(this,Zb,[]),f0(this,ex,void 0),f0(this,xk,void 0),f0(this,tx,void 0),this.registerHooks()}getMenu(){return Er(xn,this)}registerHooks(){this.addLocalHook("click",()=>vy(rx,this,aje).call(this))}setItems(e){ng(Zb,this,this.translateNames(e)),Er(xn,this)&&Er(xn,this).setMenuItems(Er(Zb,this))}translateNames(e){return B(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),ng(xn,this,new lp(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Er(xn,this).setMenuItems(Er(Zb,this));const e=new wa(this.hot,{className:"htUISelectCaption"}),r=new wa(this.hot,{className:"htUISelectDropdown"});ng(ex,this,e),ng(xk,this,e.element),ng(tx,this,r),this.hot.getSettings().ariaTags&&(Ne(r.element,[yf()]),Ne(this._element,[dU()])),B([e,r],n=>this._element.appendChild(n.element)),Er(xn,this).addLocalHook("select",n=>vy(rx,this,sje).call(this,n)),Er(xn,this).addLocalHook("afterClose",()=>vy(rx,this,oje).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Er(xn,this).hot.getTranslatedPhrase(M_),Er(xk,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Er(xn,this)&&(Er(xn,this).open(),Er(xn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Er(xn,this).getNavigator().toFirstItem(),Er(xn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Er(xn,this)&&Er(xn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Er(xn,this)&&(Er(xn,this).destroy(),ng(xn,this,null)),Er(ex,this)&&Er(ex,this).destroy(),Er(tx,this)&&Er(tx,this).destroy(),super.destroy()}}function sje(t){t.name!==ot&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function oje(){this.runLocalHooks("afterClose")}function aje(){this.openOptions()}function lje(t,e){cje(t,e),e.add(t)}function cje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OF(t,e,r){return(e=uje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uje(t){var e=dje(t,"string");return typeof e=="symbol"?e:e+""}function dje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IF(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Sk=new WeakSet;class zM extends ow{constructor(e,r){super(e,{id:r.id,stateless:!1}),lje(this,Sk),OF(this,"name",""),OF(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new gv(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new Ju(this.hot,{placeholder:yj})),this.elements.push(new Ju(this.hot,{placeholder:vj})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>IF(Sk,this,hje).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),B(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>IF(Sk,this,fje).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=kl(e.command);r.name.startsWith(Dr)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),B(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Nh(Un),r=[];return B(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=Nh(e?e.name:Un);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||B(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof gv)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ju)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{ee(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ee(r.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||B(this.elements,c=>r.appendChild(c.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[Nh(Un)];if(e!==null){const{visualIndex:n}=e;r=Q2e(this.hot.getDataType(0,n,this.hot.countRows(),n))}B(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function hje(t){B(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function fje(t){Am(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ao(t))}function jF(t,e,r){gje(t,e),e.set(t,r)}function gje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g0(t,e){return t.get(jG(t,e))}function HF(t,e,r){return t.set(jG(t,e),r),r}function jG(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ig=new WeakMap,Ck=new WeakMap;class i1 extends wa{static get DEFAULTS(){return kl({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,vn(i1.DEFAULTS,r)),jF(this,ig,void 0),jF(this,Ck,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),HF(Ck,this,e),HF(ig,this,this._element.firstChild),g0(ig,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(g0(Ck,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?g0(ig,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(g0(ig,this).checked=e)}focus(){this.isBuilt()&&g0(ig,this).focus()}}function mje(t,e){pje(t,e),e.add(t)}function pje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yje(t,e,r){return(e=vje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vje(t){var e=wje(t,"string");return typeof e=="symbol"?e:e+""}function wje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bje(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $F=0;var DF=new WeakSet;class xje extends ow{constructor(e,r){super(e,{id:r.id,stateless:!1}),mje(this,DF),yje(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(ee(r.parentNode,"htFiltersMenuOperators"),B(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[Qu,n1];B(e,r=>{const n=new i1(this.hot,{name:"operator",label:{htmlFor:r,textContent:B2e(r)},value:r,checked:r===e[$F],id:r});n.addLocalHook("change",i=>bje(DF,this,Sje).call(this,i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Rt`Radio button with index ${e} doesn't exist.`);B(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof i1&&r.isChecked());return e?e.getValue():Qu}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&B(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Qu,r=arguments.length>1?arguments[1]:void 0,n=e;n===xH&&(n=n1),this.state.setValueAtIndex(r,n)}reset(){this.setChecked($F)}}function Sje(t){this.setState(t.target.value)}function Cje(t,e,r){_je(t,e),e.set(t,r)}function _je(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _k(t,e){return t.get(HG(t,e))}function Rje(t,e,r){return t.set(HG(t,e),r),r}function HG(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var m0=new WeakMap;class mv extends wa{static get DEFAULTS(){return kl({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,vn(mv.DEFAULTS,r)),Cje(this,m0,void 0)}build(){super.build(),Rje(m0,this,this._element.firstChild)}update(){this.isBuilt()&&(_k(m0,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_k(m0,this).focus()}activate(){_k(m0,this).click()}}function Eje(t,e){$G(t,e),e.add(t)}function sg(t,e,r){$G(t,e),e.set(t,r)}function $G(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(qg(t,e))}function Go(t,e,r){return t.set(qg(t,e),r),r}function qg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const LF="multipleSelect.itemBox";var sa=new WeakMap,hr=new WeakMap,Rk=new WeakMap,ql=new WeakMap,ou=new WeakMap,au=new WeakMap,p0=new WeakSet;class pv extends wa{static get DEFAULTS(){return kl({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,vn(pv.DEFAULTS,r)),Eje(this,p0),sg(this,sa,[]),sg(this,hr,void 0),sg(this,Rk,void 0),sg(this,ql,void 0),sg(this,ou,void 0),sg(this,au,void 0),Go(ql,this,new Ju(this.hot,{placeholder:pj,className:"htUIMultipleSelectSearch"})),Go(ou,this,new mv(this.hot,{textContent:hj,className:"htUISelectAll"})),Go(au,this,new mv(this.hot,{textContent:fj,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ye(hr,this)}registerHooks(){Ye(ql,this).addLocalHook("keydown",e=>qg(p0,this,kje).call(this,e)),Ye(ql,this).addLocalHook("input",e=>qg(p0,this,Nje).call(this,e)),Ye(ou,this).addLocalHook("click",e=>qg(p0,this,Tje).call(this,e)),Ye(au,this).addLocalHook("click",e=>qg(p0,this,Pje).call(this,e))}setItems(e){var r;Go(sa,this,e),(r=Ye(hr,this))===null||r===void 0||r.loadData(Ye(sa,this))}setLocale(e){Go(Rk,this,e)}getLocale(){return Ye(Rk,this)}getItems(){return[...Ye(sa,this)]}getValue(){return Aje(Ye(sa,this))}getSearchInputElement(){return Ye(ql,this)}getSelectAllElement(){return Ye(ou,this)}getClearAllElement(){return Ye(au,this)}isSelectedAllValues(){return Ye(sa,this).length===this.getValue().length}build(){var e;super.build();const{rootDocument:r}=this.hot,n=r.createElement("div"),i=new wa(this.hot,{className:"htUISelectionControls",children:[Ye(ou,this),Ye(au,this)]});this._element.appendChild(Ye(ql,this).element),this._element.appendChild(i.element),this._element.appendChild(n),(e=Ye(hr,this))===null||e===void 0||e.destroy(),ee(n,"htUIMultipleSelectHot"),Go(hr,this,new this.hot.constructor(n,{data:[[]],columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(a,c,u,d,f,h)=>{a.title=h.instance.getDataAtRowProp(c,h.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ye(hr,this).listen()},modifyColWidth:a=>{const c=Ye(hr,this).container.scrollWidth-on(r);return a!==void 0&&a<c?c:a},autoColumnSize:!0,autoRowSize:!1,hiddenRows:!0,maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ye(hr,this).init();const o=Ye(hr,this).getShortcutManager().getContext("grid");o.removeShortcutsByKeys(["Tab"]),o.removeShortcutsByKeys(["Shift","Tab"]),o.addShortcut({keys:[["Escape"]],callback:a=>{this.runLocalHooks("keydown",a,this)},group:LF}),o.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:a=>{Ye(hr,this).deselectCell(),this.runLocalHooks("keydown",a,this),this.runLocalHooks("listTabKeydown",a,this)},group:LF})}focus(){this.isBuilt()&&Ye(hr,this).listen()}reset(){Ye(ql,this).reset(),Ye(ou,this).reset(),Ye(au,this).reset()}update(){!this.isBuilt()||Ye(hr,this).rootElement.offsetHeight===0||(Ye(hr,this).updateSettings({data:Mje(Ye(sa,this),this.options.value)}),super.update())}destroy(){var e;(e=Ye(hr,this))===null||e===void 0||e.destroy(),Ye(ql,this).destroy(),Ye(au,this).destroy(),Ye(ou,this).destroy(),Go(ql,this,null),Go(au,this,null),Go(ou,this,null),Go(hr,this,null),Go(sa,this,null),super.destroy()}}function Nje(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());if(this.options.searchMode==="apply"){const r=Ye(hr,this).getPlugin("hiddenRows");r.showRows(r.getHiddenRows()),Ye(sa,this).forEach((n,i)=>{n.checked=`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0,n.checked||r.hideRow(i)}),Ye(hr,this).view.adjustElementsSize(),Ye(hr,this).render()}else{let r;e===""?r=[...Ye(sa,this)]:r=Ye(sa,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ye(hr,this).loadData(r)}}function kje(t){this.runLocalHooks("keydown",t,this),DU(Am,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ao(t),Ye(hr,this).listen(),Ye(hr,this).selectCell(0,0))}function Tje(t){const e=[];t.preventDefault(),Ye(hr,this).getSourceData().forEach((r,n)=>{r.checked=!0,e.push(p9(r,n)[0])}),Ye(hr,this).setSourceDataAtCell(e)}function Pje(t){const e=[];t.preventDefault(),Ye(hr,this).getSourceData().forEach((r,n)=>{r.checked=!1,e.push(p9(r,n)[0])}),Ye(hr,this).setSourceDataAtCell(e)}function Mje(t,e){const r=aw(e);return t.map(n=>(n.checked=r(n.value),n))}function Aje(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function Oje(t,e){Ije(t,e),e.add(t)}function Ije(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FF(t,e,r){return(e=jje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jje(t){var e=Hje(t,"string");return typeof e=="symbol"?e:e+""}function Hje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nx(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var y0=new WeakSet;class $je extends ow{constructor(e,r){super(e,{id:r.id,stateless:!1}),Oje(this,y0),FF(this,"name",""),FF(this,"searchMode",void 0),this.name=r.name,this.searchMode=r.searchMode,this.elements.push(new pv(this.hot,{searchMode:this.searchMode})),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>nx(y0,this,Dje).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>nx(y0,this,Lje).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===kh){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?Un:kh},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,o,a)=>{const[c]=Kh(i,f=>f.name===kh),u={},d=this.hot.getTranslatedPhrase(IC);if(c){const f=o(n,a),h=_t(f,v=>v.value),m=new Map(f.map(v=>[v.value,this.hot.getCellMeta(v.meta.visualRow,v.meta.visualCol)])),g=WM(h);s&&(c.args[0]=s);const p=[],y=TF(g,c.args[0],d,v=>{v.checked&&p.push(v.value),nx(y0,this,VF).call(this,v,m)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[p],u.command=Nh(kh),u.itemsSnapshot=y}else u.args=[],u.command=Nh(Un);this.state.setValueAtIndex(n,u)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof pv)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{ee(r.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||B(this.elements,c=>r.appendChild(c.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(IC),r=this._getColumnVisibleValues(),n=r.map(c=>c.value),i=new Map(r.map(c=>[c.value,c.meta])),s=WM(n),o=TF(s,s,e,c=>{nx(y0,this,VF).call(this,c,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:_t(this.hot.getDataAtCol(e.visualIndex),(r,n)=>({value:wH(r),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function Dje(t){Am(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ao(t)),Am(t.keyCode,"ENTER")&&(this.searchMode==="apply"&&this.runLocalHooks("accept"),Ao(t))}function VF(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Lje(t,e){switch(e.type){case"numeric":return SY(t,e);default:return t}}var DG;function Fje(t,e){Vje(t,e),e.add(t)}function Vje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bje(t,e,r){return(e=Wje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wje(t){var e=zje(t,"string");return typeof e=="symbol"?e:e+""}function zje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uje(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var BF=new WeakSet;class yv extends ow{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),Fje(this,BF),Bje(this,"name",""),this.name=r.name,this.elements.push(new Ju(this.hot,{type:"button",value:gj,className:"htUIButton htUIButtonOK",identifier:yv.BUTTON_OK})),this.elements.push(new Ju(this.hot,{type:"button",value:mj,className:"htUIButton htUIButtonCancel",identifier:yv.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){B(this.elements,e=>{e.addLocalHook("click",(r,n)=>Uje(BF,this,Yje).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(ee(r.parentNode,"htFiltersMenuActionBar"),B(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}DG=yv;function Yje(t,e){e.options.identifier===DG.BUTTON_OK?this.accept():this.cancel()}function Ek(t,e,r){return(e=Gje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gje(t){var e=Kje(t,"string");return typeof e=="symbol"?e:e+""}function Kje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const WF="ConditionCollection.filteringStates";class CH{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Ek(this,"hot",void 0),Ek(this,"isMapRegistrable",void 0),Ek(this,"filteringStates",new P_),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(WF,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i==null?void 0:i.conditions)!==null&&n!==void 0?n:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qu;return e.length?V2e(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qu,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=r.args.map(d=>typeof d=="string"?d.toLocaleLowerCase(s):d),a=r.name||r.command.key;this.runLocalHooks("beforeAdd",e);const c=this.getOperation(e);if(c){if(c!==n)throw Error(Rt`The column of index ${e} has been already applied with a \`${c}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(fr(fv[n]))throw new Error(Rt`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:o,func:id(a,o)}]},i):u.push({name:a,args:o,func:id(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:s.map(o=>{let{name:a,args:c}=o;return{name:a,args:[...c]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(r=>{r.conditions.forEach(n=>this.addCondition(r.column,n))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(WF),this.filteringStates=null,this.clearLocalHooks()}}Ht(CH,Mn);function zF(t,e,r){return(e=qje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qje(t){var e=Xje(t,"string");return typeof e=="symbol"?e:e+""}function Xje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LG{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];zF(this,"conditionCollection",void 0),zF(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return B(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return B(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return B(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}function Qje(t,e){Jje(t,e),e.add(t)}function Jje(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ld(t,e,r){return(e=Zje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zje(t){var e=eHe(t,"string");return typeof e=="symbol"?e:e+""}function eHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ix=new WeakSet;class FG{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Qje(this,ix),Ld(this,"hot",void 0),Ld(this,"conditionCollection",void 0),Ld(this,"columnDataFactory",void 0),Ld(this,"changes",[]),Ld(this,"grouping",!1),Ld(this,"latestEditedColumnPosition",-1),Ld(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",i=>Nk(ix,this,tHe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Nk(ix,this,rHe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Nk(ix,this,nHe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,B(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const c=hve(function(d,f){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const m=new CH(n.hot,!1),g=[].concat(d,h);m.importAllConditions(g);const p=n.columnDataFactory(f);let y;m.isEmpty()?y=p:y=new LG(m,v=>n.columnDataFactory(v)).filter(),y=_t(y,v=>v.meta.visualRow);const w=aw(y);return m.destroy(),Kh(p,v=>w(v.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:c,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),at(this,(e,r)=>{this[r]=null})}}function tHe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function rHe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function nHe(){B(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Ht(FG,Mn);function iHe(t){return oG({initialPage:0,size:()=>t.length,onItemSelect:(r,n)=>{const i=t[r];if(i instanceof pv)return n;if(i.element&&!Qh(i.element))return!1;i.focus()}})}const v0="filters";function sHe(t,e){let r=-1,n;const i=iHe(e),s=f=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(v0),i.setCurrentPage(e.indexOf(f))};e.forEach(f=>{f instanceof wa&&(f.addLocalHook("click",s(f)),f.addLocalHook("focus",s(f)),f.addLocalHook("afterClose",s(f)))}),c(t);function o(f){const h=n.getKeyboardShortcutsCtrl(),m=f.getKeyboardShortcutsCtrl();i.clear(),m.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:h.getContext(v0),callback:()=>{f.isSubMenu()&&f.close(),h.listen(v0)}}]),!f.isSubMenu()&&h.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const p=n.getNavigator();p.getCurrentPage()>-1&&(r=p.getCurrentPage()),p.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const p=e[i.getCurrentPage()];p instanceof gv&&(p.openOptions(),g.preventDefault()),p instanceof mv&&(p.activate(),g.preventDefault()),p instanceof wa||g.preventDefault()}}],v0)}function a(){n.focus(),n.getKeyboardShortcutsCtrl().listen(v0)}function c(f){f.addLocalHook("afterSelectionChange",h=>{h.key.startsWith("filter_")||i.clear()}),f.addLocalHook("afterSubmenuOpen",o),f.addLocalHook("afterOpen",o),n=f}function u(){return n}function d(){return r}return{...i,listen:a,setMenu:c,getMenu:u,getLastMenuPage:d}}function oHe(t,e){VG(t,e),e.add(t)}function kk(t,e,r){VG(t,e),e.set(t,r)}function VG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w0(t,e,r){return(e=aHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aHe(t){var e=lHe(t,"string");return typeof e=="symbol"?e:e+""}function lHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PS(t,e,r){return t.set(rs(t,e),r),r}function wo(t,e){return t.get(rs(t,e))}function rs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const UM="filters",cHe=250,UF=UM;var ec=new WeakMap,YM=new WeakMap,mh=new WeakMap,Ts=new WeakSet;class uHe extends wt{static get PLUGIN_KEY(){return UM}static get PLUGIN_PRIORITY(){return cHe}static get DEFAULT_SETTINGS(){return{searchMode:"show"}}static get SETTINGS_VALIDATORS(){return{searchMode:e=>typeof e=="string"&&["show","apply"].includes(e)}}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var r;super(e),r=this,oHe(this,Ts),w0(this,"dropdownMenuPlugin",null),w0(this,"conditionCollection",null),w0(this,"conditionUpdateObserver",null),w0(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),w0(this,"filtersRowsMap",null),kk(this,ec,void 0),kk(this,YM,new WeakSet),kk(this,mh,[]),this.hot.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return rs(Ts,r,yHe).call(r,...i)})}isEnabled(){return!!this.hot.getSettings()[UM]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Qv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,n=r&&r.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>rs(Ts,this,YF).call(this,"accept")),a.addLocalHook("cancel",()=>rs(Ts,this,YF).call(this,"cancel")),a.addLocalHook("change",c=>rs(Ts,this,pHe).call(this,a,c)),a),s=()=>`${this.hot.getTranslatedPhrase(cj)}:`,o=()=>`${this.hot.getTranslatedPhrase(uj)}:`;if(!this.components.get("filter_by_condition")){const a=new zM(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:n});a.addLocalHook("afterClose",()=>rs(Ts,this,GF).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new xje(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new zM(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});a.addLocalHook("afterClose",()=>rs(Ts,this,GF).call(this)),this.components.set("filter_by_condition2",i(a))}if(!this.components.get("filter_by_value")){const a=this.getSetting("searchMode");this.components.set("filter_by_value",i(new $je(this.hot,{id:"filter_by_value",name:o,searchMode:a})))}if(this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new yv(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new CH(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new FG(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>rs(Ts,this,vHe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return rs(Ts,e,mHe).call(e,...c)}),this.addHook("beforeDropdownMenuShow",()=>rs(Ts,this,gHe).call(this)),this.addHook("afterDropdownMenuShow",()=>rs(Ts,this,hHe).call(this)),this.addHook("afterDropdownMenuHide",()=>rs(Ts,this,fHe).call(this)),this.addHook("afterChange",a=>rs(Ts,this,dHe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!wo(ec,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=wo(ec,this).getMenu(),d=u.getNavigator(),f=wo(ec,this).getLastMenuPage();u.focus(),f>0?d.setCurrentPage(f):d.toFirstItem()}},...Array.from(this.components).map(u=>{let[,d]=u;return d.getElements()}).flat()];PS(ec,this,sHe(this.dropdownMenuPlugin.menu,a));const c=u=>{wo(ec,this).listen(),u.preventDefault(),Am(u.keyCode,"TAB")&&(u.shiftKey?wo(ec,this).toPreviousItem():wo(ec,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",c),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",c)}this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:UF})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(UF)}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Qu;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const s=this.exportConditions(),o=this.hot.runHooks("beforeFilter",s,wo(mh,this));if(o!==!1&&n){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=_t(r.filter(),u=>u.meta.visualRow);const c=aw(i);Oe(this.hot.countSourceRows()-1,u=>{c(u)||a.push(u)}),B(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),PS(mh,this,this.exportConditions())}else o!==!1&&!n?(PS(mh,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(wo(mh,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),o!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return B(this.hot.getSourceDataAtCol(r),(i,s)=>{var o;const{row:a,col:c,visualCol:u,visualRow:d,type:f,instance:h,dateFormat:m,locale:g}=this.hot.getCellMeta(s,r),p=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&o!==void 0?o:i;n.push({meta:{row:a,col:c,visualCol:u,visualRow:d,type:f,instance:h,dateFormat:m,locale:g},value:wH(p)})}),n}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=WM(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===n1&&r.command.key!==Un&&n.command.key!==Un&&i.command.key!==Un?s=xH:i.command.key!==Un&&(r.command.key===Un||n.command.key===Un)&&(s=Qu),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new LG(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return B(i,o=>{B(r.menuItems,(a,c)=>{a.key===o.getMenuItemDescriptor().key&&e.push(c)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const c=this.getIndexesOfComponents(...o);e?i.showRows(c):i.hideRows(c),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function dHe(t){t&&B(t,e=>{const[,r]=e,n=this.hot.propToCol(r);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function hHe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function fHe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function gHe(){const t=this.dropdownMenuPlugin.menu;wo(YM,this).has(t)||wo(ec,this).setMenu(t),wo(YM,this).add(t)}function mHe(t){t.items.push({name:ot}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function YF(t){var e;if(t==="accept"){const n=this.getSelectedColumn();if(n===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=n,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),c=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==Un&&(this.conditionCollection.addCondition(i,s,c,u),o.command.key!==Un&&this.conditionCollection.addCondition(i,o,c,u)),a.command.key!==Un&&this.conditionCollection.addCondition(i,a,c,u),this.conditionUpdateObserver.flush(),this.components.forEach(d=>d.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function pHe(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===zM&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function GF(){this.setListeningDropdownMenu()}function yHe(t,e,r){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)&&r===this.hot.view.getColumnHeadersCount()-1?ee(e,"htFiltersActive"):Re(e,"htFiltersActive")}function vHe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:n},conditionArgsChange:i}=t;Array.isArray(i)&&PS(mh,this,wo(mh,this).map(a=>(a.column===n&&r.length>0&&a.conditions.forEach(c=>{c.name==="by_value"&&(c.args=[[...i]])}),a)));const s=r.filter(a=>a.name===kh),o=r.filter(a=>a.name!==kh);if(s.length>=2||o.length>=3)nt(Rt`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_operators").updateState(a,n),this.components.get("filter_by_value").updateState(t)}}const BG="internal-use-in-handsontable",GM={licenseKey:BG,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function WG(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[wi])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function zG(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function wHe(t){var e;const r=t[wi],n=zG(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=WG(t);return{...GM,...n,...i}}function bHe(t){var e;const r=t[wi],n=zG(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=WG(t);return{...n,...i}}function xHe(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function J_(){const t="engine_relationship",e=$o(wi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function _H(){const t="shared_engine_usage",e=$o(wi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function SHe(t){const e=t.getSettings(),r=e[wi],n=r==null?void 0:r.engine;if(r===!0||fr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return CHe((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&fr(n.hyperformula)){const s=J_(),o=_H().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:BG}),(n.getConfig().leapYear1900!==GM.leapYear1900||x_(n.getConfig().nullDate,GM.nullDate)===!1)&&nt(Rt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function CHe(t,e,r){const n=e[wi],i=wHe(e),s=J_(),o=_H();_He(t,n.functions),RHe(t,n.language);const a=t.buildEmpty(i);return s.set(a,[r]),o.set(a,[r.guid]),EHe(a,n.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function KF(t){var e;const r=J_(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function qF(t,e){if(t){const r=J_(),n=r.get(t),i=_H(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function _He(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(o){nt(o.message)}})}function RHe(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){nt(n.message)}}}function EHe(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:o}=r;try{t.addNamedExpression(n,i,s,o)}catch(a){nt(a.message)}}),t.resumeEvaluation())}function NHe(t,e){return(fr(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const UG="DD/MM/YYYY";function kHe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function THe(t){return kHe(t)?t.substr(1):t}function PHe(t){return typeof t=="string"&&t.startsWith("=")}function RH(t,e){return typeof t=="string"&&e==="date"}function YG(t,e){return ce(t,e,!0).isValid()}function GG(t,e){return ce(t,e,!0).format(UG)}function MHe(t,e){return ce(t,UG,!0).format(e)}function KG(t,e){const n=new Date(Date.UTC(0,0,t+-1));return ce(n).format(e)}function AHe(t,e,r){const n=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function OHe(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function IHe(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function EH(t,e,r){const n=OHe(t,AHe(t,e,r));return IHe(n)}function Fd(t,e,r){jHe(t,e),e.set(t,r)}function jHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cr(t,e){return t.get(qG(t,e))}function lu(t,e,r){return t.set(qG(t,e),r),r}function qG(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var b0=new WeakMap,cu=new WeakMap,Ps=new WeakMap,sx=new WeakMap,Tk=new WeakMap,Pk=new WeakMap,ox=new WeakMap;class XF{constructor(e,r,n){Fd(this,b0,void 0),Fd(this,cu,void 0),Fd(this,Ps,void 0),Fd(this,sx,[]),Fd(this,Tk,[]),Fd(this,Pk,void 0),Fd(this,ox,[]),lu(b0,this,e),lu(cu,this,r),lu(Ps,this,n)}setRemovedHfIndexes(e){return lu(ox,this,e.map(r=>{const n=cr(cu,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),cr(ox,this)}getRemovedHfIndexes(){return cr(ox,this)}getHfIndexFromVisualIndex(e){const r=cr(cu,this).getIndexesSequence(),n=cr(cu,this).getNotTrimmedIndexes();return r.indexOf(n[e],e)}syncMoves(e){const n=`move${_a(cr(b0,this))}s`;cr(Ps,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&cr(Ps,this).getEngine()[n](cr(Ps,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(lu(Tk,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),lu(Pk,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(cr(Ps,this).isPerformingUndoRedo()||e===!1||r===!1)return;const n=EH(cr(Tk,this),cr(Pk,this),cr(cu,this).getNumberOfIndexes());cr(Ps,this).getSheetId()===null?cr(Ps,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${_a(cr(b0,this))}Order`;return r=>{if(cr(Ps,this).isPerformingUndoRedo())return;const n=cr(cu,this).getIndexesSequence();if(r==="update"&&n.length>0){const i=cr(sx,this).map(c=>n.indexOf(c)),s=cr(Ps,this).getEngine().getSheetDimensions(cr(Ps,this).getSheetId());let o;cr(b0,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let c=a;c<o;c+=1)i.push(c);cr(Ps,this).getEngine()[e](cr(Ps,this).getSheetId(),i)}lu(sx,this,n)}}init(){lu(sx,this,cr(cu,this).getIndexesSequence())}}function Vd(t,e,r){HHe(t,e),e.set(t,r)}function HHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xl(t,e){return t.get(XG(t,e))}function Bd(t,e,r){return t.set(XG(t,e),r),r}function XG(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ax=new WeakMap,lx=new WeakMap,Mk=new WeakMap,Ak=new WeakMap,Ok=new WeakMap,Ik=new WeakMap,jk=new WeakMap;class $He{constructor(e,r,n){Vd(this,ax,void 0),Vd(this,lx,void 0),Vd(this,Mk,void 0),Vd(this,Ak,!1),Vd(this,Ok,!1),Vd(this,Ik,null),Vd(this,jk,null),Bd(ax,this,new XF("row",e,this)),Bd(lx,this,new XF("column",r,this)),Bd(Mk,this,n)}getForAxis(e){return e==="row"?Xl(ax,this):Xl(lx,this)}setPerformUndo(e){Bd(Ak,this,e)}setPerformRedo(e){Bd(Ok,this,e)}isPerformingUndoRedo(){return Xl(Ak,this)||Xl(Ok,this)}getSheetId(){return Xl(jk,this)}getEngine(){return Xl(Ik,this)}getPostponeAction(){return Xl(Mk,this)}setupSyncEndpoint(e,r){Bd(Ik,this,e),Bd(jk,this,r),Xl(ax,this).init(),Xl(lx,this).init()}}function DHe(t,e){QG(t,e),e.add(t)}function Wd(t,e,r){return(e=LHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LHe(t){var e=FHe(t,"string");return typeof e=="symbol"?e:e+""}function FHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hk(t,e,r){QG(t,e),e.set(t,r)}function QG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,r){return t.set(et(t,e),r),r}function Lh(t,e){return t.get(et(t,e))}function et(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wi="formulas",VHe=["maxRows","maxColumns","language"],BHe=260;_e.getSingleton().register("afterNamedExpressionAdded");_e.getSingleton().register("afterNamedExpressionRemoved");_e.getSingleton().register("afterSheetAdded");_e.getSingleton().register("afterSheetRemoved");_e.getSingleton().register("afterSheetRenamed");_e.getSingleton().register("afterFormulasValuesUpdate");const cp=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Ic=new WeakMap,Z_=new WeakMap,x0=new WeakMap,it=new WeakSet;class WHe extends wt{constructor(){var e;super(...arguments),e=this,DHe(this,it),Hk(this,Ic,!1),Hk(this,Z_,!1),Hk(this,x0,[["valuesUpdated",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return et(it,e,s$e).call(e,...n)}],["namedExpressionAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return et(it,e,o$e).call(e,...n)}],["namedExpressionRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return et(it,e,a$e).call(e,...n)}],["sheetAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return et(it,e,l$e).call(e,...n)}],["sheetRenamed",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return et(it,e,c$e).call(e,...n)}],["sheetRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return et(it,e,u$e).call(e,...n)}]]),Wd(this,"staticRegister",$o("formulas")),Wd(this,"engine",null),Wd(this,"sheetId",null),Wd(this,"sheetName",null),Wd(this,"indexSyncer",null),Wd(this,"rowAxisSyncer",null),Wd(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return wi}static get PLUGIN_PRIORITY(){return BHe}static get SETTING_KEYS(){return[wi,...VHe]}isEnabled(){return!!this.hot.getSettings()[wi]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=SHe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){nt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,et(it,this,vv).call(this));n!==!1&&et(it,this,wy).call(this,n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,QF).call(r,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,JF).call(r,...i)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,QF).call(r,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,JF).call(r,...i)}),this.addHook("modifyData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,GHe).call(r,...i)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,KHe).call(r,...i)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,zHe).call(r,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,qHe).call(r,...i)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,ZF).call(r,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,ZF).call(r,...i)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,XHe).call(r,...i)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,QHe).call(r,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,e$e).call(r,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,t$e).call(r,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,JHe).call(r,...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,ZHe).call(r,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,r$e).call(r,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,n$e).call(r,...i)}),this.indexSyncer=new $He(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("beforeColumnMove",(n,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("afterRowMove",(n,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(n,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,YHe).call(r,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,i$e).call(r,...i)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return et(it,r,UHe).call(r,...i)}),Lh(x0,this).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){Lh(x0,this).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),qF(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=bHe(this.hot.getSettings());xHe(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[wi];if(xe(n)&&xe(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[wi].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const s=this.addSheet(i??void 0,et(it,this,vv).call(this));et(it,this,wy).call(this,s)}}super.updatePlugin(e)}destroy(){Lh(x0,this).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),sd(x0,this,null),qF(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(xe(r)&&!LCe(r))return nt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return nt("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return nt(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){EI(`The sheet named \`${e}\` does not exist, switch aborted.`);return}et(it,this,wy).call(this,e);const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${_a(wi)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(n.has(o)||n.add(o))}),KF(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var o;const{row:a,col:c,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return xe(u)?`${u}:${a}x${c}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var o,a;const{row:c,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(xe(c)===!1||xe(u)===!1||c>=this.hot.countRows()||u>=this.hot.countCols())return;const d=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,f=n(s);if(d!==void 0&&!i.has(f)){const h=KF(this.engine).get(d);if(!h)return;h.validateCell(h.getDataAtCell(c,u),h.getCellMeta(c,u),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){nt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return RH(n,s.type)&&(YG(n,s.dateFormat)?n=GG(n,s.dateFormat):PHe(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function wy(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function JG(t,e,r){if(Le(r)&&r!==null){const n=this.hot.toVisualRow(t),i=this.hot.toVisualColumn(e),s=this.hot.getCellMeta(n,i).valueGetter;return s?s.call(this.hot,r):r.toString()}return r}function vv(t,e,r,n){return this.hot.getSourceDataArray(t,e,r,n).map((i,s)=>i.map((o,a)=>et(it,this,JG).call(this,s,a,o)))}function zHe(t,e,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(e,n)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},s=this.hot.getCellMeta(e,n);let o=this.engine.getCellValue(i);return s.type==="date"&&Di(o)&&(o=KG(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function UHe(t,e,r){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:c}=r.getTopStartCorner(),{row:u,col:d}=r.getBottomEndCorner(),f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(h)===!1)return!1;const m=this.engine.getFillRangeData(f,h),{row:g,col:p}=f.start,{row:y,col:w}=f.end,v=y-g+1,x=w-p+1;for(let S=0;S<m.length;S+=1)for(let N=0;N<m[S].length;N+=1){const R=m[S][N],E=g+S%v,P=p+N%x,D=this.hot.getCellMeta(E,P);RH(R,D.type)&&(R.startsWith("'")?m[S][N]=R.slice(1):this.isFormulaCellType(E,P,this.sheetId)===!1&&(m[S][N]=MHe(R,D.dateFormat)))}return m}function QF(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(_a(wi))||sd(Z_,this,fr(this.hot.getSettings().data))}function YHe(){if(Lh(Z_,this)){this.switchSheet(this.sheetName);return}const t=et(it,this,vv).call(this);t.forEach((r,n)=>{r.forEach((i,s)=>{const o=this.hot.getCellMeta(n,s,{skipMetaExtension:!0}),a=o.dateFormat;RH(i,o.type)&&(YG(i,a)?t[n][s]=GG(i,a):i.startsWith("=")||(t[n][s]=`'${i}`))})}),sd(Ic,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),sd(Ic,this,!1)}function JF(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(r.includes(_a(wi)))return;const n=NHe(this.engine,this.hot.getSettings()[wi].sheetName);if(et(it,this,wy).call(this,n),r!=="updateSettings")if(Lh(Z_,this))this.switchSheet(this.sheetName);else{const i=et(it,this,vv).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){sd(Ic,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),sd(Ic,this,!1)}}}function GHe(t,e,r,n){if(n!=="get"||Lh(Ic,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){r.value=THe(r.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let o=this.engine.getCellValue(s);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Di(o)&&(o=KG(o,a.dateFormat)),r.value=typeof o=="object"&&o!==null?o.value:o}function KHe(t,e,r,n){if(n!=="get"||Lh(Ic,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null)return;const o=this.getCellType(i,s);if(o==="VALUE"||o==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(c)}function ZF(t,e){if(cp(e))return;const r=[],n=[],i=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,c]=s;const u=this.hot.propToCol(a),d=this.hot.toPhysicalRow(o),f=this.hot.toPhysicalColumn(u),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c=et(it,this,JG).call(this,d,f,c),d!==null&&f!==null?this.syncChangeWithEngine(o,u,c):r.push([o,u,c]),n.push({address:h})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(o=>{let[a,c,u]=o;this.syncChangeWithEngine(a,c,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function qHe(t,e){if(cp(e))return;const r=[],n=[];t.forEach(i=>{let[s,o,,a]=i;const c=this.hot.propToCol(o);if(!Di(c))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){nt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}n.push({address:u}),r.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function XHe(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function QHe(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function JHe(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function ZHe(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function e$e(t,e,r){if(cp(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function t$e(t,e,r){if(cp(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function r$e(t,e,r,n){if(cp(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function n$e(t,e,r,n){if(cp(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function i$e(t,e,r){var n;sd(Ic,this,!0);const i=et(it,this,vv).call(this,r,0,r+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());sd(Ic,this,!1),i.forEach((s,o)=>{s.forEach((a,c)=>{this.engine.setCellContents({col:c,row:r+o,sheet:this.sheetId},[[a]])})})}function s$e(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function o$e(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function a$e(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function l$e(t){this.hot.runHooks("afterSheetAdded",t)}function c$e(t,e){et(it,this,wy).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function u$e(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function d$e(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(F2,r)},callback(){const{from:e,to:r}=this.getSelectedRangeActive(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let c=n;c<=i;c+=1)s.push(c);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function h$e(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(V2,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.view.adjustElementsSize(),this.render(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=_t(t.getHiddenColumns(),f=>this.toPhysicalColumn(f));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeActive(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),c=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),d=[];if(i!==s){const f=s-i+1,h=c-a+1;if(f>h){const m=u.slice(i,s+1);d.push(...m.filter(g=>r.includes(g)))}}else if(a===0&&a<i)d.push(...u.slice(0,i));else if(a===null)d.push(...u.slice(0,this.countCols()));else{const f=this.countCols()-1,h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));c===h&&f>s&&d.push(...u.slice(s+1))}return B(d,f=>{e.push(this.toVisualColumn(f))}),e.length===0}}}function f$e(t,e){ZG(t,e),e.add(t)}function g$e(t,e,r){ZG(t,e),e.set(t,r)}function ZG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zd(t,e){return t.get(xu(t,e))}function eV(t,e,r){return t.set(xu(t,e),r),r}function xu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("beforeHideColumns");_e.getSingleton().register("afterHideColumns");_e.getSingleton().register("beforeUnhideColumns");_e.getSingleton().register("afterUnhideColumns");const tV="hiddenColumns",m$e=310;var Ya=new WeakMap,Ud=new WeakSet;class p$e extends wt{constructor(){super(...arguments),f$e(this,Ud),g$e(this,Ya,null)}static get PLUGIN_KEY(){return tV}static get PLUGIN_PRIORITY(){return m$e}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[tV]}enablePlugin(){var e=this;this.enabled||(eV(Ya,this,new T_),zd(Ya,this).addLocalHook("init",()=>xu(Ud,this,S$e).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,zd(Ya,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return xu(Ud,e,x$e).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>xu(Ud,this,v$e).call(this,r,n,i)),this.addHook("modifyColWidth",(r,n)=>xu(Ud,this,y$e).call(this,r,n),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return xu(Ud,e,b$e).call(e,...n)}),this.addHook("modifyCopyableRange",r=>xu(Ud,this,w$e).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=zd(Ya,this).getValues().slice(),o=e.length>0;if(n&&o){const c=e.map(u=>this.hot.toPhysicalColumn(u));B(c,u=>{s[u]=!1}),i=bs(s,(u,d,f)=>(d&&u.push(this.hot.toVisualColumn(f)),u),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&o)!==!1&&(n&&o&&zd(Ya,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&o,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{B(e,o=>{zd(Ya,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return _t(zd(Ya,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return zd(Ya,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){B(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){eV(Ya,this,null),super.destroy()}}function y$e(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function v$e(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenColumn");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function w$e(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return B(t,n=>{let i=!0,s=0;Oe(n.startCol,n.endCol,o=>{this.isHidden(o)?(i||r(n.startRow,n.endRow,s,o-1),i=!0):(i&&(s=o),o===n.endCol&&r(n.startRow,n.endRow,s,o),i=!1)})}),e}function b$e(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),ee(e,r)}function x$e(t){t.items.push({name:ot},d$e(this),h$e(this))}function S$e(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function C$e(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(B2,r)},callback(){const{from:e,to:r}=this.getSelectedRangeActive(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let c=n;c<=i;c+=1)s.push(c);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function _$e(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(W2,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.view.adjustElementsSize(),this.render(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=_t(t.getHiddenRows(),f=>this.toPhysicalRow(f));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeActive(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),c=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),d=[];if(i!==s){const f=s-i+1,h=c-a+1;if(f>h){const m=u.slice(i,s+1);d.push(...m.filter(g=>r.includes(g)))}}else if(a===0&&a<i)d.push(...u.slice(0,i));else if(a===null)d.push(...u.slice(0,this.countRows()));else{const f=this.countRows()-1,h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));c===h&&f>s&&d.push(...u.slice(s+1))}return B(d,f=>{e.push(this.toVisualRow(f))}),e.length===0}}}function R$e(t,e){eK(t,e),e.add(t)}function E$e(t,e,r){eK(t,e),e.set(t,r)}function eK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yd(t,e){return t.get(Su(t,e))}function rV(t,e,r){return t.set(Su(t,e),r),r}function Su(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("beforeHideRows");_e.getSingleton().register("afterHideRows");_e.getSingleton().register("beforeUnhideRows");_e.getSingleton().register("afterUnhideRows");const nV="hiddenRows",N$e=320;var Ga=new WeakMap,Gd=new WeakSet;class k$e extends wt{constructor(){super(...arguments),R$e(this,Gd),E$e(this,Ga,null)}static get PLUGIN_KEY(){return nV}static get PLUGIN_PRIORITY(){return N$e}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[nV]}enablePlugin(){var e=this;this.enabled||(rV(Ga,this,new T_),Yd(Ga,this).addLocalHook("init",()=>Su(Gd,this,I$e).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Yd(Ga,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Su(Gd,e,O$e).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>Su(Gd,this,P$e).call(this,r,n,i)),this.addHook("modifyRowHeight",(r,n)=>Su(Gd,this,T$e).call(this,r,n)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Su(Gd,e,A$e).call(e,...n)}),this.addHook("modifyCopyableRange",r=>Su(Gd,this,M$e).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=Yd(Ga,this).getValues().slice(),o=e.length>0;if(n&&o){const c=e.map(u=>this.hot.toPhysicalRow(u));B(c,u=>{s[u]=!1}),i=bs(s,(u,d,f)=>(d&&u.push(this.hot.toVisualRow(f)),u),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&o)!==!1&&(n&&o&&Yd(Ga,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&o,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{B(e,o=>{Yd(Ga,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return _t(Yd(Ga,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Yd(Ga,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){B(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){rV(Ga,this,null),super.destroy()}}function T$e(t,e){return this.isHidden(e)?0:t}function P$e(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenRow");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function M$e(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return B(t,n=>{let i=!0,s=0;Oe(n.startRow,n.endRow,o=>{this.isHidden(o)?(i||r(s,o-1,n.startCol,n.endCol),i=!0):(i&&(s=o),o===n.endRow&&r(s,o,n.startCol,n.endCol),i=!1)})}),e}function A$e(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),ee(e,r)}function O$e(t){t.items.push({name:ot},C$e(this),_$e(this))}function I$e(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function j$e(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(p2)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function H$e(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(y2)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function $$e(t,e){tK(t,e),e.add(t)}function D$e(t,e,r){tK(t,e),e.set(t,r)}function tK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KM(t,e){return t.get(s1(t,e))}function $k(t,e,r){return t.set(s1(t,e),r),r}function s1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("beforeColumnFreeze");_e.getSingleton().register("afterColumnFreeze");_e.getSingleton().register("beforeColumnUnfreeze");_e.getSingleton().register("afterColumnUnfreeze");const iV="manualColumnFreeze",L$e=110;var lh=new WeakMap,Dk=new WeakSet;class F$e extends wt{constructor(){super(...arguments),$$e(this,Dk),D$e(this,lh,!1)}static get PLUGIN_KEY(){return iV}static get PLUGIN_PRIORITY(){return L$e}isEnabled(){return!!this.hot.getSettings()[iV]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>s1(Dk,this,V$e).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>s1(Dk,this,B$e).call(this,e,r)),super.enablePlugin())}disablePlugin(){$k(lh,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;KM(lh,this)||$k(lh,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;KM(lh,this)||$k(lh,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function V$e(t){t.items.push({name:"---------"},j$e(this),H$e(this))}function B$e(t,e){if(KM(lh,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(n=>n<r))return!1}}function cx(t,e,r){return(e=W$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W$e(t){var e=z$e(t,"string");return typeof e=="symbol"?e:e+""}function z$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lk=0,sV=1,oV=2,og="px";let rK=class{constructor(e){cx(this,"hot",void 0),cx(this,"_element",null),cx(this,"state",Lk),cx(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=oV}build(){this.state===Lk&&(this._element=this.hot.rootDocument.createElement("div"),this.state=sV)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Lk}isAppended(){return this.state===oV}isBuilt(){return this.state>=sV}setPosition(e,r){Di(e)&&(this._element.style.top=e+og),Di(r)&&(this._element.style[this.inlineProperty]=r+og)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){Di(e)&&(this._element.style.width=e+og),Di(r)&&(this._element.style.height=r+og)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){Di(e)&&(this._element.style.marginTop=e+og),Di(r)&&(this._element.style[`margin${_a(this.inlineProperty)}`]=r+og)}getOffset(){const e=this._element.style,r=`margin${_a(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const U$e="ht__manualColumnMove--backlight";let Y$e=class extends rK{build(){super.build(),ee(this._element,U$e)}};const G$e="ht__manualColumnMove--guideline";let K$e=class extends rK{build(){super.build(),ee(this._element,G$e)}};function q$e(t,e){nK(t,e),e.add(t)}function Ko(t,e,r){nK(t,e),e.set(t,r)}function nK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ls(t,e,r){return t.set(Cu(t,e),r),r}function Me(t,e){return t.get(Cu(t,e))}function Cu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("beforeColumnMove");_e.getSingleton().register("afterColumnMove");const Fk="manualColumnMove",X$e=120,aV="ht__manualColumnMove",o1="show-ui",qM="on-moving--columns",XM="after-selection--columns";var ji=new WeakMap,Nu=new WeakMap,yc=new WeakMap,MS=new WeakMap,$u=new WeakMap,Ii=new WeakMap,ux=new WeakMap,mo=new WeakMap,kg=new WeakMap,a1=new WeakMap,by=new WeakMap,Kd=new WeakSet;class Q$e extends wt{constructor(){super(...arguments),q$e(this,Kd),Ko(this,ji,new Y$e(this.hot)),Ko(this,Nu,new K$e(this.hot)),Ko(this,yc,[]),Ko(this,MS,0),Ko(this,$u,!1),Ko(this,Ii,{}),Ko(this,ux,void 0),Ko(this,mo,void 0),Ko(this,kg,void 0),Ko(this,a1,void 0),Ko(this,by,void 0)}static get PLUGIN_KEY(){return Fk}static get PLUGIN_PRIORITY(){return X$e}isEnabled(){return!!this.hot.getSettings()[Fk]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cu(Kd,e,J$e).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cu(Kd,e,eDe).call(e,...n)}),this.addHook("afterScrollVertically",()=>Cu(Kd,this,rDe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cu(Kd,e,nDe).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,aV),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Re(this.hot.rootElement,aV),this.unregisterEvents(),Me(ji,this).destroy(),Me(Nu,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=Me(ux,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,n,i);if(ls(ux,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=i&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,n,i,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r);return ls(ux,this,r),this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(c=>c<0),a=e.some(c=>c>=n);return!(i||s||o||a)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=bs(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const o=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Fk];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return Oe(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Me(mo,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Me(mo,this)-1);const o=r.hider.offsetWidth,a=r.TBODY.offsetLeft,c=Me(ji,this).getOffset().start,u=Me(ji,this).getSize().width;let d=0,f=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,p=sn(this.hot.rootElement),y=g.innerWidth-Me(kg,this)-p;f=g.innerWidth-Me(Ii,this).eventPageX-y-(n.scrollX===void 0?i:0)}else f=Me(Ii,this).eventPageX-(Me(kg,this)-(n.scrollX===void 0?i:0));if(Me(a1,this)&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Me(mo,this))&&(s+=i),s+=d,Me(mo,this)<0)Me(by,this)>0?Me(Ii,this).col=0:Me(Ii,this).col=e>0?e-1:e;else if(Me(Ii,this).TD.offsetWidth/2+s<=f){const g=Me(mo,this)>=Me(MS,this)?Me(MS,this)-1:Me(mo,this);Me(Ii,this).col=g+1,s+=Me(Ii,this).TD.offsetWidth}else Me(Ii,this).col=Me(mo,this);let h=f,m=s;f+u+c>=o?h=o-u-c:f+c<a+d&&(h=a+d+Math.abs(c)),s>=o-1?m=o-1:m===0?m=1:n.scrollX!==void 0&&Me(mo,this)<Me(by,this)&&(m-=Me(kg,this)<=n.scrollX?Me(kg,this):0),Me(ji,this).setPosition(null,h),Me(Nu,this).setPosition(null,m)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Cu(Kd,this,Z$e).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Cu(Kd,this,tDe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Me(ji,this).build(),Me(Nu,this).build()}destroy(){Me(ji,this).destroy(),Me(Nu,this).destroy(),super.destroy()}}function J$e(t,e,r,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeActive(),a=Ve(t.target,"sortAction");if(!o||!s||Me($u,this)||t.button!==0||a){ls($u,this,!1),Me(yc,this).length=0,Re(this.hot.rootElement,[qM,o1]);return}const c=Me(Nu,this).isBuilt()&&!Me(Nu,this).isAppended(),u=Me(ji,this).isBuilt()&&!Me(ji,this).isAppended();c&&u&&(Me(Nu,this).appendTo(i.hider),Me(ji,this).appendTo(i.hider));const{from:d,to:f}=o,h=Math.min(d.col,f.col),m=Math.max(d.col,f.col);if(e.row<0&&e.col>=h&&e.col<=m){n.column=!0,ls($u,this,!0);const g=r.firstChild?yve(t,r.firstChild).x:t.offsetX;Me(Ii,this).eventPageX=t.pageX,ls(mo,this,e.col),Me(Ii,this).TD=r,Me(Ii,this).col=e.col,ls(yc,this,this.prepareColumnsToMoving(h,m)),ls(a1,this,!!this.hot.getSettings().rowHeaders),ls(MS,this,this.hot.countCols()),ls(by,this,this.hot.getSettings().fixedColumnsStart),ls(kg,this,xi(this.hot.rootElement).left);const p=Me(a1,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,w=e.col<Me(by,this),v=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),x=Math.abs(g-(this.hot.isRtl()?r.offsetWidth:0)),S=this.getColumnsWidth(h,e.col-1)+x,N=this.getColumnsWidth(p,h-1)+(w?v:0)+S;Me(ji,this).setPosition(y,N),Me(ji,this).setSize(this.getColumnsWidth(h,m),i.hider.offsetHeight-y),Me(ji,this).setOffset(null,-S),ee(this.hot.rootElement,qM)}else Re(this.hot.rootElement,XM),ls($u,this,!1),Me(yc,this).length=0}function Z$e(t){Me($u,this)&&(Me(Ii,this).eventPageX=t.pageX,this.refreshPositions())}function eDe(t,e,r,n){!this.hot.getSelectedRangeActive()||!Me($u,this)||(Me(yc,this).indexOf(e.col)>-1?Re(this.hot.rootElement,o1):ee(this.hot.rootElement,o1),n.row=!0,n.column=!0,n.cell=!0,ls(mo,this,e.col),Me(Ii,this).TD=r)}function tDe(){const t=Me(Ii,this).col,e=Me(yc,this).length;if(ls(mo,this,void 0),ls($u,this,!1),Re(this.hot.rootElement,[qM,o1,XM]),this.hot.selection.isSelectedByColumnHeader()&&ee(this.hot.rootElement,XM),e<1||t===void 0)return;const r=Me(yc,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns(Me(yc,this),t);if(Me(yc,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const s=this.hot.toVisualColumn(n),o=s+e-1;this.hot.selectColumns(s,o)}}function rDe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,n=e+r;Me(ji,this).setPosition(n),Me(ji,this).setSize(null,t.hider.offsetHeight-n)}function nDe(){this.moveBySettingsOrLoad()}function iDe(t,e){iK(t,e),e.add(t)}function ui(t,e,r){iK(t,e),e.set(t,r)}function iK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yr(t,e,r){return t.set(na(t,e),r),r}function Ce(t,e){return t.get(na(t,e))}function na(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const l1="manualColumnResize",sDe=130,lV="manualColumnWidths";var lc=new WeakMap,dx=new WeakMap,Fs=new WeakMap,c1=new WeakMap,bl=new WeakMap,oDe=new WeakMap,mm=new WeakMap,hx=new WeakMap,ts=new WeakMap,tc=new WeakMap,nf=new WeakMap,u1=new WeakMap,Xg=new WeakMap,xy=new WeakMap,Ws=new WeakMap,Sy=new WeakMap,Ka=new WeakSet;class aDe extends wt{static get PLUGIN_KEY(){return l1}static get PLUGIN_PRIORITY(){return sDe}constructor(e){super(e),iDe(this,Ka),ui(this,lc,null),ui(this,dx,null),ui(this,Fs,[]),ui(this,c1,null),ui(this,bl,null),ui(this,oDe,null),ui(this,mm,null),ui(this,hx,null),ui(this,ts,this.hot.rootDocument.createElement("DIV")),ui(this,tc,this.hot.rootDocument.createElement("DIV")),ui(this,nf,null),ui(this,u1,!1),ui(this,Xg,0),ui(this,xy,null),ui(this,Ws,void 0),ui(this,Sy,void 0),ee(Ce(ts,this),"manualColumnResizer"),ee(Ce(tc,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[l1]}enablePlugin(){var e=this;this.enabled||(Yr(Ws,this,new hd),Ce(Ws,this).addLocalHook("init",()=>na(Ka,this,lDe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ce(Ws,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return na(Ka,e,gDe).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return na(Ka,e,mDe).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return na(Ka,e,pDe).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Yr(Sy,this,Ce(Ws,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",lV,Ce(Ws,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",lV,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return Ce(Ws,this).setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);Ce(Ws,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode||Ce(Xg,this)>1)return;Yr(lc,this,e);const{_wt:r}=this.hot.view,n=r.wtTable.getCoords(Ce(lc,this)),i=n.col;if(i<0)return;const s=yn(Ce(lc,this)),o=Ce(lc,this).getBoundingClientRect(),a=i<r.getSetting("fixedColumnsStart");let c;a&&(c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ce(lc,this),n.row,n.col)),c||(c=r.wtOverlays.topOverlay.getRelativeCellPosition(Ce(lc,this),n.row,n.col)),Yr(dx,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Yr(Fs,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const d=this.hot.getSelectedRange();B(d,f=>{const h=f.getTopStartCorner().col,m=f.getBottomEndCorner().col;Oe(h,m,g=>{Ce(Fs,this).includes(g)||Ce(Fs,this).push(g)})})}Ce(Fs,this).includes(Ce(dx,this))||Yr(Fs,this,[Ce(dx,this)]),Yr(hx,this,c.start-6),Yr(mm,this,parseInt(o.width,10)),Ce(ts,this).style.top=`${c.top}px`,Ce(ts,this).style[this.inlineDir]=`${Ce(hx,this)+Ce(mm,this)}px`,Ce(ts,this).style.height=`${s}px`,this.hot.rootElement.appendChild(Ce(ts,this))}refreshHandlePosition(){Ce(ts,this).style[this.inlineDir]=`${Ce(hx,this)+Ce(c1,this)}px`}setupGuidePosition(){const e=parseInt(yn(Ce(ts,this)),10),r=parseInt(Ce(ts,this).style.top,10)+e,n=this.hot.view.getTableHeight();ee(Ce(ts,this),"active"),ee(Ce(tc,this),"active"),Ce(tc,this).style.top=`${r}px`,this.refreshGuidePosition(),Ce(tc,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(Ce(tc,this))}refreshGuidePosition(){Ce(tc,this).style[this.inlineDir]=Ce(ts,this).style[this.inlineDir]}hideHandleAndGuide(){Re(Ce(ts,this),"active"),Re(Ce(tc,this),"active")}checkIfColumnHeader(e){const r=qh(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",Ce(bl,this),n,!0);s!==void 0&&Yr(bl,this,s),this.setManualSize(n,Ce(bl,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ce(bl,this),n,!0),i&&e()};Ce(Xg,this)>=2&&(Ce(Fs,this).length>1?(B(Ce(Fs,this),i=>{r(i)}),e()):B(Ce(Fs,this),i=>{r(i,!0)})),Yr(Xg,this,0),Yr(xy,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>na(Ka,this,cDe).call(this,n)),this.eventManager.addEventListener(r,"mousedown",n=>na(Ka,this,uDe).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>na(Ka,this,dDe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>na(Ka,this,hDe).call(this)),this.eventManager.addEventListener(Ce(ts,this),"contextmenu",()=>na(Ka,this,fDe).call(this))}destroy(){super.destroy()}}function lDe(){const t=this.hot.getSettings()[l1],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,n)=>{Ce(Ws,this).setValueAtIndex(n,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,n)=>{Ce(Ws,this).setValueAtIndex(n,r)})},!0),Yr(Sy,this,t)):t===!0&&Array.isArray(Ce(Sy,this))&&this.hot.batchExecution(()=>{Ce(Sy,this).forEach((r,n)=>{Ce(Ws,this).setValueAtIndex(n,r)})},!0)}function cDe(t){if(!jU(t.target)&&Ce(u1,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(Ce(nf,this)||this.setupHandlePosition(e))}}function uDe(t){t.target.parentNode===this.hot.rootElement&&Ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Ce(lc,this)),this.setupGuidePosition(),Yr(nf,this,!0),Ce(xy,this)===null&&(Yr(xy,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ce(xy,this))),Yr(Xg,this,Ce(Xg,this)+1),this.startX=t.pageX,Yr(bl,this,Ce(mm,this)))}function dDe(t){if(Ce(nf,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Yr(c1,this,Ce(mm,this)+e),B(Ce(Fs,this),r=>{Yr(bl,this,this.setManualSize(r,Ce(c1,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function hDe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(r,n)=>{this.hot.runHooks("beforeColumnResize",Ce(bl,this),r,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ce(bl,this),r,!1)};Ce(nf,this)&&(this.hideHandleAndGuide(),Yr(nf,this,!1),Ce(bl,this)!==Ce(mm,this)&&(Ce(Fs,this).length>1?(B(Ce(Fs,this),n=>{e(n)}),t()):B(Ce(Fs,this),n=>{e(n,!0)})),this.setupHandlePosition(Ce(lc,this)))}function fDe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ce(ts,this)),this.hot.rootElement.removeChild(Ce(tc,this)),Yr(nf,this,!1),Yr(u1,this,!0),this.hot._registerImmediate(()=>{Yr(u1,this,!1)})}function gDe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalColumn(e),i=Ce(Ws,this).getValueAtIndex(n);this.hot.getSettings()[l1]&&i&&(r=i)}return r}function mDe(t,e){const r=Ce(Ws,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function pDe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Vk(t,e,r){return(e=yDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yDe(t){var e=vDe(t,"string");return typeof e=="symbol"?e:e+""}function vDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Bk=0,cV=1,uV=2,ag="px";let sK=class{constructor(e){Vk(this,"hot",void 0),Vk(this,"_element",null),Vk(this,"state",Bk),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=uV}build(){this.state===Bk&&(this._element=this.hot.rootDocument.createElement("div"),this.state=cV)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Bk}isAppended(){return this.state===uV}isBuilt(){return this.state>=cV}setPosition(e,r){e!==void 0&&(this._element.style.top=e+ag),r!==void 0&&(this._element.style.left=r+ag)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+ag),r&&(this._element.style.height=r+ag)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+ag),r&&(this._element.style.marginLeft=r+ag)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const wDe="ht__manualRowMove--backlight";class bDe extends sK{build(){super.build(),ee(this._element,wDe)}}const xDe="ht__manualRowMove--guideline";class SDe extends sK{build(){super.build(),ee(this._element,xDe)}}function CDe(t,e){oK(t,e),e.add(t)}function lg(t,e,r){oK(t,e),e.set(t,r)}function oK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Th(t,e,r){return t.set(_u(t,e),r),r}function Ke(t,e){return t.get(_u(t,e))}function _u(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("beforeRowMove");_e.getSingleton().register("afterRowMove");const Wk="manualRowMove",_De=140,dV="ht__manualRowMove",d1="show-ui",QM="on-moving--rows",JM="after-selection--rows";var Hi=new WeakMap,ku=new WeakMap,vc=new WeakMap,Du=new WeakMap,cs=new WeakMap,fx=new WeakMap,qd=new WeakSet;class RDe extends wt{constructor(){super(...arguments),CDe(this,qd),lg(this,Hi,new bDe(this.hot)),lg(this,ku,new SDe(this.hot)),lg(this,vc,[]),lg(this,Du,void 0),lg(this,cs,{}),lg(this,fx,void 0)}static get PLUGIN_KEY(){return Wk}static get PLUGIN_PRIORITY(){return _De}isEnabled(){return!!this.hot.getSettings()[Wk]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return _u(qd,e,EDe).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return _u(qd,e,kDe).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>_u(qd,this,PDe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return _u(qd,e,MDe).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,dV),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Re(this.hot.rootElement,dV),this.unregisterEvents(),Ke(Hi,this).destroy(),Ke(ku,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=Ke(fx,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,n,i);if(Th(fx,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=i&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,n,i,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r);return Th(fx,this,r),this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(c=>c<0),a=e.some(c=>c>=n);return!(i||s||o||a)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=bs(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const o=n.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Wk];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),o=Math.max(n.row,i.row);return Oe(s,o,a=>{r.push(a)}),r}refreshPositions(){const e=Ke(cs,this).coords,r=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=Ke(cs,this).TD,a=this.hot.rootElement,c=xi(a),u=nv(a),d=s.holder.scrollTop,f=this.hot.rootWindow!==u?u.scrollTop:0,h=c.top-f,m=Ke(cs,this).eventPageY-h+d,g=s.hider.offsetHeight,p=s.TBODY.offsetTop,y=Ke(Hi,this).getOffset().top,w=Ke(Hi,this).getSize().height,v=o.offsetHeight/2,x=o.offsetHeight;let S=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const N=m>=S+v;this.isFixedRowTop(e.row)&&(S+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ke(cs,this).row=r>0?r-1:r:N?(Ke(cs,this).row=e.row+1,S+=e.row===0?x-1:x):Ke(cs,this).row=e.row;let R=m,E=S;m+w+y>=g?R=g-w-y:m+y<p&&(R=p+Math.abs(y)),S>=g-1&&(E=g-1),Ke(Hi,this).setPosition(R),Ke(ku,this).setPosition(E)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>_u(qd,this,NDe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>_u(qd,this,TDe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ke(Hi,this).build(),Ke(ku,this).build()}destroy(){Ke(Hi,this).destroy(),Ke(ku,this).destroy(),super.destroy()}}function EDe(t,e,r,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeActive();if(!a||!o||Ke(Du,this)||t.button!==0){Th(Du,this,!1),Ke(vc,this).length=0,Re(this.hot.rootElement,[QM,d1]);return}const c=Ke(ku,this).isBuilt()&&!Ke(ku,this).isAppended(),u=Ke(Hi,this).isBuilt()&&!Ke(Hi,this).isAppended();c&&u&&(Ke(ku,this).appendTo(i.hider),Ke(Hi,this).appendTo(i.hider));const{from:d,to:f}=a,h=Math.min(d.row,f.row),m=Math.max(d.row,f.row);if(e.col<0&&e.row>=h&&e.row<=m){n.row=!0,Th(Du,this,!0),Ke(cs,this).eventPageY=t.pageY,Ke(cs,this).coords=e,Ke(cs,this).TD=r,Th(vc,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+s.getRowHeaderWidth(),p=this.getRowsHeight(h,e.row-1)+(t.clientY-r.getBoundingClientRect().top);Ke(Hi,this).setPosition(null,g),Ke(Hi,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(h,m)),Ke(Hi,this).setOffset(-p,null),ee(this.hot.rootElement,QM),this.refreshPositions()}else Re(this.hot.rootElement,JM),Th(Du,this,!1),Ke(vc,this).length=0}function NDe(t){Ke(Du,this)&&(Ke(cs,this).eventPageY=t.pageY,this.refreshPositions())}function kDe(t,e,r,n){!this.hot.getSelectedRangeActive()||!Ke(Du,this)||(Ke(vc,this).indexOf(e.row)>-1?Re(this.hot.rootElement,d1):ee(this.hot.rootElement,d1),n.row=!0,n.column=!0,n.cell=!0,Ke(cs,this).coords=e,Ke(cs,this).TD=r)}function TDe(){const t=Ke(cs,this).row,e=Ke(vc,this).length;if(Th(Du,this,!1),Re(this.hot.rootElement,[QM,d1,JM]),this.hot.selection.isSelectedByRowHeader()&&ee(this.hot.rootElement,JM),e<1||t===void 0)return;const r=Ke(vc,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(Ke(vc,this),t);if(Ke(vc,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const s=this.hot.toVisualRow(n),o=s+e-1;this.hot.selectRows(s,o)}}function PDe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,n=e+r;Ke(Hi,this).setPosition(null,n),Ke(Hi,this).setSize(t.hider.offsetWidth-n)}function MDe(){this.moveBySettingsOrLoad()}function ADe(t,e){aK(t,e),e.add(t)}function di(t,e,r){aK(t,e),e.set(t,r)}function aK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pr(t,e,r){return t.set(cc(t,e),r),r}function be(t,e){return t.get(cc(t,e))}function cc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const h1="manualRowResize",ODe=30,hV="manualRowHeights";var cl=new WeakMap,gx=new WeakMap,Vs=new WeakMap,Cy=new WeakMap,Tu=new WeakMap,NH=new WeakMap,pm=new WeakMap,mx=new WeakMap,Ti=new WeakMap,sl=new WeakMap,sf=new WeakMap,f1=new WeakMap,Qg=new WeakMap,_y=new WeakMap,ua=new WeakMap,Ry=new WeakMap,uu=new WeakSet;class IDe extends wt{static get PLUGIN_KEY(){return h1}static get PLUGIN_PRIORITY(){return ODe}constructor(e){super(e),ADe(this,uu),di(this,cl,null),di(this,gx,null),di(this,Vs,[]),di(this,Cy,null),di(this,Tu,null),di(this,NH,null),di(this,pm,null),di(this,mx,null),di(this,Ti,this.hot.rootDocument.createElement("DIV")),di(this,sl,this.hot.rootDocument.createElement("DIV")),di(this,sf,!1),di(this,f1,!1),di(this,Qg,0),di(this,_y,null),di(this,ua,void 0),di(this,Ry,void 0),ee(be(Ti,this),"manualRowResizer"),ee(be(sl,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[h1]}enablePlugin(){this.enabled||(Pr(ua,this,new hd),be(ua,this).addLocalHook("init",()=>cc(uu,this,VDe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,be(ua,this)),this.addHook("modifyRowHeight",(e,r)=>cc(uu,this,FDe).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Pr(Ry,this,be(ua,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",hV,be(ua,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",hV,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,this.hot.stylesHandler.getDefaultRowHeight());return be(ua,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return be(Cy,this)}setupHandlePosition(e){if(be(Qg,this)>1)return;Pr(cl,this,e);const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(be(cl,this)),s=i.row;if(s<0)return;const o=sn(be(cl,this)),a=be(cl,this).getBoundingClientRect(),c=s<n.getSetting("fixedRowsTop"),u=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let d;c?d=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(be(cl,this),i.row,i.col):u&&(d=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(be(cl,this),i.row,i.col)),d||(d=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(be(cl,this),i.row,i.col)),Pr(gx,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Pr(Vs,this,[]);const f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){const h=this.hot.getSelectedRange();B(h,m=>{const g=m.getTopStartCorner().row,p=m.getBottomStartCorner().row;Oe(g,p,y=>{be(Vs,this).includes(y)||be(Vs,this).push(y)})})}be(Vs,this).includes(be(gx,this))||Pr(Vs,this,[be(gx,this)]),Pr(mx,this,d.top-6),Pr(pm,this,parseInt(a.height,10)),be(Ti,this).style.top=`${be(mx,this)+be(pm,this)}px`,be(Ti,this).style[this.inlineDir]=`${d.start}px`,be(Ti,this).style.width=`${o}px`,this.hot.rootElement.appendChild(be(Ti,this))}refreshHandlePosition(){be(Ti,this).style.top=`${be(mx,this)+be(Cy,this)}px`}setupGuidePosition(){const e=parseInt(sn(be(Ti,this)),10),r=parseInt(be(Ti,this).style[this.inlineDir],10)+e,n=this.hot.view.getTableWidth();ee(be(Ti,this),"active"),ee(be(sl,this),"active"),be(sl,this).style.top=be(Ti,this).style.top,be(sl,this).style[this.inlineDir]=`${r}px`,be(sl,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(be(sl,this))}refreshGuidePosition(){be(sl,this).style.top=be(Ti,this).style.top}hideHandleAndGuide(){Re(be(Ti,this),"active"),Re(be(sl,this),"active")}checkIfRowHeader(e){const r=qh(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&be(Tu,this)<r?r:be(Tu,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&Pr(Tu,this,s),this.setManualSize(n,be(Tu,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};be(Qg,this)>=2&&(be(Vs,this).length>1?(B(be(Vs,this),i=>{r(i)}),e()):B(be(Vs,this),i=>{r(i,!0)})),Pr(Qg,this,0),Pr(_y,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>cc(uu,this,jDe).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>cc(uu,this,HDe).call(this,n)),this.eventManager.addEventListener(r,"mousemove",n=>cc(uu,this,$De).call(this,n)),this.eventManager.addEventListener(r,"mouseup",()=>cc(uu,this,DDe).call(this)),this.eventManager.addEventListener(be(Ti,this),"contextmenu",()=>cc(uu,this,LDe).call(this))}destroy(){super.destroy()}}function jDe(t){if(!jU(t.target)&&be(f1,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(be(sf,this)||this.setupHandlePosition(e))}}function HDe(t){Ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(be(cl,this)),this.setupGuidePosition(),Pr(sf,this,!0),be(_y,this)===null&&(Pr(_y,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(be(_y,this))),Pr(Qg,this,be(Qg,this)+1),Pr(NH,this,t.pageY),Pr(Tu,this,be(pm,this)))}function $De(t){be(sf,this)&&(Pr(Cy,this,be(pm,this)+(t.pageY-be(NH,this))),B(be(Vs,this),e=>{Pr(Tu,this,this.setManualSize(e,be(Cy,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function DDe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};be(sf,this)&&(this.hideHandleAndGuide(),Pr(sf,this,!1),be(Tu,this)!==be(pm,this)&&(be(Vs,this).length>1?(B(be(Vs,this),n=>{e(n)}),t()):B(be(Vs,this),n=>{e(n,!0)})),this.setupHandlePosition(be(cl,this)))}function LDe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(be(Ti,this)),this.hot.rootElement.removeChild(be(sl,this)),Pr(sf,this,!1),Pr(f1,this,!0),this.hot._registerImmediate(()=>{Pr(f1,this,!1)})}function FDe(t,e){let r=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),s=be(ua,this).getValueAtIndex(i);if(this.hot.getSettings()[h1]&&s){var n;(n=this.hot.getPlugin("autoRowSize"))!==null&&n!==void 0&&n.isEnabled()?r=Math.max(s,r??0):r=s}}return r}function VDe(){const t=this.hot.getSettings()[h1],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,n)=>{be(ua,this).setValueAtIndex(n,r)}):Array.isArray(t)?(t.forEach((r,n)=>{be(ua,this).setValueAtIndex(n,r)}),Pr(Ry,this,t)):t===!0&&Array.isArray(be(Ry,this))&&be(Ry,this).forEach((r,n)=>{be(ua,this).setValueAtIndex(n,r)})},!0)}var BDe=E_;BDe("flatMap");var WDe=wn,fV=bn,zDe=Al,UDe=$O,YDe=function(t,e){(!e||typeof t!="string")&&fV(t);var r=UDe(t);return zDe(fV(r!==void 0?WDe(r,t):t))},GDe=Jt,ZM=wn,KDe=vs,eA=bn,qDe=Al,XDe=YDe,QDe=WO,tA=ws,JDe=zO,ZDe=ud,lK=!JDe("flatMap",function(){}),rA=!lK&&ZDe("flatMap",TypeError),eLe=lK||rA,tLe=QDe(function(){for(var t=this.iterator,e=this.mapper,r,n;;){if(n=this.inner)try{if(r=eA(ZM(n.next,n.iterator)),!r.done)return r.value;this.inner=null}catch(i){tA(t,"throw",i)}if(r=eA(ZM(this.next,t)),this.done=!!r.done)return;try{this.inner=XDe(e(r.value,this.counter++),!1)}catch(i){tA(t,"throw",i)}}});GDe({target:"Iterator",proto:!0,real:!0,forced:eLe},{flatMap:function(e){eA(this);try{KDe(e)}catch(r){tA(this,"throw",r)}return rA?ZM(rA,this,e):new tLe(qDe(this),{mapper:e,inner:null})}});function rLe(t,e,r){nLe(t,e),e.set(t,r)}function nLe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xd(t,e,r){return(e=iLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iLe(t){var e=sLe(t,"string");return typeof e=="symbol"?e:e+""}function sLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gV(t,e){return t.get(cK(t,e))}function px(t,e,r){return t.set(cK(t,e),r),r}function cK(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qd=new WeakMap;class ul{constructor(e,r,n,i,s,o){Xd(this,"row",void 0),Xd(this,"col",void 0),Xd(this,"rowspan",void 0),Xd(this,"colspan",void 0),Xd(this,"removed",!1),Xd(this,"cellCoordsFactory",void 0),Xd(this,"cellRangeFactory",void 0),rLe(this,Qd,null),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return Rt`The merged cell declared with {row: ${r}, col: ${n},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:n}=e;return Rt`The merged cell declared at [${r}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:n}=e;return Rt`The merged cell declared at [${r}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:n}=e;return Rt`The merged cell declared at [${r}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return r<0||n<0||i<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:n}=e;return n===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:n}=e;return n===0||r===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),px(Qd,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(r,i),c=Math.max(r,i),u=this[o],d=this[o]+this[s]-1;if(u>=r&&(this[o]+=n),n>0)r<=d&&r>u&&(this[s]+=n);else if(n<0){if(a<=u&&c>=d)return this.removed=!0,px(Qd,this,null),!1;if(u>=a&&u<=c){const f=c-u+1,h=Math.abs(n)-f;this[o]-=h+n,this[s]-=f}else if(u<=a&&d>=c)this[s]+=n;else if(u<=a&&d>=a&&d<c){const f=d-a+1;this[s]-=f}}return px(Qd,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return gV(Qd,this)||px(Qd,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),gV(Qd,this)}}function oLe(t,e){aLe(t,e),e.add(t)}function aLe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yx(t,e,r){return(e=lLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lLe(t){var e=cLe(t,"string");return typeof e=="symbol"?e:e+""}function cLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jd(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var du=new WeakSet;class g1{constructor(e){oLe(this,du),yx(this,"plugin",void 0),yx(this,"mergedCells",[]),yx(this,"mergedCellsMatrix",new Map),yx(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:n}=e;return Rt`The merged cell declared at [${r}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(r))!==null&&n!==void 0?n:!1}getByRange(e){const{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let c=0;c<o;c++){const u=this.mergedCells[c],{row:d,col:f,rowspan:h,colspan:m}=u;if(d>=r&&d+h-1<=i&&f>=n&&f+m-1<=s){a=u;break}}return a}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:c}=i;for(let u=s;u<s+c;u++)for(let d=o;d<o+a;d++)r.add(`r${u},c${d}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:c}=i,u=new Set;let d=!1;for(let f=s;f<s+c;f++){for(let h=o;h<o+a;h++){const m=`r${f},c${h}`;if(r.has(m)){nt(g1.IS_OVERLAPPING_WARNING(i)),d=!0;break}u.add(m)}if(d)break}return d||r.add(...u),!d})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let c=n;c<=s;c++)for(let u=i;u<=o;u++){const d=this.get(c,u);d&&(r||!r&&d.row===c&&d.col===u)&&a.push(d)}return a}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new ul(n,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),c=this.get(n,i),u=r?!1:this.isOverlapping(a);return!c&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Jd(du,this,mV).call(this,a),a):(u&&nt(g1.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,r){const n=this.get(e,r),i=n?this.mergedCells.indexOf(n):-1;return n&&i!==-1?(this.mergedCells.splice(i,1),Jd(du,this,uLe).call(this,n),n):!1}clear(){B(this.mergedCells,e=>{let{row:r,col:n,rowspan:i,colspan:s}=e;Oe(r,r+i,o=>{Oe(n,n+s,a=>{const c=this.hot.getCell(o,a);c&&(c.removeAttribute("rowspan"),c.removeAttribute("colspan"),c.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);if(!n)return!1;const{row:i,col:s,rowspan:o,colspan:a}=n,c=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(c)?0:this.hot.getFirstRenderedVisibleRow(),d=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(c)?0:this.hot.getFirstRenderedVisibleColumn(),f=ut(u,i,i+o-1),h=ut(d,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(h,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,r){const n=Jd(du,this,vx).call(this,e,"col",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getEndMostColumnIndex(e,r){const n=Jd(du,this,vx).call(this,e,"col",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}getTopMostRowIndex(e,r){const n=Jd(du,this,vx).call(this,e,"row",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getBottomMostRowIndex(e,r){const n=Jd(du,this,vx).call(this,e,"row",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,r),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{Jd(du,this,mV).call(this,o)})}}function vx(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,i=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=i.row;r===1?o<=s.row:o>=s.row;o+=r)for(let a=i.col;r===1?a<=s.col:a>=s.col;a+=r){const c=e==="row"?o:a,u=this.get(o,a);let d=c;u&&(d=r===1?u[e]+u[`${e}span`]-1:u[e]),n.has(c)||n.set(c,new Set),n.get(c).add(d)}return Array.from(new Set(Array.from(n.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function mV(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function uLe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function zk(t,e,r){return(e=dLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dLe(t){var e=hLe(t,"string");return typeof e=="symbol"?e:e+""}function hLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fLe{constructor(e){zk(this,"plugin",void 0),zk(this,"mergedCellsCollection",void 0),zk(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),o=this.getAutofillSize(e,r,n),[a,c,u,d]=e,h=["up","down"].indexOf(n)>-1?u-a+1:d-c+1,m=Math.floor(o/h)*h,g=o-m,p=this.getFarthestCollection(e,r,n,i);if(p){if(n==="down"){const y=p.row+p.rowspan-a-g;s[2]+y>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?y:0}else if(n==="right"){const y=p.col+p.colspan-c-g;s[3]+y>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?y:0}else if(n==="up"){const y=u-g-p.row+1;s[0]+y<0?s[0]+=g:s[0]-=g?y:0}else if(n==="left"){const y=d-g-p.col+1;s[1]+y<0?s[1]+=g:s[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:h}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),vn(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,o,a]=e,[c,u,d,f]=r;switch(n){case"up":return i-c;case"down":return d-o;case"left":return s-u;case"right":return f-a;default:return null}}getDragArea(e,r,n){const[i,s,o,a]=e,[c,u,d,f]=r;switch(n){case"up":return[c,u,i-1,a];case"down":{const h=this.mergedCellsCollection.get(d,a),m=h?h.rowspan-1:0;return[o+1,s,d+m,a]}case"left":return[c,u,o,s-1];case"right":{const h=this.mergedCellsCollection.get(d,a),m=h?h.colspan-1:0;return[i,a+m,d,f]}default:return null}}getFarthestCollection(e,r,n,i){const[s,o,a,c]=e,u=["up","down"].indexOf(n)>-1,d=u?a:c,f=u?s:o,h=this.getAutofillSize(e,r,n),m=u?a-s+1:c-o+1,g=Math.floor(h/m)*m,p=h-g;let y=null,w=null,v=null;switch(n){case"up":y="includesVertically",v=d-p+1;break;case"left":y="includesHorizontally",v=d-p+1;break;case"down":y="includesVertically",v=f+p-1;break;case"right":y="includesHorizontally",v=f+p-1;break}return B(i,x=>{x[y](v)&&x.isFarther(w,n)&&(w=x)}),w}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,d)=>{switch(i){case"up":return u.row-d>=r.from.row;case"down":return u.row+u.rowspan-1+d<=r.to.row;case"left":return u.col-d>=r.from.column;case"right":return u.col+u.colspan-1+d<=r.to.column;default:return null}};let o=0,a=null,c=1;do for(let u=0;u<n.length;u+=1){if(a=n[u],o=c*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0);break}u===n.length-1&&(c+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return B(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,o,a,c]=i,u=this.plugin.hot._createCellCoords(s,o),d=this.plugin.hot._createCellCoords(a,c),f=this.plugin.hot._createCellRange(u,u,d);if(this.mergedCellsCollection.getWithinRange(f,!0).length===0)return!1;const m=this.mergedCellsCollection.getWithinRange(f,!1);return m.length===0?!0:n==="up"||n==="down"?!m.every(g=>{let{colspan:p}=g;return p===f.getWidth()}):!m.every(g=>{let{rowspan:p}=g;return p===f.getHeight()})}}function Uk(t,e,r){return(e=gLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gLe(t){var e=mLe(t,"string");return typeof e=="symbol"?e:e+""}function mLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pLe{constructor(e){Uk(this,"plugin",void 0),Uk(this,"hot",void 0),Uk(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),c=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const d=this.plugin.mergedCellsCollection.get(e,r);if(!d)return;const f=d.getLastRow(),h=d.getLastColumn();if(s<=d.row&&o<=d.col&&a>=f&&c>=h)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(d,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let o=0;o<r.length;o+=1)s[o]=r[o].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function yLe(t){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(w2)}return this.getTranslatedPhrase(v2)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedActive();return e?ul.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Ey(t,e,r){return(e=vLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vLe(t){var e=wLe(t,"string");return typeof e=="symbol"?e:e+""}function wLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pV{constructor(e){Ey(this,"data",void 0),Ey(this,"next",null),Ey(this,"prev",null),this.data=e}}class wx{constructor(){Ey(this,"first",null),Ey(this,"last",null)}push(e){const r=new pV(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.last;this.last=r,r.prev=n,n.next=r}return r}unshift(e){const r=new pV(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.first;this.first=r,r.next=n,n.prev=r}}inorder(e){let r=this.first;for(;r;){const n=e(r);if(r===this.last||n===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,n,i;for(;r;){if(r.data===e)return n=r.next,i=r.prev,n&&(n.prev=i),i&&(i.next=n),r===this.first&&(this.first=n),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,i){i&&(e(i,i.next),i.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,n;for(;e;)n=e.next,e.next=r,r.prev=e,r=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=r,this.last=n}}function bLe(t,e){uK(t,e),e.add(t)}function Zd(t,e,r){uK(t,e),e.set(t,r)}function uK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){return t.get(m1(t,e))}function Ms(t,e,r){return t.set(m1(t,e),r),r}function m1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qa=new WeakMap,Xa=new WeakMap,Qa=new WeakMap,Ja=new WeakMap,nA=new WeakMap,bx=new WeakMap,xx=new WeakMap,Yk=new WeakSet;class xLe{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:n,columnIndexMapper:i}=e;bLe(this,Yk),Zd(this,qa,new wx),Zd(this,Xa,new wx),Zd(this,Qa,null),Zd(this,Ja,null),Zd(this,nA,null),Zd(this,bx,null),Zd(this,xx,null),Ms(nA,this,r),Ms(bx,this,n),Ms(xx,this,i)}getCurrentVerticalNode(){return Ot(Ja,this).data}getFirstVerticalNode(){return Ot(Xa,this).first.data}getNextVerticalNode(){return Ot(Ja,this).next.data}getPrevVerticalNode(){return Ot(Ja,this).prev.data}getCurrentHorizontalNode(){return Ot(Qa,this).data}getFirstHorizontalNode(){return Ot(qa,this).first.data}getNextHorizontalNode(){return Ot(Qa,this).next.data}getPrevHorizontalNode(){return Ot(Qa,this).prev.data}setPrevNodeAsActive(){Ms(Ja,this,Ot(Ja,this).prev),Ms(Qa,this,Ot(Qa,this).prev)}setNextNodeAsActive(){Ms(Ja,this,Ot(Ja,this).next),Ms(Qa,this,Ot(Qa,this).next)}buildFocusOrder(e){Ms(qa,this,new wx),e.forEach((r,n)=>{const i=new WeakSet,s=r.getTopStartCorner(),o=r.getBottomEndCorner();for(let a=s.row;a<=o.row;a++)if(!Ot(bx,this).isHidden(a))for(let c=s.col;c<=o.col;c++){if(Ot(xx,this).isHidden(c))continue;const u=m1(Yk,this,yV).call(this,{selectedRange:r,selectionLayer:n,listOrder:Ot(qa,this),mergeCellsVisitor:i,row:a,column:c});u&&Ms(Qa,this,u)}}),Ot(qa,this).first&&(Ot(qa,this).first.prev=Ot(qa,this).last,Ot(qa,this).last.next=Ot(qa,this).first),Ms(Xa,this,new wx),e.forEach((r,n)=>{const i=new WeakSet,s=r.getTopStartCorner(),o=r.getBottomEndCorner();for(let a=s.col;a<=o.col;a++)if(!Ot(xx,this).isHidden(a))for(let c=s.row;c<=o.row;c++){if(Ot(bx,this).isHidden(c))continue;const u=m1(Yk,this,yV).call(this,{selectedRange:r,selectionLayer:n,listOrder:Ot(Xa,this),mergeCellsVisitor:i,row:c,column:a});u&&Ms(Ja,this,u)}}),Ot(Xa,this).first&&(Ot(Xa,this).first.prev=Ot(Xa,this).last,Ot(Xa,this).last.next=Ot(Xa,this).first)}setActiveNode(e,r,n){return Ot(qa,this).inorder(i=>{const{selectionLayer:s,rowStart:o,rowEnd:a,colStart:c,colEnd:u}=i.data;if(s===n&&e>=o&&e<=a&&r>=c&&r<=u)return Ms(Qa,this,i),!0}),Ot(Xa,this).inorder(i=>{const{selectionLayer:s,rowStart:o,rowEnd:a,colStart:c,colEnd:u}=i.data;if(s===n&&e>=o&&e<=a&&r>=c&&r<=u)return Ms(Ja,this,i),!0}),this}}function yV(t){let{selectedRange:e,selectionLayer:r,listOrder:n,mergeCellsVisitor:i,row:s,column:o}=t;const a=e.getTopStartCorner(),c=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),d=Ot(nA,this).call(this,s,o);if(d&&i.has(d))return null;const f={selectionLayer:r,colStart:o,colEnd:o,rowStart:s,rowEnd:s};if(d){if(i.add(d),d.row<a.row||d.row+d.rowspan-1>c.row||d.col<a.col||d.col+d.colspan-1>c.col)return null;f.colStart=d.col,f.colEnd=d.col+d.colspan-1,f.rowStart=d.row,f.rowEnd=d.row+d.rowspan-1}const h=n.push(f);return s===u.row&&o===u.col||d&&u.row>=d.row&&u.row<=d.row+d.rowspan-1&&u.col>=d.col&&u.col<=d.col+d.colspan-1?h:null}function dK(t,e,r){const{rowIndexMapper:n,stylesHandler:i}=t;let s=0;for(let a=e;a<e+r;a++)if(!n.isHidden(a)){var o;s+=(o=t.getRowHeight(a))!==null&&o!==void 0?o:i.getDefaultRowHeight(a)}return s}function SLe(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:n}=e,i=new Map;function s(){}function o(a,c,u){const d=t.mergedCellsCollection.get(c,u);if(!Le(d)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),i.has(c)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(c)}px`,i.delete(c)),a.style.display="";return}const{row:f,col:h,colspan:m,rowspan:g}=d,[p,y]=t.translateMergedCellToRenderable(f,g,h,m),w=t.getSetting("virtualized");if(h===0&&!e.getSettings().rowHeaders){const H=e._getRowHeightFromSettings(c);if(H!==void 0){const I=e.stylesHandler.areCellsBorderBox()?0:1;i.set(c,H-I)}else if(S_()){const Z=dK(e,f,g);i.set(c,Z/g)}}const v=r.getRenderableFromVisualIndex(c),x=n.getRenderableFromVisualIndex(u),S=p-v+1,N=y-x+1;let R=r.getNearestNotHiddenIndex(f,1),E=n.getNearestNotHiddenIndex(h,1);if(w){const H=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(H)||(R=Math.max(R,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(H)||(E=Math.max(E,e.getFirstRenderedVisibleColumn()))}const P=Math.min(g,S),D=Math.min(m,N);R===c&&E===u?(a.setAttribute("rowspan",P),a.setAttribute("colspan",D)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function CLe(t,e){hK(t,e),e.add(t)}function Sx(t,e,r){hK(t,e),e.set(t,r)}function hK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gk(t,e,r){return(e=_Le(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Le(t){var e=RLe(t,"string");return typeof e=="symbol"?e:e+""}function RLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wv(t,e,r){return t.set(Dt(t,e),r),r}function Qt(t,e){return t.get(Dt(t,e))}function Dt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}_e.getSingleton().register("beforeMergeCells");_e.getSingleton().register("afterMergeCells");_e.getSingleton().register("beforeUnmergeCells");_e.getSingleton().register("afterUnmergeCells");const iA="mergeCells",ELe=150,vV=iA;var _o=new WeakMap,Ro=new WeakMap,xl=new WeakMap,wV=new WeakMap,Bt=new WeakSet;class NLe extends wt{constructor(){super(...arguments),CLe(this,Bt),Gk(this,"mergedCellsCollection",null),Gk(this,"autofillCalculations",null),Gk(this,"selectionCalculations",null),Sx(this,_o,null),Sx(this,Ro,{row:0,col:0}),Sx(this,xl,new xLe({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Sx(this,wV,SLe(this))}static get PLUGIN_KEY(){return iA}static get PLUGIN_PRIORITY(){return ELe}static get DEFAULT_SETTINGS(){return{[NY]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[iA]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new g1(this),this.autofillCalculations=new fLe(this),this.selectionCalculations=new pLe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,kLe).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,PLe).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,MLe).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,ALe).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,OLe).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,xV).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,xV).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,jLe).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,HLe).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,$Le).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,bV).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,bV).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,TLe).call(e,...n)}),this.addHook("afterRenderer",function(){return Qt(wV,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,ILe).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,DLe).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,LLe).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,FLe).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,VLe).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,BLe).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,WLe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,zLe).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,ULe).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,YLe).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,GLe).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,KLe).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,qLe).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,XLe).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Bt,e,QLe).call(e,...n)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!CU())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let o=i+1;o<i+s;o++)r.push(o)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=TC(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{var i;n.style.background=(i=TC(n,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?ul.containsNegativeValues(e)?(nt(ul.NEGATIVE_VALUES_WARNING(e)),!1):ul.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(nt(ul.IS_OUT_OF_BOUNDS_WARNING(e)),!1):ul.isSingleCell(e)?(nt(ul.IS_SINGLE_CELL(e)),!1):ul.containsZeroSpan(e)?(nt(ul.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];r.forEach(i=>{const{row:s,col:o,rowspan:a,colspan:c}=i,u=this.hot._createCellCoords(s,o),d=this.hot._createCellCoords(s+a-1,o+c-1),f=this.hot._createCellRange(u,u,d);this.mergeRange(f,!0,!0);for(let h=s;h<s+a;h++)for(let m=o;m<o+c;m++)(h!==s||m!==o)&&n.push([h,m,null])}),n.length!==0&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let c=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),Oe(0,o.rowspan-1,d=>{Oe(0,o.colspan-1,f=>{let h=null;a[d]||(a[d]=[]),d===0&&f===0?h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+d,o.col+f,"hidden",!0),a[d][f]=h})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(n?c=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),c):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),B(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),Oe(0,i.rowspan-1,s=>{Oe(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const{from:r,to:n}=e.clone().normalize(),i=this.mergedCellsCollection.get(r.row,r.col);i.row===r.row&&i.col===r.col&&i.row+i.rowspan-1===n.row&&i.col+i.colspan-1===n.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeActive();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:vV})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vV)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(Le(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(Le(o)){const a=o.row+o.rowspan-1,c=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(c>e.endRow){e.endRow=c,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(Le(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(Le(o)){const a=o.col+o.colspan-1,c=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(c>e.endColumn){e.endColumn=c,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,c;r===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?c=o.getNearestNotHiddenIndex(n,1):c=o.getNearestNotHiddenIndex(n+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,d=n>=0?o.getRenderableFromVisualIndex(c):n;return[u,d]}}function kLe(){this.generateFromSettings(),this.hot.render()}function TLe(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeActive(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(n.row===e[s].row&&n.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function PLe(t){Qt(Ro,this).row=t.row,Qt(Ro,this).col=t.col}function MLe(t){const e=this.hot.getSelectedRangeActive(),{highlight:r}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;Qt(_o,this)&&(i.getRenderableFromVisualIndex(Qt(_o,this).row)!==null&&(r.row=Qt(_o,this).row),n.getRenderableFromVisualIndex(Qt(_o,this).col)!==null&&(r.col=Qt(_o,this).col),wv(_o,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const d=r.col>=o&&r.col<=a?o-1:a,f=n.getNearestNotHiddenIndex(d,-1);f===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(f,r.col)-1,1)}else if(t.col>0){const d=r.col>=o&&r.col<=a?a+1:o,f=n.getNearestNotHiddenIndex(d,1);f===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,f)-1,1)}const c=s.row,u=s.row+s.rowspan-1;if(t.row<0){const d=r.row>=c&&r.row<=u?c-1:u,f=i.getNearestNotHiddenIndex(d,-1);f===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(f,r.row)-1,1)}else if(t.row>0){const d=r.row>=c&&r.row<=u?u+1:c,f=i.getNearestNotHiddenIndex(d,1);f===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,f)-1,1)}}function ALe(t){const e=this.hot.getSelectedRangeActive(),r=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,c)=>{r.expand(this.hot._createCellCoords(a,c));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(a=r.getTopStartCorner().col);const c=i.getNearestNotHiddenIndex(a,1);c!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(c,n.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(a=r.getBottomEndCorner().col);const c=i.getNearestNotHiddenIndex(a,-1);c!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,c)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(a=r.getTopStartCorner().row);const c=s.getNearestNotHiddenIndex(a,1);c!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(c,n.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(a=r.getBottomStartCorner().row);const c=s.getNearestNotHiddenIndex(a,-1);c!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,c)-1,1))}}function OLe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){wv(_o,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);wv(_o,this,e.clone()),r&&e.assign(r)}function bV(t,e,r,n){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:s,col:o,colspan:a,rowspan:c}=i,u=s,d=o,f=s+c-1,h=o+a-1;if(n==="render"&&this.getSetting("virtualized")){const m=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleRow(),p=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleColumn();return[ut(g,u,f),ut(p,d,h),ut(this.hot.getLastRenderedVisibleRow(),u,f),ut(this.hot.getLastRenderedVisibleColumn(),d,h)]}return[u,d,f,h]}function ILe(t){t.items.push({name:"---------"},yLe(this))}function xV(){wv(_o,this,null)}function jLe(){if(Qt(_o,this).isCell())return;const t=this.hot.getSelectedRangeActive(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),n=Qt(_o,this).clone().normalize();Qt(xl,this).setActiveNode(n.row,n.col),Qt(Ro,this).row>0||Qt(Ro,this).col>0?Qt(xl,this).setPrevNodeAsActive():(r==="E-W"&&Qt(Ro,this).col<0||e==="S-N"&&Qt(Ro,this).row<0)&&Qt(xl,this).setNextNodeAsActive()}function HLe(t,e){const{columnIndexMapper:r,rowIndexMapper:n}=this.hot;let i=this.hot.getActiveSelectionLayerIndex(),s=null,o=null;if(Qt(Ro,this).col<0){const{rowEnd:a,colEnd:c,selectionLayer:u}=Qt(xl,this).getPrevHorizontalNode();o=r.getNearestNotHiddenIndex(c,-1),s=n.getNearestNotHiddenIndex(a,-1),i=u}else if(Qt(Ro,this).col>0){const{rowStart:a,colStart:c,selectionLayer:u}=Qt(xl,this).getNextHorizontalNode();o=r.getNearestNotHiddenIndex(c,1),s=n.getNearestNotHiddenIndex(a,1),i=u}else if(Qt(Ro,this).row<0){const{rowEnd:a,colEnd:c,selectionLayer:u}=Qt(xl,this).getPrevVerticalNode();o=r.getNearestNotHiddenIndex(c,-1),s=n.getNearestNotHiddenIndex(a,-1),i=u}else if(Qt(Ro,this).row>0){const{rowStart:a,colStart:c,selectionLayer:u}=Qt(xl,this).getNextVerticalNode();o=r.getNearestNotHiddenIndex(c,1),s=n.getNearestNotHiddenIndex(a,1),i=u}if(s!==null||o!==null){this.hot.selection.setActiveSelectionLayerIndex(i);const a=this.hot.getSelectedRangeActive(),c=this.hot._createCellCoords(s,o),u=this.mergedCellsCollection.get(c.row,c.col),d=this.hot.selection.highlight.getFocus();t=c.row,e=c.col,u?a.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):a.highlight.assign(c),d.clear(),d.add(c).commit()}Qt(xl,this).setActiveNode(t,e,i),wv(Ro,this,{row:0,col:0})}function $Le(){Qt(xl,this).buildFocusOrder(this.hot.getSelectedRange())}function DLe(t,e,r){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function LLe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function FLe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function VLe(t,e){const r=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,r))return e;const n=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(n,n,i),o=this.mergedCellsCollection.getWithinRange(s);return o.length===0?t:this.autofillCalculations.snapDragArea(e,t,r,o)}function BLe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function WLe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function zLe(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function ULe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function YLe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function GLe(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeActive(),n=this.mergedCellsCollection.getWithinRange(r);B(n,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function KLe(t,e,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,n)}function qLe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function XLe(t,e,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeActive(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function QLe(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let n,i;if(r==="master")n=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const h=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(h.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(h.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return t;const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(e,i),c=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(c,!0),d=u.reduce((h,m)=>{let{rowspan:g}=m;return Math.max(h,g)},1);let f=0;return u.length>1&&u[0].rowspan<d&&(f=d-u[0].rowspan),u.forEach(h=>{let{rowspan:m}=h,g=0;r==="top"||r==="top_inline_start_corner"?g=Math.min(d,this.hot.view.countNotHiddenFixedRowsTop()-e):g=m-f,t=Math.max(t??0,dK(this.hot,e,g))}),t}function JLe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function o(a){const c=t[a],u=e[a],d=i[a],f=s[a],h=u.multiColumnSorting,g=(h.compareFunctionFactory?h.compareFunctionFactory:LY(u.type))(c,u,h)(d,f);if(g===El){const p=a+1;if(typeof e[p]<"u")return o(p)}return g}(0)}}const fK="sort";function ZLe(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${fK}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function e3e(t){const e=t.className.split(" "),r=new RegExp(`^${fK}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}function t3e(t,e,r){return(e=r3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r3e(t){var e=n3e(t,"string");return typeof e=="symbol"?e:e+""}function n3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const p1="multiColumnSorting",i3e=170,SV=p1;DY(p1,JLe);class s3e extends KY{constructor(){super(...arguments),t3e(this,"pluginKey",p1)}static get PLUGIN_KEY(){return p1}static get PLUGIN_PRIORITY(){return i3e}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,XC)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:fd,position:"before",group:SV})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SV)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),Re(e,e3e(e)),this.enabled!==!1&&ee(e,ZLe(...n))}onAfterOnCellMouseDown(e,r){fH(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,XC))):this.sort(this.getColumnNextConfig(r.col)))}}function CV(t,e,r){return(e=o3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o3e(t){var e=a3e(t,"string");return typeof e=="symbol"?e:e+""}function a3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const l3e="multipleSelectionHandles",c3e=160;class u3e extends wt{constructor(){super(...arguments),CV(this,"dragged",[]),CV(this,"lastSetCell",null)}static get PLUGIN_KEY(){return l3e}static get PLUGIN_PRIORITY(){return c3e}isEnabled(){return Sl()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(Ve(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Ve(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(Ve(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ve(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,c,u,d,f;if(e.dragged.length===0)return;const h=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!h||h===e.lastSetCell||((h.nodeName==="TD"||h.nodeName==="TH")&&(o=e.hot.getCoords(h),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeActive(),c=a.getWidth(),u=a.getHeight(),d=a.getDirection(),c===1&&u===1&&e.hot.selection.setRangeEnd(o),f=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,d,e.dragged[0]),f.start!==null&&e.hot.selection.setRangeStart(f.start),e.hot.selection.setRangeEnd(f.end),e.lastSetCell=h),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),c=e.getBottomStartCorner(),u=e.getTopEndCorner();let d={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(c.row,r.col)}:d={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?d={start:r,end:c}:d.end=r;break;case"NW-SE":s==="top"?d={start:r,end:a}:d.end=r;break;case"SE-NW":s==="top"?d={start:r,end:o}:d.end=r;break;case"SW-NE":s==="top"?d={start:r,end:u}:d.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(c.row,r.col)}:d={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)}:d={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(r.row,u.col),end:this.hot._createCellCoords(o.row,r.col)}:s==="top"&&(d={start:c,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=r);break;case"SE-NW":s==="top"?d.end=r:d={start:r,end:o};break}break}return d}isDragged(){return this.dragged.length>0}}function sA(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:c=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:c,headerClassNames:u}}function gK(){return{label:"",isPlaceholder:!0}}function d3e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;B(t,i=>{const s=[];let o=0;r.push(s),B(i,a=>{const c=sA();if(Le(a)){const{label:d,colspan:f,headerClassName:h}=a;c.label=sr(d),typeof f=="number"&&f>1&&(c.colspan=f,c.origColspan=f),typeof h=="string"&&(c.headerClassNames=[...h.split(" ")])}else c.label=sr(a);o+=c.origColspan;let u=!1;if(o>=e&&(c.colspan=c.origColspan-(o-e),c.origColspan=c.colspan,u=!0),s.push(c),c.colspan>1)for(let d=0;d<c.colspan-1;d++)s.push(gK());return!u})});const n=Math.max(..._t(r,i=>i.length));return B(r,i=>{if(i.length<n){const s=_t(new Array(n-i.length),()=>sA());i.splice(i.length,0,...s)}}),r}function Kk(t,e,r){h3e(t,e),e.set(t,r)}function h3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qo(t,e){return t.get(mK(t,e))}function S0(t,e,r){return t.set(mK(t,e),r),r}function mK(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _V=["label","collapsible"];var Ql=new WeakMap,eh=new WeakMap,qk=new WeakMap;class f3e{constructor(){Kk(this,Ql,[]),Kk(this,eh,0),Kk(this,qk,1/0)}setColumnsLimit(e){S0(qk,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];S0(Ql,this,d3e(e,qo(qk,this))),S0(eh,this,qo(Ql,this).length)}getData(){return qo(Ql,this)}mergeWith(e){B(e,r=>{let{row:n,col:i,...s}=r;const o=this.getHeaderSettings(n,i);o!==null&&vn(o,s,_V)})}map(e){B(qo(Ql,this),r=>{B(r,n=>{const i=e({...n});Le(i)&&vn(n,i,_V)})})}getHeaderSettings(e,r){var n;if(e>=qo(eh,this)||e<0)return null;const i=qo(Ql,this)[e];return Array.isArray(i)===!1||r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=qo(eh,this)||e<0)return i;const s=qo(Ql,this)[e];let o=0;for(let a=r;a<s.length;a++){const c=s[a];if(c.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=c.colspan,i.push(c),c.colspan>1&&(a+=c.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return qo(eh,this)}getColumnsCount(){return qo(eh,this)>0?qo(Ql,this)[0].length:0}clear(){S0(Ql,this,[]),S0(eh,this,0)}}function Xk(t,e,r){return(e=g3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g3e(t){var e=m3e(t,"string");return typeof e=="symbol"?e:e+""}function m3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pK="DF-pre-order";function yK(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=yK.call(this.childs[n],t,e)}return r}const p3e="DF-post-order";function vK(t,e){for(let r=0;r<this.childs.length;r++)if(vK.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const wK="BF";function y3e(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const v3e=wK,RV=new Map([[pK,yK],[p3e,vK],[wK,y3e]]);class y1{constructor(e){Xk(this,"data",{}),Xk(this,"parent",null),Xk(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new y1({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v3e;if(!RV.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);RV.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function Qk(t,e,r){w3e(t,e),e.set(t,r)}function w3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ki(t,e){return t.get(bK(t,e))}function b3e(t,e,r){return t.set(bK(t,e),r),r}function bK(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cg=new WeakMap,th=new WeakMap,ug=new WeakMap;class x3e{constructor(e){Qk(this,cg,new Map),Qk(this,th,new Map),Qk(this,ug,null),b3e(ug,this,e)}getRoots(){return Array.from(ki(cg,this).values())}getRootByColumn(e){let r;return ki(th,this).has(e)&&(r=ki(cg,this).get(ki(th,this).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-ki(th,this).get(r);let s=0,o;return n.walkDown(a=>{const{data:{origColspan:c,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+c-1)return o=a,o.data.isRoot=r===o.data.columnIndex,!1;s+=c}}),o}rebuildTreeIndex(){let e=0;ki(th,this).clear(),B(ki(cg,this),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)ki(th,this).set(i,e);e+=n})}buildTree(){this.clear();const e=ki(ug,this).getColumnsCount();let r=0;for(;r<e;){const n=ki(ug,this).getHeaderSettings(0,r),i=new y1;ki(cg,this).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=ki(ug,this).getHeadersSettings(n,r,i);n+=1,B(s,o=>{const a={...o,headerLevel:n-1,columnIndex:r};let c;n===1?(e.data=a,c=e):(c=new y1(a),e.addChild(c)),n<ki(ug,this).getLayersCount()&&this.buildLeaves(c,r,n,o.origColspan),r+=o.origColspan})}clear(){ki(cg,this).clear(),ki(th,this).clear()}}function xK(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function v1(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function w1(t){return v1(t,"origColspan")===t.data.origColspan}function kH(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(w1(t))return kH(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let o=0;if(i.length>0)B(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const c=a.data;o+=c.colspan,xK(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:c,columnIndex:u}=e;o=c-a;for(let d=1;d<c;d++)s.add(u+d)}return t.walkUp(a=>{const{data:c}=a;c.colspan+=o,c.colspan>=c.origColspan?(c.colspan=c.origColspan,c.isCollapsed=!1):w1(a)&&(c.isCollapsed=v1(a,"isCollapsed"))}),{rollbackModification:()=>TH(t),affectedColumns:Array.from(s),colspanCompensation:o}}function TH(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(w1(t))return TH(n[0]);r.isCollapsed=!0;const s=n.slice(1),o=new Set;if(s.length>0)B(s,c=>{xK(c,u=>{o.add(u)}),c.data.clonedTree=c.cloneTree(),c.walkDown(u=>{let{data:d}=u;d.isHidden=!0})});else{const{origColspan:c,columnIndex:u}=r;for(let d=1;d<c;d++){const f=u+d;o.add(f)}}const a=r.colspan-((e=v1(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(c=>{const{data:u}=c;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):w1(c)&&(u.isCollapsed=v1(c,"isCollapsed"))}),{rollbackModification:()=>kH(t),affectedColumns:Array.from(o),colspanCompensation:a}}function S3e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Rt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function C3e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Rt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const EV=new Map([["collapse",TH],["expand",kH],["hide-column",S3e],["show-column",C3e]]);function _3e(t,e,r){if(!EV.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return EV.get(t)(e,r)}function Cx(t){const e=[];return B(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:c}=i,u=E3e(e,a);let d=!1;for(let f=o;f<o+s;f++)if(c.includes(f)||d)u.push(gK());else{const m=R3e(i);m.isRoot=!0,u.push(m),d=!0}})}),e}function R3e(t){const{crossHiddenColumns:e,...r}=sA(t);return r}function E3e(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function Jk(t,e,r){N3e(t,e),e.set(t,r)}function N3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C0(t,e,r){return t.set(SK(t,e),r),r}function Nr(t,e){return t.get(SK(t,e))}function SK(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Za=new WeakMap,es=new WeakMap,rh=new WeakMap;class k3e{constructor(){Jk(this,Za,new f3e),Jk(this,es,new x3e(Nr(Za,this))),Jk(this,rh,[[]])}setState(e){Nr(Za,this).setData(e);let r=!1;try{Nr(es,this).buildTree()}catch{Nr(es,this).clear(),Nr(Za,this).clear(),r=!0}return C0(rh,this,Cx(Nr(es,this).getRoots())),r}setColumnsLimit(e){Nr(Za,this).setColumnsLimit(e)}mergeStateWith(e){const r=_t(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Nr(Za,this).mergeWith(r),Nr(es,this).buildTree(),C0(rh,this,Cx(Nr(es,this).getRoots()))}mapState(e){Nr(Za,this).map(e),Nr(es,this).buildTree(),C0(rh,this,Cx(Nr(es,this).getRoots()))}mapNodes(e){return bs(Nr(es,this).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=Nr(es,this).getNode(r,n);let s;return i&&(s=_3e(e,i,n),C0(rh,this,Cx(Nr(es,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=Nr(rh,this)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){const n=this.getHeaderTreeNode(e,r);return n?{...n.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=Nr(es,this).getNode(e,r);return n||null}findTopMostEntireHeaderLevel(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const n=r-e+1;let i=!1,s=null;for(let o=e;o<=r;o++){const a=Nr(es,this).getRootByColumn(o);if(!a)break;i=!0,a.walkDown(c=>{const{columnIndex:u,headerLevel:d,origColspan:f,isHidden:h}=c.data;h||f<=n&&u>=e&&u+f-1<=r&&(s===null||d<s)&&(s=d)},pK)}return i&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,r){var n;const{isRoot:i,origColspan:s}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(i)return r+s-1;let o=r+1;for(;o<this.getColumnsCount();){var a;const{isRoot:c}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(c)break;o+=1}return o-1}getLayersCount(){return Nr(Za,this).getLayersCount()}getColumnsCount(){return Nr(Za,this).getColumnsCount()}clear(){C0(rh,this,[]),Nr(Za,this).clear(),Nr(es,this).clear()}}function _0(t,e,r){return(e=T3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T3e(t){var e=P3e(t,"string");return typeof e=="symbol"?e:e+""}function P3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M3e{constructor(e,r){_0(this,"hot",void 0),_0(this,"nestedHeaderSettingsGetter",void 0),_0(this,"layersCount",0),_0(this,"container",void 0),_0(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(let i=0;i<n;i++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let c=0;c<this.layersCount;c++){const u=r.createElement("tr");for(let d=0;d<a;d++){let f=n.getVisualFromRenderableIndex(d);f===null&&(f=d);const h=r.createElement("th"),m=this.nestedHeaderSettingsGetter(c,f);if(m&&(!m.isPlaceholder||m.isHidden)){let g=m.label;o&&(g+='<button class="changeType"></button>'),wf(h,g),h.colSpan=m.colspan,u.appendChild(h)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function A3e(t,e){CK(t,e),e.add(t)}function NV(t,e,r){return(e=O3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O3e(t){var e=I3e(t,"string");return typeof e=="symbol"?e:e+""}function I3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dg(t,e,r){CK(t,e),e.set(t,r)}function CK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wc(t,e,r){return t.set(Sn(t,e),r),r}function Qe(t,e){return t.get(Sn(t,e))}function Sn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const kV="nestedHeaders",j3e=280;var Ft=new WeakMap,hu=new WeakMap,Ny=new WeakMap,eR=new WeakMap,b1=new WeakMap,nh=new WeakMap,jn=new WeakSet;class H3e extends wt{constructor(){super(...arguments),A3e(this,jn),dg(this,Ft,new k3e),dg(this,hu,null),dg(this,Ny,null),dg(this,eR,!1),dg(this,b1,null),NV(this,"ghostTable",new M3e(this.hot,(e,r)=>this.getHeaderSettings(e,r))),NV(this,"detectedOverlappedHeaders",!1),dg(this,nh,()=>{var e;const r=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!r)return;const{highlight:n}=r;if(n.isHeader()&&n.col>=0){const s=Qe(Ft,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=s,o.visualCellRange.from.col=s,o.visualCellRange.to.col=s,o.commit()}})}static get PLUGIN_KEY(){return kV}static get PLUGIN_PRIORITY(){return j3e}isEnabled(){return!!this.hot.getSettings()[kV]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&nt(Rt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Sn(jn,this,J3e).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,Z3e).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,F3e).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,V3e).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,B3e).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,W3e).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,z3e).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,U3e).call(e,...i)}),this.addHook("afterSelection",()=>Qe(nh,this).call(this)),this.addHook("afterSelectionFocusSet",()=>Qe(nh,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,$3e).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",n=>Sn(jn,this,G3e).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,q3e).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,X3e).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,D3e).call(e,...i)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,L3e).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,Y3e).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,K3e).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sn(jn,e,Q3e).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",Qe(nh,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Qe(nh,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Qe(Ft,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Qe(Ft,this).setState(e)),this.detectedOverlappedHeaders&&nt(Rt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";Qe(Ft,this).triggerColumnModification(i,n)}),!Qe(hu,this)&&this.enabled&&wc(hu,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:o}=n;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Qe(Ft,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Qe(nh,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",Qe(nh,this)),this.clearColspans(),Qe(Ft,this).clear(),Qe(hu,this).unsubscribe(),wc(hu,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Qe(Ft,this)}getLayersCount(){return Qe(Ft,this).getLayersCount()}getHeaderSettings(e,r){return Qe(Ft,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const a=n.childNodes[o];if(!a)break;const c=i.childNodes[o],u=s?s.childNodes[o]:null;for(let d=0,f=a.childNodes.length;d<f;d++)a.childNodes[d].removeAttribute("colspan"),Re(a.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Re(c.childNodes[d],"hiddenHeader")),s&&u&&u.childNodes[d]&&(u.childNodes[d].removeAttribute("colspan"),Re(u.childNodes[d],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:c}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),Re(s,"hiddenHeader"),Re(s,"hiddenHeaderText");const{colspan:d,isHidden:f,isPlaceholder:h,headerClassNames:m}=(o=Qe(Ft,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{};if(h||f)ee(s,"hiddenHeader");else if(d>1){var g,p,y;const{wtOverlays:w}=c._wt,v=(g=w.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),x=(p=w.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s);((y=w.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(s))&&u<n&&ee(s,"hiddenHeaderText");const N=v||x?Math.min(d,n-i):d;N>1&&s.setAttribute("colspan",N)}if(this.hot.view.appendColHeader(u,s,function(){return r.getColumnHeaderValue(...arguments)},e),!h&&!f){const w=s.querySelector("div.relative");w&&m&&m.length>0&&(Re(w,this.hot.getColumnMeta(u).headerClassName),ee(w,m))}}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=Qe(Ft,this).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}destroy(){wc(Ft,this,null),Qe(hu,this)!==null&&(Qe(hu,this).unsubscribe(),wc(hu,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Qe(Ft,this).getHeaderTreeNodeData(e.row,e.col)}}function $3e(t,e){var r;const n=this.hot.getSelectedRangeActive();if(!n)return t;const{highlight:i}=n,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?i.row:(r=Qe(b1,this))===null||r===void 0?void 0:r.row,c=o?t:i.col,u=a<0&&c>=0;if(wc(b1,this,null),!u)return t;const d=this.hot.getFirstFullyVisibleColumn(),f=this.hot.getLastFullyVisibleColumn(),h=f-d+1,m=Qe(Ft,this).findLeftMostColumnIndex(a,c),g=Qe(Ft,this).findRightMostColumnIndex(a,c),p=g-m+1;if(m<d&&g>f)return m;if(o){let y=null;return m>=d&&g>f?p>h?(e.value="start",y=m):(e.value="end",y=g):m<d&&g<=f&&(p>h?(e.value="end",y=g):(e.value="start",y=m)),y}return m<=d?m:g}function D3e(t,e,r){const n=Qe(Ft,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:o}=r,{isRoot:a,colspan:c}=Qe(Ft,this).getHeaderSettings(e,t);if(s===$I){if(!a)return n.columnIndex}else if(s===c9&&(c>o-i||!a))return null;return t}function L3e(t,e,r){let{columnHeadersCount:n}=r;if(n!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:c,endCol:u}=e[s],d=c-o+1,f=a-u+1;if(o>=0||f===1)break;for(let h=a;h<=u;h++)for(let m=o;m<=c;m++){var i;const g=d+m,p=h-a;if(p===0)continue;((i=Qe(Ft,this).getHeaderTreeNodeData(m,h))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][p]="")}}}function F3e(t,e,r,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function V3e(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;wc(Ny,this,e.clone()),wc(eR,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=r,c=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(RI(t)||Jh(t)&&c||pve(t))&&s.push(o,o+a-1,e.row),n.selectColumns(...s)}function B3e(t,e,r,n){if(!this.hot.view.isMouseDown()||n.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeActive(),c=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:d}=a;n.column=!0,n.cell=!0;const f=[],h=ut(e.row,-1/0,-1);e.col<d.col?f.push(u.col,s,h):e.col>d.col?f.push(c.col,s+o-1,h):f.push(s,s+o-1,h),this.hot.selection.selectColumns(...f)}function W3e(){wc(eR,this,!1)}function z3e(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Qe(eR,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Qe(Ft,this).getHeaderTreeNodeData(Qe(Ny,this).row,Qe(Ny,this).col);if(e.setHighlight(Qe(Ny,this)),s>e.getWidth()||i<r||i+s-1>n){const o=Qe(Ft,this).findTopMostEntireHeaderLevel(ut(r,i,i+s-1),ut(n,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function U3e(t){const{highlight:e}=this.hot.getSelectedRangeActive(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const i=Qe(Ft,this).findLeftMostColumnIndex(r.row,r.col),s=Qe(Ft,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Y3e(t,e,r){const n=t.row,i=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});wc(b1,this,r.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function G3e(t){if(Qe(Ft,this).getLayersCount()>0){t.length=0;for(let e=0;e<Qe(Ft,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function K3e(t){const e=Qe(Ft,this).getLayersCount();let r=t.startColumn,n=!!e;for(let i=0;i<e;i++){const s=Qe(Ft,this).findLeftMostColumnIndex(i,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(n=!1),Di(o)&&o<t.startColumn){r=o;break}}t.startColumn=n?Qe(Ft,this).getHeaderTreeNodeData(0,r).columnIndex:r}function q3e(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function X3e(t,e,r){var n;const{label:i}=(n=Qe(Ft,this).getHeaderTreeNodeData(r,e))!==null&&n!==void 0?n:{label:""};return i}function Q3e(t,e){if(t<0)return this.hot.getCell(t,Qe(Ft,this).findLeftMostColumnIndex(t,e),!0)}function J3e(){this.updatePlugin()}function Z3e(t,e){e||this.updatePlugin()}function R0(t,e,r){return(e=e4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e4e(t){var e=t4e(t,"string");return typeof e=="symbol"?e:e+""}function t4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r4e{constructor(e,r){R0(this,"hot",void 0),R0(this,"data",null),R0(this,"plugin",void 0),R0(this,"parentReference",new WeakMap),R0(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Oe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&B(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,o=r;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),n!=null&&o===n?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&B(a.__children,c=>{if(this.parentReference.set(c,s?null:a),o=this.readTreeNodes(c,o,n,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return at(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(B(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const a=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(Oe(e[0],e[2],h=>{const m=this.translateTrimmedRow(h);i.push(this.getDataObject(m))}),Oe(0,i.length-2,h=>{this.detachFromParent(i[h],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),o=this.countChildren(n),a=this.getRowIndexWithinParent(n),c=this.getRowParent(n),u=this.getRowParent(c),d=this.getRowIndex(u);let f=null;if(this.hot.runHooks("beforeDetachChild",c,n),a!=null){const h=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,h,this.plugin.pluginName),c.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,h,this.plugin.pluginName),u){f=d+this.countChildren(u);const m=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),u.__children.push(n)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];B(n,s=>{i.push(this.getDataObject(s))}),B(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(o,r,...n):s.__children.splice(o,r):n?this.data.splice(o,r,...n):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=r;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),c=o.__children.slice(a,a+1),u=e>r;let d=s?this.getRowParent(r-1):this.getRowParent(r);d==null&&(d=this.getRowParent(r-1)),d==null&&(d=this.getDataObject(r-1)),d?d.__children||(d.__children=[]):(d=this.getDataObject(r),d.__children=[]);const f=s||n||i?d.__children.length:this.getRowIndexWithinParent(r),h=o===d;d.__children.splice(f,0,c[0]),o.__children.splice(a+(u&&h?1:0),1),this.syncRowWithRawSource(o),h||this.syncRowWithRawSource(d)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function TV(t,e,r){return(e=n4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n4e(t){var e=i4e(t,"string");return typeof e=="symbol"?e:e+""}function i4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PH{constructor(e,r){TV(this,"hot",void 0),TV(this,"plugin",void 0),this.hot=r,this.plugin=e}}class fl extends PH{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getDataObject(n);if(!i)return;const s=this.dataManager.getRowLevel(n),o=r.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),c=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(B(c,d=>{d&&o.removeChild(d)}),ee(r,fl.CSS_CLASSES.indicatorContainer),s){const{rootDocument:d}=this.hot,f=a.cloneNode(!0);o.innerHTML="",Oe(0,s-1,()=>{const h=d.createElement("SPAN");ee(h,fl.CSS_CLASSES.emptyIndicator),o.appendChild(h)}),o.appendChild(f)}if(this.dataManager.hasChildren(i)){const d=this.hot.rootDocument.createElement("DIV");u&&Ne(d,[yf()]),ee(r,fl.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(ee(d,`${fl.CSS_CLASSES.button} ${fl.CSS_CLASSES.expandButton}`),u&&Ne(r,[ko(!1)])):(ee(d,`${fl.CSS_CLASSES.button} ${fl.CSS_CLASSES.collapseButton}`),u&&Ne(r,[ko(!0)])),o.appendChild(d)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);let n=11;this.hot.stylesHandler.isClassicTheme()||(n=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,n+10*r+25),this.hot.render()}}class s4e extends PH{constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),B(n.lastCollapsedRows,(a,c)=>{a>=i&&a<s&&(n.lastCollapsedRows[c]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{Oe(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&B(s.__children,c=>{i.push(this.dataManager.getRowIndex(c))}),a=this.collapseRows(i,!0,!1),n&&this.trimRows(a),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];B(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return B(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);B(i.__children,s=>{const o=this.dataManager.getRowIndex(s);r.push(o),this.collapseChildRows(o,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return B(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);B(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);r.push(o),this.expandChildRows(o,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&B(s.__children,c=>{const u=this.dataManager.getRowIndex(c);i.push(u)}),a=this.expandRows(i,!0,!1),n&&this.untrimRows(a),r&&this.renderAndAdjust(),a}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];B(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];B(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];B(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{B(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{B(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&B(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);Ve(e.target,fl.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Ao(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function o4e(t,e,r){a4e(t,e),e.set(t,r)}function a4e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l4e(t,e,r){return(e=c4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c4e(t){var e=u4e(t,"string");return typeof e=="symbol"?e:e+""}function u4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d4e(t,e){return t.get(h4e(t,e))}function h4e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var PV=new WeakMap;class f4e extends PH{constructor(){super(...arguments),l4e(this,"dataManager",this.plugin.dataManager),o4e(this,PV,{row_above:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(D2)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedActive();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(L2)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const n=this.hot.getSelectedActive(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Oe(0,e.items.length-1,n=>{if(n===0)return B(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Oe(0,e.items.length-1,r=>{const n=d4e(PV,this)[e.items[r].key];n!=null&&(e.items[r].callback=n)}),e}}function _x(t,e,r){return(e=g4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g4e(t){var e=m4e(t,"string");return typeof e=="symbol"?e:e+""}function m4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p4e{constructor(e){_x(this,"plugin",void 0),_x(this,"hot",void 0),_x(this,"dataManager",void 0),_x(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=n===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let c=!0;const u=e.map(g=>{if(!c)return!1;const p=this.dataManager.translateTrimmedRow(g);return c=this.shouldAllowMoving(p,a),p}),d=u.indexOf(a)===-1;if(!c||!d)return!1;const f=this.getBaseParent(u),h=this.getTargetParent(o,a),m=f===h;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,m),this.moveRows(u,a,h),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let o=!1;return fr(i)&&(nt(Rt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0;if(this.movedToCollapsed){let o=null;e[n-1]<r?o=this.dataManager.translateTrimmedRow(r-n):o=this.dataManager.translateTrimmedRow(r);const a=this.dataManager.getRowParent(o===null?this.hot.countSourceRows()-1:o-1),c=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(c),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);this.hot.selectCells([[i,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}function y4e(t,e){_K(t,e),e.add(t)}function MV(t,e,r){_K(t,e),e.set(t,r)}function _K(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zk(t,e,r){return(e=v4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v4e(t){var e=w4e(t,"string");return typeof e=="symbol"?e:e+""}function w4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AS(t,e){return t.get(Cn(t,e))}function x1(t,e,r){return t.set(Cn(t,e),r),r}function Cn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const S1="nestedRows",b4e=300,AV=S1,x4e="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var tR=new WeakMap,hg=new WeakMap,Hn=new WeakSet;class S4e extends wt{constructor(){super(...arguments),y4e(this,Hn),Zk(this,"dataManager",null),Zk(this,"headersUI",null),Zk(this,"collapsedRowsMap",null),MV(this,tR,!1),MV(this,hg,!1)}static get PLUGIN_KEY(){return S1}static get PLUGIN_PRIORITY(){return b4e}isEnabled(){return!!this.hot.getSettings()[S1]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Qv),this.dataManager=new r4e(this,this.hot),this.collapsingUI=new s4e(this,this.hot),this.headersUI=new fl(this,this.hot),this.contextMenuUI=new f4e(this,this.hot),this.rowMoveController=new p4e(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,H4e).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,$4e).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,R4e).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,E4e).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,N4e).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,_4e).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,P4e).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,T4e).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,M4e).call(e,...n)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,A4e).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,O4e).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,I4e).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,k4e).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,j4e).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Cn(Hn,e,C4e).call(e,...n)}),this.addHook("beforeLoadData",r=>Cn(Hn,this,OV).call(this,r)),this.addHook("beforeUpdateData",r=>Cn(Hn,this,OV).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:AV,relativeToGroup:fd,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AV)}disableCoreAPIModifiers(){x1(hg,this,!0)}enableCoreAPIModifiers(){x1(hg,this,!1)}onModifyRowData(e){if(!AS(hg,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!AS(hg,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return AS(hg,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}destroy(){super.destroy()}}function C4e(t,e,r,n){return this.rowMoveController.onBeforeRowMove(t,e,r,n)}function _4e(t,e,r){this.collapsingUI.toggleState(t,e,r)}function R4e(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),x1(tR,this,!0),this.dataManager.getData().slice()}function E4e(t){return this.contextMenuUI.appendOptions(t)}function N4e(t,e){this.headersUI.appendLevelIndicators(t,e)}function k4e(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function T4e(t,e,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{x1(tR,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function P4e(t,e,r){const n=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));r.length=0,r.push(...n)}function M4e(){this.collapsingUI.collapsedRowsStash.stash()}function A4e(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function O4e(){this.collapsingUI.collapsedRowsStash.stash()}function I4e(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function j4e(){this.dataManager.rewriteCache()}function H4e(){this.headersUI.updateRowHeaderWidth()}function $4e(t,e){AS(tR,this)&&(e.skipRender=!0)}function OV(t){if(!FCe(t)){EI(x4e),this.hot.getSettings()[S1]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function D4e(t,e){RK(t,e),e.add(t)}function fu(t,e,r){RK(t,e),e.set(t,r)}function RK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ft(t,e){return t.get(ky(t,e))}function el(t,e,r){return t.set(ky(t,e),r),r}function ky(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const L4e=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var Jg=new WeakMap,ch=new WeakMap,eT=new WeakMap,hi=new WeakMap,fg=new WeakMap,ho=new WeakMap,tT=new WeakMap,rT=new WeakMap,Rx=new WeakSet;class EK{constructor(e){let{rootElement:r,uiContainer:n,isRtl:i,themeName:s,phraseTranslator:o,shouldHaveBorder:a,a11yAnnouncer:c}=e;D4e(this,Rx),fu(this,Jg,void 0),fu(this,ch,void 0),fu(this,eT,!1),fu(this,hi,void 0),fu(this,fg,void 0),fu(this,ho,void 0),fu(this,tT,void 0),fu(this,rT,void 0),el(Jg,this,r),el(ch,this,n),el(eT,this,i),el(fg,this,s),el(ho,this,o),el(tT,this,a),el(rT,this,c),this.install()}install(){var e;if((e=ft(hi,this))!==null&&e!==void 0&&e.container)return;const r=Mm`${L4e}`,{container:n,first:i,prev:s,next:o,last:a,pageSizeSelect:c}=r.refs;el(hi,this,r.refs),n.setAttribute("dir",ft(eT,this)?"rtl":"ltr"),n.tabIndex=-1;const u=f=>f.currentTarget.disabled,d=(f,h,m)=>{h.addEventListener(f,g=>{u(g)||m()})};d("click",i,()=>this.runLocalHooks("firstPageClick")),d("click",s,()=>this.runLocalHooks("prevPageClick")),d("click",o,()=>this.runLocalHooks("nextPageClick")),d("click",a,()=>this.runLocalHooks("lastPageClick")),c.addEventListener("change",()=>{const f=c.value==="auto"?"auto":Number.parseInt(c.value,10);this.runLocalHooks("pageSizeChange",f)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),ft(ch,this)?(ft(ch,this).appendChild(r.fragment),ee(n,[ft(fg,this),"handsontable"])):ft(Jg,this).after(r.fragment)}getContainer(){return ft(hi,this).container}getFocusableElements(){const{first:e,prev:r,next:n,last:i,pageSizeSelect:s}=ft(hi,this);return[s,e,r,n,i].filter(o=>!o.disabled)}updateWidth(e){return ft(hi,this).container.style.width=`${e}px`,this}updateTheme(e){if(el(fg,this,e),ft(ch,this)){const{container:r}=ft(hi,this);Re(r,/ht-theme-.*/g),ft(fg,this)&&ee(r,ft(fg,this))}return this}getHeight(){return ft(hi,this).container.offsetHeight}refreshBorderState(){const{container:e}=ft(hi,this);return ft(ch,this)||ft(tT,this).call(this)?ee(e,"ht-pagination--bordered"):Re(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:r,totalPages:n,firstVisibleRowIndex:i,lastVisibleRowIndex:s,totalRenderedRows:o,pageSizeList:a,pageSize:c,autoPageSize:u}=e;const{first:d,prev:f,next:h,last:m,pageCounterSection:g,pageNavSection:p,pageNavLabel:y,pageSizeSelect:w,pageSizeLabel:v}=ft(hi,this),x=ft(ho,this).call(this,xj,{start:i+1,end:s+1,total:o}),S=ft(ho,this).call(this,Sj,{currentPage:r,totalPages:n}),N=ft(ho,this).call(this,jC);g.textContent=x,y.textContent=S,w.textContent="",v.textContent=`${N}:`,Ne(p,[Us(ft(ho,this).call(this,wj))]),Ne(w,[Us(ft(ho,this).call(this,jC))]),ft(rT,this).call(this,S),this.refreshBorderState(),a.forEach(P=>{const D=P==="auto"?ft(ho,this).call(this,bj):P,H=new Option(D,P);(u&&P==="auto"||!u&&P===c)&&(H.selected=!0),w.add(H)});const R=r===1,E=r===n;if(p.style.display!=="none"){const P=ft(Jg,this).ownerDocument.activeElement;R?(ee(d,"ht-page-navigation-section__button--disabled"),ee(f,"ht-page-navigation-section__button--disabled"),d.disabled=!0,f.disabled=!0):(Re(d,"ht-page-navigation-section__button--disabled"),Re(f,"ht-page-navigation-section__button--disabled"),d.disabled=!1,f.disabled=!1),E?(ee(h,"ht-page-navigation-section__button--disabled"),ee(m,"ht-page-navigation-section__button--disabled"),h.disabled=!0,m.disabled=!0):(Re(h,"ht-page-navigation-section__button--disabled"),Re(m,"ht-page-navigation-section__button--disabled"),h.disabled=!1,m.disabled=!1),[d,f,h,m].includes(P)&&(f.disabled?h.focus():h.disabled&&f.focus())}return Ne(d,[Us(ft(ho,this).call(this,Cj)),D0(R)]),Ne(f,[Us(ft(ho,this).call(this,_j)),D0(R)]),Ne(h,[Us(ft(ho,this).call(this,Rj)),D0(E)]),Ne(m,[Us(ft(ho,this).call(this,Ej)),D0(E)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:r,pageSizeSelect:n}=ft(hi,this);return r.style.display=e?"":"none",n.disabled=!e,ky(Rx,this,nT).call(this),this}setCounterSectionVisibility(e){return ft(hi,this).pageCounterSection.style.display=e?"":"none",ky(Rx,this,nT).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:r,first:n,prev:i,next:s,last:o}=ft(hi,this);return r.style.display=e?"":"none",n.disabled=!e,i.disabled=!e,s.disabled=!e,o.disabled=!e,ky(Rx,this,nT).call(this),this}destroy(){var e;(e=ft(hi,this))===null||e===void 0||e.container.remove(),el(hi,this,null)}}function nT(){const{container:t,pageSizeSection:e,pageCounterSection:r,pageNavSection:n}=ft(hi,this),i=e.style.display!=="none"||r.style.display!=="none"||n.style.display!=="none";ft(ch,this)||(i?ee(ft(Jg,this).querySelector(".ht-wrapper"),"htPagination"):Re(ft(Jg,this).querySelector(".ht-wrapper"),"htPagination")),t.style.display=i?"":"none"}Ht(EK,Mn);const F4e=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function V4e(t){return F4e.some(e=>{const r=!!t[e];return r&&nt(Rt`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),r})}function iT(t,e,r){return(e=B4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B4e(t){var e=W4e(t,"string");return typeof e=="symbol"?e:e+""}function W4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z4e{constructor(){iT(this,"pageSize",1),iT(this,"totalItems",0),iT(this,"totalPages",0)}calculate(e){let{pageSize:r,totalItems:n}=e;this.pageSize=Math.max(r,1),this.totalItems=n,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const r=e*this.pageSize,n=Math.max(0,Math.min(r+this.pageSize-1,this.totalItems-1));return{startIndex:r,endIndex:n,pageSize:this.pageSize}}}function U4e(t,e,r){return(e=Y4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y4e(t){var e=G4e(t,"string");return typeof e=="symbol"?e:e+""}function G4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K4e{constructor(){U4e(this,"pages",[])}calculate(e){let{itemsSizeProvider:r,viewportSizeProvider:n}=e;const i=r(),s=n(),o=[];let a=0,c=0,u=0;for(let d=0;d<i.length;d++){const f=i[d];u>0&&c+f>=s&&(o.push({startIndex:a,endIndex:d-1,pageSize:u}),a=d,c=0,u=0),c+=f,u+=1}o.push({startIndex:a,endIndex:Math.max(0,i.length-1),pageSize:u}),this.pages=o}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const IV=new Map([["fixed",z4e],["auto",K4e]]);function jV(t){if(!IV.has(t))throw new Error(`Unknown pagination strategy type: ${t}`);const e=IV.get(t);return new e}function q4e(t,e){NK(t,e),e.add(t)}function gu(t,e,r){NK(t,e),e.set(t,r)}function NK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function We(t,e){return t.get(nr(t,e))}function Jn(t,e,r){return t.set(nr(t,e),r),r}function nr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Ph="pagination",X4e=900,Q4e=`plugin:${Ph}`,HV=Rt`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var Ty=new WeakMap,Ai=new WeakMap,oa=new WeakMap,Ur=new WeakMap,aa=new WeakMap,C1=new WeakMap,OS=new WeakMap,dr=new WeakSet,sT=new WeakMap;class J4e extends wt{constructor(){super(...arguments),q4e(this,dr),gu(this,Ty,null),gu(this,Ai,1),gu(this,oa,10),gu(this,Ur,null),gu(this,aa,null),gu(this,C1,!1),gu(this,OS,!1),gu(this,sT,()=>{var e;!We(C1,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&nr(dr,this,Mh).call(this)})}static get PLUGIN_KEY(){return Ph}static get PLUGIN_PRIORITY(){return X4e}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[Ph]}enablePlugin(){var e,r=this;if(V4e(this.hot.getSettings())){this.hot.getSettings()[Ph]=!1;return}if(this.enabled)return;const n=this.hot.getSettings()[Ph];(n==null?void 0:n.initialPage)!==void 0&&Jn(Ai,this,this.getSetting("initialPage")),(n==null?void 0:n.pageSize)!==void 0&&Jn(oa,this,this.getSetting("pageSize")),Jn(Ty,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),We(oa,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&nt(HV),Jn(aa,this,jV(We(oa,this)==="auto"?"auto":"fixed")),We(Ur,this)||(Jn(Ur,this,new EK({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return r.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>nr(dr,this,Z4e).call(this),a11yAnnouncer:i=>PEe(i)})),nr(dr,this,$V).call(this),We(Ur,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",i=>this.setPageSize(i))),this.addHook("init",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,l6e).call(r,...s)},-1),this.addHook("beforeSelectAll",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,DV).call(r,...s)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,DV).call(r,...s)}),this.addHook("beforeSetRangeEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,r6e).call(r,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,n6e).call(r,...s)}),this.addHook("beforePaste",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,i6e).call(r,...s)}),this.addHook("afterViewRender",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,s6e).call(r,...s)}),this.addHook("afterRender",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,o6e).call(r,...s)}),this.addHook("afterScrollVertically",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,c6e).call(r,...s)}),this.addHook("afterLanguageChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,u6e).call(r,...s)}),this.addHook("beforeHeightChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,a6e).call(r,...s)}),this.addHook("afterSetTheme",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return nr(dr,r,d6e).call(r,...s)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",We(sT,this)),nr(dr,this,e6e).call(this),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),nr(dr,this,Mh).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",We(sT,this)).unregisterMap(this.pluginName),nr(dr,this,t6e).call(this),We(Ur,this).destroy(),Jn(Ur,this,null),super.disablePlugin()}getPaginationData(){const e=We(aa,this).getTotalPages();let r=-1,n=-1;const{pageSize:i,startIndex:s}=We(aa,this).getState(We(Ai,this)),o=this.hot.countRows();let a=0;for(let c=s;a<i&&!(c>=o);c++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(c))||(r===-1&&(r=c),n=c,a+=1);return{currentPage:We(Ai,this),totalPages:e,pageSize:i,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:We(oa,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:r,lastVisibleRowIndex:n}}setPage(e){const r=We(Ai,this);this.hot.runHooks("beforePageChange",r,e)!==!1&&(Jn(Ai,this,e),nr(dr,this,Mh).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",r,We(Ai,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var r;const n=We(oa,this);this.hot.runHooks("beforePageSizeChange",n,e)!==!1&&(e==="auto"&&!((r=this.hot.getPlugin("autoRowSize"))!==null&&r!==void 0&&r.enabled)&&nt(HV),Jn(aa,this,jV(e==="auto"?"auto":"fixed")),Jn(oa,this,e),nr(dr,this,Mh).call(this),this.hot.runHooks("afterPageSizeChange",n,We(oa,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),nr(dr,this,$V).call(this)}nextPage(){this.setPage(We(Ai,this)+1)}prevPage(){this.setPage(We(Ai,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(We(aa,this).getTotalPages())}hasPreviousPage(){return We(Ai,this)>1}hasNextPage(){return We(Ai,this)<We(aa,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:r}=this.getPaginationData();return e===-1||r===-1?[]:this.hot.getData(e,0,r,this.hot.countCols()-1)}showPageSizeSection(){We(Ur,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){We(Ur,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){We(Ur,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){We(Ur,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){We(Ur,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){We(Ur,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;Jn(Ty,this,null),Jn(aa,this,null),(e=We(Ur,this))===null||e===void 0||e.destroy(),Jn(Ur,this,null),super.destroy()}}function $V(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function Mh(){Jn(C1,this,!0),We(Ty,this).clear();const t=this.hot.rowIndexMapper.getRenderableIndexes(),e=t.length,{stylesHandler:r}=this.hot;We(aa,this).calculate({pageSize:We(oa,this),totalItems:e,viewportSizeProvider:()=>{const{view:s}=this.hot;if(s.isVerticallyScrollableByWindow()){const a=getComputedStyle(this.hot.rootDocument.body),c=Number.parseInt(a.marginTop,10)+Number.parseInt(a.marginBottom,10),u=this.hot.hasColHeaders()?s._wt.wtTable.getColumnHeaderHeight():0,d=We(Ur,this).getHeight();return s.getWorkspaceHeight()-d-u-c}const o=s.hasHorizontalScroll()?on():0;return s.getViewportHeight()-o},itemsSizeProvider:()=>this.hot.rowIndexMapper.getRenderableIndexes().map(o=>{var a;const c=this.hot.toVisualRow(o);return(a=this.hot.getRowHeight(c))!==null&&a!==void 0?a:r.getDefaultRowHeight(c)})});const n=We(aa,this).getTotalPages();if(Jn(Ai,this,ut(We(Ai,this),1,n)),t.length>0){const{startIndex:s,pageSize:o}=We(aa,this).getState(We(Ai,this));t.splice(s,o)}t.length>0?this.hot.batchExecution(()=>{t.forEach(s=>We(Ty,this).setValueAtIndex(s,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),Jn(C1,this,!1);const i=this.getPaginationData();We(Ur,this).updateState({...i,totalRenderedRows:e})}function Z4e(){if(!this.hot.view)return!0;const{view:t}=this.hot;if(t.isVerticallyScrollableByWindow())return!1;if(t.hasHorizontalScroll()||t.getTableHeight()<t.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return t.getLastFullyVisibleRow()!==e}function e6e(){this.hot.getFocusScopeManager().registerScope(Ph,We(Ur,this).getContainer(),{shortcutsContextName:Q4e,runOnlyIf:()=>this.getSetting("showPageSize")||this.getSetting("showNavigation"),onActivate:t=>{const e=We(Ur,this).getFocusableElements();e.length>0&&(t==="tab_from_above"?e.at(0).focus():t==="tab_from_below"&&e.at(-1).focus())}})}function t6e(){this.hot.getFocusScopeManager().unregisterScope(Ph)}function DV(t,e){const{firstVisibleRowIndex:r,lastVisibleRowIndex:n}=this.getPaginationData();(We(Ai,this)>1||t.row>=0)&&(t.row=r),e.row=n}function r6e(t){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();t.row=e}}function n6e(){if(!this.hot.getSettings().navigableHeaders)return;const t=this.hot.getSelectedRangeLast();if(!t.isSingle()){const{highlight:e}=t;e.row=ut(e.row,t.getTopStartCorner().row,t.getBottomEndCorner().row)}}function i6e(t,e){const{firstVisibleRowIndex:r,lastVisibleRowIndex:n}=this.getPaginationData();if(r===-1||n===-1)return!1;e.forEach(i=>{let{startRow:s}=i;if(t.length===0)return;const o=Math.min(t.length-(n-s+1),t.length);t.splice(0,o)})}function s6e(){if(We(oa,this)!=="auto"||We(OS,this)){Jn(OS,this,!1);return}nr(dr,this,Mh).call(this),Jn(OS,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function o6e(){const{view:t}=this.hot,e=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();We(Ur,this).updateWidth(e).refreshBorderState()}function a6e(t){return this.getSetting("uiContainer")||!(typeof t=="number"||typeof t=="string"&&/^\d+$/.test(t)||typeof t=="string"&&t.endsWith("px"))?t:`calc(${typeof t=="string"&&t.endsWith("px")?t:`${t}px`} - ${We(Ur,this).getHeight()}px)`}function l6e(){We(oa,this)!=="auto"&&nr(dr,this,Mh).call(this)}function c6e(){We(Ur,this).refreshBorderState()}function u6e(){nr(dr,this,Mh).call(this)}function d6e(t){We(Ur,this).updateTheme(t)}function oT(t,e,r){return(e=h6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h6e(t){var e=f6e(t,"string");return typeof e=="symbol"?e:e+""}function f6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g6e{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;oT(this,"rootWindow",void 0),oT(this,"prefix",void 0),oT(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){B(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function m6e(t,e,r){return(e=p6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p6e(t){var e=y6e(t,"string");return typeof e=="symbol"?e:e+""}function y6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}_e.getSingleton().register("persistentStateSave");_e.getSingleton().register("persistentStateLoad");_e.getSingleton().register("persistentStateReset");const LV="persistentState",v6e=0,FV=new WeakSet;class w6e extends wt{constructor(){super(...arguments),m6e(this,"storage",void 0)}static get PLUGIN_KEY(){return LV}static get PLUGIN_PRIORITY(){return v6e}isEnabled(){return!!this.hot.getSettings()[LV]}enablePlugin(){this.enabled||(FV.has(this.hot)||(FV.add(this.hot),FU("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new g6e(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function b6e(t,e){x6e(t,e),e.add(t)}function x6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aT(t,e,r){return(e=S6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S6e(t){var e=C6e(t,"string");return typeof e=="symbol"?e:e+""}function C6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VV(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const lT="search",_6e=190,R6e="htSearchResult",E6e=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},N6e=function(t,e,r){return fr(t)||t===null||!t.toLocaleLowerCase||t.length===0||fr(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var cT=new WeakSet;class k6e extends wt{constructor(){super(...arguments),b6e(this,cT),aT(this,"callback",E6e),aT(this,"queryMethod",N6e),aT(this,"searchResultClass",R6e)}static get PLUGIN_KEY(){return lT}static get PLUGIN_PRIORITY(){return _6e}isEnabled(){return this.hot.getSettings()[lT]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[lT];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return VV(cT,e,BV).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return VV(cT,e,BV).call(e,...i)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return Oe(0,i-1,c=>{Oe(0,s-1,u=>{const d=this.hot.getDataAtCell(c,u),f=this.hot.getCellMeta(c,u),h=f.search.callback||r,g=(f.search.queryMethod||n)(e,d,f);if(g){const p={row:c,col:u,data:d};o.push(p)}h&&h(a,c,u,d,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Le(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function BV(t,e,r,n,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Ex(t,e,r){return(e=T6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T6e(t){var e=P6e(t,"string");return typeof e=="symbol"?e:e+""}function P6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kK{constructor(e){Ex(this,"viewportWidth",void 0),Ex(this,"overwriteColumnWidthFn",void 0),Ex(this,"baseWidths",new Map),Ex(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class M6e extends kK{calculate(){const e=Array.from(this.baseWidths).reduce((f,h)=>{let[,m]=h;return f+m},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const n=this.viewportWidth/e,i=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((f,h)=>{const m=Math.round(f*n),g=this.overwriteColumnWidthFn(m,h);m===g&&m>=Om?(i.push([h,g]),a+=g):m!==g&&(i.push([h,g]),s.push(h),o-=g)}),o<=Om){this.stretchedWidths.clear();return}const c=o/a;let u=-1,d=0;i.forEach((f,h)=>{let[m,g]=f,p=g;s.includes(m)||(p=Math.round(g*c)),this.stretchedWidths.set(m,p),u=m,h<i.length-1&&(d+=p)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-d))}}function WV(t,e,r){A6e(t,e),e.set(t,r)}function A6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uT(t,e){return t.get(TK(t,e))}function Nx(t,e,r){return t.set(TK(t,e),r),r}function TK(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kx=new WeakMap,E0=new WeakMap;class O6e extends kK{constructor(){super(...arguments),WV(this,kx,0),WV(this,E0,-1)}prepare(e){super.prepare(e),Nx(kx,this,0),Nx(E0,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),Nx(E0,this,e),Nx(kx,this,r)}calculate(){if(uT(E0,this)===-1)return;const e=Array.from(this.baseWidths).reduce((n,i)=>{let[,s]=i;return n+s},0),r=Math.max(this.viewportWidth-e+uT(kx,this),0);this.stretchedWidths.set(uT(E0,this),r)}}function I6e(t,e){PK(t,e),e.add(t)}function Tx(t,e,r){PK(t,e),e.set(t,r)}function PK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xr(t,e){return t.get(Zg(t,e))}function dT(t,e,r){return t.set(Zg(t,e),r),r}function Zg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const j6e="stretchColumns";var Vn=new WeakMap,gg=new WeakMap,hT=new WeakMap,Px=new WeakMap,N0=new WeakSet;class H6e{constructor(e){I6e(this,N0),Tx(this,Vn,void 0),Tx(this,gg,void 0),Tx(this,hT,new Map([["all",new M6e(Zg(N0,this,zV).bind(this))],["last",new O6e(Zg(N0,this,zV).bind(this))]])),Tx(this,Px,"none"),dT(Vn,this,e),dT(gg,this,xr(Vn,this).columnIndexMapper.createAndRegisterIndexMap(j6e,"physicalIndexToValue"))}useStrategy(e){dT(Px,this,xr(hT,this).has(e)?e:"none")}refreshStretching(){if(xr(Px,this)==="none"){xr(gg,this).clear();return}xr(Vn,this).batchExecution(()=>{xr(gg,this).clear();const e=xr(hT,this).get(xr(Px,this));let n=xr(Vn,this).view.getViewportWidth();Zg(N0,this,$6e).call(this)&&(n-=on(xr(Vn,this).rootDocument)),e.prepare({viewportWidth:n});for(let i=0;i<xr(Vn,this).countCols();i++)xr(Vn,this).columnIndexMapper.isHidden(xr(Vn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Zg(N0,this,D6e).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,o]=i;xr(gg,this).setValueAtIndex(xr(Vn,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return xr(gg,this).getValueAtIndex(xr(Vn,this).toPhysicalColumn(e))}}function $6e(){const{view:t,stylesHandler:e}=xr(Vn,this);if(t.isVerticallyScrollableByWindow())return!1;const r=t.getViewportHeight(),n=xr(Vn,this).countRows(),i=e.getDefaultRowHeight(),s=e.isClassicTheme(),o=d=>s&&d===0?1:0;let a=0,c=!1;for(let d=0;d<n;d++){var u;if(!xr(Vn,this).rowIndexMapper.isHidden(xr(Vn,this).toPhysicalRow(d))&&(a+=((u=xr(Vn,this).getRowHeight(d))!==null&&u!==void 0?u:i)+o(d),a>r)){c=!0;break}}return c}function D6e(t){var e;return(e=xr(Vn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Om}function zV(t,e){return xr(Vn,this).runHooks("beforeStretchingColumnWidth",t,e)}function L6e(t,e){MK(t,e),e.add(t)}function fT(t,e,r){MK(t,e),e.set(t,r)}function MK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gT(t,e,r){return t.set(_1(t,e),r),r}function rc(t,e){return t.get(_1(t,e))}function _1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const F6e="stretchColumns",V6e=155;var Tg=new WeakMap,Mx=new WeakMap,k0=new WeakMap,mT=new WeakSet;class B6e extends wt{constructor(){super(...arguments),L6e(this,mT),fT(this,Tg,new H6e(this.hot)),fT(this,Mx,null),fT(this,k0,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(n=>{let{contentRect:i}=n;rc(Mx,this)!==null&&rc(Mx,this)!==i.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),gT(Mx,this,i.width)})})}))}static get PLUGIN_KEY(){return F6e}static get PLUGIN_PRIORITY(){return V6e}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(rc(Tg,this).useStrategy(this.hot.getSettings().stretchH),rc(k0,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return _1(mT,e,z6e).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return _1(mT,e,W6e).call(e,...n)},10),super.enablePlugin())}updatePlugin(){rc(Tg,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),rc(k0,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return rc(Tg,this).getStretchedWidth(e)}destroy(){rc(k0,this).disconnect(),gT(k0,this,null),gT(Tg,this,null),super.destroy()}}function W6e(t,e,r){if(r===this.pluginName)return;const n=this.getColumnWidth(e);return typeof n=="number"?n:t}function z6e(t){t&&rc(Tg,this).refreshStretching()}function U6e(t,e){Y6e(t,e),e.add(t)}function Y6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ax(t,e,r){return(e=G6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G6e(t){var e=K6e(t,"string");return typeof e=="symbol"?e:e+""}function K6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const q6e="touchScroll",X6e=200;var Ox=new WeakSet;class Q6e extends wt{constructor(){super(...arguments),U6e(this,Ox),Ax(this,"scrollbars",[]),Ax(this,"clones",[]),Ax(this,"lockedCollection",!1),Ax(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return q6e}static get PLUGIN_PRIORITY(){return X6e}static get SETTING_KEYS(){return!0}isEnabled(){return SU()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>pT(Ox,this,J6e).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>pT(Ox,this,Z6e).call(this)),this.addHook("afterMomentumScroll",()=>pT(Ox,this,eFe).call(this))}}function J6e(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Z6e(){this.freezeOverlays=!0,B(this.clones,t=>{ee(t,"hide-tween")})}function eFe(){this.freezeOverlays=!1,B(this.clones,t=>{Re(t,"hide-tween"),ee(t,"show-tween")}),this.hot._registerTimeout(()=>{B(this.clones,t=>{Re(t,"show-tween")})},400),B(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function tFe(t,e){rFe(t,e),e.add(t)}function rFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nFe(t,e,r){return(e=iFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iFe(t){var e=sFe(t,"string");return typeof e=="symbol"?e:e+""}function sFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oFe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const IS="trimRows",aFe=330;var UV=new WeakSet;class lFe extends wt{constructor(){super(...arguments),tFe(this,UV),nFe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return IS}static get PLUGIN_PRIORITY(){return aFe}isEnabled(){return!!this.hot.getSettings()[IS]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Qv),this.trimmedRowsMap.addLocalHook("init",()=>oFe(UV,this,cFe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[IS];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),B(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{B(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(B(e,c=>{s[c]=!1}),i=bs(s,(c,u,d)=>(u&&c.push(d),c),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&o)!==!1&&(n&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&o,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}destroy(){super.destroy()}}function cFe(){const t=this.hot.getSettings()[IS];Array.isArray(t)&&this.hot.batchExecution(()=>{B(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function uFe(t,e,r){return(e=dFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dFe(t){var e=hFe(t,"string");return typeof e=="symbol"?e:e+""}function hFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Do{constructor(e){uFe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Ix(t,e,r){return(e=fFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fFe(t){var e=gFe(t,"string");return typeof e=="symbol"?e:e+""}function gFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MH extends Do{constructor(e){let{stateBefore:r,range:n,type:i,alignment:s}=e;super("cell_alignment"),Ix(this,"stateBefore",void 0),Ix(this,"range",void 0),Ix(this,"type",void 0),Ix(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=s}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,s,o)=>{r.done(()=>new MH({stateBefore:n,range:i,type:s,alignment:o}))})}undo(e,r){B(this.range,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&e.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){vu(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,s,o)=>e.setCellMeta(n,i,s,o)),e.addHookOnce("afterViewRender",r),e.render()}}function YV(t,e,r){return(e=mFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mFe(t){var e=pFe(t,"string");return typeof e=="symbol"?e:e+""}function pFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AH extends Do{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),YV(this,"columns",void 0),YV(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new AH({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),EH(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),n.moveColumn(a,o)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function GV(t,e,r){return(e=yFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yFe(t){var e=vFe(t,"string");return typeof e=="symbol"?e:e+""}function vFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OH extends Do{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),GV(this,"previousSortState",void 0),GV(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,s)=>{s&&r.done(()=>new OH({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),s=i.isEnabled()?i:n;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function KV(t,e,r){return(e=wFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wFe(t){var e=bFe(t,"string");return typeof e=="symbol"?e:e+""}function bFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IH extends Do{constructor(e){let{index:r,amount:n}=e;super("insert_col"),KV(this,"index",void 0),KV(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,s)=>{r.done(()=>new IH({index:n,amount:i}),s)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function qV(t,e,r){return(e=xFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xFe(t){var e=SFe(t,"string");return typeof e=="symbol"?e:e+""}function SFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jH extends Do{constructor(e){let{index:r,amount:n}=e;super("insert_row"),qV(this,"index",void 0),qV(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,s)=>{r.done(()=>new jH({index:n,amount:i}),s)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function jx(t,e,r){return(e=CFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CFe(t){var e=_Fe(t,"string");return typeof e=="symbol"?e:e+""}function _Fe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HH extends Do{constructor(e){let{changes:r,selected:n,countCols:i,countRows:s}=e;super("change"),jx(this,"changes",void 0),jx(this,"selected",void 0),jx(this,"countCols",void 0),jx(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=s}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const s=n&&n.length;if(!s||!n.find(c=>{const[,,u,d]=c;return u!==d}))return;const a=()=>{const c=n.reduce((d,f)=>(d.push([...f]),d),[]);c.forEach(d=>{d[1]=e.propToCol(d[1])});const u=s>1?this.getSelected():[[c[0][0],c[0][1]]];return new HH({changes:c,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=Bi(this.changes);for(let i=0,s=n.length;i<s;i++)n[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.undo")}redo(e,r){const n=Bi(this.changes);for(let i=0,s=n.length;i<s;i++)n[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.redo")}}function XV(t,e,r){return(e=RFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RFe(t){var e=EFe(t,"string");return typeof e=="symbol"?e:e+""}function EFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $H extends Do{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),XV(this,"conditionsStack",void 0),XV(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new $H({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function NFe(t,e,r){return(e=kFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kFe(t){var e=TFe(t,"string");return typeof e=="symbol"?e:e+""}function TFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DH extends Do{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),NFe(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const s=n.getTopStartCorner(),o=n.getBottomEndCorner(),a=e.getData(s.row,s.col,o.row,o.col);r.done(()=>new DH({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function AK(t,e,r,n,i){const s=["visualRow","visualCol","row","col","prop"],o=s.length,a=[];return Oe(n,i,c=>{Oe(e,r,u=>{const d=t.getCellMeta(u,c);if(Object.keys(d).length!==o){const f=Object.fromEntries(Object.entries(d).filter(h=>{let[m]=h;return s.includes(m)===!1}));a.push([d.visualRow,d.visualCol,f])}})}),a}function Jl(t,e,r){return(e=PFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PFe(t){var e=MFe(t,"string");return typeof e=="symbol"?e:e+""}function MFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LH extends Do{constructor(e){let{index:r,indexes:n,data:i,amount:s,headers:o,columnPositions:a,rowPositions:c,fixedColumnsStart:u,removedCellMetas:d}=e;super("remove_col"),Jl(this,"index",void 0),Jl(this,"indexes",void 0),Jl(this,"data",void 0),Jl(this,"amount",void 0),Jl(this,"headers",void 0),Jl(this,"columnPositions",void 0),Jl(this,"rowPositions",void 0),Jl(this,"fixedColumnsStart",void 0),Jl(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=s,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=c.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=d}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,s,o)=>{const a=()=>{const c=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),d=u+i-1,f=[],h=[],m=[];return Oe(c.length-1,g=>{const p=[],y=c[g];Oe(u,d,w=>{p.push(y[e.toPhysicalColumn(w)])}),f.push(p)}),Oe(i-1,g=>{m.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&Oe(i-1,g=>{h.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new LH({index:u,indexes:m,data:f,amount:i,headers:h,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:AK(e,0,e.countRows(),u,d)})};r.done(a,o)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),s=(d,f,h)=>h[this.indexes.indexOf(i[f])],o=this.data.length,a=[];for(let d=0;d<o;d++)a.push(_t(this.data[d],s));const c=_t(this.headers,s),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),B(e.getSourceDataArray(),(d,f)=>{B(i,(h,m)=>{d[h]=a[f][m],u.push([f,h,d[h]])})}),typeof this.headers<"u"&&B(c,(d,f)=>{e.getSettings().colHeaders[i[f]]=d}),this.removedCellMetas.forEach(d=>{let[f,h,m]=d;e.setCellMetaObject(f,h,m)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function mg(t,e,r){return(e=AFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AFe(t){var e=OFe(t,"string");return typeof e=="symbol"?e:e+""}function OFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FH extends Do{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:s,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),mg(this,"index",void 0),mg(this,"data",void 0),mg(this,"fixedRowsBottom",void 0),mg(this,"fixedRowsTop",void 0),mg(this,"rowIndexesSequence",void 0),mg(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=s,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,s,o)=>{const a=()=>{const c=e.toPhysicalRow(n),u=c+i-1,d=Bi(e.getSourceData(c,0,c+i-1,e.countSourceCols()-1));return new FH({index:c,data:d,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:AK(e,c,u,0,e.countCols()-1)})};r.done(a,o)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const c=parseInt(a,10);i.push([this.index+o,isNaN(c)?a:c,s[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[o,a,c]=s;e.setCellMetaObject(o,a,c)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function QV(t,e,r){return(e=IFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IFe(t){var e=jFe(t,"string");return typeof e=="symbol"?e:e+""}function jFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VH extends Do{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),QV(this,"rows",void 0),QV(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new VH({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),EH(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),n.moveRow(a,o)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function HFe(t,e,r){return(e=$Fe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Fe(t){var e=DFe(t,"string");return typeof e=="symbol"?e:e+""}function DFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BH extends Do{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),HFe(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new BH({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function LFe(t,e){[MH,AH,OH,IH,jH,HH,$H,DH,LH,FH,VH,BH].forEach(r=>r.startRegisteringEvents(t,e))}function FFe(t,e){VFe(t,e),e.add(t)}function VFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yT(t,e,r){return(e=BFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BFe(t){var e=WFe(t,"string");return typeof e=="symbol"?e:e+""}function WFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const JV="undoRedo",zFe="undoRedo",UFe=1e3;_e.getSingleton().register("beforeUndo");_e.getSingleton().register("afterUndo");_e.getSingleton().register("beforeRedo");_e.getSingleton().register("afterRedo");const ZV=new Set;var Hx=new WeakSet;class YFe extends wt{static get PLUGIN_KEY(){return zFe}static get PLUGIN_PRIORITY(){return UFe}static get SETTING_KEYS(){return!0}constructor(e){super(e),FFe(this,Hx),yT(this,"doneActions",[]),yT(this,"undoneActions",[]),yT(this,"ignoreNewActions",!1),LFe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return vT(Hx,e,GFe).call(e,...n)}),this.registerShortcuts(),vT(Hx,this,KFe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),vT(Hx,this,qFe).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:JV};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JV)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const o=e(),a=this.undoneActions.slice();this.doneActions.push(o),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=Bi(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=Bi(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function GFe(t,e){e==="loadData"&&this.clear()}function KFe(){const t=e=>{ZV.has(e)||(nt(Rt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),ZV.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function qFe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}const Wn="ht-dialog";function XFe(){function t(){return`
      <div data-ref="contentElement" class="${Wn}__content"></div>
    `}let e=null;const r={};function n(){const s=Mm`${t()}`;return Object.assign(r,s.refs),e=s.fragment,s}function i(){if(e===null)throw new Error("Compile the template first.");return[]}return{TEMPLATE_NAME:"base",dialogA11YOptions(){return{role:"dialog"}},compile:n,focusableElements:i}}function QFe(t){let{id:e="",title:r="",description:n="",buttons:i=[]}=t;function s(){return`
      <div tabindex="-1" data-ref="contentElement" class="${Wn}__content-wrapper-inner">
        <div class="${Wn}__content">
          <h2
            id="${e}-dialog-confirm-title"
            class="${Wn}__title">${Cc(r)}</h2>
          <p
            id="${e}-dialog-confirm-description"
            class="${Wn}__description">${Cc(n)}</p>
        </div>
        ${i.length>0?`
          <div data-ref="buttonsContainer" class="${Wn}__buttons">
            ${i.map(d=>`
              <button class="ht-button ht-button--${d.type}">${Cc(d.text)}</button>
            `).join("")}
          </div>
        `:""}
      </div>
    `}let o=null;const a={};function c(){const d=Mm`${s()}`;return Object.assign(a,d.refs),o=d.fragment,d}function u(){if(o===null)throw new Error("Compile the template first.");const{contentElement:d,buttonsContainer:f}=a,h=[];return f?h.push(...Array.from(f.children)):h.push(d),h}return{TEMPLATE_NAME:"confirm",dialogA11YOptions(){return{role:"alertdialog",ariaLabelledby:`${e}-dialog-confirm-title`,ariaDescribedby:n?`${e}-dialog-confirm-description`:void 0}},compile:c,focusableElements:u}}const T0=new Map([["base",XFe],["confirm",QFe]]);function JFe(t,e){OK(t,e),e.add(t)}function pg(t,e,r){OK(t,e),e.set(t,r)}function OK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function br(t,e){return t.get(R1(t,e))}function Zo(t,e,r){return t.set(R1(t,e),r),r}function R1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ZFe=`
<div data-ref="dialogElement" class="${Wn}">
  <div data-ref="dialogWrapperElement" class="${Wn}__content-wrapper">
</div>
`;var wT=new WeakMap,fi=new WeakMap,bT=new WeakMap,Y0=new WeakMap,tl=new WeakMap,$x=new WeakMap,xT=new WeakSet;class IK{constructor(e){let{rootElement:r,isRtl:n}=e;JFe(this,xT),pg(this,wT,void 0),pg(this,fi,void 0),pg(this,bT,!1),pg(this,Y0,!1),pg(this,tl,T0.get("base")),pg(this,$x,[]),Zo(wT,this,r),Zo(bT,this,n),this.install()}useTemplate(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!T0.has(e)||e==="base"){const i=Array.from(T0.keys()).filter(s=>s!=="base").join(", ");throw new Error(Rt`Invalid template: ${e}.\x20
        Valid templates are: ${i}.`)}Zo(tl,this,T0.get(e)(n)),Zo($x,this,((r=n.buttons)!==null&&r!==void 0?r:[]).map(i=>i.callback))}useDefaultTemplate(){Zo(tl,this,T0.get("base")()),Zo($x,this,[])}install(){var e;if((e=br(fi,this))!==null&&e!==void 0&&e.dialogElement)return;const r=Mm`${ZFe}`;Zo(fi,this,r.refs);const{dialogElement:n}=br(fi,this);Ne(n,[vye(),["dir",br(bT,this)?"rtl":"ltr"]]),n.addEventListener("transitionstart",()=>R1(xT,this,tVe).call(this)),n.addEventListener("transitionend",()=>R1(xT,this,eVe).call(this)),br(wT,this).after(r.fragment)}getContainer(){return br(fi,this).dialogElement}getFocusableElements(){return br(tl,this).focusableElements()}updateDialog(e){let{isVisible:r,content:n,customClassName:i,background:s,contentBackground:o,animation:a,a11y:c}=e;const u=br(tl,this).compile(),{dialogElement:d,dialogWrapperElement:f}=br(fi,this);f.innerHTML="",f.appendChild(u.fragment),Object.assign(br(fi,this),u.refs);const{contentElement:h,buttonsContainer:m}=br(fi,this);br(tl,this).TEMPLATE_NAME!=="base"&&Object.assign(c,br(tl,this).dialogA11YOptions());const g=i?` ${i}`:"",p=s?` ${Wn}--background-${s}`:"",y=a?` ${Wn}--animation`:"",w=r?` ${Wn}--show`:"";d.className=[Wn,`${Wn}--${br(tl,this).TEMPLATE_NAME}`,"handsontable",g,p,y,w].join(" "),Ne(d,[br(tl,this).TEMPLATE_NAME==="base"?Ra(-1):void 0]),Ne(d,[c.role==="alertdialog"?nye():rye()]),c.ariaLabel&&!c.ariaLabelledby?Ne(d,[c.ariaLabel?Us(c.ariaLabel):void 0]):_c(d,"aria-label"),c.ariaLabelledby?Ne(d,[aye(c.ariaLabelledby)]):_c(d,"aria-labelledby"),c.ariaDescribedby?Ne(d,[lye(c.ariaDescribedby)]):_c(d,"aria-describedby");const v=o?` ${Wn}__content--background`:"";return ee(h,`${Wn}__content${v}`),br(tl,this).TEMPLATE_NAME==="base"?(h.innerHTML="",typeof n=="string"?wf(h,n):(n instanceof HTMLElement||n instanceof DocumentFragment)&&h.appendChild(n)):m&&Array.from(m.children).forEach((x,S)=>{const N=br($x,this)[S];N&&x.addEventListener("click",N)}),this}showDialog(e){const{dialogElement:r}=br(fi,this);return r.style.display="block",e&&r.offsetHeight,ee(r,`${Wn}--show`),Zo(Y0,this,!1),this}hideDialog(e){const{dialogElement:r}=br(fi,this);return Re(r,`${Wn}--show`),(e&&!br(Y0,this)||!e)&&(r.style.display="none"),Zo(Y0,this,!1),this}focusDialog(){br(fi,this).dialogElement.focus()}updateWidth(e){return br(fi,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return br(fi,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=br(fi,this))===null||e===void 0||e.dialogElement.remove(),Zo(fi,this,null)}}function eVe(){const{dialogElement:t}=br(fi,this);Ve(t,`${Wn}--show`)||(t.style.display="none")}function tVe(){Zo(Y0,this,!0)}Ht(IK,Mn);function rVe(t,e){jK(t,e),e.add(t)}function ST(t,e,r){jK(t,e),e.set(t,r)}function jK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mu(t,e,r){return t.set(ph(t,e),r),r}function Bn(t,e){return t.get(ph(t,e))}function ph(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Lu="dialog",nVe=360,oA=Lu,E1=`plugin:${Lu}`;var Zn=new WeakMap,Pg=new WeakMap,yg=new WeakMap,vg=new WeakSet;class N1 extends wt{constructor(){super(...arguments),rVe(this,vg),ST(this,Zn,null),ST(this,Pg,!1),ST(this,yg,null)}static get PLUGIN_KEY(){return Lu}static get PLUGIN_PRIORITY(){return nVe}static get DEFAULT_SETTINGS(){return{template:null,content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{template:e=>Le(e)&&typeof["alert","confirm"].includes(e.type)&&typeof e.title=="string"&&(typeof(e==null?void 0:e.description)>"u"||typeof(e==null?void 0:e.description)=="string")&&(typeof(e==null?void 0:e.buttons)>"u"||Array.isArray(e==null?void 0:e.buttons)&&e.buttons.every(r=>typeof r=="object"&&typeof r.text=="string"&&["primary","secondary"].includes(r.type)&&(typeof r.callback>"u"||typeof r.callback=="function"))),content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>Le(e)&&(typeof(e==null?void 0:e.role)>"u"||["dialog","alertdialog"].includes(e==null?void 0:e.role))&&(typeof(e==null?void 0:e.ariaLabel)>"u"||typeof(e==null?void 0:e.ariaLabel)=="string")&&(typeof(e==null?void 0:e.ariaLabelledby)>"u"||typeof(e==null?void 0:e.ariaLabelledby)=="string")&&(typeof(e==null?void 0:e.ariaDescribedby)>"u"||typeof(e==null?void 0:e.ariaDescribedby)=="string")}}isEnabled(){return!!this.hot.getSettings()[Lu]}enablePlugin(){this.enabled||(Bn(Zn,this)||mu(Zn,this,new IK({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),ph(vg,this,iVe).call(this),ph(vg,this,oVe).call(this),this.addHook("afterViewRender",()=>ph(vg,this,lVe).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),ph(vg,this,sVe).call(this),ph(vg,this,aVe).call(this),super.disablePlugin()}isVisible(){return Bn(Pg,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.enabled){if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),Bn(Zn,this).showDialog(this.getSetting("animation")),mu(Pg,this,!0),this.hot.getFocusScopeManager().activateScope(Lu),mu(yg,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow")}}hide(){var e;this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),Bn(Zn,this).hideDialog(this.getSetting("animation")),mu(Pg,this,!1),this.hot.getFocusScopeManager().deactivateScope(Lu),((e=Bn(yg,this))===null||e===void 0?void 0:e.ranges.length)>0?(this.hot.selection.importSelection(Bn(yg,this)),this.hot.view.render(),mu(yg,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){if(!this.enabled)return;this.updatePluginSettings(e);const r=this.getSetting("template");if(r!==N1.DEFAULT_SETTINGS.template&&this.getSetting("content")!==N1.DEFAULT_SETTINGS.content)throw new Error("The `template` option cannot be used together with the `content` option.");r?Bn(Zn,this).useTemplate(r.type,{id:this.hot.guid,...r}):Bn(Zn,this).useDefaultTemplate(),Bn(Zn,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")})}showAlert(e,r){const{title:n="Alert",description:i}=Le(e)?e:{title:e};this.show({template:{type:"confirm",title:n,description:i,buttons:[{text:this.hot.getTranslatedPhrase(AC),type:"primary",callback:function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r==null?void 0:r(...o)}}]},contentBackground:!1,background:"solid",animation:!0,closable:!1})}showConfirm(e,r,n){const{title:i="Confirm",description:s}=Le(e)?e:{title:e};this.show({template:{type:"confirm",title:i,description:s,buttons:[{text:this.hot.getTranslatedPhrase(e2),type:"secondary",callback:function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return n==null?void 0:n(...a)}},{text:this.hot.getTranslatedPhrase(AC),type:"primary",callback:function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return r==null?void 0:r(...a)}}]},contentBackground:!0,background:"semi-transparent",animation:!0,closable:!1})}focus(){Bn(Zn,this).focusDialog()}destroy(){var e;(e=Bn(Zn,this))===null||e===void 0||e.destroyDialog(),mu(Zn,this,null),mu(Pg,this,!1),mu(yg,this,null),super.destroy()}}function iVe(){var t;const e=this.hot.getShortcutManager(),r=(t=e.getContext(E1))!==null&&t!==void 0?t:e.addContext(E1);r.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>Bn(Pg,this)&&this.getSetting("closable"),group:oA}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:n=>{this.hot._registerTimeout(()=>{n.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")})},group:oA})}function sVe(){this.hot.getShortcutManager().getContext(E1).removeShortcutsByGroup(oA)}function oVe(){this.hot.getFocusScopeManager().registerScope(Lu,Bn(Zn,this).getContainer(),{shortcutsContextName:E1,type:"modal",runOnlyIf:()=>this.isVisible(),onActivate:t=>{const e=this.hot.isListening(),r=Bn(Zn,this).getFocusableElements();r.length>0?t==="tab_from_above"?r.at(0).focus():t==="tab_from_below"&&r.at(-1).focus():t!=="tab_from_above"&&t!=="tab_from_below"&&e&&!Bn(Zn,this).getContainer().contains(this.hot.rootDocument.activeElement)&&Bn(Zn,this).getContainer().focus(),e&&this.hot.runHooks("afterDialogFocus",t==="unknown"?"show":t)}})}function aVe(){this.hot.getFocusScopeManager().unregisterScope(Lu)}function lVe(){const{view:t,rootWrapperElement:e,rootWindow:r}=this.hot,n=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Bn(Zn,this).updateWidth(n);const i=e.querySelector(".hot-display-license-info");if(i){const s=i.offsetHeight,o=Number.parseFloat(r.getComputedStyle(i).marginTop);Bn(Zn,this).updateHeight(s+o)}}function cVe(t){let{id:e,icon:r,title:n,description:i}=t;return`
    <div class="${yh}__content">
      <i class="${yh}__icon">${r}</i>
      <div class="${yh}__text">
        <h2 id="${e}-${Ah}-title" class="${yh}__title">${n}</h2>
        ${i?`<p id="${e}-${Ah}-description" class="${yh}__description">${i}</p>`:""}
      </div>
    </div>
  `}function uVe(t,e){HK(t,e),e.add(t)}function dVe(t,e,r){HK(t,e),e.set(t,r)}function HK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eB(t,e,r){return t.set(WH(t,e),r),r}function js(t,e){return t.get(WH(t,e))}function WH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Ah="loading",hVe=350,yh=`ht-${Ah}`;var gi=new WeakMap,tB=new WeakSet;class fVe extends wt{constructor(){super(...arguments),uVe(this,tB),dVe(this,gi,null)}static get PLUGIN_KEY(){return Ah}static get PLUGIN_PRIORITY(){return hVe}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${yh}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[Ah]}enablePlugin(){if(!this.enabled){if(js(gi,this)===null){var e;eB(gi,this,this.hot.getPlugin("dialog")),(e=js(gi,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>WH(tB,this,gVe).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,r;return(e=(r=js(gi,this))===null||r===void 0?void 0:r.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!js(gi,this)||!((e=js(gi,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(r);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(r),js(gi,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!js(gi,this)||!((e=js(gi,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(js(gi,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var r,n;if(!this.isEnabled()||!js(gi,this)||!((r=js(gi,this))!==null&&r!==void 0&&r.isEnabled()))return;this.updatePluginSettings(e);const i=this.hot.guid,s=this.getSetting("icon"),o=(n=this.getSetting("title"))!==null&&n!==void 0?n:this.hot.getTranslatedPhrase(Pj),a=this.getSetting("description"),c=cVe({id:i,icon:s,title:o,description:a});js(gi,this).update({content:c,customClassName:yh,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${i}-${Ah}-title`,ariaDescribedby:a?`${i}-${Ah}-description`:void 0}})}destroy(){eB(gi,this,null),super.destroy()}}function gVe(){js(gi,this).focus()}function Dx(t,e,r){mVe(t,e),e.set(t,r)}function mVe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wr(t,e){return t.get($K(t,e))}function Zl(t,e,r){return t.set($K(t,e),r),r}function $K(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $i="ht-empty-data-state",pVe=150,yVe=`<div data-ref="emptyDataStateElement" class="${$i} handsontable">
  <div class="${$i}__content-wrapper">
    <div data-ref="emptyDataStateInner" class="${$i}__content-wrapper-inner"></div>
  </div>
</div>`,vVe=t=>{let{title:e,description:r,buttons:n}=t;return`
  <div class="${$i}__content">
    ${e?`<h2 class="${$i}__title">${Cc(e)}</h2>`:""}
    ${r?`<p class="${$i}__description">${Cc(r)}</p>`:""}
  </div>
  <div
    data-ref="emptyDataStateButtons"
    class="${$i}__buttons${(n==null?void 0:n.length)>0?` ${$i}__buttons--has-buttons`:""}"
  >${(n==null?void 0:n.length)>0?n.map(i=>`<button class="ht-button ht-button--${i.type}">${Cc(i.text)}</button>`).join(""):""}</div>`};var CT=new WeakMap,_T=new WeakMap,$n=new WeakMap,As=new WeakMap;class wVe{constructor(e){let{rootElement:r,rootDocument:n}=e;Dx(this,CT,void 0),Dx(this,_T,void 0),Dx(this,$n,void 0),Dx(this,As,void 0),Zl(CT,this,r),Zl(_T,this,n),this.install()}install(){var e;if((e=wr($n,this))!==null&&e!==void 0&&e.emptyDataStateElement)return;const r=Mm`${yVe}`;Zl($n,this,r.refs);const{emptyDataStateInner:n,emptyDataStateElement:i}=wr($n,this);Ne(n,[Ra(-1)]),Ne(i,[Ra(-1)]),wr(CT,this).after(r.fragment)}getElement(){var e;return(e=wr($n,this))===null||e===void 0?void 0:e.emptyDataStateElement}getFocusableElements(){const{emptyDataStateButtons:e,emptyDataStateInner:r}=wr($n,this),n=Array.from(e==null?void 0:e.children);return n.length===0?[r]:n}show(){var e;(e=wr($n,this))!==null&&e!==void 0&&e.emptyDataStateElement&&(wr($n,this).emptyDataStateElement.style.display="block")}hide(){var e,r;(e=wr($n,this))!==null&&e!==void 0&&e.emptyDataStateElement&&((r=wr(As,this))===null||r===void 0||r.remove(),Zl(As,this,null),wr($n,this).emptyDataStateElement.style.display="none")}updateContent(e){var r;const{emptyDataStateInner:n}=wr($n,this);let i="";typeof e=="string"?i={title:e}:i={title:e==null?void 0:e.title,description:e==null?void 0:e.description,buttons:e==null?void 0:e.buttons};const s=Mm`${vVe(i)}`;Zl($n,this,{...wr($n,this),...s.refs}),n.innerHTML="",n.appendChild(s.fragment),((r=i.buttons)===null||r===void 0?void 0:r.length)>0&&Array.from(wr($n,this).emptyDataStateButtons.children).forEach((o,a)=>{o.addEventListener("click",i.buttons[a].callback)})}updateClassNames(e){const{emptyDataStateElement:r}=wr($n,this);e.countRenderableColumns()>0&&e.getColumnHeadersCount()>0?ee(r,`${$i}--disable-top-border`):Re(r,`${$i}--disable-top-border`),e.countRenderableRows()>0&&e.getRowHeadersCount()>0?ee(r,`${$i}--disable-inline-border`):Re(r,`${$i}--disable-inline-border`),e.hasHorizontalScroll()&&!e.isHorizontallyScrollableByWindow()?ee(r,`${$i}--disable-bottom-border`):Re(r,`${$i}--disable-bottom-border`)}updateSize(e){const{emptyDataStateElement:r}=wr($n,this),n=e.hasHorizontalScroll()?on(e.hot.rootDocument):0,i=e.countRenderableRows(),s=e.countRenderableColumns(),o=e.getColumnHeadersCount();if(r.style.top=s>0?`${e.getColumnHeaderHeight()}px`:"0px",r.style.insetInlineStart=i>0?`${e.getRowHeaderWidth()}px`:"0px",i===0)wr(As,this)||(Zl(As,this,wr(_T,this).createElement("div")),wr(As,this).classList.add(`${$i}-placeholder`),e._wt.wtTable.holder.appendChild(wr(As,this))),wr(As,this).style.width="100%",wr(As,this).style.height=`${pVe}px`;else{var a;(a=wr(As,this))===null||a===void 0||a.remove(),Zl(As,this,null)}let c=e.getWorkspaceWidth(),u=e.getTableHeight();e.isHorizontallyScrollableByWindow()?s>0?c=e.getTotalTableWidth():i>0&&(c=e.getViewportWidth()):i>0?c=e.getViewportWidth():e.getTableWidth()-e.getRowHeaderWidth()<e.getViewportWidth()&&s>0&&(c=e.getTableWidth()),e.isVerticallyScrollableByWindow()||e.hasVerticalScroll()?s>0?u=e.hot.getTableHeight()-e.getColumnHeaderHeight():u=e.hot.getTableHeight():o>0&&s>0?u=e.getViewportHeight()-n:o>0&&s===0&&(u=e.getWorkspaceHeight()-n),r.style.width=`${c}px`,r.style.height=`${u}px`}destroy(){var e,r;(e=wr($n,this))===null||e===void 0||(e=e.emptyDataStateElement)===null||e===void 0||e.remove(),(r=wr(As,this))===null||r===void 0||r.remove(),Zl(As,this,null),Zl($n,this,null)}}function bVe(t,e){DK(t,e),e.add(t)}function P0(t,e,r){DK(t,e),e.set(t,r)}function DK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e,r){return t.set(rn(t,e),r),r}function Ir(t,e){return t.get(rn(t,e))}function rn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const of="emptyDataState",xVe=370,aA=Object.freeze({UNKNOWN:"unknown",FILTERS:"filters"}),SVe=`plugin:${of}`;var Fh=new WeakMap,Nn=new WeakMap,Vm=new WeakMap,k1=new WeakMap,ym=new WeakMap,gn=new WeakSet;class CVe extends wt{constructor(){super(...arguments),bVe(this,gn),P0(this,Fh,!1),P0(this,Nn,null),P0(this,Vm,null),P0(this,k1,!1),P0(this,ym,null)}static get PLUGIN_KEY(){return of}static get PLUGIN_PRIORITY(){return xVe}static get DEFAULT_SETTINGS(){return{message:void 0}}static get SETTINGS_VALIDATORS(){return{message:e=>typeof e=="string"||typeof e=="function"||Le(e)&&(typeof(e==null?void 0:e.title)>"u"||typeof(e==null?void 0:e.title)=="string")&&(typeof(e==null?void 0:e.description)>"u"||typeof(e==null?void 0:e.description)=="string")&&(typeof(e==null?void 0:e.buttons)>"u"||Array.isArray(e==null?void 0:e.buttons)&&(e==null?void 0:e.buttons.every(r=>typeof r=="object"&&typeof r.text=="string"&&typeof r.type=="string"&&["primary","secondary"].includes(r.type)&&typeof r.callback=="function")))||e===void 0}}isEnabled(){return!!this.hot.getSettings()[of]}enablePlugin(){this.enabled||(Ir(Nn,this)||(us(Nn,this,new wVe({rootElement:this.hot.rootGridElement,rootDocument:this.hot.rootDocument})),rn(gn,this,NVe).call(this),rn(gn,this,_Ve).call(this),rn(gn,this,RVe).call(this)),this.addHook("afterInit",()=>rn(gn,this,AVe).call(this)),this.addHook("afterRender",()=>rn(gn,this,OVe).call(this)),this.addHook("afterRowSequenceCacheUpdate",()=>rn(gn,this,lA).call(this)),this.addHook("afterColumnSequenceCacheUpdate",()=>rn(gn,this,lA).call(this)),this.addHook("beforeFilter",e=>rn(gn,this,IVe).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),rn(gn,this,zH).call(this),this.isVisible()&&Ir(Nn,this).show(),super.updatePlugin()}disablePlugin(){rn(gn,this,kVe).call(this),rn(gn,this,EVe).call(this),Ir(Nn,this).destroy(),us(Nn,this,null),super.disablePlugin()}isVisible(){return Ir(Fh,this)}destroy(){var e;us(Fh,this,!1),(e=Ir(Nn,this))===null||e===void 0||e.destroy(),us(Nn,this,null),us(Vm,this,null),us(k1,this,!1),us(ym,this,null),super.destroy()}}function _Ve(){this.eventManager.addEventListener(Ir(Nn,this).getElement(),"wheel",t=>rn(gn,this,MVe).call(this,t))}function RVe(){us(Vm,this,new MutationObserver(()=>{if(!this.hot)return;const t=Ir(Nn,this).getElement();this.hot.rootGridElement.nextElementSibling!==t&&this.hot.rootGridElement.after(t)})),Ir(Vm,this).observe(this.hot.rootWrapperElement,{childList:!0})}function EVe(){Ir(Vm,this).disconnect(),us(Vm,this,null)}function NVe(){this.hot.getFocusScopeManager().registerScope(of,Ir(Nn,this).getElement(),{shortcutsContextName:SVe,runOnlyIf:()=>this.isVisible(),onActivate:t=>{var e;const r=(e=Ir(Nn,this))===null||e===void 0?void 0:e.getFocusableElements();r.length>0&&(t==="tab_from_above"?r.at(0).focus():t==="tab_from_below"&&r.at(-1).focus())}})}function kVe(){this.hot.getFocusScopeManager().unregisterScope(of)}function rB(t){var e,r,n;let i;return typeof this.getSetting("message")=="function"?i=this.getSetting("message")(t):i=this.getSetting("message"),typeof i=="string"&&(i={title:i}),!((e=i)!==null&&e!==void 0&&e.title)&&!((r=i)!==null&&r!==void 0&&r.description)&&!((n=i)!==null&&n!==void 0&&n.buttons)&&(i={},t===aA.FILTERS?(i.title=this.hot.getTranslatedPhrase(Oj),i.description=this.hot.getTranslatedPhrase(Ij),i.buttons=[{text:this.hot.getTranslatedPhrase(jj),type:"secondary",callback:()=>{const s=this.hot.getPlugin("filters");s&&(s.clearConditions(),s.filter())}}]):(i.title=this.hot.getTranslatedPhrase(Mj),i.description=this.hot.getTranslatedPhrase(Aj))),i}function lA(){this.hot.view&&(this.hot.view.countRenderableColumns()===0||this.hot.view.countRenderableRows()===0?rn(gn,this,TVe).call(this):rn(gn,this,PVe).call(this))}function TVe(){Ir(Fh,this)||(this.hot.runHooks("beforeEmptyDataStateShow"),rn(gn,this,zH).call(this),Ir(Nn,this).show(),us(Fh,this,!0),us(ym,this,this.hot.selection.exportSelection()),this.hot.getFocusScopeManager().activateScope(of),this.hot.runHooks("afterEmptyDataStateShow"))}function zH(){Ir(k1,this)?Ir(Nn,this).updateContent(rn(gn,this,rB).call(this,aA.FILTERS)):Ir(Nn,this).updateContent(rn(gn,this,rB).call(this,aA.UNKNOWN))}function PVe(){var t;Ir(Fh,this)&&(this.hot.runHooks("beforeEmptyDataStateHide"),Ir(Nn,this).hide(),us(Fh,this,!1),this.hot.getFocusScopeManager().deactivateScope(of),((t=Ir(ym,this))===null||t===void 0?void 0:t.ranges.length)>0?(this.hot.selection.importSelection(Ir(ym,this)),this.hot.view.render(),us(ym,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterEmptyDataStateHide"))}function MVe(t){const e=Number.isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;e!==0&&this.hot.view.hasHorizontalScroll()&&!this.hot.view.isHorizontallyScrollableByWindow()&&(this.hot.view.setTableScrollPosition({left:this.hot.view.getTableScrollPosition().left+e}),t.preventDefault())}function AVe(){rn(gn,this,lA).call(this),this.hot.render()}function OVe(){var t;(t=Ir(Nn,this))!==null&&t!==void 0&&t.getElement()&&this.isVisible()&&(Ir(Nn,this).updateSize(this.hot.view),Ir(Nn,this).updateClassNames(this.hot.view))}function IVe(t){us(k1,this,(t==null?void 0:t.length)>0),this.isVisible()&&rn(gn,this,zH).call(this)}function jVe(){ht(gy),ht(SPe),ht(my),ht(tMe),ht(cMe),ht(KY),ht(sAe),ht(UAe),ht(K_),ht(ZOe),ht(RIe),ht(IIe),ht(Q_),ht(p2e),ht(uHe),ht(WHe),ht(p$e),ht(k$e),ht(F$e),ht(Q$e),ht(aDe),ht(RDe),ht(IDe),ht(NLe),ht(s3e),ht(u3e),ht(H3e),ht(S4e),ht(J4e),ht(w6e),ht(k6e),ht(B6e),ht(Q6e),ht(lFe),ht(YFe),ht(N1),ht(fVe),ht(CVe)}function Yt(){WNe(),hTe(),xTe(),UTe(),jVe()}Yt();const HVe=({submissions:t,academicYears:e,currentYear:r,filters:n})=>{const i=$.useRef(null),[s,o]=$.useState(!1),[a,c]=$.useState((n==null?void 0:n.year)||r),[u,d]=$.useState((n==null?void 0:n.status)||"submitted");$.useEffect(()=>{const g=()=>{o(document.documentElement.classList.contains("dark"))};g();const p=new MutationObserver(g);return p.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>p.disconnect()},[]);const f=g=>{const p=g.target.value;c(p),lt.get("/admin/submissions",{year:p,status:u},{preserveState:!0})},h=g=>{const p=g.target.value;d(p),lt.get("/admin/submissions",{year:a,status:p},{preserveState:!0})},m=[{data:"academic_year",title:"Academic Year",readOnly:!0,width:120,className:"htCenter htMiddle"},{data:"hei.name",title:"HEI Name",readOnly:!0,width:200,className:"htLeft htMiddle"},{data:"hei.type",title:"Type",readOnly:!0,width:100,className:"htCenter htMiddle"},{data:"population_male",title:"Male",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(g,p,y,w,v,x)=>(p.innerHTML=(x||0).toLocaleString(),p.className="htRight htMiddle",p.style.color=s?"#60a5fa":"#2563eb",p)},{data:"population_female",title:"Female",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(g,p,y,w,v,x)=>(p.innerHTML=(x||0).toLocaleString(),p.className="htRight htMiddle",p.style.color=s?"#f472b6":"#db2777",p)},{data:"population_intersex",title:"Intersex",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(g,p,y,w,v,x)=>(p.innerHTML=(x||0).toLocaleString(),p.className="htRight htMiddle",p.style.color=s?"#c084fc":"#9333ea",p)},{data:"population_total",title:"Total",readOnly:!0,width:100,className:"htRight htMiddle",renderer:(g,p,y,w,v,x)=>(p.innerHTML=`<strong>${(x||0).toLocaleString()}</strong>`,p.className="htRight htMiddle",p.style.fontWeight="bold",p)},{data:"submitted_org_chart",title:"Org Chart",readOnly:!0,width:90,className:"htCenter htMiddle",renderer:(g,p,y,w,v,x)=>{const S=x==="yes"?`<span class="px-2 py-1 rounded text-xs ${s?"bg-green-900 text-green-300":"bg-green-100 text-green-800"}">Yes</span>`:`<span class="px-2 py-1 rounded text-xs ${s?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800"}">No</span>`;return p.innerHTML=S,p.className="htCenter htMiddle",p}},{data:"hei_website",title:"HEI Website",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(g,p,y,w,v,x)=>(x?p.innerHTML=`<a href="${x}" target="_blank" class="${s?"text-blue-400":"text-blue-600"} hover:underline">${x.substring(0,30)}...</a>`:p.innerHTML=`<span class="${s?"text-gray-500":"text-gray-400"}">-</span>`,p.className="htLeft htMiddle",p)},{data:"sas_website",title:"SAS Website",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(g,p,y,w,v,x)=>(x?p.innerHTML=`<a href="${x}" target="_blank" class="${s?"text-blue-400":"text-blue-600"} hover:underline">${x.substring(0,30)}...</a>`:p.innerHTML=`<span class="${s?"text-gray-500":"text-gray-400"}">-</span>`,p.className="htLeft htMiddle",p)},{data:"student_handbook",title:"Handbook",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(g,p,y,w,v,x)=>(p.innerHTML=x||`<span class="${s?"text-gray-500":"text-gray-400"}">-</span>`,p.className="htLeft htMiddle",p)},{data:"student_publication",title:"Publication",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(g,p,y,w,v,x)=>(p.innerHTML=x||`<span class="${s?"text-gray-500":"text-gray-400"}">-</span>`,p.className="htLeft htMiddle",p)},{data:"request_notes",title:"Request Notes",readOnly:!0,width:200,className:"htLeft htMiddle",renderer:(g,p,y,w,v,x)=>{if(x){const S=x.length>100?x.substring(0,100)+"...":x;p.innerHTML=`<span class="${s?"text-gray-300":"text-gray-700"}" title="${x.replace(/"/g,"&quot;")}">${S}</span>`}else p.innerHTML=`<span class="${s?"text-gray-600":"text-gray-400"}">-</span>`;return p.className="htLeft htMiddle",p}},{data:"status",title:"Status",readOnly:!0,width:100,className:"htCenter htMiddle",renderer:(g,p,y,w,v,x)=>{const N={submitted:s?"bg-green-900 text-green-300":"bg-green-100 text-green-800",overwritten:s?"bg-yellow-900 text-yellow-300":"bg-yellow-100 text-yellow-800",rejected:s?"bg-red-900 text-red-300":"bg-red-100 text-red-800",cancelled:s?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-700"}[x]||(s?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800");return p.innerHTML=`<span class="px-2 py-1 rounded-full text-xs font-semibold ${N}">${x}</span>`,p.className="htCenter htMiddle",p}},{data:"created_at",title:"Submitted At",readOnly:!0,width:160,className:"htCenter htMiddle",renderer:(g,p,y,w,v,x)=>(p.innerHTML=an(x),p.className="htCenter htMiddle",p)}];return l.jsxs(Tl,{title:"Submissions",children:[l.jsx("style",{children:`
        .handsontable td,
        .handsontable th {
          white-space: nowrap !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          max-height: 50px !important;
          vertical-align: middle !important;
        }

        .handsontable .htMiddle {
          vertical-align: middle !important;
        }

        ${s?`
          .handsontable {
            color: #e5e7eb !important;
          }
          .handsontable th {
            background-color: #374151 !important;
            color: #f3f4f6 !important;
            border-color: #4b5563 !important;
          }
          .handsontable td {
            background-color: #1f2937 !important;
            border-color: #374151 !important;
            color: #e5e7eb !important;
          }
          .handsontable td.area {
            background-color: #111827 !important;
          }
          .ht_clone_top th,
          .ht_clone_left th {
            background-color: #374151 !important;
          }
          .handsontable .htDimmed {
            color: #9ca3af !important;
          }
        `:""}
      `}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex justify-between items-center",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"HEI Submissions"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View all submitted, overwritten, rejected, and cancelled submissions"})]})}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Academic Year:"}),l.jsx("select",{value:a,onChange:f,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",children:e&&e.map(g=>l.jsx("option",{value:g,children:g},g))})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Status:"}),l.jsxs("select",{value:u,onChange:h,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"submitted",children:"Submitted"}),l.jsx("option",{value:"overwritten",children:"Overwritten"}),l.jsx("option",{value:"rejected",children:"Rejected"}),l.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]})}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:t&&t.length>0?l.jsx(xt,{ref:i,data:t,columns:m,colHeaders:!0,rowHeaders:!0,width:"100%",height:600,rowHeights:50,licenseKey:"non-commercial-and-evaluation",className:"htCenter htMiddle",stretchH:"all"}):l.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No submissions found for the selected year."})})]})]})},$Ve=Object.freeze(Object.defineProperty({__proto__:null,default:HVe},Symbol.toStringTag,{value:"Module"}));Yt();const DVe=({submissions:t})=>{const e=$.useRef(null),[r,n]=$.useState(!1);$.useEffect(()=>{const a=()=>{n(document.documentElement.classList.contains("dark"))};a();const c=new MutationObserver(a);return c.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>c.disconnect()},[]);const i=a=>{confirm("Are you sure you want to accept this request? This will replace the current submitted data.")&&lt.post(`/admin/submissions/${a}/approve`)},s=a=>{confirm("Are you sure you want to reject this request?")&&lt.post(`/admin/submissions/${a}/reject`)},o=[{data:"academic_year",title:"Academic Year",readOnly:!0,width:120,className:"htCenter htMiddle"},{data:"hei.name",title:"HEI Name",readOnly:!0,width:200,className:"htLeft htMiddle"},{data:"population_male",title:"Male",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=(h||0).toLocaleString(),c.className="htRight htMiddle",c.style.color=r?"#60a5fa":"#2563eb",c)},{data:"population_female",title:"Female",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=(h||0).toLocaleString(),c.className="htRight htMiddle",c.style.color=r?"#f472b6":"#db2777",c)},{data:"population_intersex",title:"Intersex",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=(h||0).toLocaleString(),c.className="htRight htMiddle",c.style.color=r?"#c084fc":"#9333ea",c)},{data:"population_total",title:"Total",readOnly:!0,width:100,className:"htRight htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=`<strong>${(h||0).toLocaleString()}</strong>`,c.className="htRight htMiddle",c.style.fontWeight="bold",c)},{data:"submitted_org_chart",title:"Org Chart",readOnly:!0,width:90,className:"htCenter htMiddle",renderer:(a,c,u,d,f,h)=>{const m=h==="yes"?`<span class="px-2 py-1 rounded text-xs ${r?"bg-green-900 text-green-300":"bg-green-100 text-green-800"}">Yes</span>`:`<span class="px-2 py-1 rounded text-xs ${r?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800"}">No</span>`;return c.innerHTML=m,c.className="htCenter htMiddle",c}},{data:"hei_website",title:"HEI Website",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(a,c,u,d,f,h)=>(h?c.innerHTML=`<a href="${h}" target="_blank" class="${r?"text-blue-400":"text-blue-600"} hover:underline">${h.substring(0,30)}...</a>`:c.innerHTML=`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,c.className="htLeft htMiddle",c)},{data:"sas_website",title:"SAS Website",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(a,c,u,d,f,h)=>(h?c.innerHTML=`<a href="${h}" target="_blank" class="${r?"text-blue-400":"text-blue-600"} hover:underline">${h.substring(0,30)}...</a>`:c.innerHTML=`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,c.className="htLeft htMiddle",c)},{data:"student_handbook",title:"Handbook",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=h||`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,c.className="htLeft htMiddle",c)},{data:"student_publication",title:"Publication",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=h||`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,c.className="htLeft htMiddle",c)},{data:"request_notes",title:"Request Notes",readOnly:!0,width:200,className:"htLeft htMiddle",renderer:(a,c,u,d,f,h)=>{if(h){const m=h.length>100?h.substring(0,100)+"...":h;c.innerHTML=`<span class="${r?"text-gray-300":"text-gray-700"}" title="${h.replace(/"/g,"&quot;")}">${m}</span>`}else c.innerHTML=`<span class="${r?"text-gray-600":"text-gray-400"}">-</span>`;return c.className="htLeft htMiddle",c}},{data:"created_at",title:"Submitted At",readOnly:!0,width:160,className:"htCenter htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=an(h),c.className="htCenter htMiddle",c)},{data:"id",title:"Actions",readOnly:!0,width:120,className:"htCenter htMiddle",renderer:(a,c,u,d,f,h)=>(c.innerHTML=`
          <div class="flex gap-2 justify-center items-center">
            <button
              class="accept-btn px-3 py-1 rounded text-xs font-semibold ${r?"bg-green-900 text-green-300 hover:bg-green-800":"bg-green-100 text-green-800 hover:bg-green-200"}"
              data-id="${h}"
              title="Accept Request"
            >
              Accept
            </button>
            <button
              class="reject-btn px-3 py-1 rounded text-xs font-semibold ${r?"bg-red-900 text-red-300 hover:bg-red-800":"bg-red-100 text-red-800 hover:bg-red-200"}"
              data-id="${h}"
              title="Reject Request"
            >
              Reject
            </button>
          </div>
        `,c.className="htCenter htMiddle",c)}];return $.useEffect(()=>{var u,d;const a=f=>{const h=f.target.closest(".accept-btn"),m=f.target.closest(".reject-btn");if(h){const g=h.dataset.id;i(g)}else if(m){const g=m.dataset.id;s(g)}},c=(d=(u=e.current)==null?void 0:u.hotInstance)==null?void 0:d.rootElement;if(c)return c.addEventListener("click",a),()=>c.removeEventListener("click",a)},[t]),l.jsxs(Tl,{title:"Request Submissions",children:[l.jsx("style",{children:`
        .handsontable td,
        .handsontable th {
          white-space: nowrap !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          max-height: 50px !important;
          vertical-align: middle !important;
        }

        .handsontable .htMiddle {
          vertical-align: middle !important;
        }

        ${r?`
          .handsontable {
            color: #e5e7eb !important;
          }
          .handsontable th {
            background-color: #374151 !important;
            color: #f3f4f6 !important;
            border-color: #4b5563 !important;
          }
          .handsontable td {
            background-color: #1f2937 !important;
            border-color: #374151 !important;
            color: #e5e7eb !important;
          }
          .handsontable td.area {
            background-color: #111827 !important;
          }
          .ht_clone_top th,
          .ht_clone_left th {
            background-color: #374151 !important;
          }
          .handsontable .htDimmed {
            color: #9ca3af !important;
          }
        `:""}
      `}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex justify-between items-center",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Request Submissions"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Pending overwrite requests from HEIs (sorted by oldest first)"})]})}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:t&&t.length>0?l.jsx(xt,{ref:e,data:t,columns:o,colHeaders:!0,rowHeaders:!0,width:"100%",height:600,rowHeights:50,licenseKey:"non-commercial-and-evaluation",className:"htCenter htMiddle",stretchH:"all"}):l.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No pending requests found. All submissions are up to date."})})]})]})},LVe=Object.freeze(Object.defineProperty({__proto__:null,default:DVe},Symbol.toStringTag,{value:"Module"})),FVe=()=>{const{data:t,setData:e,put:r,processing:n,errors:i,reset:s}=Oo({current_password:"",password:"",password_confirmation:""}),o=a=>{a.preventDefault(),r("/change-password",{onSuccess:()=>s()})};return l.jsx(Tv,{title:"Change Password",children:l.jsx("div",{className:"max-w-2xl mx-auto",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Change Password"}),l.jsxs("form",{onSubmit:o,className:"space-y-6",children:[l.jsx(qt,{label:"Current Password",name:"current_password",type:"password",value:t.current_password,onChange:a=>e("current_password",a.target.value),error:i.current_password,required:!0}),l.jsx(qt,{label:"New Password",name:"password",type:"password",value:t.password,onChange:a=>e("password",a.target.value),error:i.password,required:!0}),l.jsx(qt,{label:"Confirm New Password",name:"password_confirmation",type:"password",value:t.password_confirmation,onChange:a=>e("password_confirmation",a.target.value),error:i.password_confirmation,required:!0}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Updating...":"Update Password"})]})]})]})})})},VVe=Object.freeze(Object.defineProperty({__proto__:null,default:FVe},Symbol.toStringTag,{value:"Module"})),BVe=({status:t})=>{const{data:e,setData:r,post:n,processing:i,errors:s}=Oo({email:""}),o=a=>{a.preventDefault(),n("/forgot-password")};return l.jsxs(l.Fragment,{children:[l.jsx(_A,{title:"Forgot Password"}),l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"max-w-md w-full space-y-8",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/images/ched_logo.png",alt:"CHED Logo",className:"mx-auto h-20 w-20 object-contain"}),l.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),l.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Enter your email to receive password reset instructions"})]}),l.jsx("form",{className:"mt-8 space-y-6",onSubmit:o,children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 space-y-4",children:[t&&l.jsx(Et,{type:"success",message:t}),l.jsx(qt,{label:"Email Address",name:"email",type:"email",value:e.email,onChange:a=>r("email",a.target.value),error:s.email,required:!0,placeholder:"your.email@example.com"}),l.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Sending...":"Send Reset Link"}),l.jsx("div",{className:"text-center",children:l.jsx(yt,{href:"/login",className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400",children:"Back to Login"})})]})})]})})]})},WVe=Object.freeze(Object.defineProperty({__proto__:null,default:BVe},Symbol.toStringTag,{value:"Module"})),zVe=({isOpen:t,onClose:e})=>t?l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-4 p-6 animate-slide-in",children:[l.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors","aria-label":"Close",children:l.jsx(AW,{size:24})}),l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:l.jsx(jW,{className:"text-blue-600 dark:text-blue-400",size:24})}),l.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Contact Administrator"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Need access to the system? Please contact your administrator using the information below:"}),l.jsxs("div",{className:"space-y-3 pt-2",children:[l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[l.jsx(ste,{className:"text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0",size:20}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Email"}),l.jsx("a",{href:"mailto:admin@ched.gov.ph",className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline",children:"admin@ched.gov.ph"})]})]}),l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[l.jsx(MW,{className:"text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0",size:20}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Phone"}),l.jsx("a",{href:"tel:+6328441143",className:"text-sm font-medium text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:"+63 (2) 8441-1143"})]})]})]}),l.jsx("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Please provide your institution details and contact information when requesting access."})})]}),l.jsx("div",{className:"mt-6",children:l.jsx("button",{onClick:e,className:"w-full py-2.5 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Close"})})]})]}):null,UVe=()=>{const[t,e]=$.useState(!1),{data:r,setData:n,post:i,processing:s,errors:o}=Oo({email:"",password:"",remember:!1}),a=c=>{c.preventDefault(),i("/login")};return l.jsxs(l.Fragment,{children:[l.jsx(_A,{title:"Login - CHED HEI System"}),l.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:"url(/images/login_bg.jpg)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[l.jsx("div",{className:"absolute inset-0 bg-blue-900/50 dark:bg-black/40 backdrop-blur-sm"}),l.jsxs("div",{className:"max-w-md w-full relative z-10",children:[l.jsxs("div",{className:"text-center animate-fade-in",children:[l.jsx("div",{className:"inline-block p-4 bg-white/95 dark:bg-gray-800/95 rounded-2xl shadow-2xl mb-6 backdrop-blur-md border border-white/20 dark:border-gray-700/50",children:l.jsx("img",{src:"/images/ched_logo.png",alt:"CHED Logo",className:"h-16 w-16 object-contain"})}),l.jsx("h1",{className:"text-3xl font-bold text-white dark:text-white mb-2 drop-shadow-lg",children:"Welcome Back"}),l.jsx("p",{className:"text-sm text-white/90 dark:text-gray-200 drop-shadow-md",children:"CHED SASIS Management System- IX"})]}),l.jsx("form",{className:"mt-10 animate-slide-in",onSubmit:a,children:l.jsxs("div",{className:"bg-white/95 dark:bg-gray-800/95 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 dark:border-gray-700/50 p-8 space-y-6",children:[l.jsx(qt,{label:"Email Address",name:"email",type:"email",value:r.email,onChange:c=>n("email",c.target.value),error:o.email,required:!0,placeholder:"your.email@example.com"}),l.jsx(qt,{label:"Password",name:"password",type:"password",value:r.password,onChange:c=>n("password",c.target.value),error:o.password,required:!0,placeholder:""}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{id:"remember",name:"remember",type:"checkbox",checked:r.remember,onChange:c=>n("remember",c.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 border-gray-300 dark:border-gray-600 rounded transition-colors"}),l.jsx("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300 select-none cursor-pointer",children:"Remember me"})]}),l.jsx("a",{href:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:"Forgot password?"})]}),l.jsx("button",{type:"submit",disabled:s,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none transition-all duration-200",children:s?l.jsxs("span",{className:"flex items-center justify-center",children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign In to Your Account"})]})}),l.jsxs("p",{className:"mt-8 text-center text-sm text-white/90 dark:text-gray-200 drop-shadow-md",children:["Need an account?"," ",l.jsx("button",{type:"button",onClick:()=>e(!0),className:"font-medium text-white hover:text-blue-200 dark:text-blue-300 dark:hover:text-blue-200 transition-colors underline",children:"Contact your administrator"})]}),l.jsxs("div",{className:"mt-8 text-center text-xs text-white/80 dark:text-gray-300 drop-shadow-md",children:[l.jsx("p",{children:"Commission on Higher Education"}),l.jsx("p",{className:"mt-1",children:"Republic of the Philippines"})]})]}),l.jsx(zVe,{isOpen:t,onClose:()=>e(!1)})]})]})},YVe=Object.freeze(Object.defineProperty({__proto__:null,default:UVe},Symbol.toStringTag,{value:"Module"})),Ct=({title:t,children:e})=>{const r=[{href:"/hei/dashboard",label:"Dashboard",icon:l.jsx(EA,{})},{label:"Submission",divider:!0,children:[{label:"Basic Information",icon:l.jsx(ba,{}),children:[{href:"/hei/submission/create",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/submission/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex A",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-a/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-a/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex B",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-b/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-b/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex C",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-c/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-c/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex D",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-d/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-d/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex E",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-e/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-e/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex F",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-f/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-f/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex G",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-g/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-g/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex H",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-h/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-h/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex I",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-i/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-i/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex J",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-j/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-j/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex K",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-k/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-k/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex L",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-l/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-l/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex M",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-m/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-m/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex N",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-n/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-n/history",label:"History",icon:l.jsx(Ln,{})}]},{label:"Annex O",icon:l.jsx(pt,{}),children:[{href:"/hei/annex-o/submit",label:"Submit",icon:l.jsx(ai,{})},{href:"/hei/annex-o/history",label:"History",icon:l.jsx(Ln,{})}]}]}];return l.jsx(TA,{permission:fn.VIEW_OWN_SUBMISSIONS,children:l.jsx(Tv,{title:t,children:l.jsxs("div",{className:"flex",children:[l.jsx(kA,{links:r}),l.jsx("div",{className:"flex-1 p-6",children:e})]})})})},or=()=>{const[t,e]=$.useState(!1);return $.useEffect(()=>{const r=()=>{e(document.documentElement.classList.contains("dark"))};r();const n=new MutationObserver(r);return n.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>n.disconnect()},[]),t},xs=({value:t,onChange:e,maxLength:r=1e3})=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Additional Notes (Optional)"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes for this submission"}),l.jsx("textarea",{value:t,onChange:n=>e(n.target.value),rows:4,maxLength:r,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:`Optional: Any notes for this batch submission (max ${r} characters)`}),l.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:[t.length,"/",r," characters"]})]})]}),ar=`
  .dark .handsontable td, .dark .handsontable th {
    background-color: #374151 !important;
    color: #f9fafb !important;
    border-color: #4b5563 !important;
  }
  .dark .handsontable thead th {
    background-color: #1f2937 !important;
    color: #f9fafb !important;
  }
  .dark .handsontable .htDimmed {
    color: #9ca3af !important;
  }
  .handsontable td, .handsontable th {
    border-color: #e5e7eb !important;
  }
  .handsontable td {
    height: 28px !important;
    line-height: 28px !important;
    padding: 2px 4px !important;
  }
  .handsontable th {
    height: 32px !important;
    line-height: 32px !important;
  }
`;Yt();const GVe=({existingSubmission:t,programs:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({title:y.title,venue:y.venue,implementation_date:y.implementation_date?y.implementation_date.split("T")[0]:"",target_group:y.target_group,participants_online:y.participants_online,participants_face_to_face:y.participants_face_to_face,organizer:y.organizer,remarks:y.remarks||""})):[],[d,f]=$.useState(u),h=[{data:"title",title:"Title of Programs/Projects/Activities",type:"text",width:250,placeholder:"e.g., Mental Health Awareness Week"},{data:"venue",title:"Venue",type:"text",width:150,placeholder:"e.g., University Auditorium"},{data:"implementation_date",title:"Date of Implementation",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,width:150,placeholder:"YYYY-MM-DD"},{data:"target_group",title:"Target Group",type:"text",width:150,placeholder:"e.g., Students, Faculty"},{data:"participants_online",title:"Participants (Online)",type:"numeric",numericFormat:{pattern:"0,0"},width:130,placeholder:"0"},{data:"participants_face_to_face",title:"Participants (Face-to-Face)",type:"numeric",numericFormat:{pattern:"0,0"},width:150,placeholder:"0"},{data:"organizer",title:"Organizer",type:"text",width:150,placeholder:"e.g., Student Affairs Office"},{data:"remarks",title:"Remarks (Optional)",type:"text",width:200,placeholder:"Optional notes"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v,x,S,N){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");if(N){const R=parseInt(N.dataset.row);g(R)}},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const N=w[S],[R,E,P,D,H,Z,I,Y]=N;if(!(!R&&!E&&!P&&!D&&!I)){if(!R||!E||!P||!D||!I){alert(`Row ${S+1}: Please fill in all required fields (Title, Venue, Date, Target Group, Organizer)`);return}v.push({title:R,venue:E,implementation_date:P,target_group:D,participants_online:parseInt(H)||0,participants_face_to_face:parseInt(Z)||0,organizer:I,remarks:Y||""})}}if(v.length===0){alert("Please add at least one program to submit.");return}c(!0),lt.post("/hei/annex-a",{programs:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex A",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"LIST OF PROGRAMS/ PROJECTS/ ACTIVITIES INFORMATION AND ORIENTATION SERVICES"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex A"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple programs/projects/activities in the table below. You can submit them all at once as a batch. Submitting will replace any previous submission for this year."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-a/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Programs/Projects/Activities"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple programs below. Each row represents one program/project/activity."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Program"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-a/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},KVe=Object.freeze(Object.defineProperty({__proto__:null,default:GVe},Symbol.toStringTag,{value:"Module"})),_i=({isOpen:t,onClose:e,onConfirm:r,submissionId:n})=>{const[i,s]=$.useState("");if(!t)return null;const o=()=>{r(n,i),s("")},a=()=>{s(""),e()};return l.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),l.jsx("div",{className:"flex min-h-screen items-center justify-center p-4",children:l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Cancel Request"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"This action cannot be undone"})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Cancellation Notes (Optional)"}),l.jsx("textarea",{value:i,onChange:c=>s(c.target.value),rows:4,maxLength:1e3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",placeholder:"Provide a reason for cancelling this request (optional)"}),l.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[i.length,"/1000 characters"]})]}),l.jsxs("div",{className:"flex gap-3 justify-end",children:[l.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Keep Request"}),l.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Cancel Request"})]})]})})]})},Ss=t=>{const[e,r]=$.useState(!1),[n,i]=$.useState(null);return{showCancelModal:e,selectedId:n,handleCancel:c=>{i(c),r(!0)},handleCancelConfirm:(c,u)=>{lt.post(`/hei/${t}/${c}/cancel`,{cancelled_notes:u}),r(!1),i(null)},handleCancelClose:()=>{r(!1),i(null)}}},Cs=({status:t})=>{const e={submitted:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",label:"Submitted"},request:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",label:"Request"},published:{color:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",label:"Published"},overwritten:{color:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400",label:"Overwritten"},rejected:{color:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",label:"Rejected"},cancelled:{color:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400",label:"Cancelled"}},r=e[t]||e.submitted;return l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${r.color}`,children:r.label})},_s=({title:t="No Submissions Yet",message:e="You haven't submitted any data yet.",buttonText:r="Create Your First Submission",buttonHref:n})=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center border border-gray-200 dark:border-gray-700",children:[l.jsx(pt,{className:"mx-auto text-6xl text-gray-400 dark:text-gray-600 mb-4"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:t}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:e}),n&&l.jsxs(yt,{href:n,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors",children:[l.jsx(pt,{}),r]})]});Yt();const qVe=({batches:t})=>{const e=or(),{showCancelModal:r,selectedId:n,handleCancel:i,handleCancelConfirm:s,handleCancelClose:o}=Ss("annex-a"),[a,c]=$.useState({}),[u,d]=$.useState({}),f=async m=>{if(a[m])c(g=>({...g,[m]:!1}));else if(c(g=>({...g,[m]:!0})),!u[m])try{const p=await(await fetch(`/hei/annex-a/${m}/programs`)).json();d(y=>({...y,[m]:p}))}catch(g){console.error("Failed to fetch programs:",g)}},h=[{data:"title",title:"Title",type:"text",readOnly:!0,width:250},{data:"venue",title:"Venue",type:"text",readOnly:!0,width:150},{data:"implementation_date",title:"Date",type:"date",dateFormat:"YYYY-MM-DD",readOnly:!0,width:120},{data:"target_group",title:"Target Group",type:"text",readOnly:!0,width:150},{data:"participants_online",title:"Online",type:"numeric",numericFormat:{pattern:"0,0"},readOnly:!0,width:100},{data:"participants_face_to_face",title:"Face-to-Face",type:"numeric",numericFormat:{pattern:"0,0"},readOnly:!0,width:110},{data:"organizer",title:"Organizer",type:"text",readOnly:!0,width:150},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex A History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex A Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-a/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex A data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-a/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(m=>{const g=m.status==="request",p=m.status==="published",y=a[m.batch_id],w=u[m.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsxs("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:[l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>f(m.batch_id),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:y?l.jsx(ri,{className:"text-lg"}):l.jsx(ni,{className:"text-lg"})}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Batch #",m.batch_id.substring(0,8)]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:m.academic_year}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[m.programs_count," program",m.programs_count!==1?"s":""]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:an(m.created_at)})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Cs,{status:m.status}),l.jsx("a",{href:`/hei/annex-a/${m.batch_id}/edit`,className:`inline-flex items-center justify-center w-7 h-7 transition-colors ${p?"text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-300":"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"}`,title:p?"Edit Request":"Edit Batch",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),g&&l.jsx("button",{onClick:()=>i(m.batch_id),className:"px-3 py-1 text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",title:"Cancel Request",children:"Cancel"})]})]}),m.request_notes&&l.jsx("div",{className:"px-3 py-2 border-t border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:l.jsxs("p",{className:"text-xs text-yellow-900 dark:text-yellow-200",children:[l.jsx("strong",{children:"Notes:"})," ",m.request_notes]})})]}),y&&l.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 p-3 bg-white dark:bg-gray-800",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsx(xt,{data:w.map(v=>({title:v.title,venue:v.venue,implementation_date:v.implementation_date?v.implementation_date.split("T")[0]:"",target_group:v.target_group,participants_online:v.participants_online,participants_face_to_face:v.participants_face_to_face,organizer:v.organizer,remarks:v.remarks||""})),colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",licenseKey:"non-commercial-and-evaluation",readOnly:!0,stretchH:"all",className:e?"dark-table":""})})})]},m.batch_id)})})]}),l.jsx(_i,{isOpen:r,onClose:o,onConfirm:s,submissionId:n})]})},XVe=Object.freeze(Object.defineProperty({__proto__:null,default:qVe},Symbol.toStringTag,{value:"Module"}));Yt();const QVe=({existingSubmission:t,programs:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({title:y.title,venue:y.venue,implementation_date:y.implementation_date?y.implementation_date.split("T")[0]:"",target_group:y.target_group,participants_online:y.participants_online,participants_face_to_face:y.participants_face_to_face,organizer:y.organizer,remarks:y.remarks||""})):[],[d,f]=$.useState(u),h=[{data:"title",title:"Title of Programs/Projects/Activities",type:"text",width:250,placeholder:"e.g., Career Fair 2025"},{data:"venue",title:"Venue",type:"text",width:150,placeholder:"e.g., University Auditorium"},{data:"implementation_date",title:"Date of Implementation",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,width:150,placeholder:"YYYY-MM-DD"},{data:"target_group",title:"Target Group",type:"text",width:150,placeholder:"e.g., Students, Faculty"},{data:"participants_online",title:"Participants (Online)",type:"numeric",numericFormat:{pattern:"0,0"},width:130,placeholder:"0"},{data:"participants_face_to_face",title:"Participants (Face-to-Face)",type:"numeric",numericFormat:{pattern:"0,0"},width:150,placeholder:"0"},{data:"organizer",title:"Organizer",type:"text",width:150,placeholder:"e.g., Career Services Office"},{data:"remarks",title:"Remarks (Optional)",type:"text",width:200,placeholder:"Optional notes"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v,x,S,N){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");if(N){const R=parseInt(N.dataset.row);g(R)}},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const N=w[S],[R,E,P,D,H,Z,I,Y]=N;if(!(!R&&!E&&!P&&!D&&!I)){if(!R||!E||!P||!D||!I){alert(`Row ${S+1}: Please fill in all required fields (Title, Venue, Date, Target Group, Organizer)`);return}v.push({title:R,venue:E,implementation_date:P,target_group:D,participants_online:parseInt(H)||0,participants_face_to_face:parseInt(Z)||0,organizer:I,remarks:Y||""})}}if(v.length===0){alert("Please add at least one program to submit.");return}c(!0),lt.post("/hei/annex-b",{programs:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex B",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"LIST OF PROGRAMS/ PROJECTS/ ACTIVITIES GUIDANCE AND COUNSELING SERVICE"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex B"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple programs/projects/activities in the table below. You can submit them all at once as a batch. Submitting will replace any previous submission for this year."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-b/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Programs/Projects/Activities"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple programs below. Each row represents one program/project/activity."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Program"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-b/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},JVe=Object.freeze(Object.defineProperty({__proto__:null,default:QVe},Symbol.toStringTag,{value:"Module"}));Yt();const ZVe=({batches:t})=>{const e=or(),{showCancelModal:r,selectedId:n,handleCancel:i,handleCancelConfirm:s,handleCancelClose:o}=Ss("annex-b"),[a,c]=$.useState({}),[u,d]=$.useState({}),f=async m=>{if(a[m])c(g=>({...g,[m]:!1}));else if(c(g=>({...g,[m]:!0})),!u[m])try{const p=await(await fetch(`/hei/annex-b/${m}/programs`)).json();d(y=>({...y,[m]:p}))}catch(g){console.error("Failed to fetch programs:",g)}},h=[{data:"title",title:"Title",type:"text",readOnly:!0,width:250},{data:"venue",title:"Venue",type:"text",readOnly:!0,width:150},{data:"implementation_date",title:"Date",type:"date",dateFormat:"YYYY-MM-DD",readOnly:!0,width:120},{data:"target_group",title:"Target Group",type:"text",readOnly:!0,width:150},{data:"participants_online",title:"Online",type:"numeric",numericFormat:{pattern:"0,0"},readOnly:!0,width:100},{data:"participants_face_to_face",title:"Face-to-Face",type:"numeric",numericFormat:{pattern:"0,0"},readOnly:!0,width:110},{data:"organizer",title:"Organizer",type:"text",readOnly:!0,width:150},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex B History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex B Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-b/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex B data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-b/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(m=>{const g=m.status==="request",p=m.status==="published",y=a[m.batch_id],w=u[m.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsxs("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:[l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>f(m.batch_id),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:y?l.jsx(ri,{className:"text-lg"}):l.jsx(ni,{className:"text-lg"})}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Batch #",m.batch_id.substring(0,8)]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:m.academic_year}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[m.programs_count," program",m.programs_count!==1?"s":""]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:an(m.created_at)})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Cs,{status:m.status}),l.jsx("a",{href:`/hei/annex-b/${m.batch_id}/edit`,className:`inline-flex items-center justify-center w-7 h-7 transition-colors ${p?"text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-300":"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"}`,title:p?"Edit Request":"Edit Batch",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),g&&l.jsx("button",{onClick:()=>i(m.batch_id),className:"px-3 py-1 text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",title:"Cancel Request",children:"Cancel"})]})]}),m.request_notes&&l.jsx("div",{className:"px-3 py-2 border-t border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:l.jsxs("p",{className:"text-xs text-yellow-900 dark:text-yellow-200",children:[l.jsx("strong",{children:"Notes:"})," ",m.request_notes]})})]}),y&&l.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 p-3 bg-white dark:bg-gray-800",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsx(xt,{data:w.map(v=>({title:v.title,venue:v.venue,implementation_date:v.implementation_date?v.implementation_date.split("T")[0]:"",target_group:v.target_group,participants_online:v.participants_online,participants_face_to_face:v.participants_face_to_face,organizer:v.organizer,remarks:v.remarks||""})),colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",licenseKey:"non-commercial-and-evaluation",readOnly:!0,stretchH:"all",className:e?"dark-table":""})})})]},m.batch_id)})})]}),l.jsx(_i,{isOpen:r,onClose:o,onConfirm:s,submissionId:n})]})},eBe=Object.freeze(Object.defineProperty({__proto__:null,default:ZVe},Symbol.toStringTag,{value:"Module"}));Yt();const tBe=({existingSubmission:t,programs:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({title:y.title,venue:y.venue,implementation_date:y.implementation_date?y.implementation_date.split("T")[0]:"",participants_online:y.participants_online,participants_face_to_face:y.participants_face_to_face,organizer:y.organizer,remarks:y.remarks||""})):[],[d,f]=$.useState(u),h=[{data:"title",title:"Title of Programs/Projects/Activities",type:"text",width:250,placeholder:"e.g., Job Fair 2025"},{data:"venue",title:"Venue",type:"text",width:150,placeholder:"e.g., University Auditorium"},{data:"implementation_date",title:"Date of Implementation",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,width:150,placeholder:"YYYY-MM-DD"},{data:"participants_online",title:"Participants (Online)",type:"numeric",numericFormat:{pattern:"0,0"},width:130,placeholder:"0"},{data:"participants_face_to_face",title:"Participants (Face-to-Face)",type:"numeric",numericFormat:{pattern:"0,0"},width:150,placeholder:"0"},{data:"organizer",title:"Organizer",type:"text",width:150,placeholder:"e.g., Career Center"},{data:"remarks",title:"Remarks (Optional)",type:"text",width:200,placeholder:"Optional notes"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v,x,S,N){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");if(N){const R=parseInt(N.dataset.row);g(R)}},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const N=w[S],[R,E,P,D,H,Z,I]=N;if(!(!R&&!E&&!P&&!Z)){if(!R||!E||!P||!Z){alert(`Row ${S+1}: Please fill in all required fields (Title, Venue, Date, Organizer)`);return}v.push({title:R,venue:E,implementation_date:P,participants_online:parseInt(D)||0,participants_face_to_face:parseInt(H)||0,organizer:Z,remarks:I||""})}}if(v.length===0){alert("Please add at least one program to submit.");return}c(!0),lt.post("/hei/annex-c",{programs:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex C",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"LIST OF PROGRAMS/ PROJECTS/ ACTIVITIES CAREER AND JOB PLACEMENT SERVICES"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex C"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple programs/projects/activities in the table below. You can submit them all at once as a batch. Submitting will replace any previous submission for this year."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-c/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Programs/Projects/Activities"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple programs below. Each row represents one program/project/activity."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Program"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-c/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},rBe=Object.freeze(Object.defineProperty({__proto__:null,default:tBe},Symbol.toStringTag,{value:"Module"}));Yt();const nBe=({batches:t})=>{const e=or(),{showCancelModal:r,selectedId:n,handleCancel:i,handleCancelConfirm:s,handleCancelClose:o}=Ss("annex-c"),[a,c]=$.useState({}),[u,d]=$.useState({}),f=async m=>{if(a[m])c(g=>({...g,[m]:!1}));else if(c(g=>({...g,[m]:!0})),!u[m])try{const p=await(await fetch(`/hei/annex-c/${m}/programs`)).json();d(y=>({...y,[m]:p}))}catch(g){console.error("Failed to fetch programs:",g)}},h=[{data:"title",title:"Title",type:"text",readOnly:!0,width:250},{data:"venue",title:"Venue",type:"text",readOnly:!0,width:150},{data:"implementation_date",title:"Date",type:"date",dateFormat:"YYYY-MM-DD",readOnly:!0,width:120},{data:"participants_online",title:"Online",type:"numeric",numericFormat:{pattern:"0,0"},readOnly:!0,width:100},{data:"participants_face_to_face",title:"Face-to-Face",type:"numeric",numericFormat:{pattern:"0,0"},readOnly:!0,width:110},{data:"organizer",title:"Organizer",type:"text",readOnly:!0,width:150},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex C History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex C Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-c/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex C data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-c/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(m=>{const g=m.status==="request",p=m.status==="published",y=a[m.batch_id],w=u[m.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsxs("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:[l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>f(m.batch_id),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:y?l.jsx(ri,{className:"text-lg"}):l.jsx(ni,{className:"text-lg"})}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Batch #",m.batch_id.substring(0,8)]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:m.academic_year}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[m.programs_count," program",m.programs_count!==1?"s":""]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:an(m.created_at)})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Cs,{status:m.status}),l.jsx("a",{href:`/hei/annex-c/${m.batch_id}/edit`,className:`inline-flex items-center justify-center w-7 h-7 transition-colors ${p?"text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-300":"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"}`,title:p?"Edit Request":"Edit Batch",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),g&&l.jsx("button",{onClick:()=>i(m.batch_id),className:"px-3 py-1 text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",title:"Cancel Request",children:"Cancel"})]})]}),m.request_notes&&l.jsx("div",{className:"px-3 py-2 border-t border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:l.jsxs("p",{className:"text-xs text-yellow-900 dark:text-yellow-200",children:[l.jsx("strong",{children:"Notes:"})," ",m.request_notes]})})]}),y&&l.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 p-3 bg-white dark:bg-gray-800",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsx(xt,{data:w.map(v=>({title:v.title,venue:v.venue,implementation_date:v.implementation_date?v.implementation_date.split("T")[0]:"",participants_online:v.participants_online,participants_face_to_face:v.participants_face_to_face,organizer:v.organizer,remarks:v.remarks||""})),colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",licenseKey:"non-commercial-and-evaluation",readOnly:!0,stretchH:"all",className:e?"dark-table":""})})})]},m.batch_id)})})]}),l.jsx(_i,{isOpen:r,onClose:o,onConfirm:s,submissionId:n})]})},iBe=Object.freeze(Object.defineProperty({__proto__:null,default:nBe},Symbol.toStringTag,{value:"Module"})),sBe=({existingSubmission:t,formData:e})=>{const r=`${St}-${St+1}`,[n,i]=$.useState(!1),[s,o]=$.useState({version_publication_date:(e==null?void 0:e.version_publication_date)||"",officer_in_charge:(e==null?void 0:e.officer_in_charge)||"",handbook_committee:(e==null?void 0:e.handbook_committee)||"",dissemination_orientation:(e==null?void 0:e.dissemination_orientation)||!1,orientation_dates:(e==null?void 0:e.orientation_dates)||"",mode_of_delivery:(e==null?void 0:e.mode_of_delivery)||"",dissemination_uploaded:(e==null?void 0:e.dissemination_uploaded)||!1,dissemination_others:(e==null?void 0:e.dissemination_others)||!1,dissemination_others_text:(e==null?void 0:e.dissemination_others_text)||"",type_digital:(e==null?void 0:e.type_digital)||!1,type_printed:(e==null?void 0:e.type_printed)||!1,type_others:(e==null?void 0:e.type_others)||!1,type_others_text:(e==null?void 0:e.type_others_text)||"",has_academic_policies:(e==null?void 0:e.has_academic_policies)||!1,has_admission_requirements:(e==null?void 0:e.has_admission_requirements)||!1,has_code_of_conduct:(e==null?void 0:e.has_code_of_conduct)||!1,has_scholarships:(e==null?void 0:e.has_scholarships)||!1,has_student_publication:(e==null?void 0:e.has_student_publication)||!1,has_housing_services:(e==null?void 0:e.has_housing_services)||!1,has_disability_services:(e==null?void 0:e.has_disability_services)||!1,has_student_council:(e==null?void 0:e.has_student_council)||!1,has_refund_policies:(e==null?void 0:e.has_refund_policies)||!1,has_drug_education:(e==null?void 0:e.has_drug_education)||!1,has_foreign_students:(e==null?void 0:e.has_foreign_students)||!1,has_disaster_management:(e==null?void 0:e.has_disaster_management)||!1,has_safe_spaces:(e==null?void 0:e.has_safe_spaces)||!1,has_anti_hazing:(e==null?void 0:e.has_anti_hazing)||!1,has_anti_bullying:(e==null?void 0:e.has_anti_bullying)||!1,has_violence_against_women:(e==null?void 0:e.has_violence_against_women)||!1,has_gender_fair:(e==null?void 0:e.has_gender_fair)||!1,has_others:(e==null?void 0:e.has_others)||!1,has_others_text:(e==null?void 0:e.has_others_text)||""}),[a,c]=$.useState(""),u=d=>{d.preventDefault(),i(!0),lt.post("/hei/annex-d",{...s,request_notes:a},{onFinish:()=>i(!1)})};return l.jsx(Ct,{title:"Submit Annex D",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"UPDATES ON STUDENT HANDBOOK/MANUAL"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex D"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsxs("form",{onSubmit:u,className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Basic Information"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Version/ Publication date"}),l.jsx("input",{type:"text",value:s.version_publication_date,onChange:d=>o({...s,version_publication_date:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Second Revision 2023"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Officer-in-Charge"}),l.jsx("input",{type:"text",value:s.officer_in_charge,onChange:d=>o({...s,officer_in_charge:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Dean of Students Affair"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Composition of the Student Handbook Committee"}),l.jsx("textarea",{value:s.handbook_committee,onChange:d=>o({...s,handbook_committee:d.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"List committee members..."})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Mode of Dissemination"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.dissemination_orientation,onChange:d=>o({...s,dissemination_orientation:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Orientation"})]}),s.dissemination_orientation&&l.jsxs("div",{className:"ml-8 mt-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-1",children:"Date/s of Orientation"}),l.jsx("input",{type:"text",value:s.orientation_dates,onChange:d=>o({...s,orientation_dates:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"Enter dates"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-1",children:"Mode of delivery (F2F/online or both)"}),l.jsx("input",{type:"text",value:s.mode_of_delivery,onChange:d=>o({...s,mode_of_delivery:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"e.g., F2F, Online, Both"})]})]})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.dissemination_uploaded,onChange:d=>o({...s,dissemination_uploaded:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Uploaded in Website"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.dissemination_others,onChange:d=>o({...s,dissemination_others:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Others, please specify"})]}),s.dissemination_others&&l.jsx("input",{type:"text",value:s.dissemination_others_text,onChange:d=>o({...s,dissemination_others_text:d.target.value}),className:"ml-8 mt-2 w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"Specify other dissemination mode"})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Type of Student Handbook/Manual"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.type_digital,onChange:d=>o({...s,type_digital:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Digital Copy"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.type_printed,onChange:d=>o({...s,type_printed:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Printed"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.type_others,onChange:d=>o({...s,type_others:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Others, please specify"})]}),s.type_others&&l.jsx("input",{type:"text",value:s.type_others_text,onChange:d=>o({...s,type_others_text:d.target.value}),className:"ml-8 mt-2 w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"Specify other type"})]})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Contains the following information (check all applicable items/information)"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_academic_policies,onChange:d=>o({...s,has_academic_policies:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Academic and Institutional Policies"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_admission_requirements,onChange:d=>o({...s,has_admission_requirements:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Admission requirements"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_code_of_conduct,onChange:d=>o({...s,has_code_of_conduct:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Student Code of Conduct and Discipline"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_scholarships,onChange:d=>o({...s,has_scholarships:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Scholarships/Financial Assistance"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_student_publication,onChange:d=>o({...s,has_student_publication:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Student Publication"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_housing_services,onChange:d=>o({...s,has_housing_services:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Housing Services/Dormitories (if applicable)"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_disability_services,onChange:d=>o({...s,has_disability_services:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Services for Learners with Disabilities and Special Needs"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_student_council,onChange:d=>o({...s,has_student_council:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"student council/government/organizations"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_refund_policies,onChange:d=>o({...s,has_refund_policies:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Refund policies"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_drug_education,onChange:d=>o({...s,has_drug_education:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Drug Education, prevention and control"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_foreign_students,onChange:d=>o({...s,has_foreign_students:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Foreign students (if applicable)"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_disaster_management,onChange:d=>o({...s,has_disaster_management:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Disaster Risk Reduction and Management"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_safe_spaces,onChange:d=>o({...s,has_safe_spaces:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Safe Spaces Act"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_anti_hazing,onChange:d=>o({...s,has_anti_hazing:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Anti-Hazing Act"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_anti_bullying,onChange:d=>o({...s,has_anti_bullying:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Anti-Bullying Act"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_violence_against_women,onChange:d=>o({...s,has_violence_against_women:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Violence against women and their children"})]}),l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_gender_fair,onChange:d=>o({...s,has_gender_fair:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Gender-fair education"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:s.has_others,onChange:d=>o({...s,has_others:d.target.checked}),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-900 dark:text-white",children:"Others, please specify"})]}),s.has_others&&l.jsx("input",{type:"text",value:s.has_others_text,onChange:d=>o({...s,has_others_text:d.target.value}),className:"ml-8 mt-2 w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"Specify other information"})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Additional Notes (Optional)"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes for this submission"}),l.jsx("textarea",{value:a,onChange:d=>c(d.target.value),rows:4,maxLength:1e3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Optional: Any notes for this submission (max 1000 characters)"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:[a.length,"/1000 characters"]})]})]}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-d/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"submit",disabled:n,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),n?"Submitting...":"Submit"]})]})]})]})})},oBe=Object.freeze(Object.defineProperty({__proto__:null,default:sBe},Symbol.toStringTag,{value:"Module"})),aBe=({submissions:t})=>{const[e,r]=$.useState(!1),[n,i]=$.useState(null),[s,o]=$.useState({}),a=h=>{o(m=>({...m,[h]:!m[h]}))},c=h=>{i(h),r(!0)},u=(h,m)=>{lt.post(`/hei/annex-d/${h}/cancel`,{cancelled_notes:m}),r(!1),i(null)},d=()=>{r(!1),i(null)},f=h=>{const m={submitted:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",label:"Submitted"},request:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",label:"Request"},published:{color:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",label:"Published"},overwritten:{color:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400",label:"Overwritten"},rejected:{color:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",label:"Rejected"},cancelled:{color:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400",label:"Cancelled"}},g=m[h]||m.submitted;return l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${g.color}`,children:g.label})};return l.jsxs(Ct,{title:"Annex D History",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex D Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your submissions"})]}),l.jsxs(yt,{href:"/hei/annex-d/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Submission"]})]}),t.length===0?l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center border border-gray-200 dark:border-gray-700",children:[l.jsx(pt,{className:"mx-auto text-6xl text-gray-400 dark:text-gray-600 mb-4"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"No Submissions Yet"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You haven't submitted any Annex D data yet."}),l.jsxs(yt,{href:"/hei/annex-d/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors",children:[l.jsx(pt,{}),"Create Your First Submission"]})]}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=s[h.submission_id];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsxs("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:[l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>a(h.submission_id),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:p?l.jsx(ri,{className:"text-lg"}):l.jsx(ni,{className:"text-lg"})}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Submission #",h.submission_id.substring(0,8)]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:h.academic_year}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:an(h.created_at)})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[f(h.status),l.jsx("a",{href:`/hei/annex-d/${h.submission_id}/edit`,className:`inline-flex items-center justify-center w-7 h-7 transition-colors ${g?"text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-300":"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"}`,title:g?"Edit Request":"Edit Submission",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),m&&l.jsx("button",{onClick:()=>c(h.submission_id),className:"px-3 py-1 text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",title:"Cancel Request",children:"Cancel"})]})]}),h.request_notes&&l.jsx("div",{className:"px-3 py-2 border-t border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:l.jsxs("p",{className:"text-xs text-yellow-900 dark:text-yellow-200",children:[l.jsx("strong",{children:"Notes:"})," ",h.request_notes]})})]}),p&&l.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 p-3 bg-white dark:bg-gray-800",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-300 dark:divide-gray-600 text-sm border border-gray-300 dark:border-gray-600",children:[l.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:"Field"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:"Value"})]})}),l.jsxs("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[l.jsx("tr",{className:"bg-gray-50 dark:bg-gray-700/50",children:l.jsx("td",{colSpan:2,className:"px-3 py-2 font-bold text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:"BASIC INFORMATION"})}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"version_publication_date"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.version_publication_date||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"officer_in_charge"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.officer_in_charge||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"handbook_committee"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.handbook_committee||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]}),l.jsx("tr",{className:"bg-gray-50 dark:bg-gray-700/50",children:l.jsx("td",{colSpan:2,className:"px-3 py-2 font-bold text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:"MODE OF DISSEMINATION"})}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"dissemination_orientation"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.dissemination_orientation?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"orientation_dates"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.orientation_dates||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"mode_of_delivery"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.mode_of_delivery||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"dissemination_uploaded"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.dissemination_uploaded?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"dissemination_others"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.dissemination_others?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"dissemination_others_text"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.dissemination_others_text||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]}),l.jsx("tr",{className:"bg-gray-50 dark:bg-gray-700/50",children:l.jsx("td",{colSpan:2,className:"px-3 py-2 font-bold text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:"TYPE OF HANDBOOK/MANUAL"})}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"type_digital"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.type_digital?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"type_printed"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.type_printed?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"type_others"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.type_others?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"type_others_text"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.type_others_text||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]}),l.jsx("tr",{className:"bg-gray-50 dark:bg-gray-700/50",children:l.jsx("td",{colSpan:2,className:"px-3 py-2 font-bold text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:"CHECKLIST"})}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_academic_policies"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_academic_policies?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_admission_requirements"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_admission_requirements?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_code_of_conduct"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_code_of_conduct?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_scholarships"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_scholarships?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_student_publication"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_student_publication?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_housing_services"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_housing_services?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_disability_services"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_disability_services?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_student_council"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_student_council?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_refund_policies"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_refund_policies?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_drug_education"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_drug_education?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_foreign_students"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_foreign_students?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_disaster_management"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_disaster_management?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_safe_spaces"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_safe_spaces?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_anti_hazing"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_anti_hazing?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_anti_bullying"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_anti_bullying?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_violence_against_women"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_violence_against_women?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_gender_fair"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_gender_fair?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_others"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_others?l.jsx(rr,{className:"text-green-500 text-lg"}):l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"0"})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:"has_others_text"}),l.jsx("td",{className:"px-3 py-2 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600",children:h.has_others_text||l.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"NULL"})})]})]})]})})})]},h.submission_id)})})]}),l.jsx(_i,{isOpen:e,onClose:d,onConfirm:u,submissionId:n})]})},lBe=Object.freeze(Object.defineProperty({__proto__:null,default:aBe},Symbol.toStringTag,{value:"Module"}));Yt();const cBe=({existingSubmission:t,organizations:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({name_of_accredited:y.name_of_accredited,years_of_existence:y.years_of_existence,accredited_since:y.accredited_since,faculty_adviser:y.faculty_adviser||"",president_and_officers:y.president_and_officers,specialization:y.specialization,fee_collected:y.fee_collected||"",programs_projects_activities:y.programs_projects_activities})):[],[d,f]=$.useState(u),h=[{data:"name_of_accredited",title:"Name of Accredited/Recognized/Authorized",type:"text",width:250,placeholder:"Student Organization, Council, etc."},{data:"years_of_existence",title:"No. of Years of Existence",type:"numeric",numericFormat:{pattern:"0"},width:130,placeholder:"0"},{data:"accredited_since",title:"Accredited/Recognized Since",type:"text",width:150,placeholder:"e.g., 2020"},{data:"faculty_adviser",title:"Faculty Adviser (if applicable)",type:"text",width:180,placeholder:"Optional"},{data:"president_and_officers",title:"President/Head and Officers",type:"text",width:250,placeholder:"use additional sheet if necessary"},{data:"specialization",title:"Specialization",type:"text",width:180,placeholder:"Drug Education, Academic, etc."},{data:"fee_collected",title:"Fee Collected (if authorized)",type:"text",width:150,placeholder:"Optional"},{data:"programs_projects_activities",title:"Programs/Projects/Activities Undertaken",type:"text",width:250,placeholder:"as approved and monitored by HEI"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v,x,S,N){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");if(N){const R=parseInt(N.dataset.row);g(R)}},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const N=w[S],[R,E,P,D,H,Z,I,Y]=N;if(!(!R&&!P&&!H&&!Z&&!Y)){if(!R||!P||!H||!Z||!Y){alert(`Row ${S+1}: Please fill in all required fields (Name, Accredited Since, President/Officers, Specialization, Programs/Activities)`);return}v.push({name_of_accredited:R,years_of_existence:parseInt(E)||0,accredited_since:P,faculty_adviser:D||"",president_and_officers:H,specialization:Z,fee_collected:I||"",programs_projects_activities:Y})}}if(v.length===0){alert("Please add at least one organization to submit.");return}c(!0),lt.post("/hei/annex-e",{organizations:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex E",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"LIST OF ACCREDITED/ RECOGNIZED/ AUTHORIZED STUDENT ORGANIZATIONS/ COUNCIL/ GOVERNMENT AND STUDENT ACTIVITIES"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex E"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple student organizations in the table below. You can submit them all at once as a batch. Submitting will replace any previous submission for this year."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-e/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Student Organizations"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple organizations below. Each row represents one student organization/council/government."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Organization"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-e/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},uBe=Object.freeze(Object.defineProperty({__proto__:null,default:cBe},Symbol.toStringTag,{value:"Module"}));Yt();const dBe=({batches:t})=>{const e=or(),{showCancelModal:r,selectedId:n,handleCancel:i,handleCancelConfirm:s,handleCancelClose:o}=Ss("annex-e"),[a,c]=$.useState({}),[u,d]=$.useState({}),f=async m=>{if(a[m])c(g=>({...g,[m]:!1}));else if(c(g=>({...g,[m]:!0})),!u[m])try{const p=await(await fetch(`/hei/annex-e/${m}/organizations`)).json();d(y=>({...y,[m]:p}))}catch(g){console.error("Failed to fetch organizations:",g)}},h=[{data:"name_of_accredited",title:"Name",type:"text",readOnly:!0,width:200},{data:"years_of_existence",title:"Years",type:"numeric",numericFormat:{pattern:"0"},readOnly:!0,width:80},{data:"accredited_since",title:"Since",type:"text",readOnly:!0,width:100},{data:"faculty_adviser",title:"Adviser",type:"text",readOnly:!0,width:150},{data:"president_and_officers",title:"President/Officers",type:"text",readOnly:!0,width:200},{data:"specialization",title:"Specialization",type:"text",readOnly:!0,width:150},{data:"fee_collected",title:"Fee",type:"text",readOnly:!0,width:100},{data:"programs_projects_activities",title:"Activities",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex E History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex E Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-e/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex E data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-e/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(m=>{const g=m.status==="request",p=m.status==="published",y=a[m.batch_id],w=u[m.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsxs("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:[l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>f(m.batch_id),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:y?l.jsx(ri,{className:"text-lg"}):l.jsx(ni,{className:"text-lg"})}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Batch #",m.batch_id.substring(0,8)]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:m.academic_year}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[m.organizations_count," organization",m.organizations_count!==1?"s":""]}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:an(m.created_at)})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Cs,{status:m.status}),l.jsx("a",{href:`/hei/annex-e/${m.batch_id}/edit`,className:`inline-flex items-center justify-center w-7 h-7 transition-colors ${p?"text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-300":"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"}`,title:p?"Edit Request":"Edit Batch",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),g&&l.jsx("button",{onClick:()=>i(m.batch_id),className:"px-3 py-1 text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",title:"Cancel Request",children:"Cancel"})]})]}),m.request_notes&&l.jsx("div",{className:"px-3 py-2 border-t border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:l.jsxs("p",{className:"text-xs text-yellow-900 dark:text-yellow-200",children:[l.jsx("strong",{children:"Notes:"})," ",m.request_notes]})})]}),y&&l.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 p-3 bg-white dark:bg-gray-800",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsx(xt,{data:w.map(v=>({name_of_accredited:v.name_of_accredited,years_of_existence:v.years_of_existence,accredited_since:v.accredited_since,faculty_adviser:v.faculty_adviser||"",president_and_officers:v.president_and_officers,specialization:v.specialization,fee_collected:v.fee_collected||"",programs_projects_activities:v.programs_projects_activities})),colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",licenseKey:"non-commercial-and-evaluation",readOnly:!0,stretchH:"all",className:e?"dark-table":""})})})]},m.batch_id)})})]}),l.jsx(_i,{isOpen:r,onClose:o,onConfirm:s,submissionId:n})]})},hBe=Object.freeze(Object.defineProperty({__proto__:null,default:dBe},Symbol.toStringTag,{value:"Module"}));Yt();const fBe=({existingSubmission:t,activities:e,formData:r})=>{const n=`${St}-${St+1}`,i=$.useRef(null),s=or(),[o,a]=$.useState(""),[c,u]=$.useState(!1),[d,f]=$.useState((r==null?void 0:r.procedure_mechanism)||""),[h,m]=$.useState((r==null?void 0:r.complaint_desk)||""),g=e&&e.length>0?e.map(N=>({activity:N.activity,date:N.date?N.date.split("T")[0]:"",status:N.status})):[],[p,y]=$.useState(g),w=[{data:"activity",title:"Activity",type:"text",width:300,placeholder:"Activity name"},{data:"date",title:"Date",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,width:150,placeholder:"YYYY-MM-DD"},{data:"status",title:"Status",type:"text",width:200,placeholder:"Status"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(N,R,E,P,D,H){return R.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+E+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',R.className="htCenter htMiddle",R.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",R}}],v=()=>{var R;const N=(R=i.current)==null?void 0:R.hotInstance;N&&N.alter("insert_row_below",N.countRows())},x=N=>{var R;if(confirm("Are you sure you want to delete this row?")){const E=(R=i.current)==null?void 0:R.hotInstance;E&&E.alter("remove_row",N)}};$.useEffect(()=>{var E,P;const N=D=>{const H=D.target.closest(".delete-row-btn");if(H){const Z=parseInt(H.dataset.row);x(Z)}},R=(P=(E=i.current)==null?void 0:E.hotInstance)==null?void 0:P.rootElement;if(R)return R.addEventListener("click",N),()=>R.removeEventListener("click",N)},[p]);const S=()=>{var P;const N=(P=i.current)==null?void 0:P.hotInstance;if(!N)return;const R=N.getData(),E=[];for(let D=0;D<R.length;D++){const H=R[D],[Z,I,Y]=H;if(!(!Z&&!I&&!Y)){if(!Z||!I||!Y){alert(`Row ${D+1}: Please fill in all required fields (Activity, Date, Status)`);return}E.push({activity:Z,date:I,status:Y})}}if(E.length===0){alert("Please add at least one activity to submit.");return}u(!0),lt.post("/hei/annex-f",{activities:E,procedure_mechanism:d,complaint_desk:h,request_notes:o},{onFinish:()=>u(!1)})};return l.jsxs(Ct,{title:"Submit Annex F",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"LIST OF PROGRAMS/PROJECTS/ACTIVITIES STUDENT DISCIPLINE"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex F"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:n})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple activities in the table below. You can submit them all at once as a batch."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-f/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Procedure/mechanism to address student grievance"}),l.jsx("input",{type:"text",value:d,onChange:N=>f(N.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Enter procedure/mechanism",maxLength:255})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Complaint desk"}),l.jsx("input",{type:"text",value:h,onChange:N=>m(N.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Enter complaint desk",maxLength:255})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Activities"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple activities below. Each row represents one activity."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:i,data:p,colHeaders:!0,rowHeaders:!0,columns:w,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:s?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Activity"]})]}),l.jsx(xs,{value:o,onChange:a}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-f/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:S,disabled:c,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),c?"Submitting...":"Submit Batch"]})]})]})]})},gBe=Object.freeze(Object.defineProperty({__proto__:null,default:fBe},Symbol.toStringTag,{value:"Module"}));Yt();const mBe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-f"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async h=>{if(o[h])a(m=>({...m,[h]:!1}));else if(a(m=>({...m,[h]:!0})),!c[h])try{const g=await(await fetch(`/hei/annex-f/${h}/activities`)).json();u(p=>({...p,[h]:g}))}catch(m){console.error("Failed to fetch activities:",m)}},f=[{data:"activity",title:"Activity",type:"text",readOnly:!0,width:300},{data:"date",title:"Date",type:"date",dateFormat:"YYYY-MM-DD",readOnly:!0,width:150},{data:"status",title:"Status",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex F History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex F Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-f/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex F data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-f/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=o[h.batch_id],y=c[h.batch_id],w=(y==null?void 0:y.activities)||[],v=y==null?void 0:y.procedure_mechanism,x=y==null?void 0:y.complaint_desk;return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(h.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:p?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h.academic_year}),l.jsx(Cs,{status:h.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.activities_count," ",h.activities_count===1?"activity":"activities"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(h.created_at)]}),m&&l.jsx("button",{onClick:()=>n(h.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),g&&l.jsx(yt,{href:`/hei/annex-f/${h.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),p&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30",children:[(v||x)&&l.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[v&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Procedure/mechanism to address student grievance"}),l.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:v})]}),x&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Complaint desk"}),l.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:x})]})]}),h.request_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:h.request_notes})]}),h.cancelled_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:h.cancelled_notes})]}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:w,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]},h.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},pBe=Object.freeze(Object.defineProperty({__proto__:null,default:mBe},Symbol.toStringTag,{value:"Module"}));Yt();const yBe=({existingSubmission:t,editorialBoards:e,otherPublications:r,programs:n,formData:i})=>{const s=`${St}-${St+1}`,o=$.useRef(null),a=$.useRef(null),c=$.useRef(null),u=or(),[d,f]=$.useState(!1),[h,m]=$.useState(""),[g,p]=$.useState((i==null?void 0:i.official_school_name)||""),[y,w]=$.useState((i==null?void 0:i.student_publication_name)||""),[v,x]=$.useState((i==null?void 0:i.publication_fee_per_student)||""),[S,N]=$.useState((i==null?void 0:i.frequency_monthly)||!1),[R,E]=$.useState((i==null?void 0:i.frequency_quarterly)||!1),[P,D]=$.useState((i==null?void 0:i.frequency_annual)||!1),[H,Z]=$.useState((i==null?void 0:i.frequency_per_semester)||!1),[I,Y]=$.useState((i==null?void 0:i.frequency_others)||!1),[re,ne]=$.useState((i==null?void 0:i.frequency_others_specify)||""),[ae,ue]=$.useState((i==null?void 0:i.publication_type_newsletter)||!1),[Q,fe]=$.useState((i==null?void 0:i.publication_type_gazette)||!1),[ye,de]=$.useState((i==null?void 0:i.publication_type_magazine)||!1),[se,me]=$.useState((i==null?void 0:i.publication_type_others)||!1),[te,b]=$.useState((i==null?void 0:i.publication_type_others_specify)||""),[_,T]=$.useState((i==null?void 0:i.adviser_name)||""),[F,K]=$.useState((i==null?void 0:i.adviser_position_designation)||""),C=e&&e.length>0?e.map(oe=>({name:oe.name,position_in_editorial_board:oe.position_in_editorial_board,degree_program_year_level:oe.degree_program_year_level})):[],k=r&&r.length>0?r.map(oe=>({name_of_publication:oe.name_of_publication,department_unit_in_charge:oe.department_unit_in_charge,type_of_publication:oe.type_of_publication})):[],M=n&&n.length>0?n.map(oe=>({title_of_program:oe.title_of_program,implementation_date:oe.implementation_date?oe.implementation_date.split("T")[0]:"",implementation_venue:oe.implementation_venue,target_group_of_participants:oe.target_group_of_participants})):[],[V,j]=$.useState(C),[A,U]=$.useState(k),[L,W]=$.useState(M),X=[{data:"name",title:"Name",type:"text",width:200,placeholder:"Full name"},{data:"position_in_editorial_board",title:"Position in Editorial Board",type:"text",width:200,placeholder:"Position"},{data:"degree_program_year_level",title:"Degree Program and Year Level",type:"text",width:250,placeholder:"e.g., BS Computer Science - 3rd Year"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(oe,Ee,Se){return Ee.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+Se+'" data-table="editorial" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',Ee.className="htCenter htMiddle",Ee.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",Ee}}],q=[{data:"name_of_publication",title:"Name of Publication",type:"text",width:200,placeholder:"Publication name"},{data:"department_unit_in_charge",title:"Department/Unit in Charge",type:"text",width:200,placeholder:"Department/Unit"},{data:"type_of_publication",title:"Type of Publication",type:"text",width:150,placeholder:"Type"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(oe,Ee,Se){return Ee.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+Se+'" data-table="publications" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',Ee.className="htCenter htMiddle",Ee.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",Ee}}],ie=[{data:"title_of_program",title:"Title of Program",type:"text",width:250,placeholder:"Program title"},{data:"implementation_date",title:"Implementation Date",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,width:150,placeholder:"YYYY-MM-DD"},{data:"implementation_venue",title:"Implementation Venue",type:"text",width:200,placeholder:"Venue"},{data:"target_group_of_participants",title:"Target Group of Participants",type:"text",width:200,placeholder:"Target group"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(oe,Ee,Se){return Ee.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+Se+'" data-table="programs" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',Ee.className="htCenter htMiddle",Ee.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",Ee}}],we=oe=>{var Se,He,ze;let Ee;oe==="editorial"?Ee=(Se=o.current)==null?void 0:Se.hotInstance:oe==="publications"?Ee=(He=a.current)==null?void 0:He.hotInstance:oe==="programs"&&(Ee=(ze=c.current)==null?void 0:ze.hotInstance),Ee&&Ee.alter("insert_row_below",Ee.countRows())},ve=(oe,Ee)=>{var Se,He,ze;if(confirm("Are you sure you want to delete this row?")){let Ge;oe==="editorial"?Ge=(Se=o.current)==null?void 0:Se.hotInstance:oe==="publications"?Ge=(He=a.current)==null?void 0:He.hotInstance:oe==="programs"&&(Ge=(ze=c.current)==null?void 0:ze.hotInstance),Ge&&Ge.alter("remove_row",Ee)}};$.useEffect(()=>{var ze,Ge,Zt,Qr,$t,Gt;const oe=Ue=>{const ct=Ue.target.closest(".delete-row-btn");if(ct){const Be=parseInt(ct.dataset.row),yr=ct.dataset.table;ve(yr,Be)}},Ee=(Ge=(ze=o.current)==null?void 0:ze.hotInstance)==null?void 0:Ge.rootElement,Se=(Qr=(Zt=a.current)==null?void 0:Zt.hotInstance)==null?void 0:Qr.rootElement,He=(Gt=($t=c.current)==null?void 0:$t.hotInstance)==null?void 0:Gt.rootElement;return Ee&&Ee.addEventListener("click",oe),Se&&Se.addEventListener("click",oe),He&&He.addEventListener("click",oe),()=>{Ee&&Ee.removeEventListener("click",oe),Se&&Se.removeEventListener("click",oe),He&&He.removeEventListener("click",oe)}},[V,A,L]);const je=()=>{var Zt,Qr,$t;const oe=(Zt=o.current)==null?void 0:Zt.hotInstance,Ee=(Qr=a.current)==null?void 0:Qr.hotInstance,Se=($t=c.current)==null?void 0:$t.hotInstance,He=[],ze=[],Ge=[];if(oe){const Gt=oe.getData();for(let Ue=0;Ue<Gt.length;Ue++){const ct=Gt[Ue],[Be,yr,Kt]=ct;if(Be||yr||Kt){if(!Be||!yr||!Kt){alert(`Editorial Board Row ${Ue+1}: Please fill in all fields`);return}He.push({name:Be,position_in_editorial_board:yr,degree_program_year_level:Kt})}}}if(Ee){const Gt=Ee.getData();for(let Ue=0;Ue<Gt.length;Ue++){const ct=Gt[Ue],[Be,yr,Kt]=ct;if(Be||yr||Kt){if(!Be||!yr||!Kt){alert(`Other Publications Row ${Ue+1}: Please fill in all fields`);return}ze.push({name_of_publication:Be,department_unit_in_charge:yr,type_of_publication:Kt})}}}if(Se){const Gt=Se.getData();for(let Ue=0;Ue<Gt.length;Ue++){const ct=Gt[Ue],[Be,yr,Kt,Gn]=ct;if(Be||yr||Kt||Gn){if(!Be||!yr||!Kt||!Gn){alert(`Programs Row ${Ue+1}: Please fill in all fields`);return}Ge.push({title_of_program:Be,implementation_date:yr,implementation_venue:Kt,target_group_of_participants:Gn})}}}f(!0),lt.post("/hei/annex-g",{official_school_name:g,student_publication_name:y,publication_fee_per_student:v,frequency_monthly:S,frequency_quarterly:R,frequency_annual:P,frequency_per_semester:H,frequency_others:I,frequency_others_specify:re,publication_type_newsletter:ae,publication_type_gazette:Q,publication_type_magazine:ye,publication_type_others:se,publication_type_others_specify:te,adviser_name:_,adviser_position_designation:F,editorial_boards:He,other_publications:ze,programs:Ge,request_notes:h},{onFinish:()=>f(!1)})};return l.jsxs(Ct,{title:"Submit Annex G",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"CAMPUS JOURNALISM ACT (RA 7079)"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex G"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:s})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-g/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Official School Name"}),l.jsx("input",{type:"text",value:g,onChange:oe=>p(oe.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Enter official school name",maxLength:255})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Student Publication Name"}),l.jsx("input",{type:"text",value:y,onChange:oe=>w(oe.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Enter publication name",maxLength:255})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Publication Fee per Student"}),l.jsx("input",{type:"number",step:"0.01",value:v,onChange:oe=>x(oe.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Frequency of Publication"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:S,onChange:oe=>N(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Monthly"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:R,onChange:oe=>E(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Quarterly"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:P,onChange:oe=>D(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Annual"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:H,onChange:oe=>Z(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Per Semester"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:I,onChange:oe=>Y(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Others (please specify)"})]}),I&&l.jsx("input",{type:"text",value:re,onChange:oe=>ne(oe.target.value),className:"ml-6 w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Specify frequency",maxLength:255})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type of Publication"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:ae,onChange:oe=>ue(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Newsletter"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:Q,onChange:oe=>fe(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Gazette"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:ye,onChange:oe=>de(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Magazine"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:se,onChange:oe=>me(oe.target.checked),className:"mr-2 rounded"}),l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Others (please specify)"})]}),se&&l.jsx("input",{type:"text",value:te,onChange:oe=>b(oe.target.value),className:"ml-6 w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Specify type",maxLength:255})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adviser Name"}),l.jsx("input",{type:"text",value:_,onChange:oe=>T(oe.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Enter adviser name",maxLength:255})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adviser Position/Designation"}),l.jsx("input",{type:"text",value:F,onChange:oe=>K(oe.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Enter position/designation",maxLength:255})]})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Editorial Board Members"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add members of the editorial board"})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:o,data:V,colHeaders:!0,rowHeaders:!0,columns:X,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:u?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:()=>we("editorial"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Editorial Board Member"]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Other Publications"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"List other publications in the institution"})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:a,data:A,colHeaders:!0,rowHeaders:!0,columns:q,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:u?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:()=>we("publications"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Publication"]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Training Programs"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"List training programs and seminars conducted"})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:c,data:L,colHeaders:!0,rowHeaders:!0,columns:ie,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:u?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:()=>we("programs"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Program"]})]}),l.jsx(xs,{value:h,onChange:m}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-g/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:je,disabled:d,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),d?"Submitting...":"Submit"]})]})]})]})},vBe=Object.freeze(Object.defineProperty({__proto__:null,default:yBe},Symbol.toStringTag,{value:"Module"}));Yt();const wBe=({submissions:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-g"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async g=>{if(o[g])a(p=>({...p,[g]:!1}));else if(a(p=>({...p,[g]:!0})),!c[g])try{const y=await(await fetch(`/hei/annex-g/${g}/data`)).json();u(w=>({...w,[g]:y}))}catch(p){console.error("Failed to fetch submission data:",p)}},f=[{data:"name",title:"Name",type:"text",readOnly:!0,width:200},{data:"position_in_editorial_board",title:"Position",type:"text",readOnly:!0,width:200},{data:"degree_program_year_level",title:"Degree Program & Year",type:"text",readOnly:!0,width:250}],h=[{data:"name_of_publication",title:"Publication Name",type:"text",readOnly:!0,width:200},{data:"department_unit_in_charge",title:"Department/Unit",type:"text",readOnly:!0,width:200},{data:"type_of_publication",title:"Type",type:"text",readOnly:!0,width:150}],m=[{data:"title_of_program",title:"Program Title",type:"text",readOnly:!0,width:250},{data:"implementation_date",title:"Date",type:"date",dateFormat:"YYYY-MM-DD",readOnly:!0,width:150},{data:"implementation_venue",title:"Venue",type:"text",readOnly:!0,width:200},{data:"target_group_of_participants",title:"Target Group",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex G History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex G Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your Campus Journalism Act submissions"})]}),l.jsxs(yt,{href:"/hei/annex-g/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex G data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-g/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(g=>{const p=g.status==="request",y=g.status==="published",w=o[g.submission_id],v=c[g.submission_id];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(g.submission_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:w?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:g.academic_year}),l.jsx(Cs,{status:g.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[g.editorial_boards_count," board members | ",g.other_publications_count," publications | ",g.programs_count," programs"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(g.created_at)]}),p&&l.jsx("button",{onClick:()=>n(g.submission_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),y&&l.jsx(yt,{href:`/hei/annex-g/${g.submission_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),w&&v&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30 space-y-4",children:[v.form_data&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Publication Information"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[v.form_data.official_school_name&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"School Name:"}),l.jsx("p",{className:"text-gray-900 dark:text-white",children:v.form_data.official_school_name})]}),v.form_data.student_publication_name&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Publication Name:"}),l.jsx("p",{className:"text-gray-900 dark:text-white",children:v.form_data.student_publication_name})]}),v.form_data.publication_fee_per_student&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Fee per Student:"}),l.jsxs("p",{className:"text-gray-900 dark:text-white",children:["",v.form_data.publication_fee_per_student]})]}),v.form_data.adviser_name&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Adviser:"}),l.jsx("p",{className:"text-gray-900 dark:text-white",children:v.form_data.adviser_name})]})]})]}),g.request_notes&&l.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:g.request_notes})]}),g.cancelled_notes&&l.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:g.cancelled_notes})]}),v.editorial_boards&&v.editorial_boards.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Editorial Board Members"}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:v.editorial_boards,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]}),v.other_publications&&v.other_publications.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Other Publications"}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:v.other_publications,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]}),v.programs&&v.programs.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Training Programs"}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:v.programs,colHeaders:!0,rowHeaders:!0,columns:m,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]})]},g.submission_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},bBe=Object.freeze(Object.defineProperty({__proto__:null,default:wBe},Symbol.toStringTag,{value:"Module"}));Yt();const xBe=({existingSubmission:t,admissionServices:e,admissionStatistics:r})=>{const n=`${St}-${St+1}`,i=$.useRef(null),s=$.useRef(null),o=or(),[a,c]=$.useState(!1),[u,d]=$.useState(""),f=e&&e.length>0?e.map(R=>({service_type:R.service_type,with:R.with||!1,supporting_documents:R.supporting_documents||"",remarks:R.remarks||""})):[],h=r&&r.length>0?r.map(R=>({program:R.program,applicants:R.applicants,admitted:R.admitted,enrolled:R.enrolled})):[],[m,g]=$.useState(f),[p,y]=$.useState(h),w=[{data:"service_type",title:"Service Type",type:"text",readOnly:!0,width:350,className:"htLeft"},{data:"with",title:"With",type:"checkbox",width:80,className:"htCenter"},{data:"supporting_documents",title:"Supporting Documents",type:"text",width:250,placeholder:"Document details"},{data:"remarks",title:"Remarks",type:"text",width:250,placeholder:"Additional notes"}],v=[{data:"program",title:"Program",type:"text",width:300,placeholder:"Program name"},{data:"applicants",title:"Applicants",type:"numeric",width:120,placeholder:"0"},{data:"admitted",title:"Admitted",type:"numeric",width:120,placeholder:"0"},{data:"enrolled",title:"Enrolled",type:"numeric",width:120,placeholder:"0"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(R,E,P){return E.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+P+'" data-table="statistics" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',E.className="htCenter htMiddle",E.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",E}}],x=R=>{var P;const E=(P=s.current)==null?void 0:P.hotInstance;E&&E.alter("insert_row_below",E.countRows())},S=(R,E)=>{var P,D;if(confirm("Are you sure you want to delete this row?")){const H=R==="services"?(P=i.current)==null?void 0:P.hotInstance:(D=s.current)==null?void 0:D.hotInstance;H&&H.alter("remove_row",E)}};$.useEffect(()=>{var D,H,Z,I;const R=Y=>{const re=Y.target.closest(".delete-row-btn");if(re){const ne=parseInt(re.dataset.row),ae=re.dataset.table;S(ae,ne)}},E=(H=(D=i.current)==null?void 0:D.hotInstance)==null?void 0:H.rootElement,P=(I=(Z=s.current)==null?void 0:Z.hotInstance)==null?void 0:I.rootElement;return E&&E.addEventListener("click",R),P&&P.addEventListener("click",R),()=>{E&&E.removeEventListener("click",R),P&&P.removeEventListener("click",R)}},[m,p]);const N=()=>{var H,Z;const R=(H=i.current)==null?void 0:H.hotInstance,E=(Z=s.current)==null?void 0:Z.hotInstance,P=[],D=[];if(R){const I=R.getData();if(I.length!==8){alert("Error: Must have exactly 8 predefined service types.");return}for(let Y=0;Y<I.length;Y++){const re=I[Y],[ne,ae,ue,Q]=re;P.push({service_type:ne,with:ae===!0,supporting_documents:ue||null,remarks:Q||null})}}if(E){const I=E.getData();for(let Y=0;Y<I.length;Y++){const re=I[Y],[ne,ae,ue,Q]=re;if(ne||ae||ue||Q){if(!ne||ae===null||ue===null||Q===null){alert(`Statistics Row ${Y+1}: All fields are required`);return}D.push({program:ne,applicants:parseInt(ae)||0,admitted:parseInt(ue)||0,enrolled:parseInt(Q)||0})}}}c(!0),lt.post("/hei/annex-h",{admission_services:P,admission_statistics:D,request_notes:u},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex H",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"ADMISSION SERVICES"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex H"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:n})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-h/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Admission Services/Requirements"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Check the box if your institution provides the service/requirement"})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:i,data:m,colHeaders:!0,rowHeaders:!0,columns:w,height:"auto",minRows:8,maxRows:8,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:!1,className:o?"dark-table":""})})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Admission Statistics"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Provide admission statistics per program"})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:s,data:p,colHeaders:!0,rowHeaders:!0,columns:v,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:o?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:()=>x(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Program Statistics"]})]}),l.jsx(xs,{value:u,onChange:d}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-h/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:N,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},SBe=Object.freeze(Object.defineProperty({__proto__:null,default:xBe},Symbol.toStringTag,{value:"Module"}));Yt();const CBe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-h"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async m=>{if(o[m])a(g=>({...g,[m]:!1}));else if(a(g=>({...g,[m]:!0})),!c[m])try{const p=await(await fetch(`/hei/annex-h/${m}/data`)).json();u(y=>({...y,[m]:p}))}catch(g){console.error("Failed to fetch batch data:",g)}},f=[{data:"service_type",title:"Service Type",type:"text",readOnly:!0,width:350},{data:"with",title:"With",type:"checkbox",readOnly:!0,width:80,className:"htCenter"},{data:"supporting_documents",title:"Supporting Documents",type:"text",readOnly:!0,width:250},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:250}],h=[{data:"program",title:"Program",type:"text",readOnly:!0,width:300},{data:"applicants",title:"Applicants",type:"numeric",readOnly:!0,width:120},{data:"admitted",title:"Admitted",type:"numeric",readOnly:!0,width:120},{data:"enrolled",title:"Enrolled",type:"numeric",readOnly:!0,width:120}];return l.jsxs(Ct,{title:"Annex H History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex H Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your Admission Services submissions"})]}),l.jsxs(yt,{href:"/hei/annex-h/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex H data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-h/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(m=>{const g=m.status==="request",p=m.status==="published",y=o[m.batch_id],w=c[m.batch_id];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(m.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:y?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:m.academic_year}),l.jsx(Cs,{status:m.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[m.admission_services_count," services | ",m.admission_statistics_count," programs"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(m.created_at)]}),g&&l.jsx("button",{onClick:()=>n(m.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),p&&l.jsx(yt,{href:`/hei/annex-h/${m.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),y&&w&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30 space-y-4",children:[m.request_notes&&l.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:m.request_notes})]}),m.cancelled_notes&&l.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:m.cancelled_notes})]}),w.admission_services&&w.admission_services.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Admission Services"}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:w.admission_services,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]}),w.admission_statistics&&w.admission_statistics.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Admission Statistics"}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:w.admission_statistics,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]})]},m.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},_Be=Object.freeze(Object.defineProperty({__proto__:null,default:CBe},Symbol.toStringTag,{value:"Module"}));Yt();const RBe=({existingSubmission:t,scholarships:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({scholarship_name:y.scholarship_name,type:y.type,category_intended_beneficiaries:y.category_intended_beneficiaries,number_of_beneficiaries:y.number_of_beneficiaries,remarks:y.remarks})):[],[d,f]=$.useState(u),h=[{data:"scholarship_name",title:"Scholarship Name",type:"text",width:250,placeholder:"Scholarship name"},{data:"type",title:"Type",type:"text",width:150,placeholder:"Type"},{data:"category_intended_beneficiaries",title:"Category/Intended Beneficiaries",type:"text",width:250,placeholder:"Category"},{data:"number_of_beneficiaries",title:"Number of Beneficiaries",type:"numeric",width:150,placeholder:"0"},{data:"remarks",title:"Remarks",type:"text",width:200,placeholder:"Remarks"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v,x,S,N){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");if(N){const R=parseInt(N.dataset.row);g(R)}},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const N=w[S],[R,E,P,D,H]=N;if(!(!R&&!E&&!P&&!D&&!H)){if(!R||!E||!P||D===null){alert(`Row ${S+1}: Please fill in all required fields (Scholarship Name, Type, Category, Number of Beneficiaries)`);return}v.push({scholarship_name:R,type:E,category_intended_beneficiaries:P,number_of_beneficiaries:parseInt(D)||0,remarks:H||null})}}if(v.length===0){alert("Please add at least one scholarship to submit.");return}c(!0),lt.post("/hei/annex-i",{scholarships:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex I",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"LIST OF SCHOLARSHIPS/STUDENT FINANCIAL ASSISTANCE"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex I"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple scholarships in the table below. You can submit them all at once as a batch."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-i/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Scholarships"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple scholarships below. Each row represents one scholarship."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Scholarship"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-i/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},EBe=Object.freeze(Object.defineProperty({__proto__:null,default:RBe},Symbol.toStringTag,{value:"Module"}));Yt();const NBe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-i"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async h=>{if(o[h])a(m=>({...m,[h]:!1}));else if(a(m=>({...m,[h]:!0})),!c[h])try{const g=await(await fetch(`/hei/annex-i/${h}/scholarships`)).json();u(p=>({...p,[h]:g}))}catch(m){console.error("Failed to fetch scholarships:",m)}},f=[{data:"scholarship_name",title:"Scholarship Name",type:"text",readOnly:!0,width:250},{data:"type",title:"Type",type:"text",readOnly:!0,width:150},{data:"category_intended_beneficiaries",title:"Category/Intended Beneficiaries",type:"text",readOnly:!0,width:250},{data:"number_of_beneficiaries",title:"Number of Beneficiaries",type:"numeric",readOnly:!0,width:150},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex I History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex I Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-i/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex I data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-i/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=o[h.batch_id],y=c[h.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(h.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:p?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h.academic_year}),l.jsx(Cs,{status:h.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.scholarships_count," ",h.scholarships_count===1?"scholarship":"scholarships"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(h.created_at)]}),m&&l.jsx("button",{onClick:()=>n(h.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),g&&l.jsx(yt,{href:`/hei/annex-i/${h.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),p&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30",children:[h.request_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:h.request_notes})]}),h.cancelled_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:h.cancelled_notes})]}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:y,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]},h.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},kBe=Object.freeze(Object.defineProperty({__proto__:null,default:NBe},Symbol.toStringTag,{value:"Module"}));Yt();const TBe=({existingSubmission:t,healthServices:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({title_of_program:y.title_of_program,organizer:y.organizer,number_of_participants:y.number_of_participants,remarks:y.remarks})):[],[d,f]=$.useState(u),h=[{data:"title_of_program",title:"Title of Program",type:"text",width:300,placeholder:"Program title"},{data:"organizer",title:"Organizer",type:"text",width:200,placeholder:"Organizer"},{data:"number_of_participants",title:"Number of Participants",type:"numeric",width:150,placeholder:"0"},{data:"remarks",title:"Remarks",type:"text",width:200,placeholder:"Remarks"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v,x,S,N){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");if(N){const R=parseInt(N.dataset.row);g(R)}},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const N=w[S],[R,E,P,D]=N;if(!(!R&&!E&&!P&&!D)){if(!R||!E||P===null){alert(`Row ${S+1}: Please fill in all required fields (Title of Program, Organizer, Number of Participants)`);return}v.push({title_of_program:R,organizer:E,number_of_participants:parseInt(P)||0,remarks:D||null})}}if(v.length===0){alert("Please add at least one health service program to submit.");return}c(!0),lt.post("/hei/annex-j",{health_services:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex J",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"HEALTH SERVICES"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex J"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple health service programs in the table below. You can submit them all at once as a batch."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-j/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Health Service Programs"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple health service programs below. Each row represents one program."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Program"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-j/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},PBe=Object.freeze(Object.defineProperty({__proto__:null,default:TBe},Symbol.toStringTag,{value:"Module"}));Yt();const MBe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-j"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async h=>{if(o[h])a(m=>({...m,[h]:!1}));else if(a(m=>({...m,[h]:!0})),!c[h])try{const g=await(await fetch(`/hei/annex-j/${h}/health-services`)).json();u(p=>({...p,[h]:g}))}catch(m){console.error("Failed to fetch health services:",m)}},f=[{data:"title_of_program",title:"Title of Program",type:"text",readOnly:!0,width:300},{data:"organizer",title:"Organizer",type:"text",readOnly:!0,width:200},{data:"number_of_participants",title:"Number of Participants",type:"numeric",readOnly:!0,width:150},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex J History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex J Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-j/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex J data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-j/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=o[h.batch_id],y=c[h.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(h.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:p?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h.academic_year}),l.jsx(Cs,{status:h.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.health_services_count," ",h.health_services_count===1?"program":"programs"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(h.created_at)]}),m&&l.jsx("button",{onClick:()=>n(h.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),g&&l.jsx(yt,{href:`/hei/annex-j/${h.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),p&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30",children:[h.request_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:h.request_notes})]}),h.cancelled_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:h.cancelled_notes})]}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:y,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]},h.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},ABe=Object.freeze(Object.defineProperty({__proto__:null,default:MBe},Symbol.toStringTag,{value:"Module"}));Yt();const OBe=({existingSubmission:t,committees:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({committee_name:y.committee_name,committee_head_name:y.committee_head_name,members_composition:y.members_composition,programs_projects_activities_trainings:y.programs_projects_activities_trainings,remarks:y.remarks})):[],[d,f]=$.useState(u),h=[{data:"committee_name",title:"Committee Name",type:"text",width:250,placeholder:"Committee name"},{data:"committee_head_name",title:"Committee Head Name",type:"text",width:200,placeholder:"Head name"},{data:"members_composition",title:"Members Composition",type:"text",width:200,placeholder:"Members"},{data:"programs_projects_activities_trainings",title:"Programs/Projects/Activities/Trainings",type:"text",width:300,placeholder:"Activities"},{data:"remarks",title:"Remarks",type:"text",width:200,placeholder:"Remarks"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");N&&g(parseInt(N.dataset.row))},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const[N,R,E,P,D]=w[S];if(!(!N&&!R&&!E&&!P&&!D)){if(!N||!R||!E){alert(`Row ${S+1}: Please fill in all required fields (Committee Name, Committee Head Name, Members Composition)`);return}v.push({committee_name:N,committee_head_name:R,members_composition:E,programs_projects_activities_trainings:P||null,remarks:D||null})}}if(v.length===0){alert("Please add at least one committee to submit.");return}c(!0),lt.post("/hei/annex-k",{committees:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex K",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"SAFETY AND SECURITY COMMITTEES"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex K"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple committees in the table below. You can submit them all at once as a batch."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-k/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Committees"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple committees below. Each row represents one committee."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Committee"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-k/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},IBe=Object.freeze(Object.defineProperty({__proto__:null,default:OBe},Symbol.toStringTag,{value:"Module"}));Yt();const jBe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-k"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async h=>{if(o[h])a(m=>({...m,[h]:!1}));else if(a(m=>({...m,[h]:!0})),!c[h])try{const g=await(await fetch(`/hei/annex-k/${h}/committees`)).json();u(p=>({...p,[h]:g}))}catch(m){console.error("Failed to fetch committees:",m)}},f=[{data:"committee_name",title:"Committee Name",type:"text",readOnly:!0,width:250},{data:"committee_head_name",title:"Committee Head Name",type:"text",readOnly:!0,width:200},{data:"members_composition",title:"Members Composition",type:"text",readOnly:!0,width:200},{data:"programs_projects_activities_trainings",title:"Programs/Projects/Activities/Trainings",type:"text",readOnly:!0,width:300},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex K History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex K Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-k/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex K data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-k/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=o[h.batch_id],y=c[h.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(h.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:p?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h.academic_year}),l.jsx(Cs,{status:h.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.committees_count," ",h.committees_count===1?"committee":"committees"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(h.created_at)]}),m&&l.jsx("button",{onClick:()=>n(h.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),g&&l.jsx(yt,{href:`/hei/annex-k/${h.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),p&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30",children:[h.request_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:h.request_notes})]}),h.cancelled_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:h.cancelled_notes})]}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:y,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]},h.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},HBe=Object.freeze(Object.defineProperty({__proto__:null,default:jBe},Symbol.toStringTag,{value:"Module"}));Yt();const $Be=({existingSubmission:t,housing:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({housing_name:y.housing_name,complete_address:y.complete_address,house_manager_name:y.house_manager_name,male:y.male,female:y.female,coed:y.coed,others:y.others,remarks:y.remarks})):[],[d,f]=$.useState(u),h=[{data:"housing_name",title:"Housing Name",type:"text",width:250,placeholder:"Housing name"},{data:"complete_address",title:"Complete Address",type:"text",width:300,placeholder:"Address"},{data:"house_manager_name",title:"House Manager Name",type:"text",width:200,placeholder:"Manager name"},{data:"male",title:"Male",type:"checkbox",width:80,className:"htCenter"},{data:"female",title:"Female",type:"checkbox",width:80,className:"htCenter"},{data:"coed",title:"Co-ed",type:"checkbox",width:80,className:"htCenter"},{data:"others",title:"Others",type:"text",width:150,placeholder:"Others"},{data:"remarks",title:"Remarks",type:"text",width:200,placeholder:"Remarks"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");N&&g(parseInt(N.dataset.row))},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const[N,R,E,P,D,H,Z,I]=w[S];if(!(!N&&!R&&!E&&!P&&!D&&!H&&!Z&&!I)){if(!N||!R||!E){alert(`Row ${S+1}: Please fill in all required fields (Housing Name, Complete Address, House Manager Name)`);return}v.push({housing_name:N,complete_address:R,house_manager_name:E,male:P||!1,female:D||!1,coed:H||!1,others:Z||null,remarks:I||null})}}if(v.length===0){alert("Please add at least one housing to submit.");return}c(!0),lt.post("/hei/annex-l",{housing:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex L",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"STUDENT HOUSING"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex L"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple housing facilities in the table below. You can submit them all at once as a batch."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-l/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Housing Facilities"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple housing facilities below. Each row represents one facility."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Housing"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-l/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},DBe=Object.freeze(Object.defineProperty({__proto__:null,default:$Be},Symbol.toStringTag,{value:"Module"}));Yt();const LBe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-l"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async h=>{if(o[h])a(m=>({...m,[h]:!1}));else if(a(m=>({...m,[h]:!0})),!c[h])try{const g=await(await fetch(`/hei/annex-l/${h}/housing`)).json();u(p=>({...p,[h]:g}))}catch(m){console.error("Failed to fetch housing:",m)}},f=[{data:"housing_name",title:"Housing Name",type:"text",readOnly:!0,width:250},{data:"complete_address",title:"Complete Address",type:"text",readOnly:!0,width:300},{data:"house_manager_name",title:"House Manager Name",type:"text",readOnly:!0,width:200},{data:"male",title:"Male",type:"checkbox",readOnly:!0,width:80,className:"htCenter"},{data:"female",title:"Female",type:"checkbox",readOnly:!0,width:80,className:"htCenter"},{data:"coed",title:"Co-ed",type:"checkbox",readOnly:!0,width:80,className:"htCenter"},{data:"others",title:"Others",type:"text",readOnly:!0,width:150},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex L History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex L Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-l/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex L data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-l/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=o[h.batch_id],y=c[h.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(h.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:p?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h.academic_year}),l.jsx(Cs,{status:h.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.housing_count," ",h.housing_count===1?"housing":"housing facilities"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(h.created_at)]}),m&&l.jsx("button",{onClick:()=>n(h.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),g&&l.jsx(yt,{href:`/hei/annex-l/${h.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),p&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30",children:[h.request_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:h.request_notes})]}),h.cancelled_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:h.cancelled_notes})]}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:y,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]},h.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},FBe=Object.freeze(Object.defineProperty({__proto__:null,default:LBe},Symbol.toStringTag,{value:"Module"})),M0=["A. Persons with Disabilities","B. Indigenous People","C. Dependents of Solo Parents / Solo Parents","D. Other students with special needs"],VBe=["Psychosocial","Disability due to chronic illness","Learning","Visual / Hearing","Orthopedic","Communication","Medical"],BBe=["Living with Mother/Father only","Young Parent"],WBe=({existingSubmission:t,statistics:e,services:r})=>{const n=`${St}-${St+1}`,[i,s]=$.useState(!1),[o,a]=$.useState(""),[c,u]=$.useState([]),[d,f]=$.useState({});$.useEffect(()=>{e&&e.length>0?u(e):h()},[e]),$.useEffect(()=>{if(r&&r.length>0){const I={};M0.forEach(Y=>{I[Y]=r.filter(re=>re.section===Y)}),f(I)}else{const I={};M0.forEach(Y=>{I[Y]=[]}),f(I)}},[r]);const h=()=>{const I=[];let Y=0;VBe.forEach(re=>{I.push({category:"A. Persons with Disabilities",subcategory:re,ay_2023_2024_enrollment:0,ay_2023_2024_graduates:0,ay_2022_2023_enrollment:0,ay_2022_2023_graduates:0,ay_2021_2022_enrollment:0,ay_2021_2022_graduates:0,is_subtotal:!1,display_order:Y++})}),I.push(m("A. Persons with Disabilities",Y++)),I.push(m("B. Indigenous People",Y++)),BBe.forEach(re=>{I.push({category:"C. Dependents of Solo Parents / Solo Parents",subcategory:re,ay_2023_2024_enrollment:0,ay_2023_2024_graduates:0,ay_2022_2023_enrollment:0,ay_2022_2023_graduates:0,ay_2021_2022_enrollment:0,ay_2021_2022_graduates:0,is_subtotal:!1,display_order:Y++})}),I.push(m("C. Dependents of Solo Parents / Solo Parents",Y++)),I.push({category:"TOTAL",subcategory:null,ay_2023_2024_enrollment:0,ay_2023_2024_graduates:0,ay_2022_2023_enrollment:0,ay_2022_2023_graduates:0,ay_2021_2022_enrollment:0,ay_2021_2022_graduates:0,is_subtotal:!0,display_order:999}),u(I)},m=(I,Y)=>({category:I,subcategory:"Sub-Total",ay_2023_2024_enrollment:0,ay_2023_2024_graduates:0,ay_2022_2023_enrollment:0,ay_2022_2023_graduates:0,ay_2021_2022_enrollment:0,ay_2021_2022_graduates:0,is_subtotal:!0,display_order}),g=I=>{const Y=[...I];["A. Persons with Disabilities","B. Indigenous People","C. Dependents of Solo Parents / Solo Parents"].forEach(ne=>{const ae=Y.findIndex(ue=>ue.category===ne&&ue.is_subtotal);if(ae!==-1){const ue=Y.filter(Q=>Q.category===ne&&!Q.is_subtotal);Y[ae]={...Y[ae],ay_2023_2024_enrollment:ue.reduce((Q,fe)=>Q+(parseInt(fe.ay_2023_2024_enrollment)||0),0),ay_2023_2024_graduates:ue.reduce((Q,fe)=>Q+(parseInt(fe.ay_2023_2024_graduates)||0),0),ay_2022_2023_enrollment:ue.reduce((Q,fe)=>Q+(parseInt(fe.ay_2022_2023_enrollment)||0),0),ay_2022_2023_graduates:ue.reduce((Q,fe)=>Q+(parseInt(fe.ay_2022_2023_graduates)||0),0),ay_2021_2022_enrollment:ue.reduce((Q,fe)=>Q+(parseInt(fe.ay_2021_2022_enrollment)||0),0),ay_2021_2022_graduates:ue.reduce((Q,fe)=>Q+(parseInt(fe.ay_2021_2022_graduates)||0),0)}}});const re=Y.findIndex(ne=>ne.category==="TOTAL");if(re!==-1){const ne=Y.filter(ue=>ue.is_subtotal&&ue.category!=="TOTAL"),ae=Y.filter(ue=>ue.category==="D. Other students with special needs"&&!ue.is_subtotal);Y[re]={...Y[re],ay_2023_2024_enrollment:ne.reduce((ue,Q)=>ue+(parseInt(Q.ay_2023_2024_enrollment)||0),0)+ae.reduce((ue,Q)=>ue+(parseInt(Q.ay_2023_2024_enrollment)||0),0),ay_2023_2024_graduates:ne.reduce((ue,Q)=>ue+(parseInt(Q.ay_2023_2024_graduates)||0),0)+ae.reduce((ue,Q)=>ue+(parseInt(Q.ay_2023_2024_graduates)||0),0),ay_2022_2023_enrollment:ne.reduce((ue,Q)=>ue+(parseInt(Q.ay_2022_2023_enrollment)||0),0)+ae.reduce((ue,Q)=>ue+(parseInt(Q.ay_2022_2023_enrollment)||0),0),ay_2022_2023_graduates:ne.reduce((ue,Q)=>ue+(parseInt(Q.ay_2022_2023_graduates)||0),0)+ae.reduce((ue,Q)=>ue+(parseInt(Q.ay_2022_2023_graduates)||0),0),ay_2021_2022_enrollment:ne.reduce((ue,Q)=>ue+(parseInt(Q.ay_2021_2022_enrollment)||0),0)+ae.reduce((ue,Q)=>ue+(parseInt(Q.ay_2021_2022_enrollment)||0),0),ay_2021_2022_graduates:ne.reduce((ue,Q)=>ue+(parseInt(Q.ay_2021_2022_graduates)||0),0)+ae.reduce((ue,Q)=>ue+(parseInt(Q.ay_2021_2022_graduates)||0),0)}}return Y},p=(I,Y,re)=>{const ne=[...c];ne[I]={...ne[I],[Y]:re},u(g(ne))},y=I=>{const Y=[...c];let re;I==="D. Other students with special needs"?re=Y.findIndex(ae=>ae.category==="TOTAL"):re=Y.findIndex(ae=>ae.category===I&&ae.is_subtotal);const ne={category:I,subcategory:"",ay_2023_2024_enrollment:0,ay_2023_2024_graduates:0,ay_2022_2023_enrollment:0,ay_2022_2023_graduates:0,ay_2021_2022_enrollment:0,ay_2021_2022_graduates:0,is_subtotal:!1,display_order:re};Y.splice(re,0,ne),Y.forEach((ae,ue)=>{ae.display_order=ue}),u(g(Y))},w=I=>{if(confirm("Are you sure you want to remove this subcategory?")){const Y=c.filter((re,ne)=>ne!==I);Y.forEach((re,ne)=>{re.display_order=ne}),u(g(Y))}},v=I=>{f({...d,[I]:[...d[I]||[],{section:I,category:"",institutional_services_programs_activities:"",number_of_beneficiaries_participants:0,remarks:"",display_order:(d[I]||[]).length}]})},x=(I,Y)=>{if(confirm("Are you sure you want to remove this service?")){const re=d[I].filter((ne,ae)=>ae!==Y);re.forEach((ne,ae)=>{ne.display_order=ae}),f({...d,[I]:re})}},S=(I,Y,re,ne)=>{const ae=[...d[I]];ae[Y]={...ae[Y],[re]:ne},f({...d,[I]:ae})},N=()=>{for(let Y=0;Y<c.length;Y++){const re=c[Y];if(!re.is_subtotal&&re.category!=="TOTAL"&&(!re.subcategory||re.subcategory.trim()==="")){alert(`Statistics Row ${Y+1}: Subcategory is required`);return}}for(const Y of M0){const re=d[Y]||[];for(let ne=0;ne<re.length;ne++){const ae=re[ne];if(!ae.institutional_services_programs_activities||ae.institutional_services_programs_activities.trim()===""){alert(`${Y} - Service Row ${ne+1}: Institutional Services/Programs/Activities is required`);return}if(ae.number_of_beneficiaries_participants===null||ae.number_of_beneficiaries_participants===""){alert(`${Y} - Service Row ${ne+1}: Number of Beneficiaries/Participants is required`);return}}}const I=[];M0.forEach(Y=>{d[Y]&&I.push(...d[Y])}),s(!0),lt.post("/hei/annex-m",{statistics:c,services:I,request_notes:o},{onFinish:()=>s(!1)})},R=I=>(parseInt(I.ay_2023_2024_enrollment)||0)+(parseInt(I.ay_2022_2023_enrollment)||0)+(parseInt(I.ay_2021_2022_enrollment)||0),E=I=>(parseInt(I.ay_2023_2024_graduates)||0)+(parseInt(I.ay_2022_2023_graduates)||0)+(parseInt(I.ay_2021_2022_graduates)||0),P=I=>I==="B. Indigenous People"||I==="D. Other students with special needs",D=I=>I.is_subtotal||I.category==="TOTAL"?!1:P(I.category),H=()=>{let I=null,Y=0;const re={};return c.forEach((ne,ae)=>{ne.category!==I?(I!==null&&(re[I]={start:ae-Y,count:Y}),I=ne.category,Y=1):Y++}),I!==null&&(re[I]={start:c.length-Y,count:Y}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 border border-gray-200 dark:border-gray-700",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Category"}),l.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Subcategory"}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2023-2024",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2023-2024",l.jsx("br",{}),"Graduates"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2022-2023",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2022-2023",l.jsx("br",{}),"Graduates"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2021-2022",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2021-2022",l.jsx("br",{}),"Graduates"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["Total",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["Total",l.jsx("br",{}),"Graduates"]}),l.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:c.map((ne,ae)=>{const ue=ae===0||c[ae-1].category!==ne.category,Q=re[ne.category],fe=ue?Q.count:0,ye=ne.is_subtotal||ne.category==="TOTAL",de=ye?"bg-gray-100 dark:bg-gray-700 font-semibold":"bg-white dark:bg-gray-800";return l.jsxs("tr",{className:`${de} hover:bg-gray-50 dark:hover:bg-gray-750`,children:[ue&&l.jsxs("td",{rowSpan:fe,className:"px-3 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-r border-gray-200 dark:border-gray-600 align-top",children:[ne.category,P(ne.category)&&l.jsx("button",{type:"button",onClick:()=>y(ne.category),className:"ml-2 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",title:"Add subcategory",children:l.jsx(ei,{className:"inline text-lg"})})]}),l.jsx("td",{className:"px-3 py-2 text-sm border-r border-gray-200 dark:border-gray-600",children:ye?l.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:ne.subcategory||"TOTAL"}):l.jsx("input",{type:"text",value:ne.subcategory||"",onChange:se=>p(ae,"subcategory",se.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Enter subcategory",readOnly:!P(ne.category)})}),["ay_2023_2024_enrollment","ay_2023_2024_graduates","ay_2022_2023_enrollment","ay_2022_2023_graduates","ay_2021_2022_enrollment","ay_2021_2022_graduates"].map(se=>l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600",children:l.jsx("input",{type:"number",value:ne[se]||0,onChange:me=>p(ae,se,me.target.value),className:`w-full px-2 py-1 text-sm text-center border border-gray-300 dark:border-gray-600 rounded ${ye?"bg-gray-100 dark:bg-gray-700 font-semibold cursor-not-allowed":"bg-white dark:bg-gray-800"} text-gray-900 dark:text-gray-100`,min:"0",readOnly:ye})},se)),l.jsx("td",{className:"px-2 py-2 text-sm text-center font-semibold border-r border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:R(ne)}),l.jsx("td",{className:"px-2 py-2 text-sm text-center font-semibold border-r border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:E(ne)}),l.jsx("td",{className:"px-2 py-2 text-sm text-center",children:D(ne)&&l.jsx("button",{type:"button",onClick:()=>w(ae),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",title:"Remove this row",children:l.jsx(Cm,{className:"inline text-lg"})})})]},ae)})})]})})},Z=I=>{const Y=d[I]||[];return l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:I}),l.jsxs("button",{type:"button",onClick:()=>v(I),className:"flex items-center gap-2 px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[l.jsx(ei,{className:"text-base"})," Add Service"]})]}),Y.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 border border-gray-200 dark:border-gray-700",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Category"}),l.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Institutional Services/Programs/Activities"}),l.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"No. of Beneficiaries/Participants"}),l.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Remarks"}),l.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Y.map((re,ne)=>l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-750",children:[l.jsx("td",{className:"px-3 py-2 text-sm border-r border-gray-200 dark:border-gray-600",children:l.jsx("input",{type:"text",value:re.category||"",onChange:ae=>S(I,ne,"category",ae.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Category"})}),l.jsx("td",{className:"px-3 py-2 text-sm border-r border-gray-200 dark:border-gray-600",children:l.jsx("input",{type:"text",value:re.institutional_services_programs_activities||"",onChange:ae=>S(I,ne,"institutional_services_programs_activities",ae.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Services/Programs/Activities"})}),l.jsx("td",{className:"px-3 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600",children:l.jsx("input",{type:"number",value:re.number_of_beneficiaries_participants||0,onChange:ae=>S(I,ne,"number_of_beneficiaries_participants",ae.target.value),className:"w-full px-2 py-1 text-sm text-center border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",min:"0"})}),l.jsx("td",{className:"px-3 py-2 text-sm border-r border-gray-200 dark:border-gray-600",children:l.jsx("input",{type:"text",value:re.remarks||"",onChange:ae=>S(I,ne,"remarks",ae.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Remarks"})}),l.jsx("td",{className:"px-3 py-2 text-sm text-center",children:l.jsx("button",{type:"button",onClick:()=>x(I,ne),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",title:"Remove this service",children:l.jsx(Cm,{className:"inline text-lg"})})})]},ne))})]})}):l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:'No services added yet. Click "Add Service" to add one.'})]})};return l.jsx(Ct,{title:"Submit Annex M",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"STUDENTS WITH SPECIAL NEEDS/PWD"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex M"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:n})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-m/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Table 1: Statistics"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Enrollment and graduate statistics across three academic years. Categories A and C have fixed subcategories. Categories B and D allow adding custom subcategories."})]}),H()]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Table 2: Services"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Institutional services, programs, and activities for each category of students with special needs."})]}),M0.map(I=>l.jsx("div",{children:Z(I)},I))]}),l.jsx(xs,{value:o,onChange:a}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-m/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:N,disabled:i,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),i?"Submitting...":"Submit Batch"]})]})]})})},zBe=Object.freeze(Object.defineProperty({__proto__:null,default:WBe},Symbol.toStringTag,{value:"Module"})),UBe=["A. Persons with Disabilities","B. Indigenous People","C. Dependents of Solo Parents / Solo Parents","D. Other students with special needs"],YBe=({batches:t})=>{const{showCancelModal:e,handleCancel:r,handleCancelConfirm:n,handleCancelClose:i}=Ss("annex-m"),[s,o]=$.useState({}),[a,c]=$.useState({}),u=async g=>{if(s[g])o(p=>({...p,[g]:!1}));else if(o(p=>({...p,[g]:!0})),!a[g])try{const y=await(await fetch(`/hei/annex-m/${g}/data`)).json();c(w=>({...w,[g]:y}))}catch(p){console.error("Failed to fetch batch data:",p)}},d=g=>(parseInt(g.ay_2023_2024_enrollment)||0)+(parseInt(g.ay_2022_2023_enrollment)||0)+(parseInt(g.ay_2021_2022_enrollment)||0),f=g=>(parseInt(g.ay_2023_2024_graduates)||0)+(parseInt(g.ay_2022_2023_graduates)||0)+(parseInt(g.ay_2021_2022_graduates)||0),h=g=>{if(!g||g.length===0)return null;let p=null,y=0;const w={};return g.forEach((v,x)=>{v.category!==p?(p!==null&&(w[p]={start:x-y,count:y}),p=v.category,y=1):y++}),p!==null&&(w[p]={start:g.length-y,count:y}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 border border-gray-200 dark:border-gray-700 text-sm",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Category"}),l.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Subcategory"}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2023-2024",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2023-2024",l.jsx("br",{}),"Graduates"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2022-2023",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2022-2023",l.jsx("br",{}),"Graduates"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2021-2022",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["AY 2021-2022",l.jsx("br",{}),"Graduates"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:["Total",l.jsx("br",{}),"Enrollment"]}),l.jsxs("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:["Total",l.jsx("br",{}),"Graduates"]})]})}),l.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:g.map((v,x)=>{const S=x===0||g[x-1].category!==v.category,N=w[v.category],R=S?N.count:0,P=v.is_subtotal||v.category==="TOTAL"?"bg-gray-100 dark:bg-gray-700 font-semibold":"bg-white dark:bg-gray-800";return l.jsxs("tr",{className:P,children:[S&&l.jsx("td",{rowSpan:R,className:"px-2 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-r border-gray-200 dark:border-gray-600 align-top",children:v.category}),l.jsx("td",{className:"px-2 py-2 text-sm border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:v.subcategory||"TOTAL"}),l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:v.ay_2023_2024_enrollment}),l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:v.ay_2023_2024_graduates}),l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:v.ay_2022_2023_enrollment}),l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:v.ay_2022_2023_graduates}),l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:v.ay_2021_2022_enrollment}),l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:v.ay_2021_2022_graduates}),l.jsx("td",{className:"px-2 py-2 text-sm text-center font-semibold border-r border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:d(v)}),l.jsx("td",{className:"px-2 py-2 text-sm text-center font-semibold bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:f(v)})]},x)})})]})})},m=g=>!g||g.length===0?null:l.jsx("div",{className:"space-y-4",children:UBe.map(p=>{const y=g.filter(w=>w.section===p);return y.length===0?null:l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:p}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 border border-gray-200 dark:border-gray-700 text-sm",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Category"}),l.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"Institutional Services/Programs/Activities"}),l.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider border-r border-gray-200 dark:border-gray-600",children:"No. of Beneficiaries/Participants"}),l.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Remarks"})]})}),l.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:y.map((w,v)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-2 py-2 text-sm border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:w.category||"-"}),l.jsx("td",{className:"px-2 py-2 text-sm border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:w.institutional_services_programs_activities}),l.jsx("td",{className:"px-2 py-2 text-sm text-center border-r border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:w.number_of_beneficiaries_participants}),l.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 dark:text-gray-100",children:w.remarks||"-"})]},v))})]})})]},p)})});return l.jsxs(Ct,{title:"Annex M History",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex M Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your submissions"})]}),l.jsxs(yt,{href:"/hei/annex-m/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex M data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-m/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(g=>{const p=g.status==="request",y=g.status==="published",w=s[g.batch_id],v=a[g.batch_id];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>u(g.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:w?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:g.academic_year}),l.jsx(Cs,{status:g.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[g.statistics_count," statistics | ",g.services_count," services"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(g.created_at)]}),p&&l.jsx("button",{onClick:()=>r(g.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),y&&l.jsx(yt,{href:`/hei/annex-m/${g.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),w&&v&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30 space-y-4",children:[g.request_notes&&l.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:g.request_notes})]}),g.cancelled_notes&&l.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:g.cancelled_notes})]}),v.statistics&&v.statistics.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Table 1: Statistics"}),h(v.statistics)]}),v.services&&v.services.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Table 2: Services"}),m(v.services)]})]})]},g.batch_id)})})]}),l.jsx(_i,{show:e,onClose:i,onConfirm:n})]})},GBe=Object.freeze(Object.defineProperty({__proto__:null,default:YBe},Symbol.toStringTag,{value:"Module"}));Yt();const KBe=({existingSubmission:t,activities:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({title_of_activity:y.title_of_activity,implementation_date:y.implementation_date?y.implementation_date.split("T")[0]:"",implementation_venue:y.implementation_venue,number_of_participants:y.number_of_participants,organizer:y.organizer,remarks:y.remarks})):[],[d,f]=$.useState(u),h=[{data:"title_of_activity",title:"Title of Activity",type:"text",width:300,placeholder:"Activity title"},{data:"implementation_date",title:"Implementation Date",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,width:150,placeholder:"YYYY-MM-DD"},{data:"implementation_venue",title:"Implementation Venue",type:"text",width:250,placeholder:"Venue"},{data:"number_of_participants",title:"Number of Participants",type:"numeric",width:150,placeholder:"0"},{data:"organizer",title:"Organizer",type:"text",width:200,placeholder:"Organizer"},{data:"remarks",title:"Remarks",type:"text",width:200,placeholder:"Remarks"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");N&&g(parseInt(N.dataset.row))},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const[N,R,E,P,D,H]=w[S];if(!(!N&&!R&&!E&&!P&&!D&&!H)){if(!N||!R||!E||P===null||!D){alert(`Row ${S+1}: Please fill in all required fields (Title, Date, Venue, Number of Participants, Organizer)`);return}v.push({title_of_activity:N,implementation_date:R,implementation_venue:E,number_of_participants:parseInt(P)||0,organizer:D,remarks:H||null})}}if(v.length===0){alert("Please add at least one activity to submit.");return}c(!0),lt.post("/hei/annex-n",{activities:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex N",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"CULTURE AND THE ARTS"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex N"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple culture and arts activities in the table below. You can submit them all at once as a batch."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-n/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Culture and Arts Activities"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple activities below. Each row represents one activity."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Activity"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-n/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},qBe=Object.freeze(Object.defineProperty({__proto__:null,default:KBe},Symbol.toStringTag,{value:"Module"}));Yt();const XBe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-n"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async h=>{if(o[h])a(m=>({...m,[h]:!1}));else if(a(m=>({...m,[h]:!0})),!c[h])try{const g=await(await fetch(`/hei/annex-n/${h}/activities`)).json();u(p=>({...p,[h]:g}))}catch(m){console.error("Failed to fetch activities:",m)}},f=[{data:"title_of_activity",title:"Title of Activity",type:"text",readOnly:!0,width:300},{data:"implementation_date",title:"Implementation Date",type:"date",dateFormat:"YYYY-MM-DD",readOnly:!0,width:150},{data:"implementation_venue",title:"Implementation Venue",type:"text",readOnly:!0,width:250},{data:"number_of_participants",title:"Number of Participants",type:"numeric",readOnly:!0,width:150},{data:"organizer",title:"Organizer",type:"text",readOnly:!0,width:200},{data:"remarks",title:"Remarks",type:"text",readOnly:!0,width:200}];return l.jsxs(Ct,{title:"Annex N History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex N Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-n/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex N data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-n/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=o[h.batch_id],y=c[h.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(h.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:p?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h.academic_year}),l.jsx(Cs,{status:h.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.activities_count," ",h.activities_count===1?"activity":"activities"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(h.created_at)]}),m&&l.jsx("button",{onClick:()=>n(h.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),g&&l.jsx(yt,{href:`/hei/annex-n/${h.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),p&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30",children:[h.request_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:h.request_notes})]}),h.cancelled_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:h.cancelled_notes})]}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:y,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]},h.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},QBe=Object.freeze(Object.defineProperty({__proto__:null,default:XBe},Symbol.toStringTag,{value:"Module"}));Yt();const JBe=({existingSubmission:t,programs:e})=>{const r=`${St}-${St+1}`,n=$.useRef(null),i=or(),[s,o]=$.useState(""),[a,c]=$.useState(!1),u=e&&e.length>0?e.map(y=>({title_of_program:y.title_of_program,date_conducted:y.date_conducted?y.date_conducted.split("T")[0]:"",number_of_beneficiaries:y.number_of_beneficiaries,type_of_community_service:y.type_of_community_service,community_population_served:y.community_population_served})):[],[d,f]=$.useState(u),h=[{data:"title_of_program",title:"Title of Program",type:"text",width:300,placeholder:"Program title"},{data:"date_conducted",title:"Date Conducted",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,width:150,placeholder:"YYYY-MM-DD"},{data:"number_of_beneficiaries",title:"Number of Beneficiaries",type:"numeric",width:150,placeholder:"0"},{data:"type_of_community_service",title:"Type of Community Service",type:"text",width:250,placeholder:"Service type"},{data:"community_population_served",title:"Community Population Served",type:"text",width:250,placeholder:"Population served"},{data:"actions",title:"Actions",type:"text",readOnly:!0,width:60,renderer:function(y,w,v){return w.innerHTML='<button class="delete-row-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-row="'+v+'" title="Delete this row" style="padding:0;margin:0;border:none;background:none;cursor:pointer;line-height:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%;"><svg style="width:16px;height:16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>',w.className="htCenter htMiddle",w.style.cssText="padding:0;vertical-align:middle;overflow:hidden;",w}}],m=()=>{var w;const y=(w=n.current)==null?void 0:w.hotInstance;y&&y.alter("insert_row_below",y.countRows())},g=y=>{var w;if(confirm("Are you sure you want to delete this row?")){const v=(w=n.current)==null?void 0:w.hotInstance;v&&v.alter("remove_row",y)}};$.useEffect(()=>{var v,x;const y=S=>{const N=S.target.closest(".delete-row-btn");N&&g(parseInt(N.dataset.row))},w=(x=(v=n.current)==null?void 0:v.hotInstance)==null?void 0:x.rootElement;if(w)return w.addEventListener("click",y),()=>w.removeEventListener("click",y)},[d]);const p=()=>{var x;const y=(x=n.current)==null?void 0:x.hotInstance;if(!y)return;const w=y.getData(),v=[];for(let S=0;S<w.length;S++){const[N,R,E,P,D]=w[S];if(!(!N&&!R&&!E&&!P&&!D)){if(!N||!R||E===null||!P||!D){alert(`Row ${S+1}: Please fill in all required fields`);return}v.push({title_of_program:N,date_conducted:R,number_of_beneficiaries:parseInt(E)||0,type_of_community_service:P,community_population_served:D})}}if(v.length===0){alert("Please add at least one program to submit.");return}c(!0),lt.post("/hei/annex-o",{programs:v,request_notes:s},{onFinish:()=>c(!1)})};return l.jsxs(Ct,{title:"Submit Annex O",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"COMMUNITY INVOLVEMENT/OUTREACH PROGRAMS"}),l.jsx("span",{className:"text-xl font-semibold text-gray-500 dark:text-gray-400",children:"Annex O"})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r})]})]}),t&&l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. Submitting will replace your previous submission."}),l.jsx(Et,{type:"info",message:"Add multiple community programs in the table below. You can submit them all at once as a batch."}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year. To make changes, go to History and view your submission."}),l.jsx("a",{href:"/hei/annex-o/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Community Programs"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Add multiple community programs below. Each row represents one program."})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsx(xt,{ref:n,data:d,colHeaders:!0,rowHeaders:!0,columns:h,height:"auto",minRows:1,licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,manualColumnResize:!0,contextMenu:["row_above","row_below","undo","redo","copy","cut"],className:i?"dark-table":""})}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(ei,{className:"text-lg"}),"Add Another Program"]})]}),l.jsx(xs,{value:s,onChange:o}),l.jsxs("div",{className:"flex justify-end gap-4",children:[l.jsx("button",{type:"button",onClick:()=>lt.visit("/hei/annex-o/history"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),l.jsxs("button",{type:"button",onClick:p,disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(zi,{className:"text-lg"}),a?"Submitting...":"Submit Batch"]})]})]})]})},ZBe=Object.freeze(Object.defineProperty({__proto__:null,default:JBe},Symbol.toStringTag,{value:"Module"}));Yt();const eWe=({batches:t})=>{const e=or(),{showCancelModal:r,handleCancel:n,handleCancelConfirm:i,handleCancelClose:s}=Ss("annex-o"),[o,a]=$.useState({}),[c,u]=$.useState({}),d=async h=>{if(o[h])a(m=>({...m,[h]:!1}));else if(a(m=>({...m,[h]:!0})),!c[h])try{const g=await(await fetch(`/hei/annex-o/${h}/programs`)).json();u(p=>({...p,[h]:g}))}catch(m){console.error("Failed to fetch programs:",m)}},f=[{data:"title_of_program",title:"Title of Program",type:"text",readOnly:!0,width:300},{data:"date_conducted",title:"Date Conducted",type:"date",dateFormat:"YYYY-MM-DD",readOnly:!0,width:150},{data:"number_of_beneficiaries",title:"Number of Beneficiaries",type:"numeric",readOnly:!0,width:150},{data:"type_of_community_service",title:"Type of Community Service",type:"text",readOnly:!0,width:250},{data:"community_population_served",title:"Community Population Served",type:"text",readOnly:!0,width:250}];return l.jsxs(Ct,{title:"Annex O History",children:[l.jsx("style",{children:ar}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Annex O Submission History"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage your batch submissions"})]}),l.jsxs(yt,{href:"/hei/annex-o/submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-lg hover:shadow-xl",children:[l.jsx(pt,{className:"text-xl"}),"New Batch Submission"]})]}),t.length===0?l.jsx(_s,{title:"No Submissions Yet",message:"You haven't submitted any Annex O data yet.",buttonText:"Create Your First Submission",buttonHref:"/hei/annex-o/submit"}):l.jsx("div",{className:"space-y-2",children:t.map(h=>{const m=h.status==="request",g=h.status==="published",p=o[h.batch_id],y=c[h.batch_id]||[];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 overflow-hidden",children:[l.jsx("div",{className:"border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50",children:l.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>d(h.batch_id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:p?l.jsx(ri,{className:"text-gray-600 dark:text-gray-300"}):l.jsx(ni,{className:"text-gray-600 dark:text-gray-300"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h.academic_year}),l.jsx(Cs,{status:h.status}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.programs_count," ",h.programs_count===1?"program":"programs"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",an(h.created_at)]}),m&&l.jsx("button",{onClick:()=>n(h.batch_id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Cancel Request"}),g&&l.jsx(yt,{href:`/hei/annex-o/${h.batch_id}/edit`,className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:"Request Update"})]})]})}),p&&l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/30",children:[h.request_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-300 mb-1",children:"Request Notes:"}),l.jsx("p",{className:"text-sm text-yellow-900 dark:text-yellow-100",children:h.request_notes})]}),h.cancelled_notes&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded",children:[l.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-300 mb-1",children:"Cancellation Notes:"}),l.jsx("p",{className:"text-sm text-red-900 dark:text-red-100",children:h.cancelled_notes})]}),l.jsx("div",{className:"overflow-auto",children:l.jsx(xt,{data:y,colHeaders:!0,rowHeaders:!0,columns:f,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:e?"dark-table":""})})]})]},h.batch_id)})})]}),l.jsx(_i,{show:r,onClose:s,onConfirm:i})]})},tWe=Object.freeze(Object.defineProperty({__proto__:null,default:eWe},Symbol.toStringTag,{value:"Module"})),rWe=({stats:t,currentYearSubmission:e,notificationCount:r})=>l.jsx(Ct,{title:"HEI Dashboard",notificationCount:r,children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"HEI Dashboard"}),!e&&l.jsx(Et,{type:"warning",title:"Annual Submission Required",message:`You have not submitted data for ${St}. Please submit your data as soon as possible.`}),(e==null?void 0:e.status)==="submitted"&&l.jsx(Et,{type:"info",title:"Submission Pending Review",message:"Your submission is currently under review by CHED administrators."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsx(ma,{title:"Total Submissions",value:(t==null?void 0:t.total_submissions)||0,icon:l.jsx(ba,{}),color:"blue"}),l.jsx(ma,{title:"Approved Submissions",value:(t==null?void 0:t.approved_submissions)||0,icon:l.jsx(rr,{}),color:"green"}),l.jsx(ma,{title:"Pending Requests",value:(t==null?void 0:t.pending_overwrites)||0,icon:l.jsx(Ln,{}),color:"yellow"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("a",{href:"/hei/submission/create",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Submit Data"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Submit your annual data"})]}),l.jsxs("a",{href:"/hei/submission/history",className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"View History"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"View past submissions"})]})]})]})]})}),nWe=Object.freeze(Object.defineProperty({__proto__:null,default:rWe},Symbol.toStringTag,{value:"Module"})),iWe=({hei:t})=>{const{data:e,setData:r,put:n,processing:i,errors:s}=Oo({name:t.name||"",email:t.email||"",type:t.type||""}),o=a=>{a.preventDefault(),n("/hei/profile")};return l.jsx(Ct,{title:"Profile",children:l.jsxs("div",{className:"max-w-2xl",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"HEI Profile"}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:l.jsxs("form",{onSubmit:o,className:"space-y-6",children:[l.jsx(qt,{label:"HEI Name",name:"name",value:e.name,onChange:a=>r("name",a.target.value),error:s.name,disabled:!0}),l.jsx(qt,{label:"Email Address",name:"email",type:"email",value:e.email,onChange:a=>r("email",a.target.value),error:s.email,required:!0}),l.jsx(qt,{label:"HEI Type",name:"type",value:e.type,onChange:a=>r("type",a.target.value),error:s.type,disabled:!0}),l.jsxs("div",{className:"flex justify-end gap-4 border-t border-gray-200 dark:border-gray-700 pt-6",children:[l.jsx("a",{href:"/change-password",className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Change Password"}),l.jsx("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Updating...":"Update Profile"})]})]})})]})})},sWe=Object.freeze(Object.defineProperty({__proto__:null,default:iWe},Symbol.toStringTag,{value:"Module"})),LK=({label:t,name:e,values:r=[],onChange:n,error:i=null,placeholder:s="",required:o=!1,disabled:a=!1,className:c="",type:u="text"})=>{const d=()=>{n([...r,""])},f=m=>{const g=r.filter((p,y)=>y!==m);n(g)},h=(m,g)=>{const p=[...r];p[m]=g,n(p)};return l.jsxs("div",{className:c,children:[t&&l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t,o&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsxs("div",{className:"space-y-2",children:[r.map((m,g)=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:u,name:`${e}[${g}]`,value:m,onChange:p=>h(g,p.target.value),placeholder:s,disabled:a,className:`flex-1 px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 ${i?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} ${a?"bg-gray-100 dark:bg-gray-800 cursor-not-allowed":""}`}),l.jsx("button",{type:"button",onClick:()=>f(g),disabled:a,className:"px-3 py-2 h-full border border-red-300 dark:border-red-600 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Remove",children:l.jsx(AW,{size:20})})]},g)),l.jsxs("button",{type:"button",onClick:d,disabled:a,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[l.jsx(rte,{size:20}),l.jsxs("span",{children:["Add ",t]})]})]}),i&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:i})]})},oWe=({existingSubmission:t,editableSubmission:e,submission:r,isEditing:n})=>{const i=`${St}-${St+1}`,{data:s,setData:o,post:a,put:c,processing:u,errors:d}=Oo({population_male:(r==null?void 0:r.population_male)||"",population_female:(r==null?void 0:r.population_female)||"",population_intersex:(r==null?void 0:r.population_intersex)||"",population_total:(r==null?void 0:r.population_total)||0,submitted_org_chart:(r==null?void 0:r.submitted_org_chart)||"",hei_website:(r==null?void 0:r.hei_website)||"",sas_website:(r==null?void 0:r.sas_website)||"",social_media_contacts:(r==null?void 0:r.social_media_contacts)||[""],student_handbook:(r==null?void 0:r.student_handbook)||"",student_publication:(r==null?void 0:r.student_publication)||"",request_notes:(r==null?void 0:r.request_notes)||""});$.useEffect(()=>{const h=parseInt(s.population_male)||0,m=parseInt(s.population_female)||0,g=parseInt(s.population_intersex)||0,p=h+m+g;o("population_total",p)},[s.population_male,s.population_female,s.population_intersex]);const f=h=>{h.preventDefault(),n?c(`/hei/submission/${r.id}`):a("/hei/submission")};return l.jsx(Ct,{title:n?"Edit Submission":"Submit Summary",children:l.jsxs("div",{className:"max-w-3xl",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:n?"Edit Annual Summary":"Submit Annual Summary"}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:i})]}),t&&l.jsx("div",{className:"mb-6",children:l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. To make changes, go to Submission History and request an edit."})}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year."}),l.jsxs("div",{className:"flex flex-col gap-3",children:[e&&l.jsx("a",{href:`/hei/submission/${e.id}/edit`,className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors",children:"Edit Submission"}),l.jsx("a",{href:"/hei/submission/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})]})}),l.jsx(Et,{type:"info",message:n?"You are editing a previous submission. Changes will be submitted for admin approval before becoming the official record.":"Please provide the following information for the current academic year. Data submitted here will be locked after submission. To edit, you will need to request an overwrite which requires admin approval."}),l.jsxs("form",{onSubmit:f,className:"space-y-8 mt-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-blue-500 dark:border-blue-400",children:[l.jsx(F1,{className:"text-2xl text-blue-600 dark:text-blue-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Student Population (First Semester)"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx($W,{className:"text-xl text-blue-500"}),l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Male ",l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),l.jsx("input",{type:"number",name:"population_male",value:s.population_male,onChange:h=>o("population_male",h.target.value),required:!0,placeholder:"0",className:`w-full px-4 py-2 border-2 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 border-blue-300 dark:border-blue-600 ${d.population_male?"border-red-500 dark:border-red-500":""}`}),d.population_male&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.population_male})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(OW,{className:"text-xl text-pink-500"}),l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Female ",l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),l.jsx("input",{type:"number",name:"population_female",value:s.population_female,onChange:h=>o("population_female",h.target.value),required:!0,placeholder:"0",className:`w-full px-4 py-2 border-2 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-pink-500 border-pink-300 dark:border-pink-600 ${d.population_female?"border-red-500 dark:border-red-500":""}`}),d.population_female&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.population_female})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(HW,{className:"text-xl text-purple-500"}),l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Intersex ",l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),l.jsx("input",{type:"number",name:"population_intersex",value:s.population_intersex,onChange:h=>o("population_intersex",h.target.value),required:!0,placeholder:"0",className:`w-full px-4 py-2 border-2 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 border-purple-300 dark:border-purple-600 ${d.population_intersex?"border-red-500 dark:border-red-500":""}`}),d.population_intersex&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.population_intersex})]})]}),l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-pink-50 dark:from-blue-900/20 dark:to-pink-900/20 rounded-lg p-4 border-2 border-blue-200 dark:border-blue-700",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(PW,{className:"text-2xl text-blue-600 dark:text-blue-400"}),l.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Total Population"})]}),l.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:s.population_total.toLocaleString()})]})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-green-500 dark:border-green-400",children:[l.jsx(ba,{className:"text-2xl text-green-600 dark:text-green-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Organizational Information"})]}),l.jsx(V1,{label:"Submitted Organization Chart/Structure",name:"submitted_org_chart",value:s.submitted_org_chart,onChange:h=>o("submitted_org_chart",h.target.value),options:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],error:d.submitted_org_chart,required:!0,placeholder:"Select an option"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-purple-500 dark:border-purple-400",children:[l.jsx(IW,{className:"text-2xl text-purple-600 dark:text-purple-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Contact Information"})]}),l.jsx(qt,{label:"HEI Website",name:"hei_website",type:"url",value:s.hei_website,onChange:h=>o("hei_website",h.target.value),error:d.hei_website,placeholder:"https://example.edu.ph"}),l.jsx(qt,{label:"SAS Website",name:"sas_website",type:"url",value:s.sas_website,onChange:h=>o("sas_website",h.target.value),error:d.sas_website,placeholder:"https://sas.example.edu.ph (if applicable)"}),l.jsx(LK,{label:"Social Media/Email Contacts",name:"social_media_contacts",values:s.social_media_contacts,onChange:h=>o("social_media_contacts",h),error:d.social_media_contacts,placeholder:"e.g., facebook.com/yourpage, contact@example.edu.ph"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-orange-500 dark:border-orange-400",children:[l.jsx(TW,{className:"text-2xl text-orange-600 dark:text-orange-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Student Resources"})]}),l.jsx(qt,{label:"Student Handbook/Manual Edition/Date",name:"student_handbook",type:"text",value:s.student_handbook,onChange:h=>o("student_handbook",h.target.value),error:d.student_handbook,placeholder:'e.g., "2026 Edition", "January 2026", "Ongoing for revisions" (if applicable)'}),l.jsx(qt,{label:"Title of Student Publication",name:"student_publication",type:"text",value:s.student_publication,onChange:h=>o("student_publication",h.target.value),error:d.student_publication,placeholder:"e.g., The Campus Herald (if applicable)"})]}),n&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-blue-500 dark:border-blue-400",children:[l.jsx(ba,{className:"text-2xl text-blue-600 dark:text-blue-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Request Notes (Optional)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes for this update request"}),l.jsx("textarea",{name:"request_notes",value:s.request_notes,onChange:h=>o("request_notes",h.target.value),rows:4,maxLength:1e3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Optional: Provide context or reasons for this update request (max 1000 characters)"}),d.request_notes&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.request_notes}),l.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:[s.request_notes.length,"/1000 characters"]})]})]}),l.jsxs("div",{className:"flex justify-end gap-4 border-t border-gray-200 dark:border-gray-700 pt-6",children:[l.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:u||t,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Submitting...":n?"Request Update":"Submit Summary"})]})]})]})]})})},aWe=Object.freeze(Object.defineProperty({__proto__:null,default:oWe},Symbol.toStringTag,{value:"Module"})),lWe=({existingSubmission:t,editableSubmission:e,submission:r,isEditing:n})=>{const i=`${St}-${St+1}`,{data:s,setData:o,post:a,put:c,processing:u,errors:d}=Oo({population_male:(r==null?void 0:r.population_male)||"",population_female:(r==null?void 0:r.population_female)||"",population_intersex:(r==null?void 0:r.population_intersex)||"",population_total:(r==null?void 0:r.population_total)||0,submitted_org_chart:(r==null?void 0:r.submitted_org_chart)||"",hei_website:(r==null?void 0:r.hei_website)||"",sas_website:(r==null?void 0:r.sas_website)||"",social_media_contacts:(r==null?void 0:r.social_media_contacts)||[""],student_handbook:(r==null?void 0:r.student_handbook)||"",student_publication:(r==null?void 0:r.student_publication)||"",request_notes:(r==null?void 0:r.request_notes)||""});$.useEffect(()=>{const h=parseInt(s.population_male)||0,m=parseInt(s.population_female)||0,g=parseInt(s.population_intersex)||0,p=h+m+g;o("population_total",p)},[s.population_male,s.population_female,s.population_intersex]);const f=h=>{h.preventDefault(),n?c(`/hei/submission/${r.id}`):a("/hei/submission")};return l.jsx(Ct,{title:n?"Edit Submission":"Submit Details",children:l.jsxs("div",{className:"max-w-3xl",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:n?"Edit Annual Details":"Submit Annual Details"}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Academic Year: ",l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:i})]}),t&&l.jsx("div",{className:"mb-6",children:l.jsx(Et,{type:"warning",title:"Submission Already Exists",message:"You have already submitted data for this year. To make changes, go to Submission History and request an edit."})}),l.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[t&&l.jsx("div",{className:"absolute inset-0 bg-gray-900/50 dark:bg-gray-950/70 backdrop-blur-sm rounded-lg z-10 flex items-center justify-center",children:l.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-orange-500 max-w-md",children:[l.jsx("div",{className:"text-orange-600 dark:text-orange-400 mb-4",children:l.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Locked"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You have already submitted data for this academic year."}),l.jsxs("div",{className:"flex flex-col gap-3",children:[e&&l.jsx("a",{href:`/hei/submission/${e.id}/edit`,className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors",children:"Edit Submission"}),l.jsx("a",{href:"/hei/submission/history",className:"inline-block px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium transition-colors",children:"Go to Submission History"})]})]})}),l.jsx(Et,{type:"info",message:n?"You are editing a previous submission. Changes will be submitted for admin approval before becoming the official record.":"Please provide the following information for the current academic year. Data submitted here will be locked after submission. To edit, you will need to request an overwrite which requires admin approval."}),l.jsxs("form",{onSubmit:f,className:"space-y-8 mt-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-blue-500 dark:border-blue-400",children:[l.jsx(F1,{className:"text-2xl text-blue-600 dark:text-blue-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Student Population (First Semester)"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx($W,{className:"text-xl text-blue-500"}),l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Male ",l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),l.jsx("input",{type:"number",name:"population_male",value:s.population_male,onChange:h=>o("population_male",h.target.value),required:!0,placeholder:"0",className:`w-full px-4 py-2 border-2 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 border-blue-300 dark:border-blue-600 ${d.population_male?"border-red-500 dark:border-red-500":""}`}),d.population_male&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.population_male})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(OW,{className:"text-xl text-pink-500"}),l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Female ",l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),l.jsx("input",{type:"number",name:"population_female",value:s.population_female,onChange:h=>o("population_female",h.target.value),required:!0,placeholder:"0",className:`w-full px-4 py-2 border-2 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-pink-500 border-pink-300 dark:border-pink-600 ${d.population_female?"border-red-500 dark:border-red-500":""}`}),d.population_female&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.population_female})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(HW,{className:"text-xl text-purple-500"}),l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Intersex ",l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),l.jsx("input",{type:"number",name:"population_intersex",value:s.population_intersex,onChange:h=>o("population_intersex",h.target.value),required:!0,placeholder:"0",className:`w-full px-4 py-2 border-2 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 border-purple-300 dark:border-purple-600 ${d.population_intersex?"border-red-500 dark:border-red-500":""}`}),d.population_intersex&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.population_intersex})]})]}),l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-pink-50 dark:from-blue-900/20 dark:to-pink-900/20 rounded-lg p-4 border-2 border-blue-200 dark:border-blue-700",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(PW,{className:"text-2xl text-blue-600 dark:text-blue-400"}),l.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Total Population"})]}),l.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:s.population_total.toLocaleString()})]})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-green-500 dark:border-green-400",children:[l.jsx(ba,{className:"text-2xl text-green-600 dark:text-green-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Organizational Information"})]}),l.jsx(V1,{label:"Submitted Organization Chart/Structure",name:"submitted_org_chart",value:s.submitted_org_chart,onChange:h=>o("submitted_org_chart",h.target.value),options:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],error:d.submitted_org_chart,required:!0,placeholder:"Select an option"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-purple-500 dark:border-purple-400",children:[l.jsx(IW,{className:"text-2xl text-purple-600 dark:text-purple-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Contact Information"})]}),l.jsx(qt,{label:"HEI Website",name:"hei_website",type:"url",value:s.hei_website,onChange:h=>o("hei_website",h.target.value),error:d.hei_website,placeholder:"https://example.edu.ph"}),l.jsx(qt,{label:"SAS Website",name:"sas_website",type:"url",value:s.sas_website,onChange:h=>o("sas_website",h.target.value),error:d.sas_website,placeholder:"https://sas.example.edu.ph (if applicable)"}),l.jsx(LK,{label:"Social Media/Email Contacts",name:"social_media_contacts",values:s.social_media_contacts,onChange:h=>o("social_media_contacts",h),error:d.social_media_contacts,placeholder:"e.g., facebook.com/yourpage, contact@example.edu.ph"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-orange-500 dark:border-orange-400",children:[l.jsx(TW,{className:"text-2xl text-orange-600 dark:text-orange-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Student Resources"})]}),l.jsx(qt,{label:"Student Handbook/Manual Edition/Date",name:"student_handbook",type:"text",value:s.student_handbook,onChange:h=>o("student_handbook",h.target.value),error:d.student_handbook,placeholder:'e.g., "2026 Edition", "January 2026", "Ongoing for revisions" (if applicable)'}),l.jsx(qt,{label:"Title of Student Publication",name:"student_publication",type:"text",value:s.student_publication,onChange:h=>o("student_publication",h.target.value),error:d.student_publication,placeholder:"e.g., The Campus Herald (if applicable)"})]}),n&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b-2 border-blue-500 dark:border-blue-400",children:[l.jsx(ba,{className:"text-2xl text-blue-600 dark:text-blue-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Request Notes (Optional)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes for this update request"}),l.jsx("textarea",{name:"request_notes",value:s.request_notes,onChange:h=>o("request_notes",h.target.value),rows:4,maxLength:1e3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Optional: Provide context or reasons for this update request (max 1000 characters)"}),d.request_notes&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.request_notes}),l.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:[s.request_notes.length,"/1000 characters"]})]})]}),l.jsxs("div",{className:"flex justify-end gap-4 border-t border-gray-200 dark:border-gray-700 pt-6",children:[l.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:u||t,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Submitting...":n?"Request Update":"Submit Details"})]})]})]})]})})},cWe=Object.freeze(Object.defineProperty({__proto__:null,default:lWe},Symbol.toStringTag,{value:"Module"}));Yt();const uWe=({submissions:t})=>{const e=$.useRef(null),[r,n]=$.useState(!1),[i,s]=$.useState(!1),[o,a]=$.useState(null);$.useEffect(()=>{const m=()=>{n(document.documentElement.classList.contains("dark"))};m();const g=new MutationObserver(m);return g.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>g.disconnect()},[]);const c=m=>{lt.visit(`/hei/submission/${m}/edit`)},u=m=>{a(m),s(!0)},d=(m,g)=>{lt.post(`/hei/submission/${m}/cancel`,{cancelled_notes:g}),s(!1),a(null)},f=()=>{s(!1),a(null)},h=[{data:"academic_year",title:"Academic Year",readOnly:!0,width:120,className:"htCenter htMiddle"},{data:"population_male",title:"Male",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(m,g,p,y,w,v)=>(g.innerHTML=(v||0).toLocaleString(),g.className="htRight htMiddle",g.style.color=r?"#60a5fa":"#2563eb",g)},{data:"population_female",title:"Female",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(m,g,p,y,w,v)=>(g.innerHTML=(v||0).toLocaleString(),g.className="htRight htMiddle",g.style.color=r?"#f472b6":"#db2777",g)},{data:"population_intersex",title:"Intersex",readOnly:!0,width:80,className:"htRight htMiddle",renderer:(m,g,p,y,w,v)=>(g.innerHTML=(v||0).toLocaleString(),g.className="htRight htMiddle",g.style.color=r?"#c084fc":"#9333ea",g)},{data:"population_total",title:"Total",readOnly:!0,width:100,className:"htRight htMiddle",renderer:(m,g,p,y,w,v)=>(g.innerHTML=`<strong>${(v||0).toLocaleString()}</strong>`,g.className="htRight htMiddle",g.style.fontWeight="bold",g)},{data:"submitted_org_chart",title:"Org Chart",readOnly:!0,width:90,className:"htCenter htMiddle",renderer:(m,g,p,y,w,v)=>{const x=v==="yes"?`<span class="px-2 py-1 rounded text-xs ${r?"bg-green-900 text-green-300":"bg-green-100 text-green-800"}">Yes</span>`:`<span class="px-2 py-1 rounded text-xs ${r?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800"}">No</span>`;return g.innerHTML=x,g.className="htCenter htMiddle",g}},{data:"hei_website",title:"HEI Website",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(m,g,p,y,w,v)=>(v?g.innerHTML=`<a href="${v}" target="_blank" class="${r?"text-blue-400":"text-blue-600"} hover:underline">${v.substring(0,30)}...</a>`:g.innerHTML=`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,g.className="htLeft htMiddle",g)},{data:"sas_website",title:"SAS Website",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(m,g,p,y,w,v)=>(v?g.innerHTML=`<a href="${v}" target="_blank" class="${r?"text-blue-400":"text-blue-600"} hover:underline">${v.substring(0,30)}...</a>`:g.innerHTML=`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,g.className="htLeft htMiddle",g)},{data:"student_handbook",title:"Handbook",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(m,g,p,y,w,v)=>(g.innerHTML=v||`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,g.className="htLeft htMiddle",g)},{data:"student_publication",title:"Publication",readOnly:!0,width:150,className:"htLeft htMiddle",renderer:(m,g,p,y,w,v)=>(g.innerHTML=v||`<span class="${r?"text-gray-500":"text-gray-400"}">-</span>`,g.className="htLeft htMiddle",g)},{data:"status",title:"Status",readOnly:!0,width:100,className:"htCenter htMiddle",renderer:(m,g,p,y,w,v)=>{const S={submitted:r?"bg-green-900 text-green-300":"bg-green-100 text-green-800",request:r?"bg-blue-900 text-blue-300":"bg-blue-100 text-blue-800",overwritten:r?"bg-yellow-900 text-yellow-300":"bg-yellow-100 text-yellow-800",rejected:r?"bg-red-900 text-red-300":"bg-red-100 text-red-800",cancelled:r?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-700"}[v]||(r?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800");return g.innerHTML=`<span class="px-2 py-1 rounded-full text-xs font-semibold ${S}">${v}</span>`,g.className="htCenter htMiddle",g}},{data:"request_notes",title:"Request Notes",readOnly:!0,width:200,className:"htLeft htMiddle",renderer:(m,g,p,y,w,v)=>{if(v){const x=v.length>100?v.substring(0,100)+"...":v;g.innerHTML=`<span class="${r?"text-gray-300":"text-gray-700"}" title="${v.replace(/"/g,"&quot;")}">${x}</span>`}else g.innerHTML=`<span class="${r?"text-gray-600":"text-gray-400"}">-</span>`;return g.className="htLeft htMiddle",g}},{data:"created_at",title:"Submitted At",readOnly:!0,width:160,className:"htCenter htMiddle",renderer:(m,g,p,y,w,v)=>(g.innerHTML=an(v),g.className="htCenter htMiddle",g)},{data:"id",title:"Actions",readOnly:!0,width:100,className:"htCenter htMiddle",renderer:(m,g,p,y,w,v)=>{const x=t[p],S=x.status==="submitted"||x.status==="request",N=x.status==="request";return g.innerHTML=`
          <div class="flex gap-2 justify-center items-center">
            ${S?`
              <button
                class="edit-btn ${r?"text-orange-400 hover:text-orange-300":"text-orange-600 hover:text-orange-800"}"
                data-id="${v}"
                title="Edit Submission"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </button>
            `:`
              <span class="${r?"text-gray-600":"text-gray-400"}" title="Cannot edit">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
              </span>
            `}
            ${N?`
              <button
                class="cancel-btn ${r?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-800"}"
                data-id="${v}"
                title="Cancel Request"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            `:""}
          </div>
        `,g.className="htCenter htMiddle",g}}];return $.useEffect(()=>{var p,y;const m=w=>{const v=w.target.closest(".edit-btn"),x=w.target.closest(".cancel-btn");if(v){const S=v.dataset.id;c(S)}else if(x){const S=x.dataset.id;u(S)}},g=(y=(p=e.current)==null?void 0:p.hotInstance)==null?void 0:y.rootElement;if(g)return g.addEventListener("click",m),()=>g.removeEventListener("click",m)},[t]),l.jsxs(Ct,{title:"Submission History",children:[l.jsx("style",{children:`
        .handsontable td,
        .handsontable th {
          white-space: nowrap !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          max-height: 50px !important;
          vertical-align: middle !important;
        }

        .handsontable .htMiddle {
          vertical-align: middle !important;
        }

        ${r?`
          .handsontable {
            color: #e5e7eb !important;
          }
          .handsontable th {
            background-color: #374151 !important;
            color: #f3f4f6 !important;
            border-color: #4b5563 !important;
          }
          .handsontable td {
            background-color: #1f2937 !important;
            border-color: #374151 !important;
            color: #e5e7eb !important;
          }
          .handsontable td.area {
            background-color: #111827 !important;
          }
          .ht_clone_top th,
          .ht_clone_left th {
            background-color: #374151 !important;
          }
          .handsontable .htDimmed {
            color: #9ca3af !important;
          }
        `:""}
      `}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Submission History"}),l.jsx(yt,{href:"/hei/submission/create",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"New Submission"})]}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:t&&t.length>0?l.jsx(xt,{ref:e,data:t,columns:h,colHeaders:!0,rowHeaders:!0,width:"100%",height:600,rowHeights:50,licenseKey:"non-commercial-and-evaluation",className:"htCenter htMiddle",stretchH:"all"}):l.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No submissions found. Start by submitting your first data."})})]}),l.jsx(_i,{isOpen:i,onClose:f,onConfirm:d,submissionId:o})]})},dWe=Object.freeze(Object.defineProperty({__proto__:null,default:uWe},Symbol.toStringTag,{value:"Module"})),hWe=({user:t})=>{const{data:e,setData:r,put:n,processing:i,errors:s}=Oo({name:t.name||"",email:t.email||""}),o=a=>{a.preventDefault(),n("/profile")};return l.jsx(Tv,{title:"Profile Settings",children:l.jsxs("div",{className:"max-w-2xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Profile Settings"}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:l.jsxs("form",{onSubmit:o,className:"space-y-6",children:[l.jsx(qt,{label:"Name",name:"name",value:e.name,onChange:a=>r("name",a.target.value),error:s.name,required:!0}),l.jsx(qt,{label:"Email Address",name:"email",type:"email",value:e.email,onChange:a=>r("email",a.target.value),error:s.email,required:!0}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[l.jsx("strong",{children:"Account Type:"})," ",t.account_type]})}),l.jsxs("div",{className:"flex justify-end gap-4 border-t border-gray-200 dark:border-gray-700 pt-6",children:[l.jsx("a",{href:"/change-password",className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Change Password"}),l.jsx("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Updating...":"Update Profile"})]})]})})]})})},fWe=Object.freeze(Object.defineProperty({__proto__:null,default:hWe},Symbol.toStringTag,{value:"Module"})),rR=({title:t,children:e})=>{const r=[{href:"/superadmin/dashboard",label:"Dashboard",icon:l.jsx(EA,{})},{href:"/superadmin/admin-management",label:"Admin Management",icon:l.jsx(F1,{})},{href:"/superadmin/system-audit-logs",label:"System Audit Logs",icon:l.jsx(pt,{})},{href:"/superadmin/settings",label:"Settings",icon:l.jsx(ote,{})}];return l.jsx(TA,{permission:fn.MANAGE_ADMINS,children:l.jsx(Tv,{title:t,children:l.jsxs("div",{className:"flex",children:[l.jsx(kA,{links:r}),l.jsx("div",{className:"flex-1 p-6",children:e})]})})})},gWe=({admins:t=[]})=>{const[e,r]=$.useState(!1),[n,i]=$.useState(!1),[s,o]=$.useState(null),[a,c]=$.useState(null),[u,d]=$.useState(!1),[f,h]=$.useState(!1),{data:m,setData:g,post:p,put:y,delete:w,processing:v,errors:x,reset:S}=Oo({name:"",email:"",password:"",password_confirmation:"",is_active:!0}),N=D=>{D.preventDefault(),n&&s?y(`/superadmin/admins/${s.id}`,{onSuccess:()=>{r(!1),i(!1),o(null),S()}}):p("/superadmin/admins",{onSuccess:()=>{r(!1),S()}})},R=D=>{o(D),i(!0),g({name:D.name,email:D.email,password:"",password_confirmation:"",is_active:D.is_active}),r(!0)},E=D=>{w(`/superadmin/admins/${D}`,{onSuccess:()=>{c(null)}})},P=()=>{i(!1),o(null),S(),r(!0)};return l.jsx(rR,{title:"Admin Management",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Admin Management"}),l.jsx("button",{onClick:P,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add New Admin"})]}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700",children:l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Name"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Email"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Status"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Created Date"}),l.jsx("th",{className:"text-left py-3 px-4 text-gray-700 dark:text-gray-300 font-semibold",children:"Actions"})]})}),l.jsx("tbody",{children:t.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:"5",className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No administrators found"})}):t.map(D=>l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[l.jsx("td",{className:"py-3 px-4 text-gray-900 dark:text-white",children:D.name}),l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:D.email}),l.jsx("td",{className:"py-3 px-4",children:l.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.is_active?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:D.is_active?"Active":"Inactive"})}),l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:D.created_at}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>R(D),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Edit admin",children:l.jsx(DW,{size:18})}),l.jsx("button",{onClick:()=>c(D.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete admin",children:l.jsx(Cm,{size:18})})]})})]},D.id))})]})})})}),e&&l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 dark:bg-gray-900 dark:bg-opacity-75",onClick:()=>r(!1)}),l.jsx("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:l.jsxs("form",{onSubmit:N,children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:l.jsxs("div",{className:"mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:n?"Edit Administrator":"Add New Administrator"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),l.jsx("input",{type:"text",value:m.name,onChange:D=>g("name",D.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),x.name&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:x.name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),l.jsx("input",{type:"email",value:m.email,onChange:D=>g("email",D.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),x.email&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:x.email})]}),n&&l.jsx("div",{children:l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:m.is_active,onChange:D=>g("is_active",D.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Active"})]})}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Password ",n&&l.jsx("span",{className:"text-gray-500 text-xs",children:"(leave blank to keep current)"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:u?"text":"password",value:m.password,onChange:D=>g("password",D.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!n}),l.jsx("button",{type:"button",onClick:()=>d(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none transition-colors",children:u?l.jsx(Ay,{size:20}):l.jsx(Sm,{size:20})})]}),x.password&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:x.password})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm Password"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:f?"text":"password",value:m.password_confirmation,onChange:D=>g("password_confirmation",D.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",required:!n}),l.jsx("button",{type:"button",onClick:()=>h(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none transition-colors",children:f?l.jsx(Ay,{size:20}):l.jsx(Sm,{size:20})})]}),x.password_confirmation&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:x.password_confirmation})]})]})]})}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[l.jsx("button",{type:"submit",disabled:v,className:"w-full inline-flex justify-center rounded-lg border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50",children:v?n?"Updating...":"Creating...":n?"Update Admin":"Create Admin"}),l.jsx("button",{type:"button",onClick:()=>r(!1),className:"mt-3 w-full inline-flex justify-center rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})})]})}),a&&l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 dark:bg-gray-900 dark:bg-opacity-75",onClick:()=>c(null)}),l.jsxs("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:l.jsxs("div",{className:"sm:flex sm:items-start",children:[l.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/20 sm:mx-0 sm:h-10 sm:w-10",children:l.jsx(Cm,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),l.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white",children:"Delete Administrator"}),l.jsx("div",{className:"mt-2",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Are you sure you want to delete this administrator? This action cannot be undone."})})]})]})}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[l.jsx("button",{type:"button",onClick:()=>E(a),disabled:v,className:"w-full inline-flex justify-center rounded-lg border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50",children:v?"Deleting...":"Delete"}),l.jsx("button",{type:"button",onClick:()=>c(null),className:"mt-3 w-full inline-flex justify-center rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})]})})},mWe=Object.freeze(Object.defineProperty({__proto__:null,default:gWe},Symbol.toStringTag,{value:"Module"})),pWe=({stats:t})=>l.jsx(rR,{title:"Super Admin Dashboard",children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Super Admin Dashboard"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx(ma,{title:"Total Admins",value:(t==null?void 0:t.total_admins)||0,icon:l.jsx(F1,{}),color:"blue"}),l.jsx(ma,{title:"Total HEIs",value:(t==null?void 0:t.total_heis)||0,icon:l.jsx(NA,{}),color:"green"}),l.jsx(ma,{title:"Total Submissions",value:(t==null?void 0:t.total_submissions)||0,icon:l.jsx(ba,{}),color:"purple"}),l.jsx(ma,{title:"System Audit Logs",value:(t==null?void 0:t.total_audit_logs)||0,icon:l.jsx(pt,{}),color:"yellow"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"System Overview"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Welcome to the CHED HEI Information Management System. As a Super Administrator, you have full access to manage administrators, view system audit logs, and configure system settings."})]})]})}),yWe=Object.freeze(Object.defineProperty({__proto__:null,default:pWe},Symbol.toStringTag,{value:"Module"})),vWe=({settings:t})=>{const{data:e,setData:r,post:n,processing:i,errors:s}=Oo({system_name:(t==null?void 0:t.system_name)||"CHED HEI Information System",academic_year_start:(t==null?void 0:t.academic_year_start)||new Date().getFullYear(),submission_deadline:(t==null?void 0:t.submission_deadline)||"",maintenance_mode:(t==null?void 0:t.maintenance_mode)||!1}),o=a=>{a.preventDefault(),n("/super-admin/settings")};return l.jsx(rR,{title:"System Settings",children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Settings"}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:l.jsxs("form",{onSubmit:o,className:"space-y-6",children:[l.jsx(qt,{label:"System Name",name:"system_name",value:e.system_name,onChange:a=>r("system_name",a.target.value),error:s.system_name,required:!0}),l.jsx(qt,{label:"Academic Year Start",name:"academic_year_start",type:"number",value:e.academic_year_start,onChange:a=>r("academic_year_start",a.target.value),error:s.academic_year_start,placeholder:"e.g., 2025",helperText:"The starting year of the current academic year (e.g., 2025 for 2025-2026)",required:!0}),l.jsx(qt,{label:"Annual Submission Deadline",name:"submission_deadline",type:"date",value:e.submission_deadline,onChange:a=>r("submission_deadline",a.target.value),error:s.submission_deadline}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{type:"checkbox",id:"maintenance_mode",checked:e.maintenance_mode,onChange:a=>r("maintenance_mode",a.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsx("label",{htmlFor:"maintenance_mode",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Enable Maintenance Mode"})]}),l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Saving...":"Save Settings"})})]})})]})})},wWe=Object.freeze(Object.defineProperty({__proto__:null,default:vWe},Symbol.toStringTag,{value:"Module"})),bWe=({logs:t})=>{const e=[{header:"Action",render:n=>l.jsx(MA,{status:n.action,label:n.action})},{header:"User",accessor:"user.name"},{header:"Model",accessor:"model"},{header:"Model ID",accessor:"model_id"},{header:"Reason",render:n=>n.reason||"N/A"},{header:"Timestamp",render:n=>an(n.created_at)}],r=()=>{LW("/super-admin/system-audit-logs/export","system-audit-logs.xlsx")};return l.jsx(rR,{title:"System Audit Logs",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"System Audit Logs"}),l.jsx("button",{onClick:r,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Export to Excel"})]}),l.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4",children:l.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Audit logs are immutable and can only be modified via direct database access."})}),l.jsx(PA,{columns:e,data:(t==null?void 0:t.data)||[],emptyMessage:"No audit logs found"})]})})},xWe=Object.freeze(Object.defineProperty({__proto__:null,default:bWe},Symbol.toStringTag,{value:"Module"}));window.axios=Hr;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var FK,nB=Vz;FK=nB.createRoot,nB.hydrateRoot;$ee({resolve:t=>Object.assign({"./Pages/Admin/AuditLogs.jsx":dte,"./Pages/Admin/CHEDContacts.jsx":fte,"./Pages/Admin/Dashboard.jsx":mte,"./Pages/Admin/HEIAccounts.jsx":yte,"./Pages/Admin/HEIAccounts/Create.jsx":wte,"./Pages/Admin/HEIAccounts/Edit.jsx":xte,"./Pages/Admin/HEIAccounts/Index.jsx":Cte,"./Pages/Admin/Submissions.jsx":Rte,"./Pages/Admin/Submissions/Index.jsx":$Ve,"./Pages/Admin/Submissions/Requests.jsx":LVe,"./Pages/Auth/ChangePassword.jsx":VVe,"./Pages/Auth/ForgotPassword.jsx":WVe,"./Pages/Auth/Login.jsx":YVe,"./Pages/HEI/AnnexA/Create.jsx":KVe,"./Pages/HEI/AnnexA/History.jsx":XVe,"./Pages/HEI/AnnexB/Create.jsx":JVe,"./Pages/HEI/AnnexB/History.jsx":eBe,"./Pages/HEI/AnnexC/Create.jsx":rBe,"./Pages/HEI/AnnexC/History.jsx":iBe,"./Pages/HEI/AnnexD/Create.jsx":oBe,"./Pages/HEI/AnnexD/History.jsx":lBe,"./Pages/HEI/AnnexE/Create.jsx":uBe,"./Pages/HEI/AnnexE/History.jsx":hBe,"./Pages/HEI/AnnexF/Create.jsx":gBe,"./Pages/HEI/AnnexF/History.jsx":pBe,"./Pages/HEI/AnnexG/Create.jsx":vBe,"./Pages/HEI/AnnexG/History.jsx":bBe,"./Pages/HEI/AnnexH/Create.jsx":SBe,"./Pages/HEI/AnnexH/History.jsx":_Be,"./Pages/HEI/AnnexI/Create.jsx":EBe,"./Pages/HEI/AnnexI/History.jsx":kBe,"./Pages/HEI/AnnexJ/Create.jsx":PBe,"./Pages/HEI/AnnexJ/History.jsx":ABe,"./Pages/HEI/AnnexK/Create.jsx":IBe,"./Pages/HEI/AnnexK/History.jsx":HBe,"./Pages/HEI/AnnexL/Create.jsx":DBe,"./Pages/HEI/AnnexL/History.jsx":FBe,"./Pages/HEI/AnnexM/Create.jsx":zBe,"./Pages/HEI/AnnexM/History.jsx":GBe,"./Pages/HEI/AnnexN/Create.jsx":qBe,"./Pages/HEI/AnnexN/History.jsx":QBe,"./Pages/HEI/AnnexO/Create.jsx":ZBe,"./Pages/HEI/AnnexO/History.jsx":tWe,"./Pages/HEI/Dashboard.jsx":nWe,"./Pages/HEI/Profile.jsx":sWe,"./Pages/HEI/Submission/Create.jsx":aWe,"./Pages/HEI/Submission/DetailsCreate.jsx":cWe,"./Pages/HEI/Submission/History.jsx":dWe,"./Pages/Profile/Edit.jsx":fWe,"./Pages/SuperAdmin/AdminManagement.jsx":mWe,"./Pages/SuperAdmin/Dashboard.jsx":yWe,"./Pages/SuperAdmin/Settings.jsx":wWe,"./Pages/SuperAdmin/SystemAuditLogs.jsx":xWe})[`./Pages/${t}.jsx`],setup({el:t,App:e,props:r}){FK(t).render(l.jsx(Wee,{children:l.jsx(e,{...r})}))}})});export default SWe();
